[{"path":".env.local","fileType":"local","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"ENV\u003dLOCAL"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"DB_LOCAL_URI\u003dmongodb://mongo:27017/peerprep"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"DB_URI_DEV\u003dmongodb://mongo:27017/peerprep"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"REFRESH_TOKEN_SECRET\u003dd094b5d45a93e9b1f9bc6dee9aff27e26bf7a875333db0df955415e87151c16a49a72b6ee85ce483e6a243a0fbf8b93989dc150cacdd970c29053a650d4fb908"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"REDIS_HOST\u003dredis"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"POSTGRES_HOST\u003d\u0027postgres_db\u0027"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"POSTGRES_USER\u003d\u0027postgres\u0027"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"POSTGRES_DB\u003d\u0027postgres_db\u0027"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"POSTGRES_PASSWORD\u003d\u0027postgres\u0027"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"POSTGRES_PORT\u003d5432"}],"authorContributionMap":{"Hzxin":6,"tlylt":4,"uyencfi":2}},{"path":".github/PULL_REQUEST_TEMPLATE","fileType":"PULL_REQUEST_TEMPLATE","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"**What is the purpose of this pull request?**"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"- [ ] Documentation update"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"- [ ] Bug fix"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"- [ ] Feature addition or enhancement"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"- [ ] Code maintenance or refactor"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"- [ ] Test"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"- [ ] DevOps"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"- [ ] Others:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"**Overview of changes**"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"**How it was tested/How to test**"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"**Service(s) Touched**"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"- [ ] Frontend"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"- [ ] User Service"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"- [ ] Matching Service"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"- [ ] Question Service"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"- [ ] Collaboration Service"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"- [ ] History Service"}],"authorContributionMap":{"MarcusTXK":1,"tlylt":20,"uyencfi":1}},{"path":".github/workflows/contributions.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"name: Deploy RepoSense report"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"on:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  # For active deployment on push to main branch"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  push:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    branches:"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"      - main"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"jobs:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  deploy:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    runs-on: ubuntu-latest"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    steps:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      - uses: tlylt/reposense-action@v1"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        with:"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"          token: ${{ secrets.GITHUB_TOKEN }} # Required"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"          cliArgs: \u0027--since d1\u0027"}],"authorContributionMap":{"tlylt":15}},{"path":".github/workflows/deploy.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"name: Deploy To Production"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"on:"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"  push:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"    branches:"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"      - production"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"env:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  SHA: $(git rev-parse HEAD)"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"jobs:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"  build:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"    runs-on: ubuntu-latest"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    steps:"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"      - uses: actions/checkout@v3"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"      - name: Login to Docker"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"        run: |-"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"          # docker login -u ${{ secrets.DOCKER_USERNAME }} -p ${{ secrets.DOCKER_PASSWORD }}"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"          echo ${{ secrets.DOCKER_PASSWORD }} | docker login -u ${{ secrets.DOCKER_USERNAME }} --password-stdin"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"      - name: Set Service Key"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"        uses: \u0027google-github-actions/auth@v0\u0027"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"        with:"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"          credentials_json: \u0027${{ secrets.GKE_SA_KEY }}\u0027"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"      - name: Set Project"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"        uses: google-github-actions/setup-gcloud@v0"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"        with:"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"          project_id: cs3219-365909 # from google cloud console"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"      - name: Auth"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"        run: |-"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"          gcloud --quiet auth configure-docker"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"      - name: Get Credentials"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"        uses: google-github-actions/get-gke-credentials@v0"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"        with:"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"          cluster_name: cs3219-cluster"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"          location: asia-southeast1-a"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"      - name: Build new Docker image"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"        run: |-"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"          docker build -t b9jmthkk/frontend:latest -t b9jmthkk/frontend:${{ env.SHA }} -f ./frontend/Dockerfile.production ./frontend"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"          docker build -t b9jmthkk/user:latest -t b9jmthkk/user:${{ env.SHA }} -f ./user-service/Dockerfile ./user-service"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"          docker build -t b9jmthkk/question:latest -t b9jmthkk/question:${{ env.SHA }} -f ./question-service/Dockerfile ./question-service"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"          docker build -t b9jmthkk/matching:latest -t b9jmthkk/matching:${{ env.SHA }} -f ./matching-service/Dockerfile ./matching-service"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"          docker build -t b9jmthkk/room:latest -t b9jmthkk/room:${{ env.SHA }} -f ./room-service/Dockerfile ./room-service"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"          docker build -t b9jmthkk/history:latest -t b9jmthkk/history:${{ env.SHA }} -f ./history-service/Dockerfile ./history-service"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"      - name: Push to Docker Hub"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"        run: |-"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"          docker push b9jmthkk/frontend:latest"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"          docker push b9jmthkk/user:latest"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"          docker push b9jmthkk/question:latest"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"          docker push b9jmthkk/matching:latest"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"          docker push b9jmthkk/room:latest"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"          docker push b9jmthkk/history:latest"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"          docker push b9jmthkk/frontend:${{ env.SHA }}"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"          docker push b9jmthkk/user:${{ env.SHA }}"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"          docker push b9jmthkk/question:${{ env.SHA }}"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"          docker push b9jmthkk/matching:${{ env.SHA }}"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"          docker push b9jmthkk/room:${{ env.SHA }}"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"          docker push b9jmthkk/history:${{ env.SHA }}"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"      - name: Re-Apply K8s Config and update image"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"        run: |-"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"          kubectl apply -f k8s/manifests"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"          kubectl set image deployments/frontend-deployment frontend\u003db9jmthkk/frontend:${{ env.SHA }}"},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"          kubectl set image deployments/user-deployment user\u003db9jmthkk/user:${{ env.SHA }}"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"          kubectl set image deployments/question-deployment question\u003db9jmthkk/question:${{ env.SHA }}"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"          kubectl set image deployments/matching-deployment matching\u003db9jmthkk/matching:${{ env.SHA }}"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":"          kubectl set image deployments/room-deployment room\u003db9jmthkk/room:${{ env.SHA }}"},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"          kubectl set image deployments/history-deployment history\u003db9jmthkk/history:${{ env.SHA }}"}],"authorContributionMap":{"tlylt":75}},{"path":".github/workflows/frontend.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"name: Frontend"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"on:"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"  push:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"    branches:"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"      - main"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    tags:"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"      - \u0027v[0-9]+.[0-9]+.[0-9]+\u0027"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  pull_request:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"jobs:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"  Frontend:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"    runs-on: ubuntu-latest"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    defaults:"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"      run:"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"        shell: bash"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        working-directory: frontend"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"    steps:"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"      - uses: actions/checkout@v2"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"      - uses: actions/setup-node@v2"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"        with:"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"          node-version: \u002714\u0027"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"      - name: Install dependencies"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"        run: npm ci"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"      - name: Lint"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        run: npm run lint"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"      - name: Build"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"        run: npm run build"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"      - name: Test"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"        run: docker-compose -f docker-compose.test.yml up"}],"authorContributionMap":{"tlylt":29}},{"path":".github/workflows/question-service.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"name: Question Service Test"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"on:"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"  push:"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"    branches:"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"      - main"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"    tags:"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"      - \u0027v[0-9]+.[0-9]+.[0-9]+\u0027"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"  pull_request:"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"jobs:"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"  Test:"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"    runs-on: ubuntu-latest"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"    defaults:"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"      run:"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"        shell: bash"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"        working-directory: question-service"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"    steps:"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"      - uses: actions/checkout@v2"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"      - name: Run lint \u0026 test via docker-compose"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"        run: docker-compose -f docker-compose.test.yml up --exit-code-from web --build"}],"authorContributionMap":{"Hzxin":20}},{"path":".github/workflows/user-service.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"name: User Service Test"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"on:"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"  push:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"    branches:"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"      - main"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    tags:"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"      - \u0027v[0-9]+.[0-9]+.[0-9]+\u0027"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  pull_request:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"jobs:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"  Test:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"    runs-on: ubuntu-latest"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    defaults:"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"      run:"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"        shell: bash"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        working-directory: user-service"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"    steps:"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"      - uses: actions/checkout@v2"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"      - name: Run lint \u0026 test via docker-compose"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"        run: docker-compose -f docker-compose.test.yml up --exit-code-from web --build"}],"authorContributionMap":{"tlylt":20}},{"path":"README.md","fileType":"md","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"# CS3219-AY22-23-Project-Group-58"},{"lineNumber":2,"author":{"gitId":"-"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"LeetWithFriend at https://leetwithfriend.com/"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"- An interview preparation platform and peer matching system, where students can find peers to practice whiteboard-style interview questions together."},{"lineNumber":6,"author":{"gitId":"-"},"content":""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"## Development"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"Spin up all the services for local manual testing"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"```bash"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"docker-compose -f docker-compose.local.yml up --build -d"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"```"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"Visit the frontend at http://localhost:80"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"To stop the services"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"```bash"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"docker-compose -f docker-compose.local.yml stop"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"```"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"Available seeded users for testing:"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"| Username | Password |"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"|----------|----------|"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"| qwe      | qwe      |"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"| asd      | asd      |"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"| zxc      | zxc      |"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":31,"author":{"gitId":"-"},"content":"## User Service"},{"lineNumber":32,"author":{"gitId":"-"},"content":"1. Rename `.env.sample` file to `.env`."},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"1. Create a Cloud DB URL using Mongo Atlas."},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"1. Enter the DB URL created as `DB_CLOUD_URI` in `.env` file."},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"1. Setup dependencies via `npm ci`"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"1. Install npm packages using `npm i`."},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"1. Run User Service using `npm run dev`."},{"lineNumber":38,"author":{"gitId":"-"},"content":""},{"lineNumber":39,"author":{"gitId":"-"},"content":"## Frontend"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"1. Setup dependencies via `npm ci`"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"1. Install new npm packages using `npm i`."},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"1. Run Frontend using `npm start`."}],"authorContributionMap":{"tlylt":36,"-":6}},{"path":"configs/author-config.csv","fileType":"csv","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"Repository\u0027s Location,Branch,Author\u0027s GitHub ID, Author\u0027s Emails, Author\u0027s Display Name,Author\u0027s Git Author Name,Ignore Glob List"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"https://github.com/CS3219-AY2223S1/cs3219-project-ay2223s1-g58.git,main,Hzxin,,Huang ZhenXin,,"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"https://github.com/CS3219-AY2223S1/cs3219-project-ay2223s1-g58.git,main,tlylt,,Liu Yongliang,tlylt,"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"https://github.com/CS3219-AY2223S1/cs3219-project-ay2223s1-g58.git,main,MarcusTXK,,Marcus Tang Xin Kye,,"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"https://github.com/CS3219-AY2223S1/cs3219-project-ay2223s1-g58.git,main,uyencfi,,Ngo Ngoc Phuong Uyen,,"}],"authorContributionMap":{"tlylt":5}},{"path":"configs/repo-config.csv","fileType":"csv","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"Repository\u0027s Location,Branch,File formats,Ignore Glob List,Ignore standalone config,Ignore Commits List,Ignore Authors List,Skip Ignored File Analysis"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"https://github.com/CS3219-AY2223S1/cs3219-project-ay2223s1-g58.git,main,,**.json,,,dependabot[bot];github-classroom[bot],yes"}],"authorContributionMap":{"tlylt":2}},{"path":"docker-compose.frontend.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"version: \"3.3\""},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"services:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  mongo:"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"    image: mongo"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    ports:"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"      - \"27017:27017\""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  redis:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    image: redis:alpine"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    ports:"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"      - \"6379:6379\""},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"  user-service:"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    build:"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"      context: ./user-service"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    ports:"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"      - \"8000:8000\""},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"    links:"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"      - mongo"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"      - redis"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"    depends_on:"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"      - mongo"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"      - redis"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"    env_file:"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"      - .env.local"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"    environment:"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"      - PORT\u003d3000"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"  matching-service:"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"    build:"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"      context: ./matching-service"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"    ports:"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"      - \"8001:8001\""},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"    environment:"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"      - PORT\u003d3000"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"      - URI_ROOM_SERVICE\u003dhttp://room-service:8022"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"      - URI_HISTORY_SERVICE\u003dhttp://history-service:8080"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"      - ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"  room-service:"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"    build:"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"      context: ./room-service"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"    ports:"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"      - \"8022:8022\""},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"    environment:"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"      - PORT\u003d3000"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"      - URI_QUESTION_SERVICE\u003dhttp://question-service:8500"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"      - ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"  postgres_db:"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"    image: postgres:latest"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"    restart: always"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"    ports:"},{"lineNumber":53,"author":{"gitId":"MarcusTXK"},"content":"      - \"5432:5432\""},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"    environment:"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"      POSTGRES_PASSWORD: postgres"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"      POSTGRES_DB: postgres_db"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"      POSTGRES_USER: postgres"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"      POSTGRES_HOST: postgres_db"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"      POSTGRES_PORT: 5432"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"    healthcheck:"},{"lineNumber":61,"author":{"gitId":"MarcusTXK"},"content":"      test: [\"CMD\", \"pg_isready\", \"-q\", \"-d\", \"postgres_db\", \"-U\", \"postgres\"]"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"      interval: 5s"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"      timeout: 5s"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"      retries: 5"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"  question-service:"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"    build:"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"      context: ./question-service"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"    ports:"},{"lineNumber":69,"author":{"gitId":"MarcusTXK"},"content":"      - \"8500:8500\""},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"    depends_on:"},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"      postgres_db:"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"        condition: service_healthy"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"    environment:"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":"      - PORT\u003d3000"},{"lineNumber":75,"author":{"gitId":"Hzxin"},"content":"    env_file:"},{"lineNumber":76,"author":{"gitId":"Hzxin"},"content":"      - .env.local"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"    links:"},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"      - postgres_db"},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"    restart: on-failure"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"  history-service:"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"    build:"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"      context: ./history-service"},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"    ports:"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"      - \"8080:8080\""},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"    links:"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"      - mongo"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"    depends_on:"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"      - mongo"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"    env_file:"},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"      - .env.local"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"    environment:"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"      - PORT\u003d3000"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"      - URI_QUESTION_SERVICE\u003dhttp://question-service:8500"}],"authorContributionMap":{"MarcusTXK":18,"Hzxin":2,"tlylt":58,"uyencfi":16}},{"path":"docker-compose.local.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"version: \"3.3\""},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"services:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  mongo:"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"    image: mongo"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    ports:"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"      - \"27017:27017\""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  redis:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    image: redis:alpine"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    ports:"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"      - \"6379:6379\""},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"  user-service:"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    build:"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"      context: ./user-service"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    ports:"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"      - \"8000:8000\""},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"    links:"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"      - mongo"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"      - redis"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"    depends_on:"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"      - mongo"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"      - redis"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"    env_file:"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"      - .env.local"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"    environment:"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"      - PORT\u003d80"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"  matching-service:"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"    build:"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"      context: ./matching-service"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"    ports:"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"      - \"8001:8001\""},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"    environment:"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"      - PORT\u003d80"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"      - URI_HISTORY_SERVICE\u003dhttp://history-service:8080"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"      - URI_ROOM_SERVICE\u003dhttp://room-service:8022"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"      - ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"  room-service:"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"    build:"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"      context: ./room-service"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"    ports:"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"      - \"8022:8022\""},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"    environment:"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"      - PORT\u003d80"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"      - URI_QUESTION_SERVICE\u003dhttp://question-service:8500"},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"      - ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"  postgres_db:"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"    image: postgres:latest"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    restart: always"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"    ports:"},{"lineNumber":53,"author":{"gitId":"MarcusTXK"},"content":"      - \"5432:5432\""},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"    environment:"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"      POSTGRES_PASSWORD: postgres"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"      POSTGRES_DB: postgres_db"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"      POSTGRES_USER: postgres"},{"lineNumber":58,"author":{"gitId":"MarcusTXK"},"content":"      POSTGRES_HOST: postgres_db"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"      POSTGRES_PORT: 5432"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"    healthcheck:"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"      test: [\"CMD\", \"pg_isready\", \"-q\", \"-d\", \"postgres_db\", \"-U\", \"postgres\"]"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"      interval: 5s"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"      timeout: 5s"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"      retries: 5"},{"lineNumber":65,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"  question-service:"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"    build:"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"      context: ./question-service"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"    ports:"},{"lineNumber":70,"author":{"gitId":"MarcusTXK"},"content":"      - \"8500:8500\""},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"    depends_on:"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"      postgres_db:"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"        condition: service_healthy"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"    environment:"},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"      - PORT\u003d80"},{"lineNumber":76,"author":{"gitId":"Hzxin"},"content":"    env_file:"},{"lineNumber":77,"author":{"gitId":"Hzxin"},"content":"      - .env.local"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"    links:"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"      - postgres_db"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"    restart: on-failure"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"  "},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"  history-service:"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"    build:"},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"      context: ./history-service"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"    ports:"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"      - \"8080:8080\""},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"    links:"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"      - mongo"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"    depends_on:"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"      - mongo"},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"    env_file:"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"      - .env.local"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"    environment:"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"      - PORT\u003d80"},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"      - URI_QUESTION_SERVICE\u003dhttp://question-service:8500"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":97,"author":{"gitId":"tlylt"},"content":"  frontend:"},{"lineNumber":98,"author":{"gitId":"tlylt"},"content":"    build:"},{"lineNumber":99,"author":{"gitId":"tlylt"},"content":"      context: ./frontend"},{"lineNumber":100,"author":{"gitId":"tlylt"},"content":"      dockerfile: Dockerfile"},{"lineNumber":101,"author":{"gitId":"tlylt"},"content":"    ports:"},{"lineNumber":102,"author":{"gitId":"tlylt"},"content":"      - \"80:80\""},{"lineNumber":103,"author":{"gitId":"MarcusTXK"},"content":"    environment:"},{"lineNumber":104,"author":{"gitId":"MarcusTXK"},"content":"      WATCHPACK_POLLING: \"true\""},{"lineNumber":105,"author":{"gitId":"MarcusTXK"},"content":"      CHOKIDAR_USEPOLLING: \"true\""},{"lineNumber":106,"author":{"gitId":"MarcusTXK"},"content":"    volumes:"},{"lineNumber":107,"author":{"gitId":"MarcusTXK"},"content":"      - /app/node_modules"},{"lineNumber":108,"author":{"gitId":"MarcusTXK"},"content":"      - ./frontend:/app"},{"lineNumber":109,"author":{"gitId":"tlylt"},"content":"    depends_on:"},{"lineNumber":110,"author":{"gitId":"tlylt"},"content":"      - user-service"},{"lineNumber":111,"author":{"gitId":"tlylt"},"content":"      - matching-service"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"      - question-service"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"      - history-service"},{"lineNumber":114,"author":{"gitId":"MarcusTXK"},"content":"      - room-service"}],"authorContributionMap":{"MarcusTXK":27,"Hzxin":2,"tlylt":38,"uyencfi":47}},{"path":"frontend/.dockerignore","fileType":"dockerignore","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"# See https://help.github.com/articles/ignoring-files/ for more about ignoring files."},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"# dependencies"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"/node_modules"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"/.pnp"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":".pnp.js"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"# testing"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"/coverage"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"# misc"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":".DS_Store"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"*.pem"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"# debug"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"npm-debug.log*"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"yarn-debug.log*"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"yarn-error.log*"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"# local env files"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":".env.local"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":".env.development.local"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":".env.test.local"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":".env.production.local"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"build"}],"authorContributionMap":{"tlylt":26}},{"path":"frontend/.eslintignore","fileType":"eslintignore","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"node_modules/*"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"package-lock.json"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"build"}],"authorContributionMap":{"tlylt":3}},{"path":"frontend/.gitignore","fileType":"gitignore","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"# See https://help.github.com/articles/ignoring-files/ for more about ignoring files."},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"# dependencies"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"/node_modules"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"/.pnp"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":".pnp.js"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"# testing"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"/coverage"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"# misc"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":".DS_Store"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"*.pem"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"# debug"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"npm-debug.log*"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"yarn-debug.log*"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"yarn-error.log*"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"# local env files"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":".env.local"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":".env.development.local"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":".env.test.local"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":".env.production.local"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"# production"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"/build"}],"authorContributionMap":{"tlylt":27}},{"path":"frontend/Dockerfile","fileType":"Dockerfile","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"FROM node:14-alpine as builder"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"WORKDIR /app"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"COPY package.json ."},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"COPY package-lock.json ."},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"RUN npm ci"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"COPY . ."},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"RUN npm run build"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"FROM nginx"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"# Remove default nginx index page"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"RUN rm -rf /usr/share/nginx/html/*"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"COPY --from\u003dbuilder /app/build /usr/share/nginx/html"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"# Remove default nginx configs to avoid conflict"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"RUN rm /etc/nginx/nginx.conf /etc/nginx/conf.d/default.conf"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"# Copy nginx config"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"COPY --from\u003dbuilder /app/nginx.conf /etc/nginx/nginx.conf"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":""}],"authorContributionMap":{"tlylt":26}},{"path":"frontend/Dockerfile.dev","fileType":"dev","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"FROM node:14-alpine"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"WORKDIR /app"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"COPY package.json ."},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"COPY package-lock.json ."},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"RUN npm ci --quiet"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"# Can be removed if using docker-compose, which maps the volume for you"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"COPY . ."},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"CMD [\"npm\", \"start\"]"}],"authorContributionMap":{"tlylt":13}},{"path":"frontend/Dockerfile.production","fileType":"production","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"FROM node:14-alpine as builder"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"WORKDIR /app"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"COPY package.json ."},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"COPY package-lock.json ."},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"RUN npm ci"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"COPY . ."},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"RUN npm run build"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"FROM nginx"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"# Remove default nginx index page"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"RUN rm -rf /usr/share/nginx/html/*"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"COPY --from\u003dbuilder /app/build /usr/share/nginx/html"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"# Remove default nginx configs to avoid conflict"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"RUN rm /etc/nginx/nginx.conf /etc/nginx/conf.d/default.conf"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"# Copy nginx production config"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"COPY --from\u003dbuilder /app/nginx.conf.production /etc/nginx/nginx.conf"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":""}],"authorContributionMap":{"tlylt":26}},{"path":"frontend/README.md","fileType":"md","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"# Frontend"},{"lineNumber":2,"author":{"gitId":"-"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"## Tech Stack"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"- [Chakra UI](https://chakra-ui.com/docs/components)"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"- [Tailwind CSS](https://tailwindcss.com/docs)"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"## Getting Started with Create React App"},{"lineNumber":9,"author":{"gitId":"-"},"content":""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"This project was bootstrapped with [Create React App](https://github.com/facebook/create-react-app)."},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"## Development"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"To make adjustments to only the frontend application:"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"Start other services"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"```bash"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"docker-compose -f docker-compose.frontend.yml up --build -d"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"```"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"Run `npm run start` in the `frontend` directory."},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"Visit the frontend at http://localhost:3000"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"To stop the services"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"```bash"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"docker-compose -f docker-compose.frontend.yml stop"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"```"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"## References"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"- [Tailwind Cheatsheet](https://tailwindcomponents.com/cheatsheet/)"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"- [JWT with React](https://www.youtube.com/watch?v\u003dnI8PYZNFtac)"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"- [Persistent user login](https://www.youtube.com/watch?v\u003d27KeYk-5vJw)"}],"authorContributionMap":{"tlylt":34,"-":2}},{"path":"frontend/config-overrides.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"// Override create-react-app\u0027s webpack configs for lucafabbian\u0027s Firepad to work"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"// This is used by react-app-rewired, see https://www.npmjs.com/package/react-app-rewired"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"// Without this package, we will run into this error:"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"// https://stackoverflow.com/questions/69427025/programmatic-webpack-jest-esm-cant-resolve-module-without-js-file-exten"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"module.exports \u003d function override(config, env) {"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  config.module.rules \u003d ["},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"    ...config.module.rules,"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    {"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"      test: /\\.m?js/,"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"      type: \"javascript/auto\","},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    },"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"    {"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"      test: /\\.m?js/,"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"      resolve: {"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"        fullySpecified: false,"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"    },"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"  ];"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"  return config;"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"};"}],"authorContributionMap":{"uyencfi":20}},{"path":"frontend/docker-compose.test.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"version: \"3\""},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"services:"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"    test:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"        environment:"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"            - CI\u003dtrue"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"        build:"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"            context: ."},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"            dockerfile: Dockerfile.dev"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"        command: [\"npm\", \"run\", \"test\"]"}],"authorContributionMap":{"tlylt":9}},{"path":"frontend/docker-compose.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"version: \"3\""},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"services:"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"    web:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"        build:"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"            context: ."},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"            dockerfile: Dockerfile.dev"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"        ports:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"            - \"3000:3000\""},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"        # For windows, volume only works if your files are under wsl"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        volumes:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"            - /app/node_modules"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"            - .:/app"}],"authorContributionMap":{"tlylt":12}},{"path":"frontend/nginx.conf","fileType":"conf","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"http {"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"    "},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"    server {"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"        "},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"        listen 80 default_server;"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"        listen [::]:80 default_server;"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"        server_name localhost;"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"        charset utf-8;"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"        include /etc/nginx/mime.types;"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        "},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"        location ~ ^/api/v1/user {"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"            proxy_set_header Host $host;"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"            proxy_set_header X-Real-IP $remote_addr;"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"            proxy_pass http://user-service:8000;"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"        location ~ ^/api/v1/matching {"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"            proxy_set_header Host $host;"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"            proxy_set_header X-Real-IP $remote_addr;"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"            proxy_pass http://matching-service:8001;"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"        location ~ ^/api/v1/room {"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"            proxy_set_header Host $host;"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"            proxy_set_header X-Real-IP $remote_addr;"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"            proxy_pass http://room-service:8022;"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"        }"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"        location ~ ^/api/v1/question {"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"            proxy_set_header Host $host;"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"            proxy_set_header X-Real-IP $remote_addr;"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"            proxy_pass http://question-service:8500;"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"        location ~ ^/api/v1/history {"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"            proxy_set_header Host $host;"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"            proxy_set_header X-Real-IP $remote_addr;"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"            proxy_pass http://history-service:8080;"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"        location ~ ^/socket.io/matching {"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"            proxy_set_header Host $host;"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"            proxy_set_header X-Real-IP $remote_addr;"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"            proxy_pass http://matching-service:8001;"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"            proxy_http_version 1.1;"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"            proxy_set_header Upgrade $http_upgrade;"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"            proxy_set_header Connection \"upgrade\";"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":63,"author":{"gitId":"MarcusTXK"},"content":"        location ~ ^/socket.io/room {"},{"lineNumber":64,"author":{"gitId":"MarcusTXK"},"content":"            proxy_set_header Host $host;"},{"lineNumber":65,"author":{"gitId":"MarcusTXK"},"content":"            proxy_set_header X-Real-IP $remote_addr;"},{"lineNumber":66,"author":{"gitId":"MarcusTXK"},"content":"            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"},{"lineNumber":67,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":68,"author":{"gitId":"MarcusTXK"},"content":"            proxy_pass http://room-service:8022;"},{"lineNumber":69,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":70,"author":{"gitId":"MarcusTXK"},"content":"            proxy_http_version 1.1;"},{"lineNumber":71,"author":{"gitId":"MarcusTXK"},"content":"            proxy_set_header Upgrade $http_upgrade;"},{"lineNumber":72,"author":{"gitId":"MarcusTXK"},"content":"            proxy_set_header Connection \"upgrade\";"},{"lineNumber":73,"author":{"gitId":"MarcusTXK"},"content":"        }"},{"lineNumber":74,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"        location / {"},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"            root /usr/share/nginx/html;"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"            try_files $uri $uri/ /index.html;           "},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":80,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":81,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":82,"author":{"gitId":"tlylt"},"content":"events {"},{"lineNumber":83,"author":{"gitId":"tlylt"},"content":"    worker_connections 1024;"},{"lineNumber":84,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"MarcusTXK":21,"tlylt":55,"uyencfi":8}},{"path":"frontend/nginx.conf.production","fileType":"production","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"http {"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"    "},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"    server {"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"        "},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"        listen 3000 default_server;"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"        listen [::]:3000 default_server;"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"        server_name localhost;"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"        charset utf-8;"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"        include /etc/nginx/mime.types;"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"        location / {"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"            root /usr/share/nginx/html;"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"            try_files $uri $uri/ /index.html;           "},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"events {"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"    worker_connections 1024;"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":20}},{"path":"frontend/postcss.config.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"module.exports \u003d {"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"  plugins: {"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"    tailwindcss: {},"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"    autoprefixer: {},"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  },"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":6}},{"path":"frontend/public/index.html","fileType":"html","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"\u003c!DOCTYPE html\u003e"},{"lineNumber":2,"author":{"gitId":"-"},"content":"\u003chtml lang\u003d\"en\"\u003e"},{"lineNumber":3,"author":{"gitId":"-"},"content":"    \u003chead\u003e"},{"lineNumber":4,"author":{"gitId":"-"},"content":"        \u003cmeta charset\u003d\"utf-8\" /\u003e"},{"lineNumber":5,"author":{"gitId":"-"},"content":"        \u003clink rel\u003d\"icon\" href\u003d\"%PUBLIC_URL%/favicon.ico\" /\u003e"},{"lineNumber":6,"author":{"gitId":"-"},"content":"        \u003cmeta name\u003d\"viewport\" content\u003d\"width\u003ddevice-width, initial-scale\u003d1\" /\u003e"},{"lineNumber":7,"author":{"gitId":"-"},"content":"        \u003cmeta name\u003d\"theme-color\" content\u003d\"#000000\" /\u003e"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"        \u003cmeta name\u003d\"description\" content\u003d\"LeetWithFriend\" /\u003e"},{"lineNumber":9,"author":{"gitId":"-"},"content":"        \u003clink rel\u003d\"apple-touch-icon\" href\u003d\"%PUBLIC_URL%/logo192.png\" /\u003e"},{"lineNumber":10,"author":{"gitId":"-"},"content":"        \u003c!--"},{"lineNumber":11,"author":{"gitId":"-"},"content":"      manifest.json provides metadata used when your web app is installed on a"},{"lineNumber":12,"author":{"gitId":"-"},"content":"      user\u0027s mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/"},{"lineNumber":13,"author":{"gitId":"-"},"content":"    --\u003e"},{"lineNumber":14,"author":{"gitId":"-"},"content":"        \u003clink rel\u003d\"manifest\" href\u003d\"%PUBLIC_URL%/manifest.json\" /\u003e"},{"lineNumber":15,"author":{"gitId":"-"},"content":"        \u003c!--"},{"lineNumber":16,"author":{"gitId":"-"},"content":"      Notice the use of %PUBLIC_URL% in the tags above."},{"lineNumber":17,"author":{"gitId":"-"},"content":"      It will be replaced with the URL of the `public` folder during the build."},{"lineNumber":18,"author":{"gitId":"-"},"content":"      Only files inside the `public` folder can be referenced from the HTML."},{"lineNumber":19,"author":{"gitId":"-"},"content":""},{"lineNumber":20,"author":{"gitId":"-"},"content":"      Unlike \"/favicon.ico\" or \"favicon.ico\", \"%PUBLIC_URL%/favicon.ico\" will"},{"lineNumber":21,"author":{"gitId":"-"},"content":"      work correctly both with client-side routing and a non-root public URL."},{"lineNumber":22,"author":{"gitId":"-"},"content":"      Learn how to configure a non-root public URL by running `npm run build`."},{"lineNumber":23,"author":{"gitId":"-"},"content":"    --\u003e"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"        \u003ctitle\u003eLeetWithFriend\u003c/title\u003e"},{"lineNumber":25,"author":{"gitId":"-"},"content":"    \u003c/head\u003e"},{"lineNumber":26,"author":{"gitId":"-"},"content":"    \u003cbody\u003e"},{"lineNumber":27,"author":{"gitId":"-"},"content":"        \u003cnoscript\u003eYou need to enable JavaScript to run this app.\u003c/noscript\u003e"},{"lineNumber":28,"author":{"gitId":"-"},"content":"        \u003cdiv id\u003d\"root\"\u003e\u003c/div\u003e"},{"lineNumber":29,"author":{"gitId":"-"},"content":"        \u003c!--"},{"lineNumber":30,"author":{"gitId":"-"},"content":"      This HTML file is a template."},{"lineNumber":31,"author":{"gitId":"-"},"content":"      If you open it directly in the browser, you will see an empty page."},{"lineNumber":32,"author":{"gitId":"-"},"content":""},{"lineNumber":33,"author":{"gitId":"-"},"content":"      You can add webfonts, meta tags, or analytics to this file."},{"lineNumber":34,"author":{"gitId":"-"},"content":"      The build step will place the bundled scripts into the \u003cbody\u003e tag."},{"lineNumber":35,"author":{"gitId":"-"},"content":""},{"lineNumber":36,"author":{"gitId":"-"},"content":"      To begin the development, run `npm start` or `yarn start`."},{"lineNumber":37,"author":{"gitId":"-"},"content":"      To create a production bundle, use `npm run build` or `yarn build`."},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"    --\u003e\u003c/body\u003e"},{"lineNumber":39,"author":{"gitId":"-"},"content":"\u003c/html\u003e"}],"authorContributionMap":{"tlylt":3,"-":36}},{"path":"frontend/public/profile.svg","fileType":"svg","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"\u003csvg xmlns:dc\u003d\"http://purl.org/dc/elements/1.1/\" xmlns:cc\u003d\"http://creativecommons.org/ns#\" xmlns:rdf\u003d\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\" xmlns:svg\u003d\"http://www.w3.org/2000/svg\" xmlns\u003d\"http://www.w3.org/2000/svg\" viewBox\u003d\"0 0 180 180\" width\u003d\"60\" height\u003d\"60\"\u003e\u003cmetadata\u003e\u003crdf:RDF\u003e\u003ccc:Work\u003e\u003cdc:format\u003eimage/svg+xml\u003c/dc:format\u003e\u003cdc:type rdf:resource\u003d\"http://purl.org/dc/dcmitype/StillImage\"/\u003e\u003cdc:title\u003eBottts\u003c/dc:title\u003e\u003cdc:creator\u003e\u003ccc:Agent\u003e\u003cdc:title\u003ePablo Stanley\u003c/dc:title\u003e\u003c/cc:Agent\u003e\u003c/dc:creator\u003e\u003cdc:source\u003ehttps://bottts.com/\u003c/dc:source\u003e\u003ccc:license rdf:resource\u003d\"https://bottts.com/\"/\u003e\u003cdc:contributor\u003e\u003ccc:Agent\u003e\u003cdc:title\u003eFlorian Krner\u003c/dc:title\u003e\u003c/cc:Agent\u003e\u003c/dc:contributor\u003e\u003c/cc:Work\u003e\u003c/rdf:RDF\u003e\u003c/metadata\u003e\u003cmask id\u003d\"avatarsRadiusMask\"\u003e\u003crect width\u003d\"180\" height\u003d\"180\" rx\u003d\"0\" ry\u003d\"0\" x\u003d\"0\" y\u003d\"0\" fill\u003d\"#fff\"/\u003e\u003c/mask\u003e\u003cg mask\u003d\"url(#avatarsRadiusMask)\"\u003e\u003cg transform\u003d\"translate(0, 66)\"\u003e\u003cg opacity\u003d\"0.9\"\u003e\u003cpath id\u003d\"Cable\" d\u003d\"M38 12C35.046 23.6966 18.0959 18.6663 14.6313 30.009C11.1668 41.3518 22.6565 50 32.1552 50\" stroke\u003d\"#2A3544\" stroke-width\u003d\"6\"/\u003e\u003cpath id\u003d\"Cable_2\" d\u003d\"M150 55C158.394 58.4864 170.102 47.4063 166 38.5C161.898 29.5936 150 31.8056 150 19.195\" stroke\u003d\"#2A3544\" stroke-width\u003d\"4\"/\u003e\u003c/g\u003e\u003cpath fill-rule\u003d\"evenodd\" clip-rule\u003d\"evenodd\" d\u003d\"M138 6C136.895 6 136 6.89543 136 8V22C136 23.1046 136.895 24 138 24H157C158.105 24 159 23.1046 159 22V8C159 6.89543 158.105 6 157 6H138ZM21 37C21 35.8954 21.8954 35 23 35H35C36.1046 35 37 35.8954 37 37V55C37 56.1046 36.1046 57 35 57H23C21.8954 57 21 56.1046 21 55V37ZM136 44C136 42.8954 136.895 42 138 42H157C158.105 42 159 42.8954 159 44V62C159 63.1046 158.105 64 157 64H138C136.895 64 136 63.1046 136 62V44Z\" fill\u003d\"#273951\"/\u003e\u003cmask id\u003d\"sidesCables01Mask0\" mask-type\u003d\"alpha\" maskUnits\u003d\"userSpaceOnUse\" x\u003d\"21\" y\u003d\"6\" width\u003d\"138\" height\u003d\"58\"\u003e\u003cpath fill-rule\u003d\"evenodd\" clip-rule\u003d\"evenodd\" d\u003d\"M138 6C136.895 6 136 6.89543 136 8V22C136 23.1046 136.895 24 138 24H157C158.105 24 159 23.1046 159 22V8C159 6.89543 158.105 6 157 6H138ZM21 37C21 35.8954 21.8954 35 23 35H35C36.1046 35 37 35.8954 37 37V55C37 56.1046 36.1046 57 35 57H23C21.8954 57 21 56.1046 21 55V37ZM136 44C136 42.8954 136.895 42 138 42H157C158.105 42 159 42.8954 159 44V62C159 63.1046 158.105 64 157 64H138C136.895 64 136 63.1046 136 62V44Z\" fill\u003d\"white\"/\u003e\u003c/mask\u003e\u003cg mask\u003d\"url(#sidesCables01Mask0)\"\u003e\u003crect width\u003d\"180\" height\u003d\"76\" fill\u003d\"#26C6DA\"/\u003e\u003c/g\u003e\u003c/g\u003e\u003cg transform\u003d\"translate(41, 0)\"\u003e\u003cpath fill-rule\u003d\"evenodd\" clip-rule\u003d\"evenodd\" d\u003d\"M53.5683 39L55.5437 34.3851L49.3528 23.7098L52.2483 13.0836L49.3539 12.2949L46.1288 24.1305L52.179 34.5631L50.0881 39H38V52H62V39H53.5683Z\" fill\u003d\"#E6E6E6\"/\u003e\u003cmask id\u003d\"topAntennaCrookedMask0\" mask-type\u003d\"alpha\" maskUnits\u003d\"userSpaceOnUse\" x\u003d\"38\" y\u003d\"12\" width\u003d\"24\" height\u003d\"40\"\u003e\u003cpath fill-rule\u003d\"evenodd\" clip-rule\u003d\"evenodd\" d\u003d\"M53.5683 39L55.5437 34.3851L49.3528 23.7098L52.2483 13.0836L49.3539 12.2949L46.1288 24.1305L52.179 34.5631L50.0881 39H38V52H62V39H53.5683Z\" fill\u003d\"white\"/\u003e\u003c/mask\u003e\u003cg mask\u003d\"url(#topAntennaCrookedMask0)\"\u003e\u003crect width\u003d\"100\" height\u003d\"52\" fill\u003d\"#26C6DA\"/\u003e\u003crect x\u003d\"38\" y\u003d\"39\" width\u003d\"24\" height\u003d\"13\" fill\u003d\"white\" fill-opacity\u003d\"0.2\"/\u003e\u003c/g\u003e\u003cpath fill-rule\u003d\"evenodd\" clip-rule\u003d\"evenodd\" d\u003d\"M50 16C54.4183 16 58 12.4183 58 8C58 3.58172 54.4183 0 50 0C45.5817 0 42 3.58172 42 8C42 12.4183 45.5817 16 50 16Z\" fill\u003d\"#FFE65C\"/\u003e\u003cpath fill-rule\u003d\"evenodd\" clip-rule\u003d\"evenodd\" d\u003d\"M53 8C54.6569 8 56 6.65685 56 5C56 3.34315 54.6569 2 53 2C51.3431 2 50 3.34315 50 5C50 6.65685 51.3431 8 53 8Z\" fill\u003d\"white\"/\u003e\u003c/g\u003e\u003cg transform\u003d\"translate(25, 44)\"\u003e\u003cpath d\u003d\"M0 12C0 5.37259 5.37258 0 12 0H118C124.627 0 130 5.37258 130 12V82C130 102.987 112.987 120 92 120H38C17.0132 120 0 102.987 0 82V12Z\" fill\u003d\"#0076DE\"/\u003e\u003cmask id\u003d\"faceSquare01Mask0\" mask-type\u003d\"alpha\" maskUnits\u003d\"userSpaceOnUse\" x\u003d\"0\" y\u003d\"0\" width\u003d\"130\" height\u003d\"120\"\u003e\u003cpath d\u003d\"M0 12C0 5.37259 5.37258 0 12 0H118C124.627 0 130 5.37258 130 12V82C130 102.987 112.987 120 92 120H38C17.0132 120 0 102.987 0 82V12Z\" fill\u003d\"white\"/\u003e\u003c/mask\u003e\u003cg mask\u003d\"url(#faceSquare01Mask0)\"\u003e\u003crect x\u003d\"-2\" y\u003d\"-2\" width\u003d\"134\" height\u003d\"124\" fill\u003d\"#00ACC1\"/\u003e\u003cpath fill-rule\u003d\"evenodd\" clip-rule\u003d\"evenodd\" d\u003d\"M120 130.649C116.812 113.308 110.453 128.073 95.1523 125.017C88.3923 123.666 93.8542 117.769 88.8124 115.213C84.5536 113.054 78.7499 114.793 73.8715 113.397C66.8312 111.382 66.9237 107.282 60.3639 106.669C54.1604 106.09 47.6616 107.999 41.4049 107.282C29.5967 105.928 34.4383 88.0585 25.5835 84.9025C16.7287 81.7465 2.15043 87.1967 0.242157 96.1317C-1.61816 104.842 10.8129 137.252 10.8129 137.252H120\" fill\u003d\"black\" fill-opacity\u003d\"0.2\"/\u003e\u003cpath fill-rule\u003d\"evenodd\" clip-rule\u003d\"evenodd\" d\u003d\"M156 122.767C104.757 122.767 99.4219 96.9746 74.2092 85.1582C48.9964 73.3418 26.9059 103.905 18.4298 74.2122C9.9537 44.5195 10.0005 137.072 10.0005 137.072H156V122.767Z\" fill\u003d\"black\" fill-opacity\u003d\"0.1\"/\u003e\u003cpath fill-rule\u003d\"evenodd\" clip-rule\u003d\"evenodd\" d\u003d\"M161.575 9.17587C149.64 8.20079 156.546 19.9843 151.83 19.9843C144.863 19.9843 149.727 12.0062 141.247 12.2048C139.028 12.2568 136.303 14.1443 136.135 16.709C135.773 22.2193 139.852 31.7253 134.297 31.9953C129.117 32.247 133.193 22.3562 132.652 15.7593C132.343 11.9871 128.47 9.00745 125.684 9.00745C118.113 9.00745 123.998 24.7147 118.549 24.7147C113.1 24.7147 117.341 15.6639 113.467 10.8715C108.964 5.29973 94.1677 2.55906 104.718 0H161.867\" fill\u003d\"black\" fill-opacity\u003d\"0.4\"/\u003e\u003c/g\u003e\u003c/g\u003e\u003cg transform\u003d\"translate(52, 124)\"\u003e\u003crect x\u003d\"16\" y\u003d\"8\" width\u003d\"44\" height\u003d\"4\" rx\u003d\"2\" fill\u003d\"black\" fill-opacity\u003d\"0.8\"/\u003e\u003c/g\u003e\u003cg transform\u003d\"translate(38, 76)\"\u003e\u003cpath d\u003d\"M29.2691 9.67983C26.7216 9.81334 24.305 11.9225 23.0195 13.8332C21.5357 12.0676 18.9175 10.2223 16.3701 10.3558C10.8883 10.6431 7.51531 14.1586 7.74073 18.4598C8.0406 24.1816 12.6244 27.3464 17.4365 30.7046C19.1523 31.8531 22.441 34.8494 22.8627 35.5214C23.2845 36.1935 25.0034 36.1278 25.4425 35.3862C25.8817 34.6446 28.7463 31.3502 30.3355 30.0286C34.7674 26.1859 38.9981 22.5592 38.6982 16.8374C38.4728 12.5362 34.7509 9.39254 29.2691 9.67983Z\" fill\u003d\"#FF5353\" fill-opacity\u003d\"0.8\"/\u003e\u003cpath d\u003d\"M87.6299 10.3558C85.0825 10.2223 82.4586 12.0673 80.9805 13.8332C79.6893 11.9222 77.2784 9.81331 74.7309 9.67981C69.2491 9.39252 65.5272 12.5361 65.3017 16.8374C65.0019 22.5591 69.2297 26.1857 73.6645 30.0286C75.2508 31.3501 78.2083 34.6738 78.5575 35.3862C78.9067 36.0987 80.623 36.2131 81.1373 35.5214C81.6515 34.8298 84.8449 31.8529 86.5635 30.7046C91.3728 27.3462 95.9594 24.1816 96.2593 18.4598C96.4847 14.1586 93.1117 10.6431 87.6299 10.3558Z\" fill\u003d\"#FF5353\" fill-opacity\u003d\"0.8\"/\u003e\u003c/g\u003e\u003c/g\u003e\u003c/svg\u003e"}],"authorContributionMap":{"tlylt":1}},{"path":"frontend/src/App.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"import { BrowserRouter, Routes, Route } from \u0027react-router-dom\u0027"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"import Signup from \u0027./pages/Signup\u0027"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"import Login from \u0027./pages/Login\u0027"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"import PageNotFound from \u0027./pages/PageNotFound\u0027"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"import Home from \u0027./pages/Home\u0027"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"import UserTokenTest from \u0027./pages/UserTokenTest\u0027"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"import Layout from \u0027./components/Layout\u0027"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"import RequireAuth from \u0027./components/RequireAuth\u0027"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"import Profile from \u0027./pages/Profile\u0027"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"import PersistLogin from \u0027./components/PersistLogin\u0027"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"import Match from \u0027./pages/Match\u0027"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"import Room from \u0027./pages/Room\u0027"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"import QuestionBank from \u0027./pages/QuestionBank\u0027"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"import QuestionPage from \u0027./pages/QuestionPage\u0027"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"import History from \u0027./pages/History.jsx\u0027"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":17,"author":{"gitId":"-"},"content":"function App() {"},{"lineNumber":18,"author":{"gitId":"-"},"content":"  return ("},{"lineNumber":19,"author":{"gitId":"-"},"content":"    \u003cdiv className\u003d\"App\"\u003e"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"      \u003cBrowserRouter\u003e"},{"lineNumber":21,"author":{"gitId":"-"},"content":"        \u003cRoutes\u003e"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"          \u003cRoute path\u003d\"/\" element\u003d{\u003cLayout /\u003e}\u003e"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"            {/* public routes */}"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"            \u003cRoute path\u003d\"/login\" element\u003d{\u003cLogin /\u003e} /\u003e"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"            \u003cRoute path\u003d\"/questions\" element\u003d{\u003cQuestionBank /\u003e} /\u003e"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"            \u003cRoute path\u003d\"/question/:questionId\" element\u003d{\u003cQuestionPage /\u003e} /\u003e"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"            \u003cRoute element\u003d{\u003cPersistLogin /\u003e}\u003e"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"              \u003cRoute path\u003d\"/signup\" element\u003d{\u003cSignup /\u003e} /\u003e"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"            \u003c/Route\u003e"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"            {/* private routes */}"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"            \u003cRoute element\u003d{\u003cPersistLogin /\u003e}\u003e"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"              \u003cRoute element\u003d{\u003cRequireAuth /\u003e}\u003e"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"                \u003cRoute path\u003d\"/\" element\u003d{\u003cHome /\u003e} /\u003e"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"                \u003cRoute path\u003d\"/profile\" element\u003d{\u003cProfile /\u003e} /\u003e"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"                \u003cRoute path\u003d\"/userTokenTest\" element\u003d{\u003cUserTokenTest /\u003e} /\u003e"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"                \u003cRoute path\u003d\"/match\" element\u003d{\u003cMatch /\u003e} /\u003e"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"                \u003cRoute path\u003d\"/room/:roomId\" element\u003d{\u003cRoom /\u003e} /\u003e"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"                \u003cRoute path\u003d\"/history\" element\u003d{\u003cHistory /\u003e} /\u003e"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"              \u003c/Route\u003e"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"            \u003c/Route\u003e"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"            {/* 404 */}"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"            \u003cRoute path\u003d\"*\" element\u003d{\u003cPageNotFound /\u003e} /\u003e"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"          \u003c/Route\u003e"},{"lineNumber":45,"author":{"gitId":"-"},"content":"        \u003c/Routes\u003e"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"      \u003c/BrowserRouter\u003e"},{"lineNumber":47,"author":{"gitId":"-"},"content":"    \u003c/div\u003e"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":49,"author":{"gitId":"-"},"content":"}"},{"lineNumber":50,"author":{"gitId":"-"},"content":""},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"export default App"}],"authorContributionMap":{"MarcusTXK":16,"Hzxin":4,"tlylt":20,"-":8,"uyencfi":3}},{"path":"frontend/src/App.test.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import App from \"./App\";"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { createRoot } from \u0027react-dom/client\u0027;"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"it(\u0027renders without crashing\u0027, () \u003d\u003e {"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"    const container \u003d document.createElement(\u0027div\u0027);"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    const root \u003d createRoot(container);"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    root.render(\u003cApp /\u003e);"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    root.unmount();"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":");"}],"authorContributionMap":{"tlylt":10}},{"path":"frontend/src/api/axios.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"import axios from \u0027axios\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"axios.defaults.withCredentials \u003d true"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"export default axios.create({"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  withCredentials: true,"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  headers: {"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    \u0027Content-Type\u0027: \u0027application/json\u0027,"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"})"}],"authorContributionMap":{"MarcusTXK":3,"tlylt":7}},{"path":"frontend/src/api/firebase.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import firebase from \u0027firebase/compat/app\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import \u0027firebase/compat/database\u0027"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"const firebaseConfig \u003d {"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"  apiKey: \u0027AIzaSyA4aSt26GSxjrebAMFuSykUEz-xPivu0NM\u0027,"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  authDomain: \u0027cs3219-peerprep-24ab8.firebaseapp.com\u0027,"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  databaseURL:"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    \u0027https://cs3219-peerprep-24ab8-default-rtdb.asia-southeast1.firebasedatabase.app\u0027,"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  projectId: \u0027cs3219-peerprep-24ab8\u0027,"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"  storageBucket: \u0027cs3219-peerprep-24ab8.appspot.com\u0027,"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"  messagingSenderId: \u0027116710912438\u0027,"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"  appId: \u00271:116710912438:web:153a1d1acd8d42a2cf5117\u0027,"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"  measurementId: \u0027G-B4XN4F6NJ1\u0027,"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"export const compatApp \u003d firebase.initializeApp(firebaseConfig)"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"export const db \u003d firebase.database(compatApp)"}],"authorContributionMap":{"uyencfi":17}},{"path":"frontend/src/components/AuthLayout.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { Logo } from \u0027./Logo\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"function BackgroundIllustration(props) {"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"    \u003csvg"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"      viewBox\u003d\"0 0 1090 1090\""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"      aria-hidden\u003d\"true\""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"      fill\u003d\"none\""},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      preserveAspectRatio\u003d\"none\""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"      {...props}"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    \u003e"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      \u003ccircle cx\u003d{545} cy\u003d{545} r\u003d\"544.5\" /\u003e"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"      \u003ccircle cx\u003d{545} cy\u003d{545} r\u003d\"480.5\" /\u003e"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"      \u003ccircle cx\u003d{545} cy\u003d{545} r\u003d\"416.5\" /\u003e"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      \u003ccircle cx\u003d{545} cy\u003d{545} r\u003d\"352.5\" /\u003e"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"    \u003c/svg\u003e"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"export function AuthLayout({ title, subtitle, children }) {"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"    \u003cmain className\u003d\"flex min-h-full pt-16 overflow-hidden sm:py-28\"\u003e"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"      \u003cdiv className\u003d\"flex flex-col w-full max-w-2xl px-4 mx-auto sm:px-6 \"\u003e"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"        \u003cLogo className\u003d\"h-10 mx-auto\" /\u003e"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        \u003cdiv className\u003d\"relative mt-12 sm:mt-16\"\u003e"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"          \u003cBackgroundIllustration"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"            width\u003d\"1090\""},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"            height\u003d\"1090\""},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"            className\u003d\"absolute -top-7 left-1/2 -z-10 h-[788px] -translate-x-1/2 stroke-gray-300/30 [mask-image:linear-gradient(to_bottom,white_20%,transparent_75%)] sm:-top-9 sm:h-auto\""},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"          /\u003e"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"          \u003ch1 className\u003d\"text-2xl font-medium tracking-tight text-center text-gray-900 dark:text-gray-200\"\u003e"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"            {title}"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"          \u003c/h1\u003e"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"          {subtitle \u0026\u0026 ("},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"            \u003cp className\u003d\"mt-3 text-lg text-center text-gray-600 dark:text-gray-200\"\u003e"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"              {subtitle}"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"            \u003c/p\u003e"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"          )}"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"        \u003c/div\u003e"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"        \u003cdiv className\u003d\"flex-auto px-4 py-10 mt-10 -mx-4 bg-white shadow-2xl shadow-gray-900/10 dark:bg-gray-100 sm:mx-0 sm:flex-none sm:rounded-5xl sm:p-24\"\u003e"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"          {children}"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"        \u003c/div\u003e"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"      \u003c/div\u003e"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"    \u003c/main\u003e"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":46}},{"path":"frontend/src/components/Button.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { forwardRef } from \u0027react\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import clsx from \u0027clsx\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import { Link } from \u0027react-router-dom\u0027"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"const baseStyles \u003d {"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  solid:"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    \u0027inline-flex justify-center rounded-lg py-2 px-3 text-sm font-semibold outline-2 outline-offset-2 transition-colors\u0027,"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  outline:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    \u0027inline-flex justify-center rounded-lg border py-[calc(theme(spacing.2)-1px)] px-[calc(theme(spacing.3)-1px)] text-sm outline-2 outline-offset-2 transition-colors\u0027,"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"const variantStyles \u003d {"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"  solid: {"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    cyan: \u0027relative overflow-hidden bg-cyan-500 text-white before:absolute before:inset-0 active:before:bg-transparent hover:before:bg-white/10 active:bg-cyan-600 active:text-white/80 before:transition-colors\u0027,"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    white:"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"      \u0027bg-white text-cyan-900 hover:bg-white/90 active:bg-white/90 active:text-cyan-900/70\u0027,"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"    gray: \u0027bg-gray-800 text-white hover:bg-gray-900 active:bg-gray-800 active:text-white/80\u0027,"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"  },"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"  outline: {"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"    gray: \u0027border-gray-300 text-gray-700 hover:border-gray-400 active:bg-gray-100 active:text-gray-700/80\u0027,"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"  },"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"export const Button \u003d forwardRef(function Button("},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"  { variant \u003d \u0027solid\u0027, color \u003d \u0027gray\u0027, className, href, ...props },"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"  ref"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":") {"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"  className \u003d clsx("},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"    baseStyles[variant],"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"    variantStyles[variant][color],"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"    className"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"  return href ? ("},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"    \u003cLink ref\u003d{ref} to\u003d{href} className\u003d{className} {...props} alt\u003d\"link\" /\u003e"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"  ) : ("},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"    \u003cbutton ref\u003d{ref} className\u003d{className} {...props} /\u003e"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"})"}],"authorContributionMap":{"tlylt":39}},{"path":"frontend/src/components/Container.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import clsx from \u0027clsx\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"export function Container({ className, ...props }) {"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"    \u003cdiv"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"      className\u003d{clsx(\u0027mx-auto max-w-7xl px-4 sm:px-6 lg:px-8\u0027, className)}"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"      {...props}"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    /\u003e"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":10}},{"path":"frontend/src/components/DarkModeToggle.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { useColorMode } from \u0027@chakra-ui/react\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { BsMoon, BsSun } from \u0027react-icons/bs\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"const DarkModeToggle \u003d () \u003d\u003e {"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  const { colorMode, toggleColorMode } \u003d useColorMode()"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    \u003cbutton"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      className\u003d\"h-10 px-3 text-yellow-300 transition duration-200 ease-in border border-gray-300 rounded-lg hover:bg-gray-800\""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"      onClick\u003d{toggleColorMode}"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    \u003e"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      {colorMode \u003d\u003d\u003d \u0027dark\u0027 ? \u003cBsMoon /\u003e : \u003cBsSun /\u003e}"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    \u003c/button\u003e"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"export default DarkModeToggle"}],"authorContributionMap":{"tlylt":17}},{"path":"frontend/src/components/Fields.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { faCheck, faTimes } from \u0027@fortawesome/free-solid-svg-icons\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { FontAwesomeIcon } from \u0027@fortawesome/react-fontawesome\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"const formClasses \u003d"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  \u0027block w-full appearance-none rounded-lg border border-gray-200 bg-white py-[calc(theme(spacing.2)-1px)] px-[calc(theme(spacing.3)-1px)] text-gray-900 placeholder:text-gray-400 focus:border-cyan-500 focus:outline-none focus:ring-cyan-500 sm:text-sm\u0027"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"function Label({ id, children }) {"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    \u003clabel"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"      htmlFor\u003d{id}"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"      className\u003d\"block mb-2 text-sm font-semibold text-gray-900\""},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"    \u003e"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"      {children}"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    \u003c/label\u003e"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"function FormLabel({ id, isValid, isFocused \u003d false, children }) {"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"    \u003cdiv className\u003d\"flex items-center mb-1 items\"\u003e"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"      \u003clabel"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"        htmlFor\u003d{id}"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"        className\u003d\"p-1 mr-2 text-sm font-semibold text-gray-900 \""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"      \u003e"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        {children}"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"      \u003c/label\u003e"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"      {isFocused ? ("},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"        isValid ? ("},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"          \u003cFontAwesomeIcon icon\u003d{faCheck} className\u003d\"text-green-400\" /\u003e"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"        ) : ("},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"          \u003cFontAwesomeIcon icon\u003d{faTimes} className\u003d\"text-red-500\" /\u003e"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"        )"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"      ) : null}"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"    \u003c/div\u003e"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"export function TextField({ id, label, type \u003d \u0027text\u0027, className, ...props }) {"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"    \u003cdiv className\u003d{className}\u003e"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"      {label \u0026\u0026 \u003cLabel id\u003d{id}\u003e{label}\u003c/Label\u003e}"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"      \u003cinput id\u003d{id} type\u003d{type} {...props} className\u003d{formClasses} /\u003e"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"    \u003c/div\u003e"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"export function FormTextField({"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"  id,"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"  label,"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"  isValid,"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"  isFocused,"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"  type \u003d \u0027text\u0027,"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"  className,"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"  ...props"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"}) {"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"    \u003cdiv className\u003d{className}\u003e"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"      {label \u0026\u0026 ("},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"        \u003cFormLabel id\u003d{id} isValid\u003d{isValid} isFocused\u003d{isFocused}\u003e"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"          {label}"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"        \u003c/FormLabel\u003e"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"      )}"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"      \u003cinput id\u003d{id} type\u003d{type} {...props} className\u003d{formClasses} /\u003e"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"    \u003c/div\u003e"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":66}},{"path":"frontend/src/components/Footer.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { Container } from \u0027./Container\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { NavLinks } from \u0027./NavLinks\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"export function Footer() {"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    \u003cfooter className\u003d\"border-t border-gray-200\"\u003e"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"      \u003cContainer\u003e"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"        \u003cdiv className\u003d\"flex flex-col items-start justify-between pt-16 pb-6 gap-y-12 lg:flex-row lg:items-center lg:py-16\"\u003e"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"          \u003cdiv\u003e"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"            \u003cdiv className\u003d\"flex items-center text-gray-900 dark:text-gray-300\"\u003e"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"              \u003cdiv className\u003d\"ml-4\"\u003e"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"                \u003cp className\u003d\"text-base font-semibold\"\u003eLeetWithFriend\u003c/p\u003e"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"                \u003cp className\u003d\"mt-1 text-sm\"\u003e"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"                  An interview preparation platform and peer matching system,"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"                  \u003cbr\u003e\u003c/br\u003e"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"                  where students can find peers to practice whiteboard-style"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"                  interview questions together."},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"                \u003c/p\u003e"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"              \u003c/div\u003e"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"            \u003c/div\u003e"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"            \u003cnav className\u003d\"hidden gap-8 mt-11 sm:flex\"\u003e"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"              \u003cNavLinks /\u003e"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"            \u003c/nav\u003e"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"          \u003c/div\u003e"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        \u003c/div\u003e"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"        \u003cdiv className\u003d\"flex flex-col items-center pt-8 pb-12 border-t border-gray-200 md:flex-row-reverse md:justify-between md:pt-6\"\u003e"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"          \u003cp className\u003d\"mt-6 text-sm text-gray-500 md:mt-0\"\u003e"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"            \u0026copy; Copyright {new Date().getFullYear()} CS3219 Group 58. All"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"            rights reserved."},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"          \u003c/p\u003e"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"        \u003c/div\u003e"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"      \u003c/Container\u003e"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"    \u003c/footer\u003e"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":35}},{"path":"frontend/src/components/Header.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { Popover } from \u0027@headlessui/react\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { AnimatePresence, motion } from \u0027framer-motion\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import { Button } from \u0027./Button\u0027"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"import { Container } from \u0027./Container\u0027"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"import { Logo } from \u0027./Logo\u0027"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"import { NavLinks } from \u0027./NavLinks\u0027"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"import { Link } from \u0027react-router-dom\u0027"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"import useLogout from \u0027../hooks/useLogout\u0027"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"import useAuth from \u0027../hooks/useAuth\u0027"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"import { UserAvatar } from \u0027./UserAvatar\u0027"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"import DarkModeToggle from \u0027./DarkModeToggle\u0027"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"function MenuIcon(props) {"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"    \u003csvg viewBox\u003d\"0 0 24 24\" fill\u003d\"none\" aria-hidden\u003d\"true\" {...props}\u003e"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"      \u003cpath"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"        d\u003d\"M5 6h14M5 18h14M5 12h14\""},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"        strokeWidth\u003d{2}"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"        strokeLinecap\u003d\"round\""},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"        strokeLinejoin\u003d\"round\""},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"      /\u003e"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"    \u003c/svg\u003e"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"function ChevronUpIcon(props) {"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"    \u003csvg viewBox\u003d\"0 0 24 24\" fill\u003d\"none\" aria-hidden\u003d\"true\" {...props}\u003e"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"      \u003cpath"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"        d\u003d\"M17 14l-5-5-5 5\""},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"        strokeWidth\u003d{2}"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"        strokeLinecap\u003d\"round\""},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"        strokeLinejoin\u003d\"round\""},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"      /\u003e"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"    \u003c/svg\u003e"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"function MobileNavLink({ children, ...props }) {"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"    \u003cPopover.Button"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"      as\u003d{Link}"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"      className\u003d\"block text-base leading-7 tracking-tight text-gray-700\""},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"      {...props}"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"    \u003e"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"      {children}"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"    \u003c/Popover.Button\u003e"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"export function Header() {"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"  const logout \u003d useLogout()"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"  const { auth } \u003d useAuth()"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"    \u003cheader\u003e"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"      \u003cnav\u003e"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"        \u003cContainer className\u003d\"relative z-50 flex justify-between py-8\"\u003e"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"          \u003cdiv className\u003d\"relative z-10 flex items-center gap-16\"\u003e"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"            \u003cLink to\u003d\"/\" aria-label\u003d\"Home\"\u003e"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"              \u003cLogo className\u003d\"w-auto h-10\" /\u003e"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"            \u003c/Link\u003e"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"            \u003cdiv className\u003d\"hidden lg:flex lg:gap-10\"\u003e"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"              \u003cNavLinks /\u003e"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"            \u003c/div\u003e"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"          \u003c/div\u003e"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"          \u003cdiv className\u003d\"flex items-center gap-6\"\u003e"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"            \u003cPopover className\u003d\"lg:hidden\"\u003e"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"              {({ open }) \u003d\u003e ("},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"                \u003c\u003e"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"                  \u003cPopover.Button"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"                    className\u003d\"relative z-10 inline-flex items-center p-2 rounded-lg stroke-gray-900 hover:bg-gray-200/50 hover:stroke-gray-600 active:stroke-gray-900 dark:stroke-gray-300 \""},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":"                    aria-label\u003d\"Toggle site navigation\""},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"                  \u003e"},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"                    {({ open }) \u003d\u003e"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"                      open ? ("},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"                        \u003cChevronUpIcon className\u003d\"w-6 h-6\" /\u003e"},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"                      ) : ("},{"lineNumber":80,"author":{"gitId":"tlylt"},"content":"                        \u003cMenuIcon className\u003d\"w-6 h-6\" /\u003e"},{"lineNumber":81,"author":{"gitId":"tlylt"},"content":"                      )"},{"lineNumber":82,"author":{"gitId":"tlylt"},"content":"                    }"},{"lineNumber":83,"author":{"gitId":"tlylt"},"content":"                  \u003c/Popover.Button\u003e"},{"lineNumber":84,"author":{"gitId":"tlylt"},"content":"                  \u003cAnimatePresence initial\u003d{false}\u003e"},{"lineNumber":85,"author":{"gitId":"tlylt"},"content":"                    {open \u0026\u0026 ("},{"lineNumber":86,"author":{"gitId":"tlylt"},"content":"                      \u003c\u003e"},{"lineNumber":87,"author":{"gitId":"tlylt"},"content":"                        \u003cPopover.Overlay"},{"lineNumber":88,"author":{"gitId":"tlylt"},"content":"                          static"},{"lineNumber":89,"author":{"gitId":"tlylt"},"content":"                          as\u003d{motion.div}"},{"lineNumber":90,"author":{"gitId":"tlylt"},"content":"                          initial\u003d{{ opacity: 0 }}"},{"lineNumber":91,"author":{"gitId":"tlylt"},"content":"                          animate\u003d{{ opacity: 1 }}"},{"lineNumber":92,"author":{"gitId":"tlylt"},"content":"                          exit\u003d{{ opacity: 0 }}"},{"lineNumber":93,"author":{"gitId":"tlylt"},"content":"                          className\u003d\"fixed inset-0 z-0 bg-gray-300/60 backdrop-blur\""},{"lineNumber":94,"author":{"gitId":"tlylt"},"content":"                        /\u003e"},{"lineNumber":95,"author":{"gitId":"tlylt"},"content":"                        \u003cPopover.Panel"},{"lineNumber":96,"author":{"gitId":"tlylt"},"content":"                          static"},{"lineNumber":97,"author":{"gitId":"tlylt"},"content":"                          as\u003d{motion.div}"},{"lineNumber":98,"author":{"gitId":"tlylt"},"content":"                          initial\u003d{{ opacity: 0, y: -32 }}"},{"lineNumber":99,"author":{"gitId":"tlylt"},"content":"                          animate\u003d{{ opacity: 1, y: 0 }}"},{"lineNumber":100,"author":{"gitId":"tlylt"},"content":"                          exit\u003d{{"},{"lineNumber":101,"author":{"gitId":"tlylt"},"content":"                            opacity: 0,"},{"lineNumber":102,"author":{"gitId":"tlylt"},"content":"                            y: -32,"},{"lineNumber":103,"author":{"gitId":"tlylt"},"content":"                            transition: { duration: 0.2 },"},{"lineNumber":104,"author":{"gitId":"tlylt"},"content":"                          }}"},{"lineNumber":105,"author":{"gitId":"tlylt"},"content":"                          className\u003d\"absolute inset-x-0 top-0 z-0 px-6 pt-32 pb-6 origin-top shadow-2xl rounded-b-2xl bg-gray-50 shadow-gray-900/20\""},{"lineNumber":106,"author":{"gitId":"tlylt"},"content":"                        \u003e"},{"lineNumber":107,"author":{"gitId":"tlylt"},"content":"                          \u003cdiv className\u003d\"space-y-4\"\u003e"},{"lineNumber":108,"author":{"gitId":"tlylt"},"content":"                            \u003cMobileNavLink to\u003d\"/\"\u003eHome\u003c/MobileNavLink\u003e"},{"lineNumber":109,"author":{"gitId":"tlylt"},"content":"                            \u003cMobileNavLink to\u003d\"/profile\"\u003eProfile\u003c/MobileNavLink\u003e"},{"lineNumber":110,"author":{"gitId":"tlylt"},"content":"                            \u003cMobileNavLink to\u003d\"/match\"\u003eMatch\u003c/MobileNavLink\u003e"},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"                            \u003cMobileNavLink to\u003d\"/history\"\u003e"},{"lineNumber":112,"author":{"gitId":"tlylt"},"content":"                              Learning History"},{"lineNumber":113,"author":{"gitId":"tlylt"},"content":"                            \u003c/MobileNavLink\u003e"},{"lineNumber":114,"author":{"gitId":"tlylt"},"content":"                            \u003cMobileNavLink to\u003d\"/questions\"\u003e"},{"lineNumber":115,"author":{"gitId":"tlylt"},"content":"                              Question Bank"},{"lineNumber":116,"author":{"gitId":"tlylt"},"content":"                            \u003c/MobileNavLink\u003e"},{"lineNumber":117,"author":{"gitId":"tlylt"},"content":"                          \u003c/div\u003e"},{"lineNumber":118,"author":{"gitId":"tlylt"},"content":"                          \u003cdiv className\u003d\"flex flex-col gap-4 mt-8\"\u003e"},{"lineNumber":119,"author":{"gitId":"tlylt"},"content":"                            {auth.isLoggedIn ? ("},{"lineNumber":120,"author":{"gitId":"tlylt"},"content":"                              \u003cButton variant\u003d\"outline\" onClick\u003d{logout}\u003e"},{"lineNumber":121,"author":{"gitId":"tlylt"},"content":"                                Logout"},{"lineNumber":122,"author":{"gitId":"tlylt"},"content":"                              \u003c/Button\u003e"},{"lineNumber":123,"author":{"gitId":"tlylt"},"content":"                            ) : ("},{"lineNumber":124,"author":{"gitId":"tlylt"},"content":"                              \u003c\u003e"},{"lineNumber":125,"author":{"gitId":"tlylt"},"content":"                                \u003cButton href\u003d\"/login\" variant\u003d\"outline\"\u003e"},{"lineNumber":126,"author":{"gitId":"tlylt"},"content":"                                  Log in"},{"lineNumber":127,"author":{"gitId":"tlylt"},"content":"                                \u003c/Button\u003e"},{"lineNumber":128,"author":{"gitId":"tlylt"},"content":"                                \u003cButton href\u003d\"/signup\" variant\u003d\"outline\"\u003e"},{"lineNumber":129,"author":{"gitId":"tlylt"},"content":"                                  Sign up"},{"lineNumber":130,"author":{"gitId":"tlylt"},"content":"                                \u003c/Button\u003e"},{"lineNumber":131,"author":{"gitId":"tlylt"},"content":"                              \u003c/\u003e"},{"lineNumber":132,"author":{"gitId":"tlylt"},"content":"                            )}"},{"lineNumber":133,"author":{"gitId":"tlylt"},"content":"                          \u003c/div\u003e"},{"lineNumber":134,"author":{"gitId":"tlylt"},"content":"                        \u003c/Popover.Panel\u003e"},{"lineNumber":135,"author":{"gitId":"tlylt"},"content":"                      \u003c/\u003e"},{"lineNumber":136,"author":{"gitId":"tlylt"},"content":"                    )}"},{"lineNumber":137,"author":{"gitId":"tlylt"},"content":"                  \u003c/AnimatePresence\u003e"},{"lineNumber":138,"author":{"gitId":"tlylt"},"content":"                \u003c/\u003e"},{"lineNumber":139,"author":{"gitId":"tlylt"},"content":"              )}"},{"lineNumber":140,"author":{"gitId":"tlylt"},"content":"            \u003c/Popover\u003e"},{"lineNumber":141,"author":{"gitId":"tlylt"},"content":"            {auth.isLoggedIn ? ("},{"lineNumber":142,"author":{"gitId":"tlylt"},"content":"              \u003c\u003e"},{"lineNumber":143,"author":{"gitId":"tlylt"},"content":"                \u003cdiv className\u003d\"hidden lg:block\"\u003e"},{"lineNumber":144,"author":{"gitId":"tlylt"},"content":"                  \u003cUserAvatar username\u003d{auth.username} /\u003e"},{"lineNumber":145,"author":{"gitId":"tlylt"},"content":"                \u003c/div\u003e"},{"lineNumber":146,"author":{"gitId":"tlylt"},"content":"                \u003cDarkModeToggle /\u003e"},{"lineNumber":147,"author":{"gitId":"tlylt"},"content":"                \u003cButton"},{"lineNumber":148,"author":{"gitId":"tlylt"},"content":"                  onClick\u003d{logout}"},{"lineNumber":149,"author":{"gitId":"tlylt"},"content":"                  variant\u003d\"outline\""},{"lineNumber":150,"author":{"gitId":"tlylt"},"content":"                  className\u003d\"hidden dark:text-gray-300 lg:block\""},{"lineNumber":151,"author":{"gitId":"tlylt"},"content":"                \u003e"},{"lineNumber":152,"author":{"gitId":"tlylt"},"content":"                  Logout"},{"lineNumber":153,"author":{"gitId":"tlylt"},"content":"                \u003c/Button\u003e"},{"lineNumber":154,"author":{"gitId":"tlylt"},"content":"              \u003c/\u003e"},{"lineNumber":155,"author":{"gitId":"tlylt"},"content":"            ) : ("},{"lineNumber":156,"author":{"gitId":"tlylt"},"content":"              \u003c\u003e"},{"lineNumber":157,"author":{"gitId":"tlylt"},"content":"                \u003cDarkModeToggle /\u003e"},{"lineNumber":158,"author":{"gitId":"tlylt"},"content":"                \u003cButton"},{"lineNumber":159,"author":{"gitId":"tlylt"},"content":"                  href\u003d\"/login\""},{"lineNumber":160,"author":{"gitId":"tlylt"},"content":"                  variant\u003d\"outline\""},{"lineNumber":161,"author":{"gitId":"tlylt"},"content":"                  className\u003d\"hidden dark:text-gray-300 lg:block\""},{"lineNumber":162,"author":{"gitId":"tlylt"},"content":"                \u003e"},{"lineNumber":163,"author":{"gitId":"tlylt"},"content":"                  Log in"},{"lineNumber":164,"author":{"gitId":"tlylt"},"content":"                \u003c/Button\u003e"},{"lineNumber":165,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":166,"author":{"gitId":"tlylt"},"content":"                \u003cButton"},{"lineNumber":167,"author":{"gitId":"tlylt"},"content":"                  href\u003d\"/signup\""},{"lineNumber":168,"author":{"gitId":"tlylt"},"content":"                  variant\u003d\"outline\""},{"lineNumber":169,"author":{"gitId":"tlylt"},"content":"                  className\u003d\"hidden dark:text-gray-300 lg:block\""},{"lineNumber":170,"author":{"gitId":"tlylt"},"content":"                \u003e"},{"lineNumber":171,"author":{"gitId":"tlylt"},"content":"                  Sign up"},{"lineNumber":172,"author":{"gitId":"tlylt"},"content":"                \u003c/Button\u003e"},{"lineNumber":173,"author":{"gitId":"tlylt"},"content":"              \u003c/\u003e"},{"lineNumber":174,"author":{"gitId":"tlylt"},"content":"            )}"},{"lineNumber":175,"author":{"gitId":"tlylt"},"content":"          \u003c/div\u003e"},{"lineNumber":176,"author":{"gitId":"tlylt"},"content":"        \u003c/Container\u003e"},{"lineNumber":177,"author":{"gitId":"tlylt"},"content":"      \u003c/nav\u003e"},{"lineNumber":178,"author":{"gitId":"tlylt"},"content":"    \u003c/header\u003e"},{"lineNumber":179,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":180,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":179,"uyencfi":1}},{"path":"frontend/src/components/Layout.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { Outlet } from \u0027react-router-dom\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { Box } from \u0027@chakra-ui/react\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import { Footer } from \u0027./Footer\u0027"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import { Header } from \u0027./Header\u0027"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"const Layout \u003d () \u003d\u003e {"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    \u003c\u003e"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      \u003cHeader /\u003e"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"      \u003cBox className\u003d\"h-screen\"\u003e"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"        \u003cOutlet /\u003e"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      \u003c/Box\u003e"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"      \u003cFooter /\u003e"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    \u003c/\u003e"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"export default Layout"}],"authorContributionMap":{"tlylt":18}},{"path":"frontend/src/components/Logo.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"export function Logo(props) {"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"    \u003cdiv {...props}\u003e"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"      \u003cimg src\u003d\"/apple-touch-icon.png\" alt\u003d\"Logo\" width\u003d{30} height\u003d{30} /\u003e"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"      \u003ch2 className\u003d\"font-semibold text-cyan-500\"\u003eLeetWithFriend\u003c/h2\u003e"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    \u003c/div\u003e"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":8}},{"path":"frontend/src/components/NavLinks.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { useState } from \u0027react\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { AnimatePresence, motion } from \u0027framer-motion\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import { Link } from \u0027react-router-dom\u0027"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"export function NavLinks() {"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  let [hoveredIndex, setHoveredIndex] \u003d useState(null)"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  return ["},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    [\u0027Home\u0027, \u0027/\u0027],"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    [\u0027Profile\u0027, \u0027/profile\u0027],"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    [\u0027Match\u0027, \u0027/match\u0027],"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"    [\u0027Learning History\u0027, \u0027/history\u0027],"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    [\u0027Question Bank\u0027, \u0027/questions\u0027],"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"  ].map(([label, href], index) \u003d\u003e ("},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    \u003cLink"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"      key\u003d{label}"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"      to\u003d{href}"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"      className\u003d\"relative -my-2 -mx-3 rounded-lg px-3 py-2 text-sm text-gray-700 transition-colors delay-150 hover:text-gray-900 hover:delay-[0ms] dark:text-gray-300 dark:hover:text-gray-900\""},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"      onMouseEnter\u003d{() \u003d\u003e setHoveredIndex(index)}"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"      onMouseLeave\u003d{() \u003d\u003e setHoveredIndex(null)}"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"    \u003e"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"      \u003cAnimatePresence\u003e"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"        {hoveredIndex \u003d\u003d\u003d index \u0026\u0026 ("},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"          \u003cmotion.span"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"            className\u003d\"absolute inset-0 bg-gray-100 rounded-lg\""},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"            layoutId\u003d\"hoverBackground\""},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"            initial\u003d{{ opacity: 0 }}"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"            animate\u003d{{ opacity: 1, transition: { duration: 0.15 } }}"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"            exit\u003d{{"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"              opacity: 0,"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"              transition: { duration: 0.15, delay: 0.2 },"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"            }}"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"          /\u003e"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"        )}"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"      \u003c/AnimatePresence\u003e"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"      \u003cspan className\u003d\"relative z-10\"\u003e{label}\u003c/span\u003e"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"    \u003c/Link\u003e"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"  ))"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":38,"uyencfi":1}},{"path":"frontend/src/components/PersistLogin.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { Outlet } from \u0027react-router-dom\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { useState, useEffect } from \u0027react\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import useRefreshToken from \u0027../hooks/useRefreshToken\u0027"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import useAuth from \u0027../hooks/useAuth\u0027"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"import { Spinner } from \u0027@chakra-ui/react\u0027"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"const PersistLogin \u003d () \u003d\u003e {"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  const [isLoading, setIsLoading] \u003d useState(true)"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  const refresh \u003d useRefreshToken()"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  const { auth, persist } \u003d useAuth()"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"    let isMounted \u003d true"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    const verifyRefreshToken \u003d async () \u003d\u003e {"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      try {"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        await refresh()"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"      } catch (err) {"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"        console.error(err)"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"      } finally {"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"        isMounted \u0026\u0026 setIsLoading(false)"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"      }"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"    !auth?.accessToken \u0026\u0026 persist ? verifyRefreshToken() : setIsLoading(false)"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"    return () \u003d\u003e (isMounted \u003d false)"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"    // might need to use [] instead"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"  }, [auth?.accessToken, persist, refresh])"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"    \u003c\u003e"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"      {!persist ? ("},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"        \u003cOutlet /\u003e"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"      ) : isLoading ? ("},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"        \u003cdiv className\u003d\"flex justify-center\"\u003e"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"          \u003cSpinner size\u003d\"xl\" /\u003e"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"        \u003c/div\u003e"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"      ) : ("},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"        \u003cOutlet /\u003e"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"      )}"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"    \u003c/\u003e"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"export default PersistLogin"}],"authorContributionMap":{"tlylt":45}},{"path":"frontend/src/components/QuestionPane.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import {"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"  Text,"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"  Box,"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  Badge,"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  VStack,"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  Heading,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  useToast,"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"  Image,"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"  Code,"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  StackDivider,"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"} from \u0027@chakra-ui/react\u0027"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"import ChakraUIRenderer from \u0027chakra-ui-markdown-renderer\u0027"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"import { AuthLayout } from \u0027../components/AuthLayout\u0027"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"import ReactMarkdown from \u0027react-markdown\u0027"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"import { Button } from \u0027../components/Button\u0027"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"import {"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"  URL_QUESTION_SERVICE,"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"  URL_ROOM_SERVICE,"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"  STATUS_CODE_SUCCESS,"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"} from \u0027../constants\u0027"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"import axios from \u0027../api/axios\u0027"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"import { useEffect, useState } from \u0027react\u0027"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"import useAxiosPrivate from \u0027../hooks/useAxiosPrivate\u0027"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"const difficultyColorMap \u003d new Map(["},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"  [\u0027easy\u0027, \u0027green\u0027],"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"  [\u0027medium\u0027, \u0027orange\u0027],"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"  [\u0027hard\u0027, \u0027red\u0027],"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"])"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"const supTheme \u003d {"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"  em: ({ node, ...props }) \u003d\u003e {"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"    if ("},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"      props.children[0] \u0026\u0026"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"      typeof props.children[0] \u003d\u003d\u003d \u0027string\u0027 \u0026\u0026"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"      props.children[0].startsWith(\u0027^\u0027)"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"    ) {"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"      return \u003csup\u003e{props.children[0].substring(1, 2)}\u003c/sup\u003e"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":"    if ("},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":"      props.children[0] \u0026\u0026"},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"      typeof props.children[0] \u003d\u003d\u003d \u0027string\u0027 \u0026\u0026"},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":"      props.children[0].startsWith(\u0027~\u0027)"},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"    ) {"},{"lineNumber":45,"author":{"gitId":"Hzxin"},"content":"      return \u003csub\u003e{props.children[0].substring(1, 2)}\u003c/sub\u003e"},{"lineNumber":46,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":47,"author":{"gitId":"Hzxin"},"content":"    return \u003ci {...props} /\u003e"},{"lineNumber":48,"author":{"gitId":"Hzxin"},"content":"  },"},{"lineNumber":49,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":50,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":51,"author":{"gitId":"Hzxin"},"content":"const newTheme \u003d {"},{"lineNumber":52,"author":{"gitId":"Hzxin"},"content":"  img: ({ node, children, ...props }) \u003d\u003e {"},{"lineNumber":53,"author":{"gitId":"Hzxin"},"content":"    return \u003cImage m\u003d{4} src\u003d{node.properties.src}\u003e\u003c/Image\u003e"},{"lineNumber":54,"author":{"gitId":"Hzxin"},"content":"  },"},{"lineNumber":55,"author":{"gitId":"Hzxin"},"content":"  code: ({ node, inline, children, ...props }) \u003d\u003e {"},{"lineNumber":56,"author":{"gitId":"Hzxin"},"content":"    return !inline ? ("},{"lineNumber":57,"author":{"gitId":"Hzxin"},"content":"      \u003cCode overflow\u003d\"auto\" fontSize\u003d\"lg\" w\u003d\"100%\" p\u003d{2} mt\u003d{4} mb\u003d{4}\u003e"},{"lineNumber":58,"author":{"gitId":"Hzxin"},"content":"        \u003cReactMarkdown"},{"lineNumber":59,"author":{"gitId":"Hzxin"},"content":"          components\u003d{ChakraUIRenderer(supTheme)}"},{"lineNumber":60,"author":{"gitId":"Hzxin"},"content":"          children\u003d{children[0]}"},{"lineNumber":61,"author":{"gitId":"Hzxin"},"content":"        /\u003e"},{"lineNumber":62,"author":{"gitId":"Hzxin"},"content":"      \u003c/Code\u003e"},{"lineNumber":63,"author":{"gitId":"Hzxin"},"content":"    ) : ("},{"lineNumber":64,"author":{"gitId":"Hzxin"},"content":"      \u003cCode fontSize\u003d\"lg\"\u003e"},{"lineNumber":65,"author":{"gitId":"Hzxin"},"content":"        \u003cReactMarkdown"},{"lineNumber":66,"author":{"gitId":"Hzxin"},"content":"          components\u003d{ChakraUIRenderer(supTheme)}"},{"lineNumber":67,"author":{"gitId":"Hzxin"},"content":"          children\u003d{children[0]}"},{"lineNumber":68,"author":{"gitId":"Hzxin"},"content":"        /\u003e"},{"lineNumber":69,"author":{"gitId":"Hzxin"},"content":"      \u003c/Code\u003e"},{"lineNumber":70,"author":{"gitId":"Hzxin"},"content":"    )"},{"lineNumber":71,"author":{"gitId":"Hzxin"},"content":"  },"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"  p: (props) \u003d\u003e {"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"    const { children } \u003d props"},{"lineNumber":74,"author":{"gitId":"Hzxin"},"content":"    return ("},{"lineNumber":75,"author":{"gitId":"Hzxin"},"content":"      \u003cText overflow\u003d\"auto\" mb\u003d{1} className\u003d\"text-lg\"\u003e"},{"lineNumber":76,"author":{"gitId":"Hzxin"},"content":"        {children}"},{"lineNumber":77,"author":{"gitId":"Hzxin"},"content":"      \u003c/Text\u003e"},{"lineNumber":78,"author":{"gitId":"Hzxin"},"content":"    )"},{"lineNumber":79,"author":{"gitId":"Hzxin"},"content":"  },"},{"lineNumber":80,"author":{"gitId":"Hzxin"},"content":"  em: ({ node, ...props }) \u003d\u003e {"},{"lineNumber":81,"author":{"gitId":"Hzxin"},"content":"    if ("},{"lineNumber":82,"author":{"gitId":"Hzxin"},"content":"      props.children[0] \u0026\u0026"},{"lineNumber":83,"author":{"gitId":"Hzxin"},"content":"      typeof props.children[0] \u003d\u003d\u003d \u0027string\u0027 \u0026\u0026"},{"lineNumber":84,"author":{"gitId":"Hzxin"},"content":"      props.children[0].startsWith(\u0027^\u0027)"},{"lineNumber":85,"author":{"gitId":"Hzxin"},"content":"    ) {"},{"lineNumber":86,"author":{"gitId":"Hzxin"},"content":"      return \u003csup\u003e{props.children[0].substring(1, 2)}\u003c/sup\u003e"},{"lineNumber":87,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":88,"author":{"gitId":"Hzxin"},"content":"    if ("},{"lineNumber":89,"author":{"gitId":"Hzxin"},"content":"      props.children[0] \u0026\u0026"},{"lineNumber":90,"author":{"gitId":"Hzxin"},"content":"      typeof props.children[0] \u003d\u003d\u003d \u0027string\u0027 \u0026\u0026"},{"lineNumber":91,"author":{"gitId":"Hzxin"},"content":"      props.children[0].startsWith(\u0027~\u0027)"},{"lineNumber":92,"author":{"gitId":"Hzxin"},"content":"    ) {"},{"lineNumber":93,"author":{"gitId":"Hzxin"},"content":"      return \u003csub\u003e{props.children[0].substring(1, 2)}\u003c/sub\u003e"},{"lineNumber":94,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":95,"author":{"gitId":"Hzxin"},"content":"    return \u003ci {...props} /\u003e"},{"lineNumber":96,"author":{"gitId":"Hzxin"},"content":"  },"},{"lineNumber":97,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":98,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"// Prettify the question text"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"// TODO: fix the root issue when storing questions in DB"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"const parse \u003d (text) \u003d\u003e {"},{"lineNumber":102,"author":{"gitId":"tlylt"},"content":"  if (text?.startsWith(\u0027## Description\u0027)) {"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"    text \u003d text.replace(\u0027## Description\u0027, \u0027\u0027)"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"  return text"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":107,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":108,"author":{"gitId":"MarcusTXK"},"content":"const QuestionPane \u003d ({ questionId, roomId }) \u003d\u003e {"},{"lineNumber":109,"author":{"gitId":"Hzxin"},"content":"  const [questionData, setQuestionData] \u003d useState([])"},{"lineNumber":110,"author":{"gitId":"MarcusTXK"},"content":"  const toast \u003d useToast()"},{"lineNumber":111,"author":{"gitId":"MarcusTXK"},"content":"  const axiosPrivate \u003d useAxiosPrivate()"},{"lineNumber":112,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":113,"author":{"gitId":"Hzxin"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":114,"author":{"gitId":"Hzxin"},"content":"    const getQuestion \u003d async () \u003d\u003e {"},{"lineNumber":115,"author":{"gitId":"Hzxin"},"content":"      await axios"},{"lineNumber":116,"author":{"gitId":"Hzxin"},"content":"        .get(URL_QUESTION_SERVICE + \u0027?id\u003d\u0027 + questionId)"},{"lineNumber":117,"author":{"gitId":"Hzxin"},"content":"        .then((response) \u003d\u003e {"},{"lineNumber":118,"author":{"gitId":"Hzxin"},"content":"          const newData \u003d response.data"},{"lineNumber":119,"author":{"gitId":"Hzxin"},"content":"          setQuestionData(newData)"},{"lineNumber":120,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":121,"author":{"gitId":"Hzxin"},"content":"        .catch((e) \u003d\u003e console.log(e))"},{"lineNumber":122,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":123,"author":{"gitId":"Hzxin"},"content":"    getQuestion()"},{"lineNumber":124,"author":{"gitId":"MarcusTXK"},"content":"  }, [questionId])"},{"lineNumber":125,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":126,"author":{"gitId":"Hzxin"},"content":"  const getNextQuestion \u003d async () \u003d\u003e {"},{"lineNumber":127,"author":{"gitId":"MarcusTXK"},"content":"    await axiosPrivate"},{"lineNumber":128,"author":{"gitId":"MarcusTXK"},"content":"      .put(`${URL_ROOM_SERVICE}/${roomId}`)"},{"lineNumber":129,"author":{"gitId":"MarcusTXK"},"content":"      .then((res) \u003d\u003e {"},{"lineNumber":130,"author":{"gitId":"MarcusTXK"},"content":"        if (res \u0026\u0026 res.status !\u003d\u003d STATUS_CODE_SUCCESS) {"},{"lineNumber":131,"author":{"gitId":"MarcusTXK"},"content":"          toast({"},{"lineNumber":132,"author":{"gitId":"MarcusTXK"},"content":"            title: \u0027Something went wrong\u0027,"},{"lineNumber":133,"author":{"gitId":"MarcusTXK"},"content":"            description: \u0027Please try again\u0027,"},{"lineNumber":134,"author":{"gitId":"MarcusTXK"},"content":"            status: \u0027error\u0027,"},{"lineNumber":135,"author":{"gitId":"MarcusTXK"},"content":"            duration: 4000,"},{"lineNumber":136,"author":{"gitId":"MarcusTXK"},"content":"            isClosable: true,"},{"lineNumber":137,"author":{"gitId":"MarcusTXK"},"content":"          })"},{"lineNumber":138,"author":{"gitId":"MarcusTXK"},"content":"        }"},{"lineNumber":139,"author":{"gitId":"Hzxin"},"content":"      })"},{"lineNumber":140,"author":{"gitId":"Hzxin"},"content":"      .catch(console.log)"},{"lineNumber":141,"author":{"gitId":"Hzxin"},"content":"  }"},{"lineNumber":142,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":143,"author":{"gitId":"Hzxin"},"content":"  if (typeof questionData \u003d\u003d\u003d \u0027undefined\u0027 || questionData.length \u003d\u003d\u003d 0) {"},{"lineNumber":144,"author":{"gitId":"Hzxin"},"content":"    return ("},{"lineNumber":145,"author":{"gitId":"Hzxin"},"content":"      \u003cAuthLayout title\u003d\"Retrieving question...\"\u003e"},{"lineNumber":146,"author":{"gitId":"MarcusTXK"},"content":"        \u003cdiv className\u003d\"text-center text-xl\"\u003e\u003c/div\u003e"},{"lineNumber":147,"author":{"gitId":"Hzxin"},"content":"      \u003c/AuthLayout\u003e"},{"lineNumber":148,"author":{"gitId":"Hzxin"},"content":"    )"},{"lineNumber":149,"author":{"gitId":"Hzxin"},"content":"  }"},{"lineNumber":150,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":151,"author":{"gitId":"MarcusTXK"},"content":"  const difficultyColor \u003d (difficulty) \u003d\u003e difficultyColorMap.get(difficulty)"},{"lineNumber":152,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":153,"author":{"gitId":"Hzxin"},"content":"  return ("},{"lineNumber":154,"author":{"gitId":"Hzxin"},"content":"    \u003c\u003e"},{"lineNumber":155,"author":{"gitId":"MarcusTXK"},"content":"      \u003cBox className\u003d\"rounded-lg border\"\u003e"},{"lineNumber":156,"author":{"gitId":"tlylt"},"content":"        \u003cVStack h\u003d\"100vh\" divider\u003d{\u003cStackDivider borderColor\u003d\"gray.200\" /\u003e}\u003e"},{"lineNumber":157,"author":{"gitId":"Hzxin"},"content":"          \u003cVStack divider\u003d{\u003cStackDivider borderColor\u003d\"gray.200\"/\u003e}\u003e"},{"lineNumber":158,"author":{"gitId":"tlylt"},"content":"            \u003cHeading size\u003d\"lg\" fontWeight\u003d\"semibold\" color\u003d\"gray 500\"\u003e"},{"lineNumber":159,"author":{"gitId":"Hzxin"},"content":"                {questionData.name}"},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"              \u003c/Heading\u003e"},{"lineNumber":161,"author":{"gitId":"MarcusTXK"},"content":"              \u003cBadge"},{"lineNumber":162,"author":{"gitId":"MarcusTXK"},"content":"                borderRadius\u003d\"full\""},{"lineNumber":163,"author":{"gitId":"MarcusTXK"},"content":"                px\u003d\"2\""},{"lineNumber":164,"author":{"gitId":"Hzxin"},"content":"                colorScheme\u003d{difficultyColor(questionData.difficulty)}"},{"lineNumber":165,"author":{"gitId":"MarcusTXK"},"content":"              \u003e"},{"lineNumber":166,"author":{"gitId":"Hzxin"},"content":"                {questionData.difficulty}"},{"lineNumber":167,"author":{"gitId":"Hzxin"},"content":"              \u003c/Badge\u003e"},{"lineNumber":168,"author":{"gitId":"Hzxin"},"content":"          \u003c/VStack\u003e"},{"lineNumber":169,"author":{"gitId":"MarcusTXK"},"content":"          \u003cdiv className\u003d\"mx-2 max-h-full overflow-y-auto px-2\"\u003e"},{"lineNumber":170,"author":{"gitId":"tlylt"},"content":"            \u003cReactMarkdown"},{"lineNumber":171,"author":{"gitId":"tlylt"},"content":"              components\u003d{ChakraUIRenderer(newTheme)}"},{"lineNumber":172,"author":{"gitId":"Hzxin"},"content":"              children\u003d{parse(questionData.content)}"},{"lineNumber":173,"author":{"gitId":"tlylt"},"content":"              skipHtml"},{"lineNumber":174,"author":{"gitId":"tlylt"},"content":"            /\u003e"},{"lineNumber":175,"author":{"gitId":"Hzxin"},"content":"          \u003c/div\u003e"},{"lineNumber":176,"author":{"gitId":"Hzxin"},"content":"          \u003cButton"},{"lineNumber":177,"author":{"gitId":"Hzxin"},"content":"              onClick\u003d{getNextQuestion}"},{"lineNumber":178,"author":{"gitId":"Hzxin"},"content":"              variant\u003d\"outline\""},{"lineNumber":179,"author":{"gitId":"Hzxin"},"content":"              className\u003d\" dark:text-gray-300\""},{"lineNumber":180,"author":{"gitId":"Hzxin"},"content":"            \u003e"},{"lineNumber":181,"author":{"gitId":"Hzxin"},"content":"              Next Question"},{"lineNumber":182,"author":{"gitId":"Hzxin"},"content":"            \u003c/Button\u003e"},{"lineNumber":183,"author":{"gitId":"Hzxin"},"content":"        \u003c/VStack\u003e"},{"lineNumber":184,"author":{"gitId":"Hzxin"},"content":"      \u003c/Box\u003e"},{"lineNumber":185,"author":{"gitId":"Hzxin"},"content":"    \u003c/\u003e"},{"lineNumber":186,"author":{"gitId":"Hzxin"},"content":"  )"},{"lineNumber":187,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":188,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":189,"author":{"gitId":"Hzxin"},"content":"export default QuestionPane"}],"authorContributionMap":{"MarcusTXK":31,"Hzxin":130,"tlylt":20,"uyencfi":8}},{"path":"frontend/src/components/QuestionTable.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"import React from \u0027react\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"import { useTable, useSortBy, usePagination } from \u0027react-table\u0027"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"import {"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"  Table,"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"  Thead,"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"  Tbody,"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"  Tr,"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"  Th,"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"  Td,"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"  Flex,"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"  IconButton,"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"  Text,"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"  Tooltip,"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"  Select,"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"  NumberInput,"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"  NumberInputField,"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"  NumberInputStepper,"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"  NumberIncrementStepper,"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"  NumberDecrementStepper,"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"} from \u0027@chakra-ui/react\u0027"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"import {"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"  ArrowRightIcon,"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"  ArrowLeftIcon,"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"  ChevronRightIcon,"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"  ChevronLeftIcon,"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"} from \u0027@chakra-ui/icons\u0027"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"export default function QuestionTable({ columns, data }) {"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"  const {"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"    getTableProps,"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"    getTableBodyProps,"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"    headerGroups,"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"    prepareRow,"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"    page,"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"    canPreviousPage,"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"    canNextPage,"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"    pageOptions,"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"    pageCount,"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"    gotoPage,"},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":"    nextPage,"},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":"    previousPage,"},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"    setPageSize,"},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":"    state: { pageIndex, pageSize },"},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"  } \u003d useTable("},{"lineNumber":45,"author":{"gitId":"Hzxin"},"content":"    {"},{"lineNumber":46,"author":{"gitId":"Hzxin"},"content":"      columns,"},{"lineNumber":47,"author":{"gitId":"Hzxin"},"content":"      data,"},{"lineNumber":48,"author":{"gitId":"Hzxin"},"content":"      initialState: { pageIndex: 0 },"},{"lineNumber":49,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":50,"author":{"gitId":"Hzxin"},"content":"    useSortBy,"},{"lineNumber":51,"author":{"gitId":"Hzxin"},"content":"    usePagination"},{"lineNumber":52,"author":{"gitId":"Hzxin"},"content":"  )"},{"lineNumber":53,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":54,"author":{"gitId":"Hzxin"},"content":"  return ("},{"lineNumber":55,"author":{"gitId":"Hzxin"},"content":"    \u003c\u003e"},{"lineNumber":56,"author":{"gitId":"Hzxin"},"content":"      \u003cTable variant\u003d\"striped\" {...getTableProps()}\u003e"},{"lineNumber":57,"author":{"gitId":"Hzxin"},"content":"        \u003cThead\u003e"},{"lineNumber":58,"author":{"gitId":"Hzxin"},"content":"          {headerGroups.map((headerGroup) \u003d\u003e ("},{"lineNumber":59,"author":{"gitId":"Hzxin"},"content":"            \u003cTr {...headerGroup.getHeaderGroupProps()}\u003e"},{"lineNumber":60,"author":{"gitId":"Hzxin"},"content":"              {headerGroup.headers.map((column) \u003d\u003e ("},{"lineNumber":61,"author":{"gitId":"Hzxin"},"content":"                \u003cTh {...column.getHeaderProps(column.getSortByToggleProps())}\u003e"},{"lineNumber":62,"author":{"gitId":"Hzxin"},"content":"                  {column.render(\u0027Header\u0027)}"},{"lineNumber":63,"author":{"gitId":"Hzxin"},"content":"                \u003c/Th\u003e"},{"lineNumber":64,"author":{"gitId":"Hzxin"},"content":"              ))}"},{"lineNumber":65,"author":{"gitId":"Hzxin"},"content":"            \u003c/Tr\u003e"},{"lineNumber":66,"author":{"gitId":"Hzxin"},"content":"          ))}"},{"lineNumber":67,"author":{"gitId":"Hzxin"},"content":"        \u003c/Thead\u003e"},{"lineNumber":68,"author":{"gitId":"Hzxin"},"content":"        \u003cTbody {...getTableBodyProps()}\u003e"},{"lineNumber":69,"author":{"gitId":"Hzxin"},"content":"          {page.map((row, i) \u003d\u003e {"},{"lineNumber":70,"author":{"gitId":"Hzxin"},"content":"            prepareRow(row)"},{"lineNumber":71,"author":{"gitId":"Hzxin"},"content":"            return ("},{"lineNumber":72,"author":{"gitId":"Hzxin"},"content":"              \u003cTr {...row.getRowProps()}\u003e"},{"lineNumber":73,"author":{"gitId":"Hzxin"},"content":"                {row.cells.map((cell) \u003d\u003e {"},{"lineNumber":74,"author":{"gitId":"Hzxin"},"content":"                  return \u003cTd {...cell.getCellProps()}\u003e{cell.render(\u0027Cell\u0027)}\u003c/Td\u003e"},{"lineNumber":75,"author":{"gitId":"Hzxin"},"content":"                })}"},{"lineNumber":76,"author":{"gitId":"Hzxin"},"content":"              \u003c/Tr\u003e"},{"lineNumber":77,"author":{"gitId":"Hzxin"},"content":"            )"},{"lineNumber":78,"author":{"gitId":"Hzxin"},"content":"          })}"},{"lineNumber":79,"author":{"gitId":"Hzxin"},"content":"        \u003c/Tbody\u003e"},{"lineNumber":80,"author":{"gitId":"Hzxin"},"content":"      \u003c/Table\u003e"},{"lineNumber":81,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":82,"author":{"gitId":"Hzxin"},"content":"      \u003cFlex justifyContent\u003d\"space-between\" m\u003d{4} alignItems\u003d\"center\"\u003e"},{"lineNumber":83,"author":{"gitId":"Hzxin"},"content":"        \u003cFlex\u003e"},{"lineNumber":84,"author":{"gitId":"Hzxin"},"content":"          \u003cTooltip label\u003d\"First Page\"\u003e"},{"lineNumber":85,"author":{"gitId":"Hzxin"},"content":"            \u003cIconButton"},{"lineNumber":86,"author":{"gitId":"Hzxin"},"content":"              onClick\u003d{() \u003d\u003e gotoPage(0)}"},{"lineNumber":87,"author":{"gitId":"Hzxin"},"content":"              isDisabled\u003d{!canPreviousPage}"},{"lineNumber":88,"author":{"gitId":"Hzxin"},"content":"              icon\u003d{\u003cArrowLeftIcon h\u003d{3} w\u003d{3} /\u003e}"},{"lineNumber":89,"author":{"gitId":"Hzxin"},"content":"              mr\u003d{4}"},{"lineNumber":90,"author":{"gitId":"Hzxin"},"content":"            /\u003e"},{"lineNumber":91,"author":{"gitId":"Hzxin"},"content":"          \u003c/Tooltip\u003e"},{"lineNumber":92,"author":{"gitId":"Hzxin"},"content":"          \u003cTooltip label\u003d\"Previous Page\"\u003e"},{"lineNumber":93,"author":{"gitId":"Hzxin"},"content":"            \u003cIconButton"},{"lineNumber":94,"author":{"gitId":"Hzxin"},"content":"              onClick\u003d{previousPage}"},{"lineNumber":95,"author":{"gitId":"Hzxin"},"content":"              isDisabled\u003d{!canPreviousPage}"},{"lineNumber":96,"author":{"gitId":"Hzxin"},"content":"              icon\u003d{\u003cChevronLeftIcon h\u003d{6} w\u003d{6} /\u003e}"},{"lineNumber":97,"author":{"gitId":"Hzxin"},"content":"            /\u003e"},{"lineNumber":98,"author":{"gitId":"Hzxin"},"content":"          \u003c/Tooltip\u003e"},{"lineNumber":99,"author":{"gitId":"Hzxin"},"content":"        \u003c/Flex\u003e"},{"lineNumber":100,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":101,"author":{"gitId":"Hzxin"},"content":"        \u003cFlex alignItems\u003d\"center\"\u003e"},{"lineNumber":102,"author":{"gitId":"Hzxin"},"content":"          \u003cText flexShrink\u003d\"0\" mr\u003d{8}\u003e"},{"lineNumber":103,"author":{"gitId":"Hzxin"},"content":"            Page{\u0027 \u0027}"},{"lineNumber":104,"author":{"gitId":"Hzxin"},"content":"            \u003cText fontWeight\u003d\"bold\" as\u003d\"span\"\u003e"},{"lineNumber":105,"author":{"gitId":"Hzxin"},"content":"              {pageIndex + 1}"},{"lineNumber":106,"author":{"gitId":"Hzxin"},"content":"            \u003c/Text\u003e{\u0027 \u0027}"},{"lineNumber":107,"author":{"gitId":"Hzxin"},"content":"            of{\u0027 \u0027}"},{"lineNumber":108,"author":{"gitId":"Hzxin"},"content":"            \u003cText fontWeight\u003d\"bold\" as\u003d\"span\"\u003e"},{"lineNumber":109,"author":{"gitId":"Hzxin"},"content":"              {pageOptions.length}"},{"lineNumber":110,"author":{"gitId":"Hzxin"},"content":"            \u003c/Text\u003e"},{"lineNumber":111,"author":{"gitId":"Hzxin"},"content":"          \u003c/Text\u003e"},{"lineNumber":112,"author":{"gitId":"Hzxin"},"content":"          \u003cText flexShrink\u003d\"0\"\u003eGo to page:\u003c/Text\u003e{\u0027 \u0027}"},{"lineNumber":113,"author":{"gitId":"Hzxin"},"content":"          \u003cNumberInput"},{"lineNumber":114,"author":{"gitId":"Hzxin"},"content":"            ml\u003d{2}"},{"lineNumber":115,"author":{"gitId":"Hzxin"},"content":"            mr\u003d{8}"},{"lineNumber":116,"author":{"gitId":"Hzxin"},"content":"            w\u003d{28}"},{"lineNumber":117,"author":{"gitId":"Hzxin"},"content":"            min\u003d{1}"},{"lineNumber":118,"author":{"gitId":"Hzxin"},"content":"            max\u003d{pageOptions.length}"},{"lineNumber":119,"author":{"gitId":"Hzxin"},"content":"            onChange\u003d{(value) \u003d\u003e {"},{"lineNumber":120,"author":{"gitId":"Hzxin"},"content":"              const page \u003d value ? value - 1 : 0"},{"lineNumber":121,"author":{"gitId":"Hzxin"},"content":"              gotoPage(page)"},{"lineNumber":122,"author":{"gitId":"Hzxin"},"content":"            }}"},{"lineNumber":123,"author":{"gitId":"Hzxin"},"content":"            defaultValue\u003d{pageIndex + 1}"},{"lineNumber":124,"author":{"gitId":"Hzxin"},"content":"          \u003e"},{"lineNumber":125,"author":{"gitId":"Hzxin"},"content":"            \u003cNumberInputField /\u003e"},{"lineNumber":126,"author":{"gitId":"Hzxin"},"content":"            \u003cNumberInputStepper\u003e"},{"lineNumber":127,"author":{"gitId":"Hzxin"},"content":"              \u003cNumberIncrementStepper /\u003e"},{"lineNumber":128,"author":{"gitId":"Hzxin"},"content":"              \u003cNumberDecrementStepper /\u003e"},{"lineNumber":129,"author":{"gitId":"Hzxin"},"content":"            \u003c/NumberInputStepper\u003e"},{"lineNumber":130,"author":{"gitId":"Hzxin"},"content":"          \u003c/NumberInput\u003e"},{"lineNumber":131,"author":{"gitId":"Hzxin"},"content":"          \u003cSelect"},{"lineNumber":132,"author":{"gitId":"Hzxin"},"content":"            w\u003d{32}"},{"lineNumber":133,"author":{"gitId":"Hzxin"},"content":"            value\u003d{pageSize}"},{"lineNumber":134,"author":{"gitId":"Hzxin"},"content":"            onChange\u003d{(e) \u003d\u003e {"},{"lineNumber":135,"author":{"gitId":"Hzxin"},"content":"              setPageSize(Number(e.target.value))"},{"lineNumber":136,"author":{"gitId":"Hzxin"},"content":"            }}"},{"lineNumber":137,"author":{"gitId":"Hzxin"},"content":"          \u003e"},{"lineNumber":138,"author":{"gitId":"Hzxin"},"content":"            {[10, 20, 30, 40, 50].map((pageSize) \u003d\u003e ("},{"lineNumber":139,"author":{"gitId":"Hzxin"},"content":"              \u003coption key\u003d{pageSize} value\u003d{pageSize}\u003e"},{"lineNumber":140,"author":{"gitId":"Hzxin"},"content":"                Show {pageSize}"},{"lineNumber":141,"author":{"gitId":"Hzxin"},"content":"              \u003c/option\u003e"},{"lineNumber":142,"author":{"gitId":"Hzxin"},"content":"            ))}"},{"lineNumber":143,"author":{"gitId":"Hzxin"},"content":"          \u003c/Select\u003e"},{"lineNumber":144,"author":{"gitId":"Hzxin"},"content":"        \u003c/Flex\u003e"},{"lineNumber":145,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":146,"author":{"gitId":"Hzxin"},"content":"        \u003cFlex\u003e"},{"lineNumber":147,"author":{"gitId":"Hzxin"},"content":"          \u003cTooltip label\u003d\"Next Page\"\u003e"},{"lineNumber":148,"author":{"gitId":"Hzxin"},"content":"            \u003cIconButton"},{"lineNumber":149,"author":{"gitId":"Hzxin"},"content":"              onClick\u003d{nextPage}"},{"lineNumber":150,"author":{"gitId":"Hzxin"},"content":"              isDisabled\u003d{!canNextPage}"},{"lineNumber":151,"author":{"gitId":"Hzxin"},"content":"              icon\u003d{\u003cChevronRightIcon h\u003d{6} w\u003d{6} /\u003e}"},{"lineNumber":152,"author":{"gitId":"Hzxin"},"content":"            /\u003e"},{"lineNumber":153,"author":{"gitId":"Hzxin"},"content":"          \u003c/Tooltip\u003e"},{"lineNumber":154,"author":{"gitId":"Hzxin"},"content":"          \u003cTooltip label\u003d\"Last Page\"\u003e"},{"lineNumber":155,"author":{"gitId":"Hzxin"},"content":"            \u003cIconButton"},{"lineNumber":156,"author":{"gitId":"Hzxin"},"content":"              onClick\u003d{() \u003d\u003e gotoPage(pageCount - 1)}"},{"lineNumber":157,"author":{"gitId":"Hzxin"},"content":"              isDisabled\u003d{!canNextPage}"},{"lineNumber":158,"author":{"gitId":"Hzxin"},"content":"              icon\u003d{\u003cArrowRightIcon h\u003d{3} w\u003d{3} /\u003e}"},{"lineNumber":159,"author":{"gitId":"Hzxin"},"content":"              ml\u003d{4}"},{"lineNumber":160,"author":{"gitId":"Hzxin"},"content":"            /\u003e"},{"lineNumber":161,"author":{"gitId":"Hzxin"},"content":"          \u003c/Tooltip\u003e"},{"lineNumber":162,"author":{"gitId":"Hzxin"},"content":"        \u003c/Flex\u003e"},{"lineNumber":163,"author":{"gitId":"Hzxin"},"content":"      \u003c/Flex\u003e"},{"lineNumber":164,"author":{"gitId":"Hzxin"},"content":"    \u003c/\u003e"},{"lineNumber":165,"author":{"gitId":"Hzxin"},"content":"  )"},{"lineNumber":166,"author":{"gitId":"Hzxin"},"content":"}"}],"authorContributionMap":{"Hzxin":166}},{"path":"frontend/src/components/RequireAuth.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { useLocation, Navigate, Outlet } from \u0027react-router-dom\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import useAuth from \u0027../hooks/useAuth\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"const RequireAuth \u003d () \u003d\u003e {"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  const { auth } \u003d useAuth()"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  const location \u003d useLocation()"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  return auth?.username !\u003d\u003d \u0027\u0027 ? ("},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    \u003cOutlet /\u003e"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  ) : ("},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    \u003cNavigate to\u003d\"/login\" state\u003d{{ from: location }} replace /\u003e"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"export default RequireAuth"}],"authorContributionMap":{"tlylt":14}},{"path":"frontend/src/components/TypesStack.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"import {"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"  Badge,"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"  HStack,"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"} from \u0027@chakra-ui/react\u0027"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"const TypesStack \u003d (types) \u003d\u003e {"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"  let badgeList \u003d []"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"  if (!Array.isArray(types)) {"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"    types \u003d [types]"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"  }"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"  types.forEach((type, index) \u003d\u003e {"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"    badgeList.push("},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"      \u003cBadge"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"        fontWeight\u003d\"bold\""},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"        color\u003d\"gray.600\""},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"        borderRadius\u003d\"1\""},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"        px\u003d\"2\""},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"        colorScheme\u003d\"blue\""},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"        key\u003d{index}"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"      \u003e"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"        {type}"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"      \u003c/Badge\u003e"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"    )"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"  })"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"  return \u003cHStack\u003e{badgeList}\u003c/HStack\u003e"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"export default TypesStack"}],"authorContributionMap":{"Hzxin":29}},{"path":"frontend/src/components/UserAvatar.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { Avatar } from \u0027@chakra-ui/react\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { getUserProfileUrl } from \u0027../utils\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"export function UserAvatar({ username, src }) {"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  const url \u003d src ?? getUserProfileUrl(username)"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    \u003cdiv\u003e"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"      \u003cAvatar bg\u003d\"white\" name\u003d{username} src\u003d{url}\u003e\u003c/Avatar\u003e"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    \u003c/div\u003e"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":11}},{"path":"frontend/src/components/collaboration/Editor.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { useEffect, useRef, useState } from \u0027react\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { db } from \u0027../../api/firebase\u0027"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import useAuth from \u0027../../hooks/useAuth\u0027"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"import useTabSize from \u0027../../hooks/useTabSize\u0027"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"import useLanguage from \u0027../../hooks/useLanguage\u0027"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"import Firepad from \u0027./lib/firepad\u0027"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"import { basicSetup } from \u0027codemirror\u0027"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"import { EditorView, keymap } from \u0027@codemirror/view\u0027"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"import { indentWithTab } from \u0027@codemirror/commands\u0027"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"import { indentUnit } from \u0027@codemirror/language\u0027"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"import { python } from \u0027@codemirror/lang-python\u0027"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"import { javascript } from \u0027@codemirror/lang-javascript\u0027"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"import { java } from \u0027@codemirror/lang-java\u0027"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"import { cpp } from \u0027@codemirror/lang-cpp\u0027"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"import getCursorExtension from \u0027./cursorExtension\u0027"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"import getSelectionExtension from \u0027./selectionExtension\u0027"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"import CursorListener from \u0027./cursorListener\u0027"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"import { useColorMode, Select } from \u0027@chakra-ui/react\u0027"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"import { oneDark, lightTheme } from \u0027./editorThemes\u0027"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"const indents \u003d {"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"  2: \u0027  \u0027,"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"  4: \u0027    \u0027,"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"const languageExtensions \u003d {"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"  \u0027Python\u0027: python(),"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"  \u0027Java\u0027: java(),"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"  \u0027C++\u0027: cpp(),"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"  \u0027JavaScript\u0027: javascript(),"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"const Editor \u003d ({ roomId, setEditorComponent }) \u003d\u003e {"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"  const docPath \u003d \u0027docs/\u0027 + roomId"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"  const { auth } \u003d useAuth()"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"  const editorRef \u003d useRef(null)"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"  const [ready, setReady] \u003d useState(false)"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"  const [tabSize, setTabSize] \u003d useTabSize(docPath)"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"  const [lang, setLang] \u003d useLanguage(docPath)"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"  const { colorMode } \u003d useColorMode()"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"  const uid \u003d auth.username"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"    /** Timer ID returned by setTimeout, used for sending cursor data */"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"    let timerId \u003d null"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"    const MIN_DELAY \u003d 1, MAX_DELAY \u003d 50 // Delay duration in milisec to send cursor data"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"    let lastSend \u003d 0 // Timestamp of last cursor update"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    // Delay to send cursor should be in the range [MIN_DELAY, MAX_DELAY]"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"    const getDelay \u003d () \u003d\u003e {"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"      const elapsed \u003d Date.now() - lastSend"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"      if (elapsed \u003e\u003d MAX_DELAY) {"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"        return MIN_DELAY // waited too long already, send ASAP"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"      if (MAX_DELAY - elapsed \u003c MIN_DELAY) {"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"        return MIN_DELAY // not deadline yet, but we still need to wait at least MIN_DELAY"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"      return MAX_DELAY - elapsed // keep waiting the rest of the duration until the deadline"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"    const parentNode \u003d editorRef.current"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"    const codeMirrorInstance \u003d new EditorView({"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"      parent: editorRef.current,"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"      extensions: ["},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"        basicSetup,"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"        keymap.of([indentWithTab]), // extension to press tab for indent"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"        indentUnit.of(indents[tabSize]),"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"        languageExtensions[lang], // extension for language"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"        EditorView.lineWrapping, // extension to wrap line"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"        // extension to customize editor style"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"        colorMode \u003d\u003d\u003d \u0027light\u0027"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":"          ? lightTheme"},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"          : oneDark,"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"        // extension to upload my own cursor data"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"        EditorView.updateListener.of((update) \u003d\u003e {"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"          if (!update.selectionSet \u0026\u0026 !update.docChanged) return"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"          clearTimeout(timerId)"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"          timerId \u003d setTimeout(() \u003d\u003e { // send cursor data to Firebase"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"            lastSend \u003d Date.now()"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"            db.ref(`${docPath}/users/${uid}/cursor`).set({"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"              from: update.state.selection.main.anchor,"},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"              to: update.state.selection.main.head,"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"            })"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"          }, getDelay())"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"        }),"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"        // extensions to manage the other person\u0027s cursor and selection"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"        getCursorExtension(uid),"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"        getSelectionExtension(uid),"},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"      ],"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"    const firepad \u003d Firepad.fromCodeMirror6("},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"      db.ref(docPath),"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"      codeMirrorInstance,"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"      {"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"        defaultText: \u0027# Type your answer here\u0027,"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"        userId: uid,"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"    let cl"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"    firepad.on(\u0027ready\u0027, () \u003d\u003e {"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"      console.log(\u0027editor ready\u0027)"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"      setEditorComponent(firepad)"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"      cl \u003d new CursorListener(docPath, codeMirrorInstance)"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"      setReady(true)"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"    return () \u003d\u003e {"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"      firepad.off(\u0027ready\u0027)"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"      codeMirrorInstance.destroy()"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"      cl?.deregister()"},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"      db.ref(`${docPath}/users/${uid}`).set(null)"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"      parentNode.removeChild(parentNode.children[0])"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"  // eslint-disable-next-line react-hooks/exhaustive-deps"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"  }, [docPath, lang, tabSize, uid])"},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"  return ("},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"    \u003c\u003e"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"      {!ready \u0026\u0026 \u003ch2\u003eLoading editor...\u003c/h2\u003e}"},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"      {ready \u0026\u0026 ("},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":"        \u003cdiv className\u003d\"flex flex-row\"\u003e"},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"          \u003cSelect value\u003d{lang} onChange\u003d{(event) \u003d\u003e setLang(event.target.value)}\u003e"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"            {Object.keys(languageExtensions).map((language, i) \u003d\u003e {"},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"              return ("},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"                \u003coption key\u003d{i} value\u003d{language}\u003e"},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"                  {language}"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"                \u003c/option\u003e"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":"              )"},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"            })}"},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"          \u003c/Select\u003e"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":"          \u003cSelect value\u003d{tabSize} onChange\u003d{(event) \u003d\u003e setTabSize(event.target.value)}\u003e"},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"            {Object.keys(indents).map((indent, i) \u003d\u003e {"},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":"              return ("},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":"                \u003coption key\u003d{i} value\u003d{indent}\u003e"},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":"                  {indent}"},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"                \u003c/option\u003e"},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":"              )"},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":"            })}"},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"          \u003c/Select\u003e"},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":"        \u003c/div\u003e"},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"      )}"},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":"      \u003cdiv"},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"        ref\u003d{editorRef}"},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":"        className\u003d{"},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":"          ready ? \u0027my-2 mr-2 flex h-min flex-col justify-start\u0027 : \u0027hidden\u0027"},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":"      /\u003e"},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":"    \u003c/\u003e"},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":"  )"},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":"export default Editor"}],"authorContributionMap":{"tlylt":6,"uyencfi":153}},{"path":"frontend/src/components/collaboration/cursorEffects.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { StateEffect } from \u0027@codemirror/state\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"// In CodeMirror, changes to the editor state are made by creating \"effect\" objects"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"// representing the change, then encapsulating them in a \"transaction\" object"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"// to be processed by the extension."},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"/** "},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":" * A CodeMirror Effect representing the action of adding a cursor."},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":" * "},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":" * This effect contains 3 values: "},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":" * - uid: The user id associated with this cursor (could be this user or the partner)"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":" * - from: cursor start"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":" * - to: cursor end"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":" * "},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":" *  If from \u003d\u003d to, this is a cursor. If from !\u003d to, this is a selection."},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"const addCursor \u003d StateEffect.define()"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"/** "},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":" * A CodeMirror Effect representing the action of removing a cursor."},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":" * "},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":" * This effect contains 3 values: "},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":" * - uid: The user id associated with this cursor (could be this user or the partner)"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":" * - from: cursor start"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":" * - to: cursor end"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":" * "},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":" *  If from \u003d\u003d to, this is a cursor. If from !\u003d to, this is a selection."},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"const rmCursor \u003d StateEffect.define()"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"export { addCursor, rmCursor }"}],"authorContributionMap":{"uyencfi":31}},{"path":"frontend/src/components/collaboration/cursorExtension.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { showTooltip } from \u0027@codemirror/view\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { StateField } from \u0027@codemirror/state\u0027"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import { addCursor, rmCursor } from \u0027./cursorEffects\u0027"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"// This extension must be added to the set of extensions in the Editor component."},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"// It manages a set of cursor objects representing the cursor of the other user,"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"// and updates the editor to reflect their cursor position."},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"// Although there is only 1 partner and thus 1 cursor, we keep an \"array of cursor\" to be safe."},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":" * Returns the extension to manage the other person\u0027s cursor."},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":" * @param uid The current user\u0027s id (NOT the other user!)"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"const getCursorExtension \u003d (uid) \u003d\u003e {"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"  return StateField.define({"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"    // Start with an empty array of cursors"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"    create() {"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"      return []"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"    },"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    // This function is called whenever the editor updates  it computes the"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"    // new cursor array using the previous array and the incoming transaction."},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"    update(cursors, tx) {"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"      let ret \u003d cursors"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"      for (let e of tx.effects) {"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"        // If this transaction adds or removes cursors, apply those changes"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"        if (e.is(addCursor)) {"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"          // Skip my own cursor"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"          if (e.value.uid \u003d\u003d\u003d uid) {"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"            continue"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"          ret \u003d ["},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"            ...cursors,"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"            {"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"              uid: e.value.uid, // Each cursor has 2 fields: user id and position"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"              pos: e.value.to,"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"            },"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"          ]"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"        } else if (e.is(rmCursor)) {"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"          if (e.value.uid \u003d\u003d\u003d uid) {"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"            continue"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"          // Remove a certain cursor by filtering it out"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"          ret \u003d cursors.filter((cur) \u003d\u003e cur.uid !\u003d\u003d e.value.uid)"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"      return ret"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"    },"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"    provide: (f) \u003d\u003e {"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"      return showTooltip.computeN([f], (state) \u003d\u003e {"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"        // Map each cursor obj stored in this StateField into a DOM element."},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"        // This renders into the other person\u0027s cursor."},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"        return state.field(f).map((x) \u003d\u003e {"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"          return {"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"            pos: Math.min(x.pos, state.doc.length),"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"            create: () \u003d\u003e {"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"              const dom \u003d document.createElement(\u0027div\u0027)"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"              dom.className \u003d \u0027cm-other-cursor\u0027  // Styling handled by CodeMirror\u0027s theme (see Editor.jsx)"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"              const offset \u003d { x: 0, y: -15 }"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"              return { dom, offset }"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"            },"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"        })"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"    },"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"  })"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"export default getCursorExtension"}],"authorContributionMap":{"tlylt":2,"uyencfi":66}},{"path":"frontend/src/components/collaboration/cursorListener.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { db } from \u0027../../api/firebase\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { addCursor, rmCursor } from \u0027./cursorEffects\u0027"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"function isPresent(x) {"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"  return x !\u003d\u003d null \u0026\u0026 x !\u003d\u003d undefined"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"class CursorListener {"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  /** The ref to the Firebase document */"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"  dbRef"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"  /** The CodeMirror instance */"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"  view"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"  /** The current cursor status of both users. Maps uid to the cursor data. */"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"  cursorsData"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"  /** The array of callbacks when a cursor is added */"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"  onAddCallbacks"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"  /** The array of callbacks when a cursor is removed */"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"  onRemoveCallbacks"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"  /** Boolean, true if this listerner has been deregistered */"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"  deregistered"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"  constructor(docPath, view) {"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    this.dbRef \u003d db.ref(`${docPath}/users`)"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"    this.view \u003d view"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    this.cursorsData \u003d {}"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"    this.onAddCallbacks \u003d []"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"    this.onRemoveCallbacks \u003d []"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"    this.deregistered \u003d false"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    this.registerCursorCallbacks()"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"    this.attachFirebaseListeners()"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    this.initUserData()"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"   * Registers callbacks for add-cursor and rm-cursor events."},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"   * For each event, the callback fn creates a corresponding Effect object"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"   * and dispatches this effect to update the CodeMirror view."},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"  registerCursorCallbacks() {"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"    // On add cursor"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"    this.onAddCallbacks.push((newCursor) \u003d\u003e {"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"      if (isPresent(newCursor.from) \u0026\u0026 isPresent(newCursor.to)) {"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"        let toAdd \u003d addCursor.of({"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"          uid: newCursor.uid,"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"          from: Math.min(newCursor.from, this.view.state.doc.length),"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"          to: Math.min(newCursor.to, this.view.state.doc.length),"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"        })"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"        this.view.dispatch({ effects: [toAdd] })"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"    // On remove cursor"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"    this.onRemoveCallbacks.push((oldCursor) \u003d\u003e {"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"      if (isPresent(oldCursor.from) \u0026\u0026 isPresent(oldCursor.to)) {"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"        let toRm \u003d rmCursor.of({"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"          uid: oldCursor.uid,"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"          from: oldCursor.from,"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"          to: oldCursor.to,"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"        })"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"        this.view.dispatch({ effects: [toRm] })"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"   * Attaches Firebase listeners to listen for changes in cursor data."},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"   * On the cursor data change, pass the new data to the callbacks registered"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"   * in {@link registerCursorCallbacks} which will emit changes to CodeMirror."},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"  attachFirebaseListeners() {"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"    this.dbRef.on("},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"      \u0027child_changed\u0027,"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"      (snapshot) \u003d\u003e {"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"        this.handleCursorEvent({"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"          uid: snapshot.key,"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"          ...snapshot.val(),"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"        })"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"      (err) \u003d\u003e {"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"        console.error(\u0027[child_changed] read failed: \u0027 + err.name)"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"    this.dbRef.on("},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"      \u0027child_removed\u0027,"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"      (snapshot) \u003d\u003e {"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"        this.handleCursorEvent({ uid: snapshot.key })"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"      (err) \u003d\u003e {"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"        console.error(\u0027[child_removed] read failed: \u0027 + err.name)"},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"   * Called once when the CursorListener is initialized."},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"   * Manually retrieves cursor data because Firebase listeners have not taken effect yet."},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"  initUserData() {"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"    this.dbRef"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"      .get()"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"      .then((snapshot) \u003d\u003e {"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"        if (!snapshot.exists()) {"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"          console.error(\u0027[initUserData] fail to read user data\u0027)"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"          return"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"        const v \u003d snapshot.val()"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"        for (const uid in v) {"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"          this.handleCursorEvent({ uid: uid, ...v[uid] })"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"      .catch(console.error)"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"   * Handles add- and remove-cursor events."},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"   * Invoked on Firebase change, or on init this object."},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"   * @param eventData an object `{uid, cursor}`, where `uid` is the owner of the cursor"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"   * and `cursor` contains the position of the cursor."},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"  handleCursorEvent \u003d (eventData) \u003d\u003e {"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"    const { uid, cursor } \u003d eventData"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"    // Since cursorsData stores the current cursor of both users, if one user is undefined,"},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"    // this is an addCursor event."},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"    if (this.cursorsData[uid] \u003d\u003d\u003d undefined) {"},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":"      this.cursorsData[uid] \u003d {"},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"        uid: uid,"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"        from: cursor?.from,"},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"        to: cursor?.to,"},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"      this.callbackOnAdd(this.cursorsData[uid])"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":"    // User has an existing cursor. Remove the old cursor, then add a new cursor."},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"    else {"},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"      this.callbackOnRemove(this.cursorsData[uid])"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":"      this.cursorsData[uid].from \u003d cursor?.from"},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":"      this.cursorsData[uid].to \u003d cursor?.to"},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"      this.callbackOnAdd(this.cursorsData[uid])"},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"  /** Executes all registered callbacks for Add-cursor event. */"},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":"  callbackOnAdd \u003d (cursor) \u003d\u003e {"},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":"    for (const fn of this.onAddCallbacks) {"},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"      fn(cursor)"},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":"  /** Executes all registered callbacks for Remove-cursor event. */"},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"  callbackOnRemove \u003d (cursor) \u003d\u003e {"},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":"    for (const fn of this.onRemoveCallbacks) {"},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":"      fn(cursor)"},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":"  /** Deletes all callbacks registered with this object. */"},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":"  deregister \u003d () \u003d\u003e {"},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":"    if (this.deregistered) {"},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":"      console.error(\u0027Unable to deregister twice\u0027)"},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"      return"},{"lineNumber":161,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":162,"author":{"gitId":"uyencfi"},"content":"    this.deregistered \u003d true"},{"lineNumber":163,"author":{"gitId":"uyencfi"},"content":"    this.dbRef.off()"},{"lineNumber":164,"author":{"gitId":"uyencfi"},"content":"    this.onAddCallbacks \u003d []"},{"lineNumber":165,"author":{"gitId":"uyencfi"},"content":"    this.onRemoveCallbacks \u003d []"},{"lineNumber":166,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":167,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":168,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":169,"author":{"gitId":"uyencfi"},"content":"export default CursorListener"}],"authorContributionMap":{"uyencfi":169}},{"path":"frontend/src/components/collaboration/editorThemes.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"// Source: https://github.com/codemirror/theme-one-dark/blob/main/src/one-dark.ts"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"// With modifications to fit our needs"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import { EditorView } from \u0027@codemirror/view\u0027"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import { HighlightStyle, syntaxHighlighting } from \u0027@codemirror/language\u0027"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"import { tags as t } from \u0027@lezer/highlight\u0027"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"// Using https://github.com/one-dark/vscode-one-dark-theme/ as reference for the colors"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"const chalky \u003d \u0027#e5c07b\u0027,"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  coral \u003d \u0027#e06c75\u0027,"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"  cyan \u003d \u0027#56b6c2\u0027,"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"  invalid \u003d \u0027#ffffff\u0027,"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"  ivory \u003d \u0027#abb2bf\u0027,"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"  stone \u003d \u0027#7d8799\u0027, // Brightened compared to original to increase contrast"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"  malibu \u003d \u0027#61afef\u0027,"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"  sage \u003d \u0027#98c379\u0027,"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"  whiskey \u003d \u0027#d19a66\u0027,"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"  violet \u003d \u0027#c678dd\u0027,"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"  darkBackground \u003d \u0027#21252b\u0027,"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"  highlightBackground \u003d \u0027#2c313a\u0027,"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"  background \u003d \u0027#282c34\u0027,"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"  selection \u003d \u0027#3E4451\u0027,"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"  cursor \u003d \u0027#528bff\u0027"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"// The editor theme styles for One Dark."},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"const oneDarkTheme \u003d EditorView.theme("},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"  {"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"    \u0027\u0026\u0027: {"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"      color: ivory,"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"      backgroundColor: background,"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"      // My own styles"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"      height: \u002785vh\u0027,"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"      borderColor: \u0027d3d3d3\u0027,"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"      borderWidth: \u00273px\u0027,"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"    // Colour of the other user\u0027s selection. A lighter, greener shade than this user\u0027s selection"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-other-selection\u0027: {"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"      backgroundColor: \u0027#4e524e\u0027,"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"    // Colour of the other user\u0027s cursor. Same colour as light mode (magenta)"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-tooltip.cm-other-cursor\u0027: {"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"      backgroundColor: \"magenta\","},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"      padding: \"8px 0.75px\","},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-content\u0027: {"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"      caretColor: cursor,"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-cursor, .cm-dropCursor\u0027: { borderLeftColor: cursor },"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"    \u0027\u0026.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection\u0027:"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"      { backgroundColor: selection },"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-panels\u0027: { backgroundColor: darkBackground, color: ivory },"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-panels.cm-panels-top\u0027: { borderBottom: \u00272px solid black\u0027 },"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-panels.cm-panels-bottom\u0027: { borderTop: \u00272px solid black\u0027 },"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-searchMatch\u0027: {"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"      backgroundColor: \u0027#72a1ff59\u0027,"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"      outline: \u00271px solid #457dff\u0027,"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-searchMatch.cm-searchMatch-selected\u0027: {"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"      backgroundColor: \u0027#6199ff2f\u0027,"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-activeLine\u0027: { backgroundColor: \u0027#6699ff0b\u0027 },"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-selectionMatch\u0027: { backgroundColor: \u0027#aafe661a\u0027 },"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"    \u0027\u0026.cm-focused .cm-matchingBracket, \u0026.cm-focused .cm-nonmatchingBracket\u0027: {"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"      backgroundColor: \u0027#bad0f847\u0027,"},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"      outline: \u00271px solid #515a6b\u0027,"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-gutters\u0027: {"},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"      backgroundColor: background,"},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"      color: stone,"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"      border: \u0027none\u0027,"},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-activeLineGutter\u0027: {"},{"lineNumber":80,"author":{"gitId":"tlylt"},"content":"      backgroundColor: highlightBackground,"},{"lineNumber":81,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":82,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":83,"author":{"gitId":"tlylt"},"content":"    \u0027.cm-foldPlaceholder\u0027: {"},{"lineNumber":84,"author":{"gitId":"tlylt"},"content":"      backgroundColor: \u0027transparent\u0027,"},{"lineNumber":85,"author":{"gitId":"tlylt"},"content":"      border: \u0027none\u0027,"},{"lineNumber":86,"author":{"gitId":"tlylt"},"content":"      color: \u0027#ddd\u0027,"},{"lineNumber":87,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":88,"author":{"gitId":"tlylt"},"content":"  },"},{"lineNumber":89,"author":{"gitId":"tlylt"},"content":"  { dark: true }"},{"lineNumber":90,"author":{"gitId":"tlylt"},"content":")"},{"lineNumber":91,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":92,"author":{"gitId":"tlylt"},"content":"// The syntax highlighting style for code in One Dark."},{"lineNumber":93,"author":{"gitId":"tlylt"},"content":"const oneDarkHighlightStyle \u003d HighlightStyle.define(["},{"lineNumber":94,"author":{"gitId":"tlylt"},"content":"  { tag: t.keyword, color: violet },"},{"lineNumber":95,"author":{"gitId":"tlylt"},"content":"  {"},{"lineNumber":96,"author":{"gitId":"tlylt"},"content":"    tag: [t.name, t.deleted, t.character, t.propertyName, t.macroName],"},{"lineNumber":97,"author":{"gitId":"tlylt"},"content":"    color: coral,"},{"lineNumber":98,"author":{"gitId":"tlylt"},"content":"  },"},{"lineNumber":99,"author":{"gitId":"tlylt"},"content":"  { tag: [t.function(t.variableName), t.labelName], color: malibu },"},{"lineNumber":100,"author":{"gitId":"tlylt"},"content":"  { tag: [t.color, t.constant(t.name), t.standard(t.name)], color: whiskey },"},{"lineNumber":101,"author":{"gitId":"tlylt"},"content":"  { tag: [t.definition(t.name), t.separator], color: ivory },"},{"lineNumber":102,"author":{"gitId":"tlylt"},"content":"  {"},{"lineNumber":103,"author":{"gitId":"tlylt"},"content":"    tag: ["},{"lineNumber":104,"author":{"gitId":"tlylt"},"content":"      t.typeName,"},{"lineNumber":105,"author":{"gitId":"tlylt"},"content":"      t.className,"},{"lineNumber":106,"author":{"gitId":"tlylt"},"content":"      t.number,"},{"lineNumber":107,"author":{"gitId":"tlylt"},"content":"      t.changed,"},{"lineNumber":108,"author":{"gitId":"tlylt"},"content":"      t.annotation,"},{"lineNumber":109,"author":{"gitId":"tlylt"},"content":"      t.modifier,"},{"lineNumber":110,"author":{"gitId":"tlylt"},"content":"      t.self,"},{"lineNumber":111,"author":{"gitId":"tlylt"},"content":"      t.namespace,"},{"lineNumber":112,"author":{"gitId":"tlylt"},"content":"    ],"},{"lineNumber":113,"author":{"gitId":"tlylt"},"content":"    color: chalky,"},{"lineNumber":114,"author":{"gitId":"tlylt"},"content":"  },"},{"lineNumber":115,"author":{"gitId":"tlylt"},"content":"  {"},{"lineNumber":116,"author":{"gitId":"tlylt"},"content":"    tag: ["},{"lineNumber":117,"author":{"gitId":"tlylt"},"content":"      t.operator,"},{"lineNumber":118,"author":{"gitId":"tlylt"},"content":"      t.operatorKeyword,"},{"lineNumber":119,"author":{"gitId":"tlylt"},"content":"      t.url,"},{"lineNumber":120,"author":{"gitId":"tlylt"},"content":"      t.escape,"},{"lineNumber":121,"author":{"gitId":"tlylt"},"content":"      t.regexp,"},{"lineNumber":122,"author":{"gitId":"tlylt"},"content":"      t.link,"},{"lineNumber":123,"author":{"gitId":"tlylt"},"content":"      t.special(t.string),"},{"lineNumber":124,"author":{"gitId":"tlylt"},"content":"    ],"},{"lineNumber":125,"author":{"gitId":"tlylt"},"content":"    color: cyan,"},{"lineNumber":126,"author":{"gitId":"tlylt"},"content":"  },"},{"lineNumber":127,"author":{"gitId":"tlylt"},"content":"  { tag: [t.meta, t.comment], color: stone },"},{"lineNumber":128,"author":{"gitId":"tlylt"},"content":"  { tag: t.strong, fontWeight: \u0027bold\u0027 },"},{"lineNumber":129,"author":{"gitId":"tlylt"},"content":"  { tag: t.emphasis, fontStyle: \u0027italic\u0027 },"},{"lineNumber":130,"author":{"gitId":"tlylt"},"content":"  { tag: t.strikethrough, textDecoration: \u0027line-through\u0027 },"},{"lineNumber":131,"author":{"gitId":"tlylt"},"content":"  { tag: t.link, color: stone, textDecoration: \u0027underline\u0027 },"},{"lineNumber":132,"author":{"gitId":"tlylt"},"content":"  { tag: t.heading, fontWeight: \u0027bold\u0027, color: coral },"},{"lineNumber":133,"author":{"gitId":"tlylt"},"content":"  { tag: [t.atom, t.bool, t.special(t.variableName)], color: whiskey },"},{"lineNumber":134,"author":{"gitId":"tlylt"},"content":"  { tag: [t.processingInstruction, t.string, t.inserted], color: sage },"},{"lineNumber":135,"author":{"gitId":"tlylt"},"content":"  { tag: t.invalid, color: invalid },"},{"lineNumber":136,"author":{"gitId":"tlylt"},"content":"])"},{"lineNumber":137,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":138,"author":{"gitId":"tlylt"},"content":"// Extension for One Dark theme"},{"lineNumber":139,"author":{"gitId":"tlylt"},"content":"export const oneDark \u003d [oneDarkTheme, syntaxHighlighting(oneDarkHighlightStyle)]"},{"lineNumber":140,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":141,"author":{"gitId":"tlylt"},"content":"// Extension for light mode"},{"lineNumber":142,"author":{"gitId":"tlylt"},"content":"export const lightTheme \u003d EditorView.theme({"},{"lineNumber":143,"author":{"gitId":"tlylt"},"content":"  \u0027\u0026\u0027: {"},{"lineNumber":144,"author":{"gitId":"tlylt"},"content":"    height: \u002785vh\u0027,"},{"lineNumber":145,"author":{"gitId":"tlylt"},"content":"    borderColor: \u0027d3d3d3\u0027,"},{"lineNumber":146,"author":{"gitId":"tlylt"},"content":"    borderWidth: \u00273px\u0027,"},{"lineNumber":147,"author":{"gitId":"tlylt"},"content":"  },"},{"lineNumber":148,"author":{"gitId":"tlylt"},"content":"  \u0027.cm-cursor\u0027: {"},{"lineNumber":149,"author":{"gitId":"tlylt"},"content":"    borderColor: \u0027black\u0027,"},{"lineNumber":150,"author":{"gitId":"tlylt"},"content":"    borderWidth: \u00271px\u0027,"},{"lineNumber":151,"author":{"gitId":"tlylt"},"content":"  },"},{"lineNumber":152,"author":{"gitId":"tlylt"},"content":"  \u0027.cm-other-selection\u0027: {"},{"lineNumber":153,"author":{"gitId":"tlylt"},"content":"    backgroundColor: \u0027lightblue\u0027,"},{"lineNumber":154,"author":{"gitId":"tlylt"},"content":"  },"},{"lineNumber":155,"author":{"gitId":"tlylt"},"content":"  \u0027.cm-other-cursor\u0027: {"},{"lineNumber":156,"author":{"gitId":"tlylt"},"content":"    borderColor: \u0027magenta\u0027,"},{"lineNumber":157,"author":{"gitId":"tlylt"},"content":"    height: \u002716px\u0027,"},{"lineNumber":158,"author":{"gitId":"tlylt"},"content":"  },          "},{"lineNumber":159,"author":{"gitId":"tlylt"},"content":"})"}],"authorContributionMap":{"tlylt":159}},{"path":"frontend/src/components/collaboration/lib/annotation-list.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { Span } from \"./span.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"// TODO: Rewrite this (probably using a splay tree) to be efficient.  Right now it\u0027s based on a linked list"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"// so all operations are O(n), where n is the number of spans in the list."},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"export const AnnotationList \u003d (function () {"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  function assert(bool, text) {"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"    if (!bool) {"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"      throw new Error("},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"        \"AnnotationList assertion failed\" + (text ? \": \" + text : \"\")"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"  function OldAnnotatedSpan(pos, node) {"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    this.pos \u003d pos"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"    this.length \u003d node.length"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"    this.annotation \u003d node.annotation"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"    this.attachedObject_ \u003d node.attachedObject"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"  OldAnnotatedSpan.prototype.getAttachedObject \u003d function () {"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"    return this.attachedObject_"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"  function NewAnnotatedSpan(pos, node) {"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"    this.pos \u003d pos"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"    this.length \u003d node.length"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"    this.annotation \u003d node.annotation"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"    this.node_ \u003d node"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"  NewAnnotatedSpan.prototype.attachObject \u003d function (object) {"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"    this.node_.attachedObject \u003d object"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"  var NullAnnotation \u003d {"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"    equals: function () {"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"      return false"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"    },"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"  function AnnotationList(changeHandler) {"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"    // There\u0027s always a head node; to avoid special cases."},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"    this.head_ \u003d new Node(0, NullAnnotation)"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"    this.changeHandler_ \u003d changeHandler"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"  AnnotationList.prototype.insertAnnotatedSpan \u003d function (span, annotation) {"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"    this.wrapOperation_(new Span(span.pos, 0), function (oldPos, old) {"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"      assert(!old || old.next \u003d\u003d\u003d null) // should be 0 or 1 nodes."},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"      var toInsert \u003d new Node(span.length, annotation)"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"      if (!old) {"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"        return toInsert"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"        assert(span.pos \u003e oldPos \u0026\u0026 span.pos \u003c oldPos + old.length)"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"        var newNodes \u003d new Node(0, NullAnnotation)"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"        // Insert part of old before insertion point."},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"        newNodes.next \u003d new Node(span.pos - oldPos, old.annotation)"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"        // Insert new node."},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"        newNodes.next.next \u003d toInsert"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"        // Insert part of old after insertion point."},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"        toInsert.next \u003d new Node(oldPos + old.length - span.pos, old.annotation)"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"        return newNodes.next"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"  AnnotationList.prototype.removeSpan \u003d function (removeSpan) {"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"    if (removeSpan.length \u003d\u003d\u003d 0) {"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"      return"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"    this.wrapOperation_(removeSpan, function (oldPos, old) {"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"      assert(old !\u003d\u003d null)"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"      var newNodes \u003d new Node(0, NullAnnotation),"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"        current \u003d newNodes"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"      // Add new node for part before the removed span (if any)."},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"      if (removeSpan.pos \u003e oldPos) {"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"        current.next \u003d new Node(removeSpan.pos - oldPos, old.annotation)"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"        current \u003d current.next"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"      // Skip over removed nodes."},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"      while (removeSpan.end() \u003e oldPos + old.length) {"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"        oldPos +\u003d old.length"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"        old \u003d old.next"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"      // Add new node for part after the removed span (if any)."},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"      var afterChars \u003d oldPos + old.length - removeSpan.end()"},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"      if (afterChars \u003e 0) {"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"        current.next \u003d new Node(afterChars, old.annotation)"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"      return newNodes.next"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"  AnnotationList.prototype.updateSpan \u003d function (span, updateFn) {"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"    if (span.length \u003d\u003d\u003d 0) {"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"      return"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"    this.wrapOperation_(span, function (oldPos, old) {"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"      assert(old !\u003d\u003d null)"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"      var newNodes \u003d new Node(0, NullAnnotation),"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"        current \u003d newNodes,"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"        currentPos \u003d oldPos"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"      // Add node for any characters before the span we\u0027re updating."},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"      var beforeChars \u003d span.pos - currentPos"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"      assert(beforeChars \u003c old.length)"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"      if (beforeChars \u003e 0) {"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"        current.next \u003d new Node(beforeChars, old.annotation)"},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"        current \u003d current.next"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"        currentPos +\u003d current.length"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"      // Add updated nodes for entirely updated nodes."},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"      while (old !\u003d\u003d null \u0026\u0026 span.end() \u003e\u003d oldPos + old.length) {"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"        var length \u003d oldPos + old.length - currentPos"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"        current.next \u003d new Node(length, updateFn(old.annotation, length))"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"        current \u003d current.next"},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"        oldPos +\u003d old.length"},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"        old \u003d old.next"},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":"        currentPos \u003d oldPos"},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"      // Add updated nodes for last node."},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"      var updateChars \u003d span.end() - currentPos"},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"      if (updateChars \u003e 0) {"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"        assert(updateChars \u003c old.length)"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":"        current.next \u003d new Node("},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"          updateChars,"},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"          updateFn(old.annotation, updateChars)"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":"        current \u003d current.next"},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"        currentPos +\u003d current.length"},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":"        // Add non-updated remaining part of node."},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":"        current.next \u003d new Node("},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"          oldPos + old.length - currentPos,"},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":"          old.annotation"},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"      return newNodes.next"},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":"  AnnotationList.prototype.wrapOperation_ \u003d function (span, operationFn) {"},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":"    if (span.pos \u003c 0) {"},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\"Span start cannot be negative.\")"},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":"    var oldNodes \u003d [],"},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":"      newNodes \u003d []"},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":"    var res \u003d this.getAffectedNodes_(span)"},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"    var tail"},{"lineNumber":161,"author":{"gitId":"uyencfi"},"content":"    if (res.start !\u003d\u003d null) {"},{"lineNumber":162,"author":{"gitId":"uyencfi"},"content":"      tail \u003d res.end.next"},{"lineNumber":163,"author":{"gitId":"uyencfi"},"content":"      // Temporarily truncate list so we can pass it to operationFn.  We\u0027ll splice it back in later."},{"lineNumber":164,"author":{"gitId":"uyencfi"},"content":"      res.end.next \u003d null"},{"lineNumber":165,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":166,"author":{"gitId":"uyencfi"},"content":"      // start and end are null, because span is empty and lies on the border of two nodes."},{"lineNumber":167,"author":{"gitId":"uyencfi"},"content":"      tail \u003d res.succ"},{"lineNumber":168,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":169,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":170,"author":{"gitId":"uyencfi"},"content":"    // Create a new segment to replace the affected nodes."},{"lineNumber":171,"author":{"gitId":"uyencfi"},"content":"    var newSegment \u003d operationFn(res.startPos, res.start)"},{"lineNumber":172,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":173,"author":{"gitId":"uyencfi"},"content":"    var includePredInOldNodes \u003d false,"},{"lineNumber":174,"author":{"gitId":"uyencfi"},"content":"      includeSuccInOldNodes \u003d false"},{"lineNumber":175,"author":{"gitId":"uyencfi"},"content":"    if (newSegment) {"},{"lineNumber":176,"author":{"gitId":"uyencfi"},"content":"      this.mergeNodesWithSameAnnotations_(newSegment)"},{"lineNumber":177,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":178,"author":{"gitId":"uyencfi"},"content":"      var newPos"},{"lineNumber":179,"author":{"gitId":"uyencfi"},"content":"      if (res.pred \u0026\u0026 res.pred.annotation.equals(newSegment.annotation)) {"},{"lineNumber":180,"author":{"gitId":"uyencfi"},"content":"        // We can merge the pred node with newSegment\u0027s first node."},{"lineNumber":181,"author":{"gitId":"uyencfi"},"content":"        includePredInOldNodes \u003d true"},{"lineNumber":182,"author":{"gitId":"uyencfi"},"content":"        newSegment.length +\u003d res.pred.length"},{"lineNumber":183,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":184,"author":{"gitId":"uyencfi"},"content":"        // Splice newSegment in after beforePred."},{"lineNumber":185,"author":{"gitId":"uyencfi"},"content":"        res.beforePred.next \u003d newSegment"},{"lineNumber":186,"author":{"gitId":"uyencfi"},"content":"        newPos \u003d res.predPos"},{"lineNumber":187,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":188,"author":{"gitId":"uyencfi"},"content":"        // Splice newSegment in after beforeStart."},{"lineNumber":189,"author":{"gitId":"uyencfi"},"content":"        res.beforeStart.next \u003d newSegment"},{"lineNumber":190,"author":{"gitId":"uyencfi"},"content":"        newPos \u003d res.startPos"},{"lineNumber":191,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":192,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":193,"author":{"gitId":"uyencfi"},"content":"      // Generate newNodes, but not the last one (since we may be able to merge it with succ)."},{"lineNumber":194,"author":{"gitId":"uyencfi"},"content":"      while (newSegment.next) {"},{"lineNumber":195,"author":{"gitId":"uyencfi"},"content":"        newNodes.push(new NewAnnotatedSpan(newPos, newSegment))"},{"lineNumber":196,"author":{"gitId":"uyencfi"},"content":"        newPos +\u003d newSegment.length"},{"lineNumber":197,"author":{"gitId":"uyencfi"},"content":"        newSegment \u003d newSegment.next"},{"lineNumber":198,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":199,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":200,"author":{"gitId":"uyencfi"},"content":"      if (res.succ \u0026\u0026 res.succ.annotation.equals(newSegment.annotation)) {"},{"lineNumber":201,"author":{"gitId":"uyencfi"},"content":"        // We can merge newSegment\u0027s last node with the succ node."},{"lineNumber":202,"author":{"gitId":"uyencfi"},"content":"        newSegment.length +\u003d res.succ.length"},{"lineNumber":203,"author":{"gitId":"uyencfi"},"content":"        includeSuccInOldNodes \u003d true"},{"lineNumber":204,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":205,"author":{"gitId":"uyencfi"},"content":"        // Splice rest of list after succ after newSegment."},{"lineNumber":206,"author":{"gitId":"uyencfi"},"content":"        newSegment.next \u003d res.succ.next"},{"lineNumber":207,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":208,"author":{"gitId":"uyencfi"},"content":"        // Splice tail after newSegment."},{"lineNumber":209,"author":{"gitId":"uyencfi"},"content":"        newSegment.next \u003d tail"},{"lineNumber":210,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":211,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":212,"author":{"gitId":"uyencfi"},"content":"      // Add last newSegment node to newNodes."},{"lineNumber":213,"author":{"gitId":"uyencfi"},"content":"      newNodes.push(new NewAnnotatedSpan(newPos, newSegment))"},{"lineNumber":214,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":215,"author":{"gitId":"uyencfi"},"content":"      // newList is empty.  Try to merge pred and succ."},{"lineNumber":216,"author":{"gitId":"uyencfi"},"content":"      if ("},{"lineNumber":217,"author":{"gitId":"uyencfi"},"content":"        res.pred \u0026\u0026"},{"lineNumber":218,"author":{"gitId":"uyencfi"},"content":"        res.succ \u0026\u0026"},{"lineNumber":219,"author":{"gitId":"uyencfi"},"content":"        res.pred.annotation.equals(res.succ.annotation)"},{"lineNumber":220,"author":{"gitId":"uyencfi"},"content":"      ) {"},{"lineNumber":221,"author":{"gitId":"uyencfi"},"content":"        includePredInOldNodes \u003d true"},{"lineNumber":222,"author":{"gitId":"uyencfi"},"content":"        includeSuccInOldNodes \u003d true"},{"lineNumber":223,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":224,"author":{"gitId":"uyencfi"},"content":"        // Create succ + pred merged node and splice list together."},{"lineNumber":225,"author":{"gitId":"uyencfi"},"content":"        newSegment \u003d new Node("},{"lineNumber":226,"author":{"gitId":"uyencfi"},"content":"          res.pred.length + res.succ.length,"},{"lineNumber":227,"author":{"gitId":"uyencfi"},"content":"          res.pred.annotation"},{"lineNumber":228,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":229,"author":{"gitId":"uyencfi"},"content":"        res.beforePred.next \u003d newSegment"},{"lineNumber":230,"author":{"gitId":"uyencfi"},"content":"        newSegment.next \u003d res.succ.next"},{"lineNumber":231,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":232,"author":{"gitId":"uyencfi"},"content":"        newNodes.push("},{"lineNumber":233,"author":{"gitId":"uyencfi"},"content":"          new NewAnnotatedSpan(res.startPos - res.pred.length, newSegment)"},{"lineNumber":234,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":235,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":236,"author":{"gitId":"uyencfi"},"content":"        // Just splice list back together."},{"lineNumber":237,"author":{"gitId":"uyencfi"},"content":"        res.beforeStart.next \u003d tail"},{"lineNumber":238,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":239,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":240,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":241,"author":{"gitId":"uyencfi"},"content":"    // Build list of oldNodes."},{"lineNumber":242,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":243,"author":{"gitId":"uyencfi"},"content":"    if (includePredInOldNodes) {"},{"lineNumber":244,"author":{"gitId":"uyencfi"},"content":"      oldNodes.push(new OldAnnotatedSpan(res.predPos, res.pred))"},{"lineNumber":245,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":246,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":247,"author":{"gitId":"uyencfi"},"content":"    var oldPos \u003d res.startPos,"},{"lineNumber":248,"author":{"gitId":"uyencfi"},"content":"      oldSegment \u003d res.start"},{"lineNumber":249,"author":{"gitId":"uyencfi"},"content":"    while (oldSegment !\u003d\u003d null) {"},{"lineNumber":250,"author":{"gitId":"uyencfi"},"content":"      oldNodes.push(new OldAnnotatedSpan(oldPos, oldSegment))"},{"lineNumber":251,"author":{"gitId":"uyencfi"},"content":"      oldPos +\u003d oldSegment.length"},{"lineNumber":252,"author":{"gitId":"uyencfi"},"content":"      oldSegment \u003d oldSegment.next"},{"lineNumber":253,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":254,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":255,"author":{"gitId":"uyencfi"},"content":"    if (includeSuccInOldNodes) {"},{"lineNumber":256,"author":{"gitId":"uyencfi"},"content":"      oldNodes.push(new OldAnnotatedSpan(oldPos, res.succ))"},{"lineNumber":257,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":258,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":259,"author":{"gitId":"uyencfi"},"content":"    this.changeHandler_(oldNodes, newNodes)"},{"lineNumber":260,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":261,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":262,"author":{"gitId":"uyencfi"},"content":"  AnnotationList.prototype.getAffectedNodes_ \u003d function (span) {"},{"lineNumber":263,"author":{"gitId":"uyencfi"},"content":"    // We want to find nodes \u0027start\u0027, \u0027end\u0027, \u0027beforeStart\u0027, \u0027pred\u0027, and \u0027succ\u0027 where:"},{"lineNumber":264,"author":{"gitId":"uyencfi"},"content":"    //  - \u0027start\u0027 contains the first character in span."},{"lineNumber":265,"author":{"gitId":"uyencfi"},"content":"    //  - \u0027end\u0027 contains the last character in span."},{"lineNumber":266,"author":{"gitId":"uyencfi"},"content":"    //  - \u0027beforeStart\u0027 is the node before \u0027start\u0027."},{"lineNumber":267,"author":{"gitId":"uyencfi"},"content":"    //  - \u0027beforePred\u0027 is the node before \u0027pred\u0027."},{"lineNumber":268,"author":{"gitId":"uyencfi"},"content":"    //  - \u0027succ\u0027 contains the node after \u0027end\u0027 if span.end() was on a node boundary, else null."},{"lineNumber":269,"author":{"gitId":"uyencfi"},"content":"    //  - \u0027pred\u0027 contains the node before \u0027start\u0027 if span.pos was on a node boundary, else null."},{"lineNumber":270,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":271,"author":{"gitId":"uyencfi"},"content":"    var result \u003d {}"},{"lineNumber":272,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":273,"author":{"gitId":"uyencfi"},"content":"    var prevprev \u003d null,"},{"lineNumber":274,"author":{"gitId":"uyencfi"},"content":"      prev \u003d this.head_,"},{"lineNumber":275,"author":{"gitId":"uyencfi"},"content":"      current \u003d prev.next,"},{"lineNumber":276,"author":{"gitId":"uyencfi"},"content":"      currentPos \u003d 0"},{"lineNumber":277,"author":{"gitId":"uyencfi"},"content":"    while (current !\u003d\u003d null \u0026\u0026 span.pos \u003e\u003d currentPos + current.length) {"},{"lineNumber":278,"author":{"gitId":"uyencfi"},"content":"      currentPos +\u003d current.length"},{"lineNumber":279,"author":{"gitId":"uyencfi"},"content":"      prevprev \u003d prev"},{"lineNumber":280,"author":{"gitId":"uyencfi"},"content":"      prev \u003d current"},{"lineNumber":281,"author":{"gitId":"uyencfi"},"content":"      current \u003d current.next"},{"lineNumber":282,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":283,"author":{"gitId":"uyencfi"},"content":"    if (current \u003d\u003d\u003d null \u0026\u0026 !(span.length \u003d\u003d\u003d 0 \u0026\u0026 span.pos \u003d\u003d\u003d currentPos)) {"},{"lineNumber":284,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\"Span start exceeds the bounds of the AnnotationList.\")"},{"lineNumber":285,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":286,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":287,"author":{"gitId":"uyencfi"},"content":"    result.startPos \u003d currentPos"},{"lineNumber":288,"author":{"gitId":"uyencfi"},"content":"    // Special case if span is empty and on the border of two nodes"},{"lineNumber":289,"author":{"gitId":"uyencfi"},"content":"    if (span.length \u003d\u003d\u003d 0 \u0026\u0026 span.pos \u003d\u003d\u003d currentPos) {"},{"lineNumber":290,"author":{"gitId":"uyencfi"},"content":"      result.start \u003d null"},{"lineNumber":291,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":292,"author":{"gitId":"uyencfi"},"content":"      result.start \u003d current"},{"lineNumber":293,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":294,"author":{"gitId":"uyencfi"},"content":"    result.beforeStart \u003d prev"},{"lineNumber":295,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":296,"author":{"gitId":"uyencfi"},"content":"    if (currentPos \u003d\u003d\u003d span.pos \u0026\u0026 currentPos \u003e 0) {"},{"lineNumber":297,"author":{"gitId":"uyencfi"},"content":"      result.pred \u003d prev"},{"lineNumber":298,"author":{"gitId":"uyencfi"},"content":"      result.predPos \u003d currentPos - prev.length"},{"lineNumber":299,"author":{"gitId":"uyencfi"},"content":"      result.beforePred \u003d prevprev"},{"lineNumber":300,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":301,"author":{"gitId":"uyencfi"},"content":"      result.pred \u003d null"},{"lineNumber":302,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":303,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":304,"author":{"gitId":"uyencfi"},"content":"    while (current !\u003d\u003d null \u0026\u0026 span.end() \u003e currentPos) {"},{"lineNumber":305,"author":{"gitId":"uyencfi"},"content":"      currentPos +\u003d current.length"},{"lineNumber":306,"author":{"gitId":"uyencfi"},"content":"      prev \u003d current"},{"lineNumber":307,"author":{"gitId":"uyencfi"},"content":"      current \u003d current.next"},{"lineNumber":308,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":309,"author":{"gitId":"uyencfi"},"content":"    if (span.end() \u003e currentPos) {"},{"lineNumber":310,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\"Span end exceeds the bounds of the AnnotationList.\")"},{"lineNumber":311,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":312,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":313,"author":{"gitId":"uyencfi"},"content":"    // Special case if span is empty and on the border of two nodes."},{"lineNumber":314,"author":{"gitId":"uyencfi"},"content":"    if (span.length \u003d\u003d\u003d 0 \u0026\u0026 span.end() \u003d\u003d\u003d currentPos) {"},{"lineNumber":315,"author":{"gitId":"uyencfi"},"content":"      result.end \u003d null"},{"lineNumber":316,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":317,"author":{"gitId":"uyencfi"},"content":"      result.end \u003d prev"},{"lineNumber":318,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":319,"author":{"gitId":"uyencfi"},"content":"    result.succ \u003d currentPos \u003d\u003d\u003d span.end() ? current : null"},{"lineNumber":320,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":321,"author":{"gitId":"uyencfi"},"content":"    return result"},{"lineNumber":322,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":323,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":324,"author":{"gitId":"uyencfi"},"content":"  AnnotationList.prototype.mergeNodesWithSameAnnotations_ \u003d function (list) {"},{"lineNumber":325,"author":{"gitId":"uyencfi"},"content":"    if (!list) {"},{"lineNumber":326,"author":{"gitId":"uyencfi"},"content":"      return"},{"lineNumber":327,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":328,"author":{"gitId":"uyencfi"},"content":"    var prev \u003d null,"},{"lineNumber":329,"author":{"gitId":"uyencfi"},"content":"      curr \u003d list"},{"lineNumber":330,"author":{"gitId":"uyencfi"},"content":"    while (curr) {"},{"lineNumber":331,"author":{"gitId":"uyencfi"},"content":"      if (prev \u0026\u0026 prev.annotation.equals(curr.annotation)) {"},{"lineNumber":332,"author":{"gitId":"uyencfi"},"content":"        prev.length +\u003d curr.length"},{"lineNumber":333,"author":{"gitId":"uyencfi"},"content":"        prev.next \u003d curr.next"},{"lineNumber":334,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":335,"author":{"gitId":"uyencfi"},"content":"        prev \u003d curr"},{"lineNumber":336,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":337,"author":{"gitId":"uyencfi"},"content":"      curr \u003d curr.next"},{"lineNumber":338,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":339,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":340,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":341,"author":{"gitId":"uyencfi"},"content":"  AnnotationList.prototype.forEach \u003d function (callback) {"},{"lineNumber":342,"author":{"gitId":"uyencfi"},"content":"    var current \u003d this.head_.next"},{"lineNumber":343,"author":{"gitId":"uyencfi"},"content":"    while (current !\u003d\u003d null) {"},{"lineNumber":344,"author":{"gitId":"uyencfi"},"content":"      callback(current.length, current.annotation, current.attachedObject)"},{"lineNumber":345,"author":{"gitId":"uyencfi"},"content":"      current \u003d current.next"},{"lineNumber":346,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":347,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":348,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":349,"author":{"gitId":"uyencfi"},"content":"  AnnotationList.prototype.getAnnotatedSpansForPos \u003d function (pos) {"},{"lineNumber":350,"author":{"gitId":"uyencfi"},"content":"    var currentPos \u003d 0"},{"lineNumber":351,"author":{"gitId":"uyencfi"},"content":"    var current \u003d this.head_.next,"},{"lineNumber":352,"author":{"gitId":"uyencfi"},"content":"      prev \u003d null"},{"lineNumber":353,"author":{"gitId":"uyencfi"},"content":"    while (current !\u003d\u003d null \u0026\u0026 currentPos + current.length \u003c\u003d pos) {"},{"lineNumber":354,"author":{"gitId":"uyencfi"},"content":"      currentPos +\u003d current.length"},{"lineNumber":355,"author":{"gitId":"uyencfi"},"content":"      prev \u003d current"},{"lineNumber":356,"author":{"gitId":"uyencfi"},"content":"      current \u003d current.next"},{"lineNumber":357,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":358,"author":{"gitId":"uyencfi"},"content":"    if (current \u003d\u003d\u003d null \u0026\u0026 currentPos !\u003d\u003d pos) {"},{"lineNumber":359,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\"pos exceeds the bounds of the AnnotationList\")"},{"lineNumber":360,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":361,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":362,"author":{"gitId":"uyencfi"},"content":"    var res \u003d []"},{"lineNumber":363,"author":{"gitId":"uyencfi"},"content":"    if (currentPos \u003d\u003d\u003d pos \u0026\u0026 prev) {"},{"lineNumber":364,"author":{"gitId":"uyencfi"},"content":"      res.push(new OldAnnotatedSpan(currentPos - prev.length, prev))"},{"lineNumber":365,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":366,"author":{"gitId":"uyencfi"},"content":"    if (current) {"},{"lineNumber":367,"author":{"gitId":"uyencfi"},"content":"      res.push(new OldAnnotatedSpan(currentPos, current))"},{"lineNumber":368,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":369,"author":{"gitId":"uyencfi"},"content":"    return res"},{"lineNumber":370,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":371,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":372,"author":{"gitId":"uyencfi"},"content":"  AnnotationList.prototype.getAnnotatedSpansForSpan \u003d function (span) {"},{"lineNumber":373,"author":{"gitId":"uyencfi"},"content":"    if (span.length \u003d\u003d\u003d 0) {"},{"lineNumber":374,"author":{"gitId":"uyencfi"},"content":"      return []"},{"lineNumber":375,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":376,"author":{"gitId":"uyencfi"},"content":"    var oldSpans \u003d []"},{"lineNumber":377,"author":{"gitId":"uyencfi"},"content":"    var res \u003d this.getAffectedNodes_(span)"},{"lineNumber":378,"author":{"gitId":"uyencfi"},"content":"    var currentPos \u003d res.startPos,"},{"lineNumber":379,"author":{"gitId":"uyencfi"},"content":"      current \u003d res.start"},{"lineNumber":380,"author":{"gitId":"uyencfi"},"content":"    while (current !\u003d\u003d null \u0026\u0026 currentPos \u003c span.end()) {"},{"lineNumber":381,"author":{"gitId":"uyencfi"},"content":"      var start \u003d Math.max(currentPos, span.pos),"},{"lineNumber":382,"author":{"gitId":"uyencfi"},"content":"        end \u003d Math.min(currentPos + current.length, span.end())"},{"lineNumber":383,"author":{"gitId":"uyencfi"},"content":"      var oldSpan \u003d new Span(start, end - start)"},{"lineNumber":384,"author":{"gitId":"uyencfi"},"content":"      oldSpan.annotation \u003d current.annotation"},{"lineNumber":385,"author":{"gitId":"uyencfi"},"content":"      oldSpans.push(oldSpan)"},{"lineNumber":386,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":387,"author":{"gitId":"uyencfi"},"content":"      currentPos +\u003d current.length"},{"lineNumber":388,"author":{"gitId":"uyencfi"},"content":"      current \u003d current.next"},{"lineNumber":389,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":390,"author":{"gitId":"uyencfi"},"content":"    return oldSpans"},{"lineNumber":391,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":392,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":393,"author":{"gitId":"uyencfi"},"content":"  // For testing."},{"lineNumber":394,"author":{"gitId":"uyencfi"},"content":"  AnnotationList.prototype.count \u003d function () {"},{"lineNumber":395,"author":{"gitId":"uyencfi"},"content":"    var count \u003d 0"},{"lineNumber":396,"author":{"gitId":"uyencfi"},"content":"    var current \u003d this.head_.next,"},{"lineNumber":397,"author":{"gitId":"uyencfi"},"content":"      prev \u003d null"},{"lineNumber":398,"author":{"gitId":"uyencfi"},"content":"    while (current !\u003d\u003d null) {"},{"lineNumber":399,"author":{"gitId":"uyencfi"},"content":"      if (prev) {"},{"lineNumber":400,"author":{"gitId":"uyencfi"},"content":"        assert(!prev.annotation.equals(current.annotation))"},{"lineNumber":401,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":402,"author":{"gitId":"uyencfi"},"content":"      prev \u003d current"},{"lineNumber":403,"author":{"gitId":"uyencfi"},"content":"      current \u003d current.next"},{"lineNumber":404,"author":{"gitId":"uyencfi"},"content":"      count++"},{"lineNumber":405,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":406,"author":{"gitId":"uyencfi"},"content":"    return count"},{"lineNumber":407,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":408,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":409,"author":{"gitId":"uyencfi"},"content":"  function Node(length, annotation) {"},{"lineNumber":410,"author":{"gitId":"uyencfi"},"content":"    this.length \u003d length"},{"lineNumber":411,"author":{"gitId":"uyencfi"},"content":"    this.annotation \u003d annotation"},{"lineNumber":412,"author":{"gitId":"uyencfi"},"content":"    this.attachedObject \u003d null"},{"lineNumber":413,"author":{"gitId":"uyencfi"},"content":"    this.next \u003d null"},{"lineNumber":414,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":415,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":416,"author":{"gitId":"uyencfi"},"content":"  Node.prototype.clone \u003d function () {"},{"lineNumber":417,"author":{"gitId":"uyencfi"},"content":"    var node \u003d new Node(this.spanLength, this.annotation)"},{"lineNumber":418,"author":{"gitId":"uyencfi"},"content":"    node.next \u003d this.next"},{"lineNumber":419,"author":{"gitId":"uyencfi"},"content":"    return node"},{"lineNumber":420,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":421,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":422,"author":{"gitId":"uyencfi"},"content":"  return AnnotationList"},{"lineNumber":423,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":423}},{"path":"frontend/src/components/collaboration/lib/client.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"export const Client \u003d (function () {"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"  // Client constructor"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"  function Client() {"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"    this.state \u003d synchronized_ // start state"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"  Client.prototype.setState \u003d function (state) {"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"    this.state \u003d state"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"  // Call this method when the user changes the document."},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"  Client.prototype.applyClient \u003d function (operation) {"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"    this.setState(this.state.applyClient(this, operation))"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"  // Call this method with a new operation from the server"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"  Client.prototype.applyServer \u003d function (operation) {"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"    this.setState(this.state.applyServer(this, operation))"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"  Client.prototype.serverAck \u003d function () {"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    this.setState(this.state.serverAck(this))"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"  Client.prototype.serverRetry \u003d function () {"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"    this.setState(this.state.serverRetry(this))"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"  // Override this method."},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"  Client.prototype.sendOperation \u003d function (operation) {"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    throw new Error(\"sendOperation must be defined in child class\")"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"  // Override this method."},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"  Client.prototype.applyOperation \u003d function (operation) {"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"    throw new Error(\"applyOperation must be defined in child class\")"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"  // In the \u0027Synchronized\u0027 state, there is no pending operation that the client"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"  // has sent to the server."},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"  function Synchronized() {}"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"  Client.Synchronized \u003d Synchronized"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"  Synchronized.prototype.applyClient \u003d function (client, operation) {"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"    // When the user makes an edit, send the operation to the server and"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"    // switch to the \u0027AwaitingConfirm\u0027 state"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"    client.sendOperation(operation)"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"    return new AwaitingConfirm(operation)"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"  Synchronized.prototype.applyServer \u003d function (client, operation) {"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"    // When we receive a new operation from the server, the operation can be"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"    // simply applied to the current document"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"    client.applyOperation(operation)"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"    return this"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"  Synchronized.prototype.serverAck \u003d function (client) {"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"    throw new Error(\"There is no pending operation.\")"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"  Synchronized.prototype.serverRetry \u003d function (client) {"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"    throw new Error(\"There is no pending operation.\")"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"  // Singleton"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"  var synchronized_ \u003d new Synchronized()"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"  // In the \u0027AwaitingConfirm\u0027 state, there\u0027s one operation the client has sent"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"  // to the server and is still waiting for an acknowledgement."},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"  function AwaitingConfirm(outstanding) {"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"    // Save the pending operation"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"    this.outstanding \u003d outstanding"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"  Client.AwaitingConfirm \u003d AwaitingConfirm"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"  AwaitingConfirm.prototype.applyClient \u003d function (client, operation) {"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"    // When the user makes an edit, don\u0027t send the operation immediately,"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"    // instead switch to \u0027AwaitingWithBuffer\u0027 state"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"    return new AwaitingWithBuffer(this.outstanding, operation)"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"  AwaitingConfirm.prototype.applyServer \u003d function (client, operation) {"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"    // This is another client\u0027s operation. Visualization:"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"    //"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"    //                   /\\"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"    // this.outstanding /  \\ operation"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"    //                 /    \\"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"    //                 \\    /"},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"    //  pair[1]         \\  / pair[0] (new outstanding)"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"    //  (can be applied  \\/"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"    //  to the client\u0027s"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"    //  current document)"},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"    var pair \u003d this.outstanding.transform(operation)"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"    client.applyOperation(pair[1])"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"    return new AwaitingConfirm(pair[0])"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"  AwaitingConfirm.prototype.serverAck \u003d function (client) {"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"    // The client\u0027s operation has been acknowledged"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"    // \u003d\u003e switch to synchronized state"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"    return synchronized_"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"  AwaitingConfirm.prototype.serverRetry \u003d function (client) {"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"    client.sendOperation(this.outstanding)"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"    return this"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"  // In the \u0027AwaitingWithBuffer\u0027 state, the client is waiting for an operation"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"  // to be acknowledged by the server while buffering the edits the user makes"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"  function AwaitingWithBuffer(outstanding, buffer) {"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"    // Save the pending operation and the user\u0027s edits since then"},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"    this.outstanding \u003d outstanding"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"    this.buffer \u003d buffer"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"  Client.AwaitingWithBuffer \u003d AwaitingWithBuffer"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"  AwaitingWithBuffer.prototype.applyClient \u003d function (client, operation) {"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"    // Compose the user\u0027s changes onto the buffer"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"    var newBuffer \u003d this.buffer.compose(operation)"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"    return new AwaitingWithBuffer(this.outstanding, newBuffer)"},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":"  AwaitingWithBuffer.prototype.applyServer \u003d function (client, operation) {"},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"    // Operation comes from another client"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"    //"},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"    //                       /\\"},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"    //     this.outstanding /  \\ operation"},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"    //                     /    \\"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"    //                    /\\    /"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":"    //       this.buffer /  \\* / pair1[0] (new outstanding)"},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"    //                  /    \\/"},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"    //                  \\    /"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":"    //          pair2[1] \\  / pair2[0] (new buffer)"},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":"    // the transformed    \\/"},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"    // operation -- can"},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":"    // be applied to the"},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":"    // client\u0027s current"},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":"    // document"},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"    //"},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":"    // * pair1[1]"},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":"    var pair1 \u003d this.outstanding.transform(operation)"},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"    var pair2 \u003d this.buffer.transform(pair1[1])"},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":"    client.applyOperation(pair2[1])"},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"    return new AwaitingWithBuffer(pair1[0], pair2[0])"},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"  AwaitingWithBuffer.prototype.serverRetry \u003d function (client) {"},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":"    // Merge with our buffer and resend."},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":"    var outstanding \u003d this.outstanding.compose(this.buffer)"},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":"    client.sendOperation(outstanding)"},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":"    return new AwaitingConfirm(outstanding)"},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":"  AwaitingWithBuffer.prototype.serverAck \u003d function (client) {"},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":"    // The pending operation has been acknowledged"},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":"    // \u003d\u003e send buffer"},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"    client.sendOperation(this.buffer)"},{"lineNumber":161,"author":{"gitId":"uyencfi"},"content":"    return new AwaitingConfirm(this.buffer)"},{"lineNumber":162,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":163,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":164,"author":{"gitId":"uyencfi"},"content":"  return Client"},{"lineNumber":165,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":165}},{"path":"frontend/src/components/collaboration/lib/codemirror6-adapter.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { TextOperation } from \"./text-operation.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { Cursor } from \"./cursor.js\""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"import { Annotation, StateEffect, Transaction } from \"@codemirror/state\""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"const addCodemirror6listener \u003d (_this) \u003d\u003e {"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  _this.cm.dispatch({"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    effects: StateEffect.appendConfig.of("},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"      _this.cm.constructor.updateListener.of((v) \u003d\u003e {"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"        if ("},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"          v.docChanged \u0026\u0026"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"          !("},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"            v.transactions[0] \u0026\u0026"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"            v.transactions[0].annotations.some((a) \u003d\u003e a.type \u003d\u003d\u003d \"firepad\")"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"          )"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"        ) {"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"          let index \u003d 0"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"          let change_op \u003d new TextOperation()"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"          let inverse_op \u003d new TextOperation()"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"          //Iterate over changes"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"          v.changes.toJSON().forEach((c) \u003d\u003e {"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"            if (typeof c \u003d\u003d \"number\") {"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"              if (c !\u003d\u003d 0) {"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"                index +\u003d c"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"                change_op \u003d change_op.retain(c)"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"                inverse_op \u003d inverse_op.retain(c)"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"              }"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"            } else if (typeof c \u003d\u003d \"object\") {"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"              const [len, ...inserts] \u003d c"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"              if (len \u003e 0) {"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"                change_op \u003d change_op.delete(len)"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"                inverse_op \u003d inverse_op.insert("},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"                  v.startState.sliceDoc(index, index + len)"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"                )"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"              }"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"              if (inserts) {"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"                const jInserts \u003d inserts.join(\"\\n\")"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"                change_op \u003d change_op.insert(jInserts)"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"                inverse_op \u003d inverse_op.delete(jInserts.length)"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"              }"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"            }"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"          })"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"          _this.trigger(\"change\", change_op, inverse_op)"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"        /** Update Editor Content */"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"        _this.lastDocLines \u003d _this.cm.state.doc.text"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    ),"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"  })"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":" * CodeMirror6 Adapter"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":" * Create Pipe between Firebase and CodeMirror6 Text Editor"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"var CodeMirror6Adapter \u003d (function () {"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"   * @constructor CodeMirror6Editor"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"   * @param {CodeMirror6Editor} monacoInstance - Editor Instance"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"   * @prop {CodeMirror6Editor} monaco - CodeMirror6 Instance passed as Parameter"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"   * @prop {CodeMirror6ITextModel} monacoModel - Data Model of the CodeMirror6 Instance"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"   * @prop {string[]} lastDocLines - Text for all Lines in the Editor"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"   * @prop {CodeMirror6Selection} lastCursorRange - Primary Selection of the Editor"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"   * @prop {function} onChange - Change Event Handler bound Local Object"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"   * @prop {function} onBlur - Blur Event Handler bound Local Object"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"   * @prop {function} onFocus - Focus Event Handler bound Local Object"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"   * @prop {function} onCursorActivity - Cursor Activity Handler bound Local Object"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"   * @prop {Boolean} ignoreChanges - Should Avoid OnChange Event Handling"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"   * @prop {CodeMirror6IDisposable} changeHandler - Event Handler for Model Content Change"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"   * @prop {CodeMirror6IDisposable} didBlurHandler - Event Handler for Focus Lost on Editor Text/Widget"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"   * @prop {CodeMirror6IDisposable} didFocusHandler - Event Handler for Focus Gain on Editor Text/Widget"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"   * @prop {CodeMirror6IDisposable} didChangeCursorPositionHandler - Event Handler for Cursor Position Change"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"  function CodeMirror6Adapter(cmIstance, options \u003d {}) {"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"    /* TODO: check if is valid codemirror6 istance"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"    */"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"    /** CodeMirror6 Member Variables */"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"    this.options \u003d options"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"    this.cm \u003d cmIstance"},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"    this.lastDocLines \u003d this.cm.state.doc.text"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"    this.lastCursorRange \u003d this.cm.state.selection.main"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"    /** CodeMirror6 Editor Configurations */"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"    this.callbacks \u003d {}"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"    this.otherCursors \u003d []"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"    this.addedStyleRules \u003d []"},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"    this.ignoreChanges \u003d false"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"    /** Adapter Callback Functions */"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"    this.onBlur \u003d this.onBlur.bind(this)"},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"    this.onFocus \u003d this.onFocus.bind(this)"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"    this.onCursorActivity \u003d this.onCursorActivity.bind(this)"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"    addCodemirror6listener(this)"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"   * @method detach - Clears an Instance of Editor Adapter"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.detach \u003d function detach() {"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"    /*"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"  this.changeHandler.dispose();"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"  this.didBlurHandler.dispose();"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"  this.didFocusHandler.dispose();"},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"  this.didChangeCursorPositionHandler.dispose();"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"  */"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"   * @method getCursor - Get current cursor position"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"   * @returns Firepad Cursor object"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.getCursor \u003d function getCursor() {"},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"    var selection \u003d this.cm.state.selection.main"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"    /** Fallback to last cursor change */"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"    if (typeof selection \u003d\u003d\u003d \"undefined\" || selection \u003d\u003d\u003d null) {"},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"      selection \u003d this.lastCursorRange"},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"    /** Obtain selection indexes */"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"    var start \u003d selection.from"},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"    var end \u003d selection.to"},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"    /** If Selection is Inversed */"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"    if (start \u003e end) {"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":"      var _ref \u003d [end, start]"},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"      start \u003d _ref[0]"},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"      end \u003d _ref[1]"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"    /** Return cursor position */"},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":"    return new Cursor(start, end)"},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":"   * @method setCursor - Set Selection on CodeMirror6 Editor Instance"},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":"   * @param {Object} cursor - Cursor Position (start and end)"},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"   * @param {Number} cursor.position - Starting Position of the Cursor"},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":"   * @param {Number} cursor.selectionEnd - Ending Position of the Cursor"},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.setCursor \u003d function setCursor(cursor) {"},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":"    var anchor \u003d cursor.position"},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"    var head \u003d cursor.selectionEnd"},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":"    this.cm.dispatch({ selection: { anchor, head } })"},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":"   * @method setOtherCursor - Set Remote Selection on CodeMirror6 Editor"},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":"   * @param {Number} cursor.position - Starting Position of the Selection"},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":"   * @param {Number} cursor.selectionEnd - Ending Position of the Selection"},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":"   * @param {String} color - Hex Color codes for Styling"},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":"   * @param {any} clientID - ID number of the Remote Client"},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":161,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.setOtherCursor \u003d function setOtherCursor("},{"lineNumber":162,"author":{"gitId":"uyencfi"},"content":"    cursor,"},{"lineNumber":163,"author":{"gitId":"uyencfi"},"content":"    color,"},{"lineNumber":164,"author":{"gitId":"uyencfi"},"content":"    clientID"},{"lineNumber":165,"author":{"gitId":"uyencfi"},"content":"  ) {}"},{"lineNumber":166,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":167,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":168,"author":{"gitId":"uyencfi"},"content":"   * @method registerCallbacks - Assign callback functions to internal property"},{"lineNumber":169,"author":{"gitId":"uyencfi"},"content":"   * @param {function[]} callbacks - Set of callback functions"},{"lineNumber":170,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":171,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.registerCallbacks \u003d function registerCallbacks("},{"lineNumber":172,"author":{"gitId":"uyencfi"},"content":"    callbacks"},{"lineNumber":173,"author":{"gitId":"uyencfi"},"content":"  ) {"},{"lineNumber":174,"author":{"gitId":"uyencfi"},"content":"    this.callbacks \u003d Object.assign({}, this.callbacks, callbacks)"},{"lineNumber":175,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":176,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":177,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":178,"author":{"gitId":"uyencfi"},"content":"   * @method registerUndo"},{"lineNumber":179,"author":{"gitId":"uyencfi"},"content":"   * @param {function} callback - Callback Handler for Undo Event"},{"lineNumber":180,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":181,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.registerUndo \u003d function registerUndo(callback) {"},{"lineNumber":182,"author":{"gitId":"uyencfi"},"content":"    if (typeof callback \u003d\u003d\u003d \"function\") {"},{"lineNumber":183,"author":{"gitId":"uyencfi"},"content":"      this.callbacks.undo \u003d callback"},{"lineNumber":184,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":185,"author":{"gitId":"uyencfi"},"content":"      throw new Error("},{"lineNumber":186,"author":{"gitId":"uyencfi"},"content":"        \"CodeMirror6Adapter: registerUndo method expects a \" +"},{"lineNumber":187,"author":{"gitId":"uyencfi"},"content":"          \"callback function in parameter\""},{"lineNumber":188,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":189,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":190,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":191,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":192,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":193,"author":{"gitId":"uyencfi"},"content":"   * @method registerRedo"},{"lineNumber":194,"author":{"gitId":"uyencfi"},"content":"   * @param {function} callback - Callback Handler for Redo Event"},{"lineNumber":195,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":196,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.registerRedo \u003d function registerRedo(callback) {"},{"lineNumber":197,"author":{"gitId":"uyencfi"},"content":"    if (typeof callback \u003d\u003d\u003d \"function\") {"},{"lineNumber":198,"author":{"gitId":"uyencfi"},"content":"      this.callbacks.redo \u003d callback"},{"lineNumber":199,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":200,"author":{"gitId":"uyencfi"},"content":"      throw new Error("},{"lineNumber":201,"author":{"gitId":"uyencfi"},"content":"        \"CodeMirror6Adapter: registerRedo method expects a \" +"},{"lineNumber":202,"author":{"gitId":"uyencfi"},"content":"          \"callback function in parameter\""},{"lineNumber":203,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":204,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":205,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":206,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":207,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":208,"author":{"gitId":"uyencfi"},"content":"   * @method trigger - Event Handler"},{"lineNumber":209,"author":{"gitId":"uyencfi"},"content":"   * @param {string} event - Event name"},{"lineNumber":210,"author":{"gitId":"uyencfi"},"content":"   * @param  {...any} args - Callback arguments"},{"lineNumber":211,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":212,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.trigger \u003d function trigger(event) {"},{"lineNumber":213,"author":{"gitId":"uyencfi"},"content":"    if (!this.callbacks.hasOwnProperty(event)) {"},{"lineNumber":214,"author":{"gitId":"uyencfi"},"content":"      return"},{"lineNumber":215,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":216,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":217,"author":{"gitId":"uyencfi"},"content":"    var action \u003d this.callbacks[event]"},{"lineNumber":218,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":219,"author":{"gitId":"uyencfi"},"content":"    if (!typeof action \u003d\u003d\u003d \"function\") {"},{"lineNumber":220,"author":{"gitId":"uyencfi"},"content":"      return"},{"lineNumber":221,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":222,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":223,"author":{"gitId":"uyencfi"},"content":"    var args \u003d []"},{"lineNumber":224,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":225,"author":{"gitId":"uyencfi"},"content":"    if (arguments.length \u003e 1) {"},{"lineNumber":226,"author":{"gitId":"uyencfi"},"content":"      for (var i \u003d 1; i \u003c arguments.length; i++) {"},{"lineNumber":227,"author":{"gitId":"uyencfi"},"content":"        args.push(arguments[i])"},{"lineNumber":228,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":229,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":230,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":231,"author":{"gitId":"uyencfi"},"content":"    action.apply(null, args)"},{"lineNumber":232,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":233,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":234,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":235,"author":{"gitId":"uyencfi"},"content":"   * @method onBlur - Blur event handler"},{"lineNumber":236,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":237,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.onBlur \u003d function onBlur() {"},{"lineNumber":238,"author":{"gitId":"uyencfi"},"content":"    if (this.monaco.getSelection().isEmpty()) {"},{"lineNumber":239,"author":{"gitId":"uyencfi"},"content":"      this.trigger(\"blur\")"},{"lineNumber":240,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":241,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":242,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":243,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":244,"author":{"gitId":"uyencfi"},"content":"   * @method onFocus - Focus event handler"},{"lineNumber":245,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":246,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.onFocus \u003d function onFocus() {"},{"lineNumber":247,"author":{"gitId":"uyencfi"},"content":"    this.trigger(\"focus\")"},{"lineNumber":248,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":249,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":250,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":251,"author":{"gitId":"uyencfi"},"content":"   * @method onCursorActivity - CursorActivity event handler"},{"lineNumber":252,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":253,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.onCursorActivity \u003d function onCursorActivity() {"},{"lineNumber":254,"author":{"gitId":"uyencfi"},"content":"    var _this \u003d this"},{"lineNumber":255,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":256,"author":{"gitId":"uyencfi"},"content":"    setTimeout(function () {"},{"lineNumber":257,"author":{"gitId":"uyencfi"},"content":"      return _this.trigger(\"cursorActivity\")"},{"lineNumber":258,"author":{"gitId":"uyencfi"},"content":"    }, 1)"},{"lineNumber":259,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":260,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":261,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":262,"author":{"gitId":"uyencfi"},"content":"   * @method applyOperation"},{"lineNumber":263,"author":{"gitId":"uyencfi"},"content":"   * @param {Operation} operation - OT.js Operation Object"},{"lineNumber":264,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":265,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.applyOperation \u003d function applyOperation("},{"lineNumber":266,"author":{"gitId":"uyencfi"},"content":"    operation"},{"lineNumber":267,"author":{"gitId":"uyencfi"},"content":"  ) {"},{"lineNumber":268,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":269,"author":{"gitId":"uyencfi"},"content":"    if (!operation.isNoop()) {"},{"lineNumber":270,"author":{"gitId":"uyencfi"},"content":"      this.ignoreChanges \u003d true"},{"lineNumber":271,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":272,"author":{"gitId":"uyencfi"},"content":"    /** Get Operations List */"},{"lineNumber":273,"author":{"gitId":"uyencfi"},"content":"    var opsList \u003d operation.ops"},{"lineNumber":274,"author":{"gitId":"uyencfi"},"content":"    var index \u003d 0"},{"lineNumber":275,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":276,"author":{"gitId":"uyencfi"},"content":"    var _this \u003d this"},{"lineNumber":277,"author":{"gitId":"uyencfi"},"content":"    opsList.forEach(function (op) {"},{"lineNumber":278,"author":{"gitId":"uyencfi"},"content":"      /** Retain Operation */"},{"lineNumber":279,"author":{"gitId":"uyencfi"},"content":"      if (op.isRetain()) {"},{"lineNumber":280,"author":{"gitId":"uyencfi"},"content":"        index +\u003d op.chars"},{"lineNumber":281,"author":{"gitId":"uyencfi"},"content":"      } else if (op.isInsert()) {"},{"lineNumber":282,"author":{"gitId":"uyencfi"},"content":"        /** Insert Operation */"},{"lineNumber":283,"author":{"gitId":"uyencfi"},"content":"        _this.cm.dispatch({"},{"lineNumber":284,"author":{"gitId":"uyencfi"},"content":"          annotations: [ Transaction.addToHistory.of(false), new Annotation(\"firepad\", true)],"},{"lineNumber":285,"author":{"gitId":"uyencfi"},"content":"          changes: { from: index, to: index, insert: op.text },"},{"lineNumber":286,"author":{"gitId":"uyencfi"},"content":"        })"},{"lineNumber":287,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":288,"author":{"gitId":"uyencfi"},"content":"        index +\u003d op.text.length"},{"lineNumber":289,"author":{"gitId":"uyencfi"},"content":"      } else if (op.isDelete()) {"},{"lineNumber":290,"author":{"gitId":"uyencfi"},"content":"        /** Delete Operation */"},{"lineNumber":291,"author":{"gitId":"uyencfi"},"content":"        _this.cm.dispatch({"},{"lineNumber":292,"author":{"gitId":"uyencfi"},"content":"          annotations: [Transaction.addToHistory.of(false),  new Annotation(\"firepad\", true)],"},{"lineNumber":293,"author":{"gitId":"uyencfi"},"content":"          changes: { from: index, to: index + op.chars, insert: \"\" },"},{"lineNumber":294,"author":{"gitId":"uyencfi"},"content":"        })"},{"lineNumber":295,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":296,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":297,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":298,"author":{"gitId":"uyencfi"},"content":"    /** Update Editor Content and Reset Config */"},{"lineNumber":299,"author":{"gitId":"uyencfi"},"content":"    this.lastDocLines \u003d this.cm.state.doc.text"},{"lineNumber":300,"author":{"gitId":"uyencfi"},"content":"    this.ignoreChanges \u003d false"},{"lineNumber":301,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":302,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":303,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":304,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":305,"author":{"gitId":"uyencfi"},"content":"   * @method invertOperation"},{"lineNumber":306,"author":{"gitId":"uyencfi"},"content":"   * @param {Operation} operation - OT.js Operation Object"},{"lineNumber":307,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":308,"author":{"gitId":"uyencfi"},"content":"  CodeMirror6Adapter.prototype.invertOperation \u003d function invertOperation("},{"lineNumber":309,"author":{"gitId":"uyencfi"},"content":"    operation"},{"lineNumber":310,"author":{"gitId":"uyencfi"},"content":"  ) {"},{"lineNumber":311,"author":{"gitId":"uyencfi"},"content":"    operation.invert(this.getValue())"},{"lineNumber":312,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":313,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":314,"author":{"gitId":"uyencfi"},"content":"  return CodeMirror6Adapter"},{"lineNumber":315,"author":{"gitId":"uyencfi"},"content":"})() /** Export Module */"},{"lineNumber":316,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":317,"author":{"gitId":"uyencfi"},"content":"export { CodeMirror6Adapter }"}],"authorContributionMap":{"uyencfi":317}},{"path":"frontend/src/components/collaboration/lib/constants.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"export const ATTR \u003d {"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"  BOLD: \"b\","},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"  ITALIC: \"i\","},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"  UNDERLINE: \"u\","},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"  STRIKE: \"s\","},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  FONT: \"f\","},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  FONT_SIZE: \"fs\","},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"  COLOR: \"c\","},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  BACKGROUND_COLOR: \"bc\","},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"  ENTITY_SENTINEL: \"ent\","},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"  // Line Attributes"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"  LINE_SENTINEL: \"l\","},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"  LINE_INDENT: \"li\","},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"  LINE_ALIGN: \"la\","},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"  LIST_TYPE: \"lt\","},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"export const sentinelConstants \u003d {"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"  // A special character we insert at the beginning of lines so we can attach attributes to it to represent"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"  // \"line attributes.\"  E000 is from the unicode \"private use\" range."},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"  LINE_SENTINEL_CHARACTER: \"\\uE000\","},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"  // A special character used to represent any \"entity\" inserted into the document (e.g. an image)."},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"  ENTITY_SENTINEL_CHARACTER: \"\\uE001\","},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"}"}],"authorContributionMap":{"uyencfi":26}},{"path":"frontend/src/components/collaboration/lib/cursor.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"export const Cursor \u003d (function () {"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"  // A cursor has a `position` and a `selectionEnd`. Both are zero-based indexes"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"  // into the document. When nothing is selected, `selectionEnd` is equal to"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"  // `position`. When there is a selection, `position` is always the side of the"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  // selection that would move if you pressed an arrow key."},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  function Cursor(position, selectionEnd) {"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    this.position \u003d position"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"    this.selectionEnd \u003d selectionEnd"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"  Cursor.fromJSON \u003d function (obj) {"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"    return new Cursor(obj.position, obj.selectionEnd)"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"  Cursor.prototype.equals \u003d function (other) {"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"    return ("},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"      this.position \u003d\u003d\u003d other.position \u0026\u0026"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"      this.selectionEnd \u003d\u003d\u003d other.selectionEnd"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"  // Return the more current cursor information."},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"  Cursor.prototype.compose \u003d function (other) {"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    return other"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"  // Update the cursor with respect to an operation."},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"  Cursor.prototype.transform \u003d function (other) {"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    function transformIndex(index) {"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"      var newIndex \u003d index"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"      var ops \u003d other.ops"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"      for (var i \u003d 0, l \u003d other.ops.length; i \u003c l; i++) {"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"        if (ops[i].isRetain()) {"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"          index -\u003d ops[i].chars"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"        } else if (ops[i].isInsert()) {"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"          newIndex +\u003d ops[i].text.length"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"          newIndex -\u003d Math.min(index, ops[i].chars)"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"          index -\u003d ops[i].chars"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"        if (index \u003c 0) {"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"          break"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"      return newIndex"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"    var newPosition \u003d transformIndex(this.position)"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"    if (this.position \u003d\u003d\u003d this.selectionEnd) {"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"      return new Cursor(newPosition, newPosition)"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"    return new Cursor(newPosition, transformIndex(this.selectionEnd))"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"  return Cursor"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":57}},{"path":"frontend/src/components/collaboration/lib/document.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"let fDocument \u003d null"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"export const getDocument \u003d () \u003d\u003e fDocument || window.document"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"export const setDocument \u003d (document) \u003d\u003e (fDocument \u003d document)"}],"authorContributionMap":{"uyencfi":5}},{"path":"frontend/src/components/collaboration/lib/editor-client.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { utils } from \"./utils.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { Cursor } from \"./cursor.js\""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import { Client } from \"./client.js\""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"import { UndoManager } from \"./undo-manager.js\""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"import { WrappedOperation } from \"./wrapped-operation.js\""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"export const EditorClient \u003d (function () {"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  function SelfMeta(cursorBefore, cursorAfter) {"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"    this.cursorBefore \u003d cursorBefore"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    this.cursorAfter \u003d cursorAfter"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"  SelfMeta.prototype.invert \u003d function () {"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    return new SelfMeta(this.cursorAfter, this.cursorBefore)"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"  SelfMeta.prototype.compose \u003d function (other) {"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"    return new SelfMeta(this.cursorBefore, other.cursorAfter)"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"  SelfMeta.prototype.transform \u003d function (operation) {"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    return new SelfMeta("},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"      this.cursorBefore ? this.cursorBefore.transform(operation) : null,"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"      this.cursorAfter ? this.cursorAfter.transform(operation) : null"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"  function OtherClient(id, editorAdapter) {"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    this.id \u003d id"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"    this.editorAdapter \u003d editorAdapter"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"  OtherClient.prototype.setColor \u003d function (color) {"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"    this.color \u003d color"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"  OtherClient.prototype.updateCursor \u003d function (cursor) {"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"    this.removeCursor()"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"    this.cursor \u003d cursor"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"    this.mark \u003d this.editorAdapter.setOtherCursor(cursor, this.color, this.id)"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"  OtherClient.prototype.removeCursor \u003d function () {"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"    if (this.mark) {"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"      this.mark.clear()"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"  function EditorClient(serverAdapter, editorAdapter) {"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    Client.call(this)"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"    this.serverAdapter \u003d serverAdapter"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"    this.editorAdapter \u003d editorAdapter"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"    this.undoManager \u003d new UndoManager()"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"    this.clients \u003d {}"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"    this.editorAdapter.registerCallbacks({"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"      change: function (operation, inverse) {"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"        self.onChange(operation, inverse)"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"      cursorActivity: function () {"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"        self.onCursorActivity()"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"      blur: function () {"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"        self.onBlur()"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"      focus: function () {"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"        self.onFocus()"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"    this.editorAdapter.registerUndo(function () {"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"      self.undo()"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"    this.editorAdapter.registerRedo(function () {"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"      self.redo()"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"    this.serverAdapter.registerCallbacks({"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"      ack: function () {"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"        self.serverAck()"},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"        if (self.focused \u0026\u0026 self.state instanceof Client.Synchronized) {"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"          self.updateCursor()"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"          self.sendCursor(self.cursor)"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"        self.emitStatus()"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"      retry: function () {"},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"        self.serverRetry()"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"      operation: function (operation) {"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"        self.applyServer(operation)"},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"      cursor: function (clientId, cursor, color) {"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"        if ("},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"          self.serverAdapter.userId_ \u003d\u003d\u003d clientId ||"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"          !(self.state instanceof Client.Synchronized)"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"        ) {"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"          return"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"        var client \u003d self.getClientObject(clientId)"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"        if (cursor) {"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"          if (color) client.setColor(color)"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"          client.updateCursor(Cursor.fromJSON(cursor))"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"          client.removeCursor()"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"  inherit(EditorClient, Client)"},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.getClientObject \u003d function (clientId) {"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"    var client \u003d this.clients[clientId]"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"    if (client) {"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"      return client"},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"    return (this.clients[clientId] \u003d new OtherClient("},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"      clientId,"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"      this.editorAdapter"},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"    ))"},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.applyUnredo \u003d function (operation) {"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"    this.undoManager.add(this.editorAdapter.invertOperation(operation))"},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"    this.editorAdapter.applyOperation(operation.wrapped)"},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"    this.cursor \u003d operation.meta.cursorAfter"},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"    if (this.cursor) this.editorAdapter.setCursor(this.cursor)"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"    this.applyClient(operation.wrapped)"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.undo \u003d function () {"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":"    if (!this.undoManager.canUndo()) {"},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"      return"},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":"    this.undoManager.performUndo(function (o) {"},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":"      self.applyUnredo(o)"},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.redo \u003d function () {"},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"    if (!this.undoManager.canRedo()) {"},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":"      return"},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"    this.undoManager.performRedo(function (o) {"},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":"      self.applyUnredo(o)"},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.onChange \u003d function (textOperation, inverse) {"},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":"    var cursorBefore \u003d this.cursor"},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":"    this.updateCursor()"},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":"    var compose \u003d"},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"      this.undoManager.undoStack.length \u003e 0 \u0026\u0026"},{"lineNumber":161,"author":{"gitId":"uyencfi"},"content":"      inverse.shouldBeComposedWithInverted("},{"lineNumber":162,"author":{"gitId":"uyencfi"},"content":"        last(this.undoManager.undoStack).wrapped"},{"lineNumber":163,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":164,"author":{"gitId":"uyencfi"},"content":"    var inverseMeta \u003d new SelfMeta(this.cursor, cursorBefore)"},{"lineNumber":165,"author":{"gitId":"uyencfi"},"content":"    this.undoManager.add(new WrappedOperation(inverse, inverseMeta), compose)"},{"lineNumber":166,"author":{"gitId":"uyencfi"},"content":"    this.applyClient(textOperation)"},{"lineNumber":167,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":168,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":169,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.updateCursor \u003d function () {"},{"lineNumber":170,"author":{"gitId":"uyencfi"},"content":"    this.cursor \u003d this.editorAdapter.getCursor()"},{"lineNumber":171,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":172,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":173,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.onCursorActivity \u003d function () {"},{"lineNumber":174,"author":{"gitId":"uyencfi"},"content":"    var oldCursor \u003d this.cursor"},{"lineNumber":175,"author":{"gitId":"uyencfi"},"content":"    this.updateCursor()"},{"lineNumber":176,"author":{"gitId":"uyencfi"},"content":"    if (!this.focused || (oldCursor \u0026\u0026 this.cursor.equals(oldCursor))) {"},{"lineNumber":177,"author":{"gitId":"uyencfi"},"content":"      return"},{"lineNumber":178,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":179,"author":{"gitId":"uyencfi"},"content":"    this.sendCursor(this.cursor)"},{"lineNumber":180,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":181,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":182,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.onBlur \u003d function () {"},{"lineNumber":183,"author":{"gitId":"uyencfi"},"content":"    this.cursor \u003d null"},{"lineNumber":184,"author":{"gitId":"uyencfi"},"content":"    this.sendCursor(null)"},{"lineNumber":185,"author":{"gitId":"uyencfi"},"content":"    this.focused \u003d false"},{"lineNumber":186,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":187,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":188,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.onFocus \u003d function () {"},{"lineNumber":189,"author":{"gitId":"uyencfi"},"content":"    this.focused \u003d true"},{"lineNumber":190,"author":{"gitId":"uyencfi"},"content":"    this.onCursorActivity()"},{"lineNumber":191,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":192,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":193,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.sendCursor \u003d function (cursor) {"},{"lineNumber":194,"author":{"gitId":"uyencfi"},"content":"    if (this.state instanceof Client.AwaitingWithBuffer) {"},{"lineNumber":195,"author":{"gitId":"uyencfi"},"content":"      return"},{"lineNumber":196,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":197,"author":{"gitId":"uyencfi"},"content":"    this.serverAdapter.sendCursor(cursor)"},{"lineNumber":198,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":199,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":200,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.sendOperation \u003d function (operation) {"},{"lineNumber":201,"author":{"gitId":"uyencfi"},"content":"    this.serverAdapter.sendOperation(operation)"},{"lineNumber":202,"author":{"gitId":"uyencfi"},"content":"    this.emitStatus()"},{"lineNumber":203,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":204,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":205,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.applyOperation \u003d function (operation) {"},{"lineNumber":206,"author":{"gitId":"uyencfi"},"content":"    this.editorAdapter.applyOperation(operation)"},{"lineNumber":207,"author":{"gitId":"uyencfi"},"content":"    this.updateCursor()"},{"lineNumber":208,"author":{"gitId":"uyencfi"},"content":"    this.undoManager.transform(new WrappedOperation(operation, null))"},{"lineNumber":209,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":210,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":211,"author":{"gitId":"uyencfi"},"content":"  EditorClient.prototype.emitStatus \u003d function () {"},{"lineNumber":212,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":213,"author":{"gitId":"uyencfi"},"content":"    setTimeout(function () {"},{"lineNumber":214,"author":{"gitId":"uyencfi"},"content":"      self.trigger(\"synced\", self.state instanceof Client.Synchronized)"},{"lineNumber":215,"author":{"gitId":"uyencfi"},"content":"    }, 0)"},{"lineNumber":216,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":217,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":218,"author":{"gitId":"uyencfi"},"content":"  // Set Const.prototype.__proto__ to Super.prototype"},{"lineNumber":219,"author":{"gitId":"uyencfi"},"content":"  function inherit(Const, Super) {"},{"lineNumber":220,"author":{"gitId":"uyencfi"},"content":"    function F() {}"},{"lineNumber":221,"author":{"gitId":"uyencfi"},"content":"    F.prototype \u003d Super.prototype"},{"lineNumber":222,"author":{"gitId":"uyencfi"},"content":"    Const.prototype \u003d new F()"},{"lineNumber":223,"author":{"gitId":"uyencfi"},"content":"    Const.prototype.constructor \u003d Const"},{"lineNumber":224,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":225,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":226,"author":{"gitId":"uyencfi"},"content":"  function last(arr) {"},{"lineNumber":227,"author":{"gitId":"uyencfi"},"content":"    return arr[arr.length - 1]"},{"lineNumber":228,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":229,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":230,"author":{"gitId":"uyencfi"},"content":"  return EditorClient"},{"lineNumber":231,"author":{"gitId":"uyencfi"},"content":"})()"},{"lineNumber":232,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":233,"author":{"gitId":"uyencfi"},"content":"utils.makeEventEmitter(EditorClient, [\"synced\"])"}],"authorContributionMap":{"uyencfi":233}},{"path":"frontend/src/components/collaboration/lib/entity-manager.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { utils } from \"./utils.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { Entity } from \"./entity.js\""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import { getDocument } from \"./document.js\""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"export const EntityManager \u003d (function () {"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  function EntityManager() {"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"    this.entities_ \u003d {}"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"    var attrs \u003d [\"src\", \"alt\", \"width\", \"height\", \"style\", \"class\"]"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"    this.register(\"img\", {"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"      render: function (info) {"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"        utils.assert(info.src, \"image entity should have \u0027src\u0027!\")"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"        var attrs \u003d [\"src\", \"alt\", \"width\", \"height\", \"style\", \"class\"]"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"        var html \u003d \"\u003cimg \""},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"        for (var i \u003d 0; i \u003c attrs.length; i++) {"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"          var attr \u003d attrs[i]"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"          if (attr in info) {"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"            html +\u003d \" \" + attr + \u0027\u003d\"\u0027 + info[attr] + \u0027\"\u0027"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"        html +\u003d \"\u003e\""},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"        return html"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"      fromElement: function (element) {"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"        var info \u003d {}"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"        for (var i \u003d 0; i \u003c attrs.length; i++) {"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"          var attr \u003d attrs[i]"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"          if (element.hasAttribute(attr)) {"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"            info[attr] \u003d element.getAttribute(attr)"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"        return info"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"  EntityManager.prototype.register \u003d function (type, options) {"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"    utils.assert("},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"      options.render,"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"      \"Entity options should include a \u0027render\u0027 function!\""},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"    utils.assert("},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"      options.fromElement,"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"      \"Entity options should include a \u0027fromElement\u0027 function!\""},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"    this.entities_[type] \u003d options"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"  EntityManager.prototype.renderToElement \u003d function (entity, entityHandle) {"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"    return this.tryRenderToElement_(entity, \"render\", entityHandle)"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"  EntityManager.prototype.exportToElement \u003d function (entity) {"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"    // Turns out \u0027export\u0027 is a reserved keyword, so \u0027getHtml\u0027 is preferable."},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"    var elt \u003d"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"      this.tryRenderToElement_(entity, \"export\") ||"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"      this.tryRenderToElement_(entity, \"getHtml\") ||"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"      this.tryRenderToElement_(entity, \"render\")"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"    elt.setAttribute(\"data-firepad-entity\", entity.type)"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"    return elt"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"  /* Updates a DOM element to reflect the given entity."},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"     If the entity doesn\u0027t support the update method, it is fully"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"     re-rendered."},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"  */"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"  EntityManager.prototype.updateElement \u003d function (entity, element) {"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"    var type \u003d entity.type"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"    var info \u003d entity.info"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"    if ("},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"      this.entities_[type] \u0026\u0026"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"      typeof this.entities_[type].update !\u003d \"undefined\""},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"    ) {"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"      this.entities_[type].update(info, element)"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"  EntityManager.prototype.fromElement \u003d function (element) {"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"    var type \u003d element.getAttribute(\"data-firepad-entity\")"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"    // HACK.  This should be configurable through entity registration."},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"    if (!type) type \u003d element.nodeName.toLowerCase()"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"    if (type \u0026\u0026 this.entities_[type]) {"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"      var info \u003d this.entities_[type].fromElement(element)"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"      return new Entity(type, info)"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"  EntityManager.prototype.tryRenderToElement_ \u003d function ("},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"    entity,"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"    renderFn,"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"    entityHandle"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"  ) {"},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"    var type \u003d entity.type,"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"      info \u003d entity.info"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"    if (this.entities_[type] \u0026\u0026 this.entities_[type][renderFn]) {"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"      var windowDocument \u003d getDocument()"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"      var res \u003d this.entities_[type][renderFn]("},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"        info,"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"        entityHandle,"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"        windowDocument"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"      if (res) {"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"        if (typeof res \u003d\u003d\u003d \"string\") {"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"          var div \u003d getDocument().createElement(\"div\")"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"          div.innerHTML \u003d res"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"          return div.childNodes[0]"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"        } else if (typeof res \u003d\u003d\u003d \"object\") {"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"          utils.assert("},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"            typeof res.nodeType !\u003d\u003d \"undefined\","},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"            \"Error rendering \" +"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"              type +"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"              \" entity.  render() function\" +"},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"              \" must return an html string or a DOM element.\""},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"          )"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"          return res"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"  EntityManager.prototype.entitySupportsUpdate \u003d function (entityType) {"},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"    return this.entities_[entityType] \u0026\u0026 this.entities_[entityType][\"update\"]"},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"  return EntityManager"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":128}},{"path":"frontend/src/components/collaboration/lib/entity.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { ATTR } from \"./constants.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":" * Object to represent an Entity."},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"export const Entity \u003d (function () {"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  var SENTINEL \u003d ATTR.ENTITY_SENTINEL"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"  var PREFIX \u003d SENTINEL + \"_\""},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"  function Entity(type, info) {"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    // Allow calling without new."},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"    if (!(this instanceof Entity)) {"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"      return new Entity(type, info)"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"    this.type \u003d type"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"    this.info \u003d info || {}"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"  Entity.prototype.toAttributes \u003d function () {"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"    var attrs \u003d {}"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"    attrs[SENTINEL] \u003d this.type"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"    for (var attr in this.info) {"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"      attrs[PREFIX + attr] \u003d this.info[attr]"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"    return attrs"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"  Entity.fromAttributes \u003d function (attributes) {"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    var type \u003d attributes[SENTINEL]"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"    var info \u003d {}"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"    for (var attr in attributes) {"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"      if (attr.indexOf(PREFIX) \u003d\u003d\u003d 0) {"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"        info[attr.substr(PREFIX.length)] \u003d attributes[attr]"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"    return new Entity(type, info)"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"  return Entity"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":44}},{"path":"frontend/src/components/collaboration/lib/firebase-adapter.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { TextOperation } from \"./text-operation.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { utils } from \"./utils.js\""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"import firebase from \"firebase/compat/app\""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"import \"firebase/compat/database\""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"export const FirebaseAdapter \u003d (function (global) {"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"  /*"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  if (typeof firebase \u003d\u003d\u003d \"undefined\" \u0026\u0026 typeof require \u003d\u003d\u003d \u0027function\u0027 \u0026\u0026 typeof Firebase !\u003d\u003d \u0027function\u0027) {"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"\t  firebase \u003d require(\u0027firebase/app\u0027);"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"\t  require(\u0027firebase/database\u0027);"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"  }*/"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"  // Save a checkpoint every 100 edits."},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"  var CHECKPOINT_FREQUENCY \u003d 100"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"  function FirebaseAdapter(ref, userId, userColor) {"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"    this.ref_ \u003d ref"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"    this.ready_ \u003d false"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    this.firebaseCallbacks_ \u003d []"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"    this.zombie_ \u003d false"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    // We store the current document state as a TextOperation so we can write checkpoints to Firebase occasionally."},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"    // TODO: Consider more efficient ways to do this. (composing text operations is ~linear in the length of the document)."},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    this.document_ \u003d new TextOperation()"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"    // The next expected revision."},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"    this.revision_ \u003d 0"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    // This is used for two purposes:"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"    // 1) On initialization, we fill this with the latest checkpoint and any subsequent operations and then"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    //      process them all together."},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"    // 2) If we ever receive revisions out-of-order (e.g. rev 5 before rev 4), we queue them here until it\u0027s time"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"    //    for them to be handled. [this should never happen with well-behaved clients; but if it /does/ happen we want"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"    //    to handle it gracefully.]"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"    this.pendingReceivedRevisions_ \u003d {}"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"    if (userId) {"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"      this.setUserId(userId)"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"      this.setColor(userColor)"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"      var connectedRef \u003d ref.root.child(\".info/connected\")"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"      this.firebaseOn_("},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"        connectedRef,"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"        \"value\","},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"        function (snapshot) {"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"          if (snapshot.val() \u003d\u003d\u003d true) {"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"            self.initializeUserData_()"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"        },"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"        this"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"      // Once we\u0027re initialized, start tracking users\u0027 cursors."},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"      this.on(\"ready\", function () {"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"        self.monitorCursors_()"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"      this.userId_ \u003d ref.push().key"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"    // Avoid triggering any events until our callers have had a chance to attach their listeners."},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"    setTimeout(function () {"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"      self.monitorHistory_()"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"    }, 0)"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"  utils.makeEventEmitter(FirebaseAdapter, ["},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"    \"ready\","},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"    \"cursor\","},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"    \"operation\","},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"    \"ack\","},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"    \"retry\","},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"  ])"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.dispose \u003d function () {"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"    this.removeFirebaseCallbacks_()"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"    this.handleInitialRevisions_ \u003d () \u003d\u003e {}"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"    if (!this.ready_) {"},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"      this.on(\"ready\", function () {"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"        self.dispose()"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"      return"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"    if (this.userRef_) {"},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"      this.userRef_.child(\"cursor\").remove()"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"      this.userRef_.child(\"color\").remove()"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"    this.ref_ \u003d null"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"    this.document_ \u003d null"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"    this.zombie_ \u003d true"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.setUserId \u003d function (userId) {"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"    if (this.userRef_) {"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"      // Clean up existing data.  Avoid nuking another user\u0027s data"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"      // (if a future user takes our old name)."},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"      this.userRef_.child(\"cursor\").remove()"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"      this.userRef_.child(\"cursor\").onDisconnect().cancel()"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"      this.userRef_.child(\"color\").remove()"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"      this.userRef_.child(\"color\").onDisconnect().cancel()"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"    this.userId_ \u003d userId"},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"    this.userRef_ \u003d this.ref_.child(\"users\").child(userId)"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"    this.initializeUserData_()"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.isHistoryEmpty \u003d function () {"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"    assert(this.ready_, \"Not ready yet.\")"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"    return this.revision_ \u003d\u003d\u003d 0"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"  /*"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"   * Send operation, retrying on connection failure. Takes an optional callback with signature:"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"   * function(error, committed)."},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"   * An exception will be thrown on transaction failure, which should only happen on"},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"   * catastrophic failure like a security rule violation."},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.sendOperation \u003d function (operation, callback) {"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"    // If we\u0027re not ready yet, do nothing right now, and trigger a retry when we\u0027re ready."},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"    if (!this.ready_) {"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"      this.on(\"ready\", function () {"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":"        self.trigger(\"retry\")"},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"      return"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"    // Sanity check that this operation is valid."},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":"    assert("},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":"      this.document_.targetLength \u003d\u003d\u003d operation.baseLength,"},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":"      \"sendOperation() called with invalid operation.\""},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":"    // Convert revision into an id that will sort properly lexicographically."},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"    var revisionId \u003d revisionToId(this.revision_)"},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"    function doTransaction(revisionId, revisionData) {"},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":"      self.ref_"},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":"        .child(\"history\")"},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"        .child(revisionId)"},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":"        .transaction("},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":"          function (current) {"},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":"            if (current \u003d\u003d\u003d null) {"},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":"              return revisionData"},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":"            }"},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":"          },"},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":"          function (error, committed, snapshot) {"},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":"            if (error) {"},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":"              if (error.message \u003d\u003d\u003d \"disconnect\") {"},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"                if (self.sent_ \u0026\u0026 self.sent_.id \u003d\u003d\u003d revisionId) {"},{"lineNumber":161,"author":{"gitId":"uyencfi"},"content":"                  // We haven\u0027t seen our transaction succeed or fail.  Send it again."},{"lineNumber":162,"author":{"gitId":"uyencfi"},"content":"                  setTimeout(function () {"},{"lineNumber":163,"author":{"gitId":"uyencfi"},"content":"                    doTransaction(revisionId, revisionData)"},{"lineNumber":164,"author":{"gitId":"uyencfi"},"content":"                  }, 0)"},{"lineNumber":165,"author":{"gitId":"uyencfi"},"content":"                } else if (callback) {"},{"lineNumber":166,"author":{"gitId":"uyencfi"},"content":"                  callback(error, false)"},{"lineNumber":167,"author":{"gitId":"uyencfi"},"content":"                }"},{"lineNumber":168,"author":{"gitId":"uyencfi"},"content":"              } else {"},{"lineNumber":169,"author":{"gitId":"uyencfi"},"content":"                utils.log(\"Transaction failure!\", error)"},{"lineNumber":170,"author":{"gitId":"uyencfi"},"content":"                throw error"},{"lineNumber":171,"author":{"gitId":"uyencfi"},"content":"              }"},{"lineNumber":172,"author":{"gitId":"uyencfi"},"content":"            } else {"},{"lineNumber":173,"author":{"gitId":"uyencfi"},"content":"              if (callback) callback(null, committed)"},{"lineNumber":174,"author":{"gitId":"uyencfi"},"content":"            }"},{"lineNumber":175,"author":{"gitId":"uyencfi"},"content":"          },"},{"lineNumber":176,"author":{"gitId":"uyencfi"},"content":"          /*applyLocally\u003d*/ false"},{"lineNumber":177,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":178,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":179,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":180,"author":{"gitId":"uyencfi"},"content":"    this.sent_ \u003d { id: revisionId, op: operation }"},{"lineNumber":181,"author":{"gitId":"uyencfi"},"content":"    doTransaction(revisionId, {"},{"lineNumber":182,"author":{"gitId":"uyencfi"},"content":"      a: self.userId_,"},{"lineNumber":183,"author":{"gitId":"uyencfi"},"content":"      o: operation.toJSON(),"},{"lineNumber":184,"author":{"gitId":"uyencfi"},"content":"      t: firebase.database.ServerValue.TIMESTAMP,"},{"lineNumber":185,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":186,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":187,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":188,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.sendCursor \u003d function (obj) {"},{"lineNumber":189,"author":{"gitId":"uyencfi"},"content":"    this.userRef_.child(\"cursor\").set(obj)"},{"lineNumber":190,"author":{"gitId":"uyencfi"},"content":"    this.cursor_ \u003d obj"},{"lineNumber":191,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":192,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":193,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.setColor \u003d function (color) {"},{"lineNumber":194,"author":{"gitId":"uyencfi"},"content":"    this.userRef_.child(\"color\").set(color)"},{"lineNumber":195,"author":{"gitId":"uyencfi"},"content":"    this.color_ \u003d color"},{"lineNumber":196,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":197,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":198,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.getDocument \u003d function () {"},{"lineNumber":199,"author":{"gitId":"uyencfi"},"content":"    return this.document_"},{"lineNumber":200,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":201,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":202,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.registerCallbacks \u003d function (callbacks) {"},{"lineNumber":203,"author":{"gitId":"uyencfi"},"content":"    for (var eventType in callbacks) {"},{"lineNumber":204,"author":{"gitId":"uyencfi"},"content":"      this.on(eventType, callbacks[eventType])"},{"lineNumber":205,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":206,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":207,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":208,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.initializeUserData_ \u003d function () {"},{"lineNumber":209,"author":{"gitId":"uyencfi"},"content":"    this.userRef_.child(\"cursor\").onDisconnect().remove()"},{"lineNumber":210,"author":{"gitId":"uyencfi"},"content":"    this.userRef_.child(\"color\").onDisconnect().remove()"},{"lineNumber":211,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":212,"author":{"gitId":"uyencfi"},"content":"    this.sendCursor(this.cursor_ || null)"},{"lineNumber":213,"author":{"gitId":"uyencfi"},"content":"    this.setColor(this.color_ || null)"},{"lineNumber":214,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":215,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":216,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.monitorCursors_ \u003d function () {"},{"lineNumber":217,"author":{"gitId":"uyencfi"},"content":"    var usersRef \u003d this.ref_.child(\"users\"),"},{"lineNumber":218,"author":{"gitId":"uyencfi"},"content":"      self \u003d this"},{"lineNumber":219,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":220,"author":{"gitId":"uyencfi"},"content":"    function childChanged(childSnap) {"},{"lineNumber":221,"author":{"gitId":"uyencfi"},"content":"      var userId \u003d childSnap.key"},{"lineNumber":222,"author":{"gitId":"uyencfi"},"content":"      var userData \u003d childSnap.val()"},{"lineNumber":223,"author":{"gitId":"uyencfi"},"content":"      self.trigger(\"cursor\", userId, userData.cursor, userData.color)"},{"lineNumber":224,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":225,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":226,"author":{"gitId":"uyencfi"},"content":"    this.firebaseOn_(usersRef, \"child_added\", childChanged)"},{"lineNumber":227,"author":{"gitId":"uyencfi"},"content":"    this.firebaseOn_(usersRef, \"child_changed\", childChanged)"},{"lineNumber":228,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":229,"author":{"gitId":"uyencfi"},"content":"    this.firebaseOn_(usersRef, \"child_removed\", function (childSnap) {"},{"lineNumber":230,"author":{"gitId":"uyencfi"},"content":"      var userId \u003d childSnap.key"},{"lineNumber":231,"author":{"gitId":"uyencfi"},"content":"      self.trigger(\"cursor\", userId, null)"},{"lineNumber":232,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":233,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":234,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":235,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.monitorHistory_ \u003d function () {"},{"lineNumber":236,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":237,"author":{"gitId":"uyencfi"},"content":"    // Get the latest checkpoint as a starting point so we don\u0027t have to re-play entire history."},{"lineNumber":238,"author":{"gitId":"uyencfi"},"content":"    this.ref_.child(\"checkpoint\").once(\"value\", function (s) {"},{"lineNumber":239,"author":{"gitId":"uyencfi"},"content":"      if (self.zombie_) {"},{"lineNumber":240,"author":{"gitId":"uyencfi"},"content":"        return"},{"lineNumber":241,"author":{"gitId":"uyencfi"},"content":"      } // just in case we were cleaned up before we got the checkpoint data."},{"lineNumber":242,"author":{"gitId":"uyencfi"},"content":"      var revisionId \u003d s.child(\"id\").val(),"},{"lineNumber":243,"author":{"gitId":"uyencfi"},"content":"        op \u003d s.child(\"o\").val(),"},{"lineNumber":244,"author":{"gitId":"uyencfi"},"content":"        author \u003d s.child(\"a\").val()"},{"lineNumber":245,"author":{"gitId":"uyencfi"},"content":"      if (op !\u003d null \u0026\u0026 revisionId !\u003d null \u0026\u0026 author !\u003d\u003d null) {"},{"lineNumber":246,"author":{"gitId":"uyencfi"},"content":"        self.pendingReceivedRevisions_[revisionId] \u003d { o: op, a: author }"},{"lineNumber":247,"author":{"gitId":"uyencfi"},"content":"        self.checkpointRevision_ \u003d revisionFromId(revisionId)"},{"lineNumber":248,"author":{"gitId":"uyencfi"},"content":"        self.monitorHistoryStartingAt_(self.checkpointRevision_ + 1)"},{"lineNumber":249,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":250,"author":{"gitId":"uyencfi"},"content":"        self.checkpointRevision_ \u003d 0"},{"lineNumber":251,"author":{"gitId":"uyencfi"},"content":"        self.monitorHistoryStartingAt_(self.checkpointRevision_)"},{"lineNumber":252,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":253,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":254,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":255,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":256,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.monitorHistoryStartingAt_ \u003d function (revision) {"},{"lineNumber":257,"author":{"gitId":"uyencfi"},"content":"    var historyRef \u003d this.ref_"},{"lineNumber":258,"author":{"gitId":"uyencfi"},"content":"      .child(\"history\")"},{"lineNumber":259,"author":{"gitId":"uyencfi"},"content":"      .startAt(null, revisionToId(revision))"},{"lineNumber":260,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":261,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":262,"author":{"gitId":"uyencfi"},"content":"    setTimeout(function () {"},{"lineNumber":263,"author":{"gitId":"uyencfi"},"content":"      self.firebaseOn_(historyRef, \"child_added\", function (revisionSnapshot) {"},{"lineNumber":264,"author":{"gitId":"uyencfi"},"content":"        var revisionId \u003d revisionSnapshot.key"},{"lineNumber":265,"author":{"gitId":"uyencfi"},"content":"        self.pendingReceivedRevisions_[revisionId] \u003d revisionSnapshot.val()"},{"lineNumber":266,"author":{"gitId":"uyencfi"},"content":"        if (self.ready_) {"},{"lineNumber":267,"author":{"gitId":"uyencfi"},"content":"          self.handlePendingReceivedRevisions_()"},{"lineNumber":268,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":269,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":270,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":271,"author":{"gitId":"uyencfi"},"content":"      historyRef.once(\"value\", function () {"},{"lineNumber":272,"author":{"gitId":"uyencfi"},"content":"        self.handleInitialRevisions_()"},{"lineNumber":273,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":274,"author":{"gitId":"uyencfi"},"content":"    }, 0)"},{"lineNumber":275,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":276,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":277,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.handleInitialRevisions_ \u003d function () {"},{"lineNumber":278,"author":{"gitId":"uyencfi"},"content":"    assert(!this.ready_, \"Should not be called multiple times.\")"},{"lineNumber":279,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":280,"author":{"gitId":"uyencfi"},"content":"    // Compose the checkpoint and all subsequent revisions into a single operation to apply at once."},{"lineNumber":281,"author":{"gitId":"uyencfi"},"content":"    this.revision_ \u003d this.checkpointRevision_"},{"lineNumber":282,"author":{"gitId":"uyencfi"},"content":"    var revisionId \u003d revisionToId(this.revision_),"},{"lineNumber":283,"author":{"gitId":"uyencfi"},"content":"      pending \u003d this.pendingReceivedRevisions_"},{"lineNumber":284,"author":{"gitId":"uyencfi"},"content":"    while (pending[revisionId] !\u003d null) {"},{"lineNumber":285,"author":{"gitId":"uyencfi"},"content":"      var revision \u003d this.parseRevision_(pending[revisionId])"},{"lineNumber":286,"author":{"gitId":"uyencfi"},"content":"      if (!revision) {"},{"lineNumber":287,"author":{"gitId":"uyencfi"},"content":"        // If a misbehaved client adds a bad operation, just ignore it."},{"lineNumber":288,"author":{"gitId":"uyencfi"},"content":"        utils.log("},{"lineNumber":289,"author":{"gitId":"uyencfi"},"content":"          \"Invalid operation.\","},{"lineNumber":290,"author":{"gitId":"uyencfi"},"content":"          this.ref_.toString(),"},{"lineNumber":291,"author":{"gitId":"uyencfi"},"content":"          revisionId,"},{"lineNumber":292,"author":{"gitId":"uyencfi"},"content":"          pending[revisionId]"},{"lineNumber":293,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":294,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":295,"author":{"gitId":"uyencfi"},"content":"        this.document_ \u003d this.document_.compose(revision.operation)"},{"lineNumber":296,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":297,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":298,"author":{"gitId":"uyencfi"},"content":"      delete pending[revisionId]"},{"lineNumber":299,"author":{"gitId":"uyencfi"},"content":"      this.revision_++"},{"lineNumber":300,"author":{"gitId":"uyencfi"},"content":"      revisionId \u003d revisionToId(this.revision_)"},{"lineNumber":301,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":302,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":303,"author":{"gitId":"uyencfi"},"content":"    this.trigger(\"operation\", this.document_)"},{"lineNumber":304,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":305,"author":{"gitId":"uyencfi"},"content":"    this.ready_ \u003d true"},{"lineNumber":306,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":307,"author":{"gitId":"uyencfi"},"content":"    setTimeout(function () {"},{"lineNumber":308,"author":{"gitId":"uyencfi"},"content":"      self.trigger(\"ready\")"},{"lineNumber":309,"author":{"gitId":"uyencfi"},"content":"    }, 0)"},{"lineNumber":310,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":311,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":312,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.handlePendingReceivedRevisions_ \u003d function () {"},{"lineNumber":313,"author":{"gitId":"uyencfi"},"content":"    var pending \u003d this.pendingReceivedRevisions_"},{"lineNumber":314,"author":{"gitId":"uyencfi"},"content":"    var revisionId \u003d revisionToId(this.revision_)"},{"lineNumber":315,"author":{"gitId":"uyencfi"},"content":"    var triggerRetry \u003d false"},{"lineNumber":316,"author":{"gitId":"uyencfi"},"content":"    while (pending[revisionId] !\u003d null) {"},{"lineNumber":317,"author":{"gitId":"uyencfi"},"content":"      this.revision_++"},{"lineNumber":318,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":319,"author":{"gitId":"uyencfi"},"content":"      var revision \u003d this.parseRevision_(pending[revisionId])"},{"lineNumber":320,"author":{"gitId":"uyencfi"},"content":"      if (!revision) {"},{"lineNumber":321,"author":{"gitId":"uyencfi"},"content":"        // If a misbehaved client adds a bad operation, just ignore it."},{"lineNumber":322,"author":{"gitId":"uyencfi"},"content":"        utils.log("},{"lineNumber":323,"author":{"gitId":"uyencfi"},"content":"          \"Invalid operation.\","},{"lineNumber":324,"author":{"gitId":"uyencfi"},"content":"          this.ref_.toString(),"},{"lineNumber":325,"author":{"gitId":"uyencfi"},"content":"          revisionId,"},{"lineNumber":326,"author":{"gitId":"uyencfi"},"content":"          pending[revisionId]"},{"lineNumber":327,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":328,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":329,"author":{"gitId":"uyencfi"},"content":"        this.document_ \u003d this.document_.compose(revision.operation)"},{"lineNumber":330,"author":{"gitId":"uyencfi"},"content":"        if (this.sent_ \u0026\u0026 revisionId \u003d\u003d\u003d this.sent_.id) {"},{"lineNumber":331,"author":{"gitId":"uyencfi"},"content":"          // We have an outstanding change at this revision id."},{"lineNumber":332,"author":{"gitId":"uyencfi"},"content":"          if ("},{"lineNumber":333,"author":{"gitId":"uyencfi"},"content":"            this.sent_.op.equals(revision.operation) \u0026\u0026"},{"lineNumber":334,"author":{"gitId":"uyencfi"},"content":"            revision.author \u003d\u003d\u003d this.userId_"},{"lineNumber":335,"author":{"gitId":"uyencfi"},"content":"          ) {"},{"lineNumber":336,"author":{"gitId":"uyencfi"},"content":"            // This is our change; it succeeded."},{"lineNumber":337,"author":{"gitId":"uyencfi"},"content":"            if (this.revision_ % CHECKPOINT_FREQUENCY \u003d\u003d\u003d 0) {"},{"lineNumber":338,"author":{"gitId":"uyencfi"},"content":"              this.saveCheckpoint_()"},{"lineNumber":339,"author":{"gitId":"uyencfi"},"content":"            }"},{"lineNumber":340,"author":{"gitId":"uyencfi"},"content":"            this.sent_ \u003d null"},{"lineNumber":341,"author":{"gitId":"uyencfi"},"content":"            this.trigger(\"ack\")"},{"lineNumber":342,"author":{"gitId":"uyencfi"},"content":"          } else {"},{"lineNumber":343,"author":{"gitId":"uyencfi"},"content":"            // our op failed.  Trigger a retry after we\u0027re done catching up on any incoming ops."},{"lineNumber":344,"author":{"gitId":"uyencfi"},"content":"            triggerRetry \u003d true"},{"lineNumber":345,"author":{"gitId":"uyencfi"},"content":"            this.trigger(\"operation\", revision.operation)"},{"lineNumber":346,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":347,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":348,"author":{"gitId":"uyencfi"},"content":"          this.trigger(\"operation\", revision.operation)"},{"lineNumber":349,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":350,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":351,"author":{"gitId":"uyencfi"},"content":"      delete pending[revisionId]"},{"lineNumber":352,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":353,"author":{"gitId":"uyencfi"},"content":"      revisionId \u003d revisionToId(this.revision_)"},{"lineNumber":354,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":355,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":356,"author":{"gitId":"uyencfi"},"content":"    if (triggerRetry) {"},{"lineNumber":357,"author":{"gitId":"uyencfi"},"content":"      this.sent_ \u003d null"},{"lineNumber":358,"author":{"gitId":"uyencfi"},"content":"      this.trigger(\"retry\")"},{"lineNumber":359,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":360,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":361,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":362,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.parseRevision_ \u003d function (data) {"},{"lineNumber":363,"author":{"gitId":"uyencfi"},"content":"    // We could do some of this validation via security rules.  But it\u0027s nice to be robust, just in case."},{"lineNumber":364,"author":{"gitId":"uyencfi"},"content":"    if (typeof data !\u003d\u003d \"object\") {"},{"lineNumber":365,"author":{"gitId":"uyencfi"},"content":"      return null"},{"lineNumber":366,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":367,"author":{"gitId":"uyencfi"},"content":"    if (typeof data.a !\u003d\u003d \"string\" || typeof data.o !\u003d\u003d \"object\") {"},{"lineNumber":368,"author":{"gitId":"uyencfi"},"content":"      return null"},{"lineNumber":369,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":370,"author":{"gitId":"uyencfi"},"content":"    var op \u003d null"},{"lineNumber":371,"author":{"gitId":"uyencfi"},"content":"    try {"},{"lineNumber":372,"author":{"gitId":"uyencfi"},"content":"      op \u003d TextOperation.fromJSON(data.o)"},{"lineNumber":373,"author":{"gitId":"uyencfi"},"content":"    } catch (e) {"},{"lineNumber":374,"author":{"gitId":"uyencfi"},"content":"      return null"},{"lineNumber":375,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":376,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":377,"author":{"gitId":"uyencfi"},"content":"    if (op.baseLength !\u003d\u003d this.document_.targetLength) {"},{"lineNumber":378,"author":{"gitId":"uyencfi"},"content":"      return null"},{"lineNumber":379,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":380,"author":{"gitId":"uyencfi"},"content":"    return { author: data.a, operation: op }"},{"lineNumber":381,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":382,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":383,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.saveCheckpoint_ \u003d function () {"},{"lineNumber":384,"author":{"gitId":"uyencfi"},"content":"    this.ref_.child(\"checkpoint\").set({"},{"lineNumber":385,"author":{"gitId":"uyencfi"},"content":"      a: this.userId_,"},{"lineNumber":386,"author":{"gitId":"uyencfi"},"content":"      o: this.document_.toJSON(),"},{"lineNumber":387,"author":{"gitId":"uyencfi"},"content":"      id: revisionToId(this.revision_ - 1), // use the id for the revision we just wrote."},{"lineNumber":388,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":389,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":390,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":391,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.firebaseOn_ \u003d function ("},{"lineNumber":392,"author":{"gitId":"uyencfi"},"content":"    ref,"},{"lineNumber":393,"author":{"gitId":"uyencfi"},"content":"    eventType,"},{"lineNumber":394,"author":{"gitId":"uyencfi"},"content":"    callback,"},{"lineNumber":395,"author":{"gitId":"uyencfi"},"content":"    context"},{"lineNumber":396,"author":{"gitId":"uyencfi"},"content":"  ) {"},{"lineNumber":397,"author":{"gitId":"uyencfi"},"content":"    this.firebaseCallbacks_.push({"},{"lineNumber":398,"author":{"gitId":"uyencfi"},"content":"      ref: ref,"},{"lineNumber":399,"author":{"gitId":"uyencfi"},"content":"      eventType: eventType,"},{"lineNumber":400,"author":{"gitId":"uyencfi"},"content":"      callback: callback,"},{"lineNumber":401,"author":{"gitId":"uyencfi"},"content":"      context: context,"},{"lineNumber":402,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":403,"author":{"gitId":"uyencfi"},"content":"    ref.on(eventType, callback, context)"},{"lineNumber":404,"author":{"gitId":"uyencfi"},"content":"    return callback"},{"lineNumber":405,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":406,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":407,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.firebaseOff_ \u003d function ("},{"lineNumber":408,"author":{"gitId":"uyencfi"},"content":"    ref,"},{"lineNumber":409,"author":{"gitId":"uyencfi"},"content":"    eventType,"},{"lineNumber":410,"author":{"gitId":"uyencfi"},"content":"    callback,"},{"lineNumber":411,"author":{"gitId":"uyencfi"},"content":"    context"},{"lineNumber":412,"author":{"gitId":"uyencfi"},"content":"  ) {"},{"lineNumber":413,"author":{"gitId":"uyencfi"},"content":"    ref.off(eventType, callback, context)"},{"lineNumber":414,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c this.firebaseCallbacks_.length; i++) {"},{"lineNumber":415,"author":{"gitId":"uyencfi"},"content":"      var l \u003d this.firebaseCallbacks_[i]"},{"lineNumber":416,"author":{"gitId":"uyencfi"},"content":"      if ("},{"lineNumber":417,"author":{"gitId":"uyencfi"},"content":"        l.ref \u003d\u003d\u003d ref \u0026\u0026"},{"lineNumber":418,"author":{"gitId":"uyencfi"},"content":"        l.eventType \u003d\u003d\u003d eventType \u0026\u0026"},{"lineNumber":419,"author":{"gitId":"uyencfi"},"content":"        l.callback \u003d\u003d\u003d callback \u0026\u0026"},{"lineNumber":420,"author":{"gitId":"uyencfi"},"content":"        l.context \u003d\u003d\u003d context"},{"lineNumber":421,"author":{"gitId":"uyencfi"},"content":"      ) {"},{"lineNumber":422,"author":{"gitId":"uyencfi"},"content":"        this.firebaseCallbacks_.splice(i, 1)"},{"lineNumber":423,"author":{"gitId":"uyencfi"},"content":"        break"},{"lineNumber":424,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":425,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":426,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":427,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":428,"author":{"gitId":"uyencfi"},"content":"  FirebaseAdapter.prototype.removeFirebaseCallbacks_ \u003d function () {"},{"lineNumber":429,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c this.firebaseCallbacks_.length; i++) {"},{"lineNumber":430,"author":{"gitId":"uyencfi"},"content":"      var l \u003d this.firebaseCallbacks_[i]"},{"lineNumber":431,"author":{"gitId":"uyencfi"},"content":"      l.ref.off(l.eventType, l.callback, l.context)"},{"lineNumber":432,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":433,"author":{"gitId":"uyencfi"},"content":"    this.firebaseCallbacks_ \u003d []"},{"lineNumber":434,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":435,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":436,"author":{"gitId":"uyencfi"},"content":"  // Throws an error if the first argument is falsy. Useful for debugging."},{"lineNumber":437,"author":{"gitId":"uyencfi"},"content":"  function assert(b, msg) {"},{"lineNumber":438,"author":{"gitId":"uyencfi"},"content":"    if (!b) {"},{"lineNumber":439,"author":{"gitId":"uyencfi"},"content":"      throw new Error(msg || \"assertion error\")"},{"lineNumber":440,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":441,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":442,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":443,"author":{"gitId":"uyencfi"},"content":"  // Based off ideas from http://www.zanopha.com/docs/elen.pdf"},{"lineNumber":444,"author":{"gitId":"uyencfi"},"content":"  var characters \u003d"},{"lineNumber":445,"author":{"gitId":"uyencfi"},"content":"    \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\""},{"lineNumber":446,"author":{"gitId":"uyencfi"},"content":"  function revisionToId(revision) {"},{"lineNumber":447,"author":{"gitId":"uyencfi"},"content":"    if (revision \u003d\u003d\u003d 0) {"},{"lineNumber":448,"author":{"gitId":"uyencfi"},"content":"      return \"A0\""},{"lineNumber":449,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":450,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":451,"author":{"gitId":"uyencfi"},"content":"    var str \u003d \"\""},{"lineNumber":452,"author":{"gitId":"uyencfi"},"content":"    while (revision \u003e 0) {"},{"lineNumber":453,"author":{"gitId":"uyencfi"},"content":"      var digit \u003d revision % characters.length"},{"lineNumber":454,"author":{"gitId":"uyencfi"},"content":"      str \u003d characters[digit] + str"},{"lineNumber":455,"author":{"gitId":"uyencfi"},"content":"      revision -\u003d digit"},{"lineNumber":456,"author":{"gitId":"uyencfi"},"content":"      revision /\u003d characters.length"},{"lineNumber":457,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":458,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":459,"author":{"gitId":"uyencfi"},"content":"    // Prefix with length (starting at \u0027A\u0027 for length 1) to ensure the id\u0027s sort lexicographically."},{"lineNumber":460,"author":{"gitId":"uyencfi"},"content":"    var prefix \u003d characters[str.length + 9]"},{"lineNumber":461,"author":{"gitId":"uyencfi"},"content":"    return prefix + str"},{"lineNumber":462,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":463,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":464,"author":{"gitId":"uyencfi"},"content":"  function revisionFromId(revisionId) {"},{"lineNumber":465,"author":{"gitId":"uyencfi"},"content":"    assert("},{"lineNumber":466,"author":{"gitId":"uyencfi"},"content":"      revisionId.length \u003e 0 \u0026\u0026"},{"lineNumber":467,"author":{"gitId":"uyencfi"},"content":"        revisionId[0] \u003d\u003d\u003d characters[revisionId.length + 8]"},{"lineNumber":468,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":469,"author":{"gitId":"uyencfi"},"content":"    var revision \u003d 0"},{"lineNumber":470,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 1; i \u003c revisionId.length; i++) {"},{"lineNumber":471,"author":{"gitId":"uyencfi"},"content":"      revision *\u003d characters.length"},{"lineNumber":472,"author":{"gitId":"uyencfi"},"content":"      revision +\u003d characters.indexOf(revisionId[i])"},{"lineNumber":473,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":474,"author":{"gitId":"uyencfi"},"content":"    return revision"},{"lineNumber":475,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":476,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":477,"author":{"gitId":"uyencfi"},"content":"  return FirebaseAdapter"},{"lineNumber":478,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":478}},{"path":"frontend/src/components/collaboration/lib/firepad.css","fileType":"css","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":".firepad {"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"  -webkit-box-sizing: border-box;"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"  -moz-box-sizing: border-box;"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"  box-sizing: border-box;"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"  width: 100%;"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  height: 100%;"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  position: relative;"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"  text-align: left;"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  line-height: normal;"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":".firepad .CodeMirror {"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"  position: absolute;"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"  top: 0;"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"  bottom: 0;"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"  right: 0;"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"  left: 0;"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"  height: auto;"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":".firepad-with-toolbar .CodeMirror {"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"  top: 83px;"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"  padding-left: 10px;"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":".firepad-with-toolbar .CodeMirror-lines {"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"  padding-top: 10px;"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":".firepad-toolbar {"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"  height: 82px;"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"  line-height: 82px;"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"  padding-left: 10px;"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"  border-bottom: 1px solid #c9c9c9;"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"  /* Don\u0027t select text when double-clicking in toolbar */"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"  -webkit-touch-callout: none;"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"  -webkit-user-select: none;"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"  -khtml-user-select: none;"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"  -moz-user-select: none;"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"  -ms-user-select: none;"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"  user-select: none;"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":".firepad-toolbar-wrapper {"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"  display: inline-block;"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"  line-height: 14px;"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":".firepad-richtext .CodeMirror {"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"  font-family: Verdana, sans-serif;"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"  font-size: 14px;"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":".firepad-spacer {"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"  height: 10px;"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"  width: 1px;"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"/** Styles for all of the rich-text formatting we support. */"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":".firepad-b {"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"  font-weight: bold;"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":".firepad-i {"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"  font-style: italic;"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":".firepad-u {"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"  text-decoration: underline;"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":".firepad-s {"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"  text-decoration: line-through;"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":".firepad-u.firepad-s {"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"  text-decoration: underline line-through;"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":".firepad-f-arial {"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"  font-family: Arial, Helvetica, sans-serif;"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":".firepad-f-comic-sans-ms {"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"  font-family: \"Comic Sans MS\", cursive, sans-serif;"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":".firepad-f-courier-new {"},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"  font-family: \"Courier New\", Courier, monospace;"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":".firepad-f-impact {"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"  font-family: Impact, Charcoal, sans-serif;"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":".firepad-f-times-new-roman {"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"  font-family: \"Times New Roman\", Times, serif;"},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":".firepad-f-verdana {"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"  font-family: Verdana, Geneva, sans-serif;"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":".firepad-la-left {"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"  text-align: left;"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":".firepad-la-center {"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"  text-align: center;"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":".firepad-la-right {"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"  text-align: right;"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"/** Line Styles */"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"pre.firepad-lt-o,"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"pre.firepad-lt-u,"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"pre.firepad-lt-t,"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"pre.firepad-lt-tc,"},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"pre.CodeMirror-line.firepad-lt-o,"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"pre.CodeMirror-line.firepad-lt-u,"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"pre.CodeMirror-line.firepad-lt-t,"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"pre.CodeMirror-line.firepad-lt-tc {"},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"  padding-left: 40px;"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":".firepad-list-left {"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"  display: inline-block;"},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"  margin-left: -40px;"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"  width: 40px;"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"  padding-right: 5px;"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"  text-align: right;"},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":".firepad-todo-left {"},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"  display: inline-block;"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"  margin-left: -20px;"},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"  width: 20px;"},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":".powered-by-firepad {"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":"  position: absolute;"},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"  display: block;"},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"  z-index: 5;"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":"  right: 20px;"},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":"  bottom: 20px;"},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"  width: 129px;"},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":"  height: 23px;"},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":"  background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIEAAAAXCAYAAAAsnywOAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowN0M3OUFEQTk4ODUxMUUyQUFBRTg2NUQxMTExQTUxQyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowN0M3OUFEQjk4ODUxMUUyQUFBRTg2NUQxMTExQTUxQyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkRBNEIyOTA5OTg4NDExRTJBQUFFODY1RDExMTFBNTFDIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkRBNEIyOTBBOTg4NDExRTJBQUFFODY1RDExMTFBNTFDIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+o21teAAABctJREFUeNrEWttV8zgQFjl5X1EBTgVr3vKGqYBQQZIKgAoMFUAqiKkgTgUxT/CGUwH+K8DbwVrnjDbzKzOjS9jdOUcnCVjyXD7NTTp7f39XkZQPoxjGn8PI4Lulbhi3w2jht4bnzXMX8Jkx6zbD+DWMSnj3Yhh38H2J3vMTlCN+DfUeXixlwJPVSwfrtDBeE/g0a85hbhf4fDmM7TDqmBdNp1N1FgACDco3Rp/Bb4mM8p6G8ZxojEeY79Ia+MC0DDSUS8ZYV/ApAfMFeOmZ/5fAr4/MOg8R/O3Q5jIgWMEaHN0jfdvnK4HvIBBoMPgNfP7X5AJBUnYIEGYA4sLxXD8NSokePIa09AxGdeksYU7l8w4GBCMCUQaF3yDk/wEAatdKu03i07jor2FsYI0i4f17ZuctItcpPV5UC8ZUHt63Qvg0sn+iMHdEY0dhsS68g9E6rmcPa2We+XieXWvr5BTrAD7WkFP0xN+zRPD1sHtrxqCxZL1rRQD1MzBnaZj/3QTM3YFHe5FAoAONXiND9Z5nS/h8A0apmN4yqG+B8ewEBfeRgLbJ3J4Bld1dOhFYc4LHTeDcPzxGdmXJGE9zA8n7P7KNnF0pZbGG+QnsjiZAwS28jNtNPfO+BRj/ixDOzLlm5t0xPEjUILkmwO8T8MvJd8XkDecQt8/g+5LI7AtC1lBPlXt0jcnKQslRgH41BYIeGO8j405MbHcNIClZMwBo4LMnlJQH8rwEY10zxpISTDf/qIkKQqPhyxNS9SflLQXwdQuAeHT4yzEQRgSizgmldLH1J2GgLNBAnLDYA3BeJCeAVjNAK8AIdjwHGGxDGPYV8b2A+P4F62nPeplQSVAhTwuhjNODLdkvCSCUbk6AGw9ZpFv1EZW41IygGVNnt6iJEuNGMybkLJj3L5k1HoXyLDSud45X4UrSF9BZwezwlPyhg420RiC5//j4WI0dpnom9mwRExpqbktvgmvnBOaSylww5KcnLlIhpgiY44IjJ8LNPBJkHK08fDWoJ9EQILg60SO3INs3ts0YjLpTv7dLqRJsLSheqhSoWP0akXSpwH4FFdtTSzlNxPhTCTeLSkEGqT+xAF20sF6XwMcRsEbq0PdOFdjXhYvJ2lOaUzahperv2OZQBbHTl9XHUANrvnj0VavDWUzJhFAbLmfgGWeCjjn9rqU+wSlC1h4X6xqtSSiDKCC9Kr5HvmYA0xBA9x30NJG82UR6RQBqHlF5+DxWz4Skvwi9lsz6b2MQ/jExvnRMIsUBQCm+z58FKncFCu483ilnXHKVIKuJ0/eCJ2oBKHukF07GxQ9svB71azJCVtxx3QiezPBZjZEhpfZsDQu/CeVZaB28OgEEvtM0KQQ1gQDQhGfh8p1JZFwuBe8U4wVwyCoYj1p6wph57+10Ou3HaHfeEfXlRMW1Xl33lhHIywJqWyWUY3O0CyRDKk8ymqPncojBOdGTkAAaAwDOCzyAjmeMh6FKdu1Jpn09j1ahlv0YMZgTbjsUABoplbpsghWxQ8lc7eklcHnDDgzQoBK1c4QsIiocl3YOf6ckhlIu0CLvZN53AfG8QSCkjqy1J+RKdHRHYiwgPaZNHHvsbGMVLps0s0u4I9iMaPo0sON/nWgwDZ6xFnZbk+AZJe9UEfLFJou+BP6J4nsU0XjxJSopdCGUjT0A5DrC7RbgCn/i2tmDJxy0kaDSTK4l5Q9U67lzbBNySHatDucuigNBm9h4kBobPqrV7zd2toTbsrxdquNDEEnhXcJOxUq+dJTbnugpe8LgvUfnSwYkywAw2g00kYxvCV8vK9ThgCT2TpyZ84VQ26O4tke7qfEgdwPur1b8ieZC+a+9naMEibsX2anDhdBOHV9oceX7dhR/mRBibGfWHrP7Nt4CeQNbxTVE2PhEsqxiymDujmGRuItsFtud6FUyFX7DdqYOJ4Ia1c+VUAnElLju+woiCf235HP16quGshS5DAj+FmAA6gfBqr4bldAAAAAASUVORK5CYII\u003d\");"},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":"  opacity: 0.5;"},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":".powered-by-firepad:hover {"},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"  opacity: 1;"},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":".firepad-btn-group {"},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":"  margin: 5px 7px 0 0;"},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"  display: inline-block;"},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":"a.firepad-btn,"},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":"a.firepad-btn:visited,"},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":"a.firepad-btn:active {"},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":"  font-family: \"Arial\" sans-serif;"},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":"  cursor: pointer;"},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":"  text-decoration: none;"},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":"  display: inline-block;"},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"  padding: 6px 6px 4px 6px;"},{"lineNumber":161,"author":{"gitId":"uyencfi"},"content":"  text-align: center;"},{"lineNumber":162,"author":{"gitId":"uyencfi"},"content":"  vertical-align: middle;"},{"lineNumber":163,"author":{"gitId":"uyencfi"},"content":"  font-size: 16px;"},{"lineNumber":164,"author":{"gitId":"uyencfi"},"content":"  background-color: #fcfcfc;"},{"lineNumber":165,"author":{"gitId":"uyencfi"},"content":"  border: 1px solid #c9c9c9;"},{"lineNumber":166,"author":{"gitId":"uyencfi"},"content":"  border-bottom-width: 4px;"},{"lineNumber":167,"author":{"gitId":"uyencfi"},"content":"  color: #9c9c9c;"},{"lineNumber":168,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":169,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":170,"author":{"gitId":"uyencfi"},"content":"a.firepad-btn:hover {"},{"lineNumber":171,"author":{"gitId":"uyencfi"},"content":"  color: #fff;"},{"lineNumber":172,"author":{"gitId":"uyencfi"},"content":"  background-color: #ffbf86;"},{"lineNumber":173,"author":{"gitId":"uyencfi"},"content":"  border-color: #e6a165;"},{"lineNumber":174,"author":{"gitId":"uyencfi"},"content":"  text-decoration: none;"},{"lineNumber":175,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":176,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":177,"author":{"gitId":"uyencfi"},"content":"a.firepad-btn:active {"},{"lineNumber":178,"author":{"gitId":"uyencfi"},"content":"  -webkit-box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.15),"},{"lineNumber":179,"author":{"gitId":"uyencfi"},"content":"    0 1px 2px rgba(0, 0, 0, 0.05);"},{"lineNumber":180,"author":{"gitId":"uyencfi"},"content":"  -moz-box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.15),"},{"lineNumber":181,"author":{"gitId":"uyencfi"},"content":"    0 1px 2px rgba(0, 0, 0, 0.05);"},{"lineNumber":182,"author":{"gitId":"uyencfi"},"content":"  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.15), 0 1px 2px rgba(0, 0, 0, 0.05);"},{"lineNumber":183,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":184,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":185,"author":{"gitId":"uyencfi"},"content":".firepad-btn-group \u003e .firepad-btn {"},{"lineNumber":186,"author":{"gitId":"uyencfi"},"content":"  -webkit-border-radius: 0;"},{"lineNumber":187,"author":{"gitId":"uyencfi"},"content":"  -moz-border-radius: 0;"},{"lineNumber":188,"author":{"gitId":"uyencfi"},"content":"  border-radius: 0;"},{"lineNumber":189,"author":{"gitId":"uyencfi"},"content":"  margin-left: -1px;"},{"lineNumber":190,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":191,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":192,"author":{"gitId":"uyencfi"},"content":".firepad-btn-group \u003e .firepad-btn:first-child {"},{"lineNumber":193,"author":{"gitId":"uyencfi"},"content":"  border-bottom-left-radius: 6px;"},{"lineNumber":194,"author":{"gitId":"uyencfi"},"content":"  border-top-left-radius: 6px;"},{"lineNumber":195,"author":{"gitId":"uyencfi"},"content":"  -webkit-border-bottom-left-radius: 6px;"},{"lineNumber":196,"author":{"gitId":"uyencfi"},"content":"  -webkit-border-top-left-radius: 6px;"},{"lineNumber":197,"author":{"gitId":"uyencfi"},"content":"  -moz-border-radius-bottomleft: 6px;"},{"lineNumber":198,"author":{"gitId":"uyencfi"},"content":"  -moz-border-radius-topleft: 6px;"},{"lineNumber":199,"author":{"gitId":"uyencfi"},"content":"  margin-left: 0px;"},{"lineNumber":200,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":201,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":202,"author":{"gitId":"uyencfi"},"content":".firepad-btn-group \u003e .firepad-btn:last-child {"},{"lineNumber":203,"author":{"gitId":"uyencfi"},"content":"  border-bottom-right-radius: 6px;"},{"lineNumber":204,"author":{"gitId":"uyencfi"},"content":"  border-top-right-radius: 6px;"},{"lineNumber":205,"author":{"gitId":"uyencfi"},"content":"  -webkit-border-bottom-right-radius: 6px;"},{"lineNumber":206,"author":{"gitId":"uyencfi"},"content":"  -webkit-border-top-right-radius: 6px;"},{"lineNumber":207,"author":{"gitId":"uyencfi"},"content":"  -moz-border-radius-bottomright: 6px;"},{"lineNumber":208,"author":{"gitId":"uyencfi"},"content":"  -moz-border-radius-topright: 6px;"},{"lineNumber":209,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":210,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":211,"author":{"gitId":"uyencfi"},"content":".firepad-dropdown {"},{"lineNumber":212,"author":{"gitId":"uyencfi"},"content":"  position: relative;"},{"lineNumber":213,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":214,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":215,"author":{"gitId":"uyencfi"},"content":".firepad-dropdown-menu {"},{"lineNumber":216,"author":{"gitId":"uyencfi"},"content":"  position: absolute;"},{"lineNumber":217,"author":{"gitId":"uyencfi"},"content":"  top: 100%;"},{"lineNumber":218,"author":{"gitId":"uyencfi"},"content":"  left: 0;"},{"lineNumber":219,"author":{"gitId":"uyencfi"},"content":"  z-index: 1000;"},{"lineNumber":220,"author":{"gitId":"uyencfi"},"content":"  display: none;"},{"lineNumber":221,"author":{"gitId":"uyencfi"},"content":"  float: left;"},{"lineNumber":222,"author":{"gitId":"uyencfi"},"content":"  padding: 4px 0;"},{"lineNumber":223,"author":{"gitId":"uyencfi"},"content":"  margin: 4px 0 0;"},{"lineNumber":224,"author":{"gitId":"uyencfi"},"content":"  list-style: none;"},{"lineNumber":225,"author":{"gitId":"uyencfi"},"content":"  background-color: #ffffff;"},{"lineNumber":226,"author":{"gitId":"uyencfi"},"content":"  border: 1px solid #ccc;"},{"lineNumber":227,"author":{"gitId":"uyencfi"},"content":"  border: 1px solid rgba(0, 0, 0, 0.2);"},{"lineNumber":228,"author":{"gitId":"uyencfi"},"content":"  *border-right-width: 2px;"},{"lineNumber":229,"author":{"gitId":"uyencfi"},"content":"  *border-bottom-width: 2px;"},{"lineNumber":230,"author":{"gitId":"uyencfi"},"content":"  -webkit-border-radius: 5px;"},{"lineNumber":231,"author":{"gitId":"uyencfi"},"content":"  -moz-border-radius: 5px;"},{"lineNumber":232,"author":{"gitId":"uyencfi"},"content":"  border-radius: 5px;"},{"lineNumber":233,"author":{"gitId":"uyencfi"},"content":"  -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);"},{"lineNumber":234,"author":{"gitId":"uyencfi"},"content":"  -moz-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);"},{"lineNumber":235,"author":{"gitId":"uyencfi"},"content":"  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);"},{"lineNumber":236,"author":{"gitId":"uyencfi"},"content":"  -webkit-background-clip: padding-box;"},{"lineNumber":237,"author":{"gitId":"uyencfi"},"content":"  -moz-background-clip: padding;"},{"lineNumber":238,"author":{"gitId":"uyencfi"},"content":"  background-clip: padding-box;"},{"lineNumber":239,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":240,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":241,"author":{"gitId":"uyencfi"},"content":".firepad-dropdown-menu a {"},{"lineNumber":242,"author":{"gitId":"uyencfi"},"content":"  text-align: left;"},{"lineNumber":243,"author":{"gitId":"uyencfi"},"content":"  display: block;"},{"lineNumber":244,"author":{"gitId":"uyencfi"},"content":"  padding: 3px 15px;"},{"lineNumber":245,"author":{"gitId":"uyencfi"},"content":"  clear: both;"},{"lineNumber":246,"author":{"gitId":"uyencfi"},"content":"  font-weight: normal;"},{"lineNumber":247,"author":{"gitId":"uyencfi"},"content":"  line-height: 18px;"},{"lineNumber":248,"author":{"gitId":"uyencfi"},"content":"  color: #333333;"},{"lineNumber":249,"author":{"gitId":"uyencfi"},"content":"  white-space: nowrap;"},{"lineNumber":250,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":251,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":252,"author":{"gitId":"uyencfi"},"content":".firepad-dropdown-menu a:hover {"},{"lineNumber":253,"author":{"gitId":"uyencfi"},"content":"  color: #fff;"},{"lineNumber":254,"author":{"gitId":"uyencfi"},"content":"  text-decoration: none;"},{"lineNumber":255,"author":{"gitId":"uyencfi"},"content":"  background-color: #ffbf86;"},{"lineNumber":256,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":257,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":258,"author":{"gitId":"uyencfi"},"content":".firepad-color-dropdown-item {"},{"lineNumber":259,"author":{"gitId":"uyencfi"},"content":"  height: 25px;"},{"lineNumber":260,"author":{"gitId":"uyencfi"},"content":"  width: 25px;"},{"lineNumber":261,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":262,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":263,"author":{"gitId":"uyencfi"},"content":".firepad-dialog {"},{"lineNumber":264,"author":{"gitId":"uyencfi"},"content":"  position: absolute;"},{"lineNumber":265,"author":{"gitId":"uyencfi"},"content":"  left: 0px;"},{"lineNumber":266,"author":{"gitId":"uyencfi"},"content":"  top: 0px;"},{"lineNumber":267,"author":{"gitId":"uyencfi"},"content":"  width: 100%;"},{"lineNumber":268,"author":{"gitId":"uyencfi"},"content":"  height: 100%;"},{"lineNumber":269,"author":{"gitId":"uyencfi"},"content":"  z-index: 1000;"},{"lineNumber":270,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":271,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":272,"author":{"gitId":"uyencfi"},"content":".firepad-dialog-div {"},{"lineNumber":273,"author":{"gitId":"uyencfi"},"content":"  position: relative;"},{"lineNumber":274,"author":{"gitId":"uyencfi"},"content":"  width: 400px;"},{"lineNumber":275,"author":{"gitId":"uyencfi"},"content":"  height: 100px;"},{"lineNumber":276,"author":{"gitId":"uyencfi"},"content":"  margin: 100px auto;"},{"lineNumber":277,"author":{"gitId":"uyencfi"},"content":"  background-color: #fff;"},{"lineNumber":278,"author":{"gitId":"uyencfi"},"content":"  border: 1px solid #000;"},{"lineNumber":279,"author":{"gitId":"uyencfi"},"content":"  padding: 15px;"},{"lineNumber":280,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":281,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":282,"author":{"gitId":"uyencfi"},"content":".firepad-dialog-input {"},{"lineNumber":283,"author":{"gitId":"uyencfi"},"content":"  width: 80%;"},{"lineNumber":284,"author":{"gitId":"uyencfi"},"content":"  display: block;"},{"lineNumber":285,"author":{"gitId":"uyencfi"},"content":"  padding: 5px 5px;"},{"lineNumber":286,"author":{"gitId":"uyencfi"},"content":"  margin: 10px 10px 10px 5px;"},{"lineNumber":287,"author":{"gitId":"uyencfi"},"content":"  clear: both;"},{"lineNumber":288,"author":{"gitId":"uyencfi"},"content":"  font-weight: normal;"},{"lineNumber":289,"author":{"gitId":"uyencfi"},"content":"  line-height: 25px;"},{"lineNumber":290,"author":{"gitId":"uyencfi"},"content":"  color: #333333;"},{"lineNumber":291,"author":{"gitId":"uyencfi"},"content":"  white-space: nowrap;"},{"lineNumber":292,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":293,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":294,"author":{"gitId":"uyencfi"},"content":"/********************************************************************"},{"lineNumber":295,"author":{"gitId":"uyencfi"},"content":" * Generated via icomoon.io."},{"lineNumber":296,"author":{"gitId":"uyencfi"},"content":"  If you want to make changes, you can go to http://icomoon.io/app/, go to the bottom right and click the"},{"lineNumber":297,"author":{"gitId":"uyencfi"},"content":"  database-looking icon, then \"Load Session\" and use the checked-in font/firepad-icomoon.json file."},{"lineNumber":298,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":299,"author":{"gitId":"uyencfi"},"content":"  Note: When you download the generated font, turn on the \"Base 64 Encode ...\" option to generate the font inline"},{"lineNumber":300,"author":{"gitId":"uyencfi"},"content":"  in the CSS (to avoid needing to distribute a font file with firepad)."},{"lineNumber":301,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":302,"author":{"gitId":"uyencfi"},"content":"@font-face {"},{"lineNumber":303,"author":{"gitId":"uyencfi"},"content":"  font-family: \"firepad\";"},{"lineNumber":304,"author":{"gitId":"uyencfi"},"content":"  src: url(\"firepad.eot\");"},{"lineNumber":305,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":306,"author":{"gitId":"uyencfi"},"content":"@font-face {"},{"lineNumber":307,"author":{"gitId":"uyencfi"},"content":"  font-family: \"firepad\";"},{"lineNumber":308,"author":{"gitId":"uyencfi"},"content":"  src: url(data:application/font-woff;charset\u003dutf-8;base64,d09GRk9UVE8AAAzsAAsAAAAAFegAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABDRkYgAAABCAAACZUAABDLmL2mHkZGVE0AAAqgAAAAGgAAABxoZGqgR0RFRgAACrwAAAAdAAAAIABFAARPUy8yAAAK3AAAAEsAAABgL9zcQGNtYXAAAAsoAAAAXgAAAX7gqNO7aGVhZAAAC4gAAAAuAAAANv1GCI1oaGVhAAALuAAAAB4AAAAkBBD/5GhtdHgAAAvYAAAAHgAAADYEYAEQbWF4cAAAC/gAAAAGAAAABgAYUABuYW1lAAAMAAAAAOAAAAGGNHbrq3Bvc3QAAAzgAAAADAAAACAAAwAAeJy9V3l0lNUVf1+YjWQyQJghBMIMZafTCoERQUQWIaCDYGGkiNKypuBIC5hYUERB9o9FYMoOrWgrEPDkQMqpcKpCkUqnRyONCBRo2FKSgbAY+L7yDdz+7vcmw5ZqT//omTP33nff3d6977vvPUVYLEJRFEfexKnjJ48eJ5QUoYjH9U4peuc6emOL6qyjOi3eVJE1NINUNUk47WpYj+gF1mzlsXrZQtTPVsINsoUzu74vQ2SxDYeoJxqJZqKV8ItOopvoJfqLQeJZ8YIYK14UU8Q08YaYJ5aIiFgvNoutoqjg5xNzO3bsCNQviXIk6iRRZ4kCEj0sUReJHpGoq0TdJOotUR+JnpCor0T9TJQjHeVIRznSUY50lCMd5SQc5SZSVJMpIZT5ygJlobJIUZXFyhJlqbJMeVtZrqxQVioR5VfKKmW1skZZq6xT1isblI2iMaclRTjFLcWrHKrzjk23++wT7AvsW+yf2csd3tSqtCfTNqUddjqcp9Id6TnpH7jedKl6viUe0SN2Fymjr7xH4tJ21UOidfuuRBUrrpJoXN6K6OtHT6tEX87d7CD6MHyQ6GDk0QTA0OtXg2pYVfVQoRrFz0oiF1Oim5R8lYXm+WCgbMcKouqiMURn+44gutSrD5zs+TWM/qTeCyRWDC3wGG4SnT4RdhJNjQskGh1oTCL79/tJtHzqcQmoovsFyaNzlsY+kJ8IoxQxN+u2jkTmwTye/BPL9pCALvAE8+jMwTwfUdGbwnDbXHpID3mM/HDUZgTi7qCqhrV8VS0MqlpAd2MVLq2aBcbZEXmsch/RjdOLiC7ubUF0eUoboqtZw7GGJc9gOP4c0T9teRA5fprofNY6tQYyV9Rt7ZOSov66bNZuS8JVvoUtLiTRsO8plYTb09OhjQvCHQKctpJE/83LiD6eP4nE8JFTGOxk3iASvXh28PxJXm2c3SiNuz3NU116RMv3EL3YY6cNqzzUFfa2PkJ0/JVcEmnDDhEdnV2iIs/RG/OJSutOR7YGNyHRoqg8AfyYkLwAzwbqTmPeAhjDLJ0c3MQXtSHKlpNRvEuF86CVUYSCpj6GlOtDIDbkIVSrzyCiY6zqZOpI1RqV4TCVuXuIvvnjTpb8IWrIVFkqqnnB/gFbnAsnl56B4IllmyQkkRF6zeSS8F3fLyWF0iqLiFqdBNWuGNT3UWTF3xfUD55ymAkIaxHbvQs4zwtoaq6CFz8tsagozz6YEF/Qdl8ArmQAVyC2428yfNHmRq5ckmjfYJvKcILK3AVy+ZA8LFMC7QOcpvps8VVO3TWZSsBG708i0t/4CFRmkOhaz5nYEL0HOEgU9Dpgc2mWGHa241gjEvY2lZAERVqbSp/fbuIEp4bt9dsYVzAnU6qwsi9mTxqpSLIzvX/v7ilMzJgmpA+2E7bVZt4XtkvzNcFkmsreQttdMUofMO/TW+2tPfgaMzXWM6VTo/i+6BN2CmuPXivWQvfZNw1V/G/2M5P2Jdvr50+qtvC735P7C//X3FfeFUytuU94XW9Yvm3jPJCb+4NPpOa7gs9MBl9Re/D3VeS/3TjanG/bOQ9s+wcqm8jCf9g5Lo1bf/NUo9S4C8UjWrXne6lGyJIAEIua01roDooHCj3BcKG/0BY2mnqiW9VSP06OqKpODU5S+8TMA8QaDXr84Wg4aP5jfNRYWsC+/26fMQ+zMGiRmpgP3DUfDzwwb5TePR95UB/2a4MurdgS1KqjdqM65kkQUEtQfkkUxjyaWw36rVHNjUNYjcasuBGc2FlEyp4dh1GMDg22E5WYvXznzd8weZTBOjTdXZBigHNfjChDJ5v5MJFxtR0oFTcA7RdorJ62k9DTcn78uQkgmbX4rwwWc+NcNY+o/OUAxkuPw94t2BcpdTKs4E7ZBu4y9O0j4c9UHuPgLZ9cDqkVlzcBXN1iSk0wuXzaTNzDZtawwQJ4TLGOMg3CY53bfyCKK2jPlonTQe22gPodTuFbvT6FvaMNCxh0hj2j+DWI8xXF+PoLUAv3QtwzC9RFPkRvxbdzfCGrzAJS0xareNr6jkkC1Ed8YlL6coAGE6wmg6fasNAZiHbIuMaqvNZRR3CIjPqql8e0yLarrFKWSi435WTj2GBZc8zLvnoR4Eq56Xw1czdxRfh+VnJxMfsakwzRkpWQgsciM8RzbHsiS51HiAOfxtE2cCAubES/RZ4qZqcjJa5hoF7ejU9leVuiyqNfwd7n718B2JJjNfNq1oWT/VJdriHXZfK79yY7a+mz4E69hupGuqlcw6YAS1ycmPrvcmLamFLHTcCbYKUuy4vxseQmsPqsXLNcrt4vUY5VfwH1ZBzUc/iqUz5+Hfba8rLbVs6EPUsQOynOR7KlXSdQ+Tht61TO5OrNdmA/z6gaFkamF4/A4b66+DYuAp1wbfmmoU63q+ecIvqX/SUHYpnRYZMRMkIa/hjNrJgO0/8YJUhYe+zCpS2M68aYE5eI/twyg2iNccGBT4yUsSVjPLAztzkJmx6B7ZxtRM6LiHDx8y2JJgRToNGihMTPLI2lFbGxZUNpmW7uHwTPNKvRfM30q4WsLj2ALtUyVcPt1KMFNDcaTQyfpur3c8Uu9R7A558y/vWH1HAh3T4++7B6RyffKPbEVANaRsBwoy358XlDKx1apaw1o0pqvZXBN123zg0hErXH/MhPg7W4MLvycJ+9Coqq8vJ8RsBuEglWDd/rN9xGBKGh/1aNP4uJdc2kKhvxadC6Yy3J92qluLFrASQZAkr/zgHtPbh1ljQnur4RFUkd68bVqkNZAlzfsJ1BFQ9PSQCRkOSZasL5RRnzMqQu87z3ds07MNEb3VoEjQ5p8Vu/QzISRW9E5mOcXoseiQfiEZueX+jRquMho9qulZrhN5l5E31uli0BzGGSR5Wg6DxT55PDWnhJXW/MmOPxa62CzxtuLeA3IqhSBFUimrpxMtGSMW8TbS7DzlnSXPDb6qMPkeXWVi/Rp/sG4O11Hk+SY6fQU8UufFjGj9CNxWg4Mbr0g7Thex3wZDoeL2f6biA6HX4Cw73j8DjpYsXXd23RPlSu5yt4FChTi0j03vwlnjEnwiS63OqQAOlKlOj28CGghu5GB2nhBLVSR4cUHJ3gOMVIH662U8v6MBAybDGyuTBX4cOzxa16VGcqXvYNhUVR7M/9dG1QK43a03A/Hqrj1bbdkQDmMMmjs6DoBFMnksNaeEldb1pQx/ZOi/lV4xy+A6093iP6EQuDXB7GvfF8W5KPhmMHJRxHcn2qdi4Ws6b9G/R4y/0AAAB4nGNgYGBkAIIztovOg+hzwskvYDQASW0G1AAAeJxjYGRgYOADYgkGEGBiYARCcSBmAfMYAAVHAEoAAAB4nGNgZmJgnMDAysDB6MOYxsDA4A6lvzJIMrQwMDAxsDIzwIEAgskQkOaawuDwgOEDA+OD/w8Y9BgfMCg0MDAwwhUoACEjABBCDB8AeJzljdkRgCAMRB+I94UH+mNpFmK5lmAHGGCsws1ksjvJmwAZqQ8UQZckFbPhlFlJ6bC43YP30fE5q+JtEUktpCGXVApT09DS0TMwYtmZmFlYcWyghEkP/6sX448KEgAAeJxjYGRgYADiA48eTY3nt/nKwM3EAALnhJNfIOj/D5gYGB8AuRwMYGkAXjsL7AAAeJxjYGRgYHzw/wGDHhMDA8M/BiAJFEEBzABt5wP2AAB4nGNigAAmBoYEBgcghgAFBmSgwGCAwmcAADLOAXUAAAAAUAAAGAAAeJx1jk9qwkAUh79otJRK6ap0OeCmm4RkXAgeIAfown2gYwhIIqNCT9KVR3DpMXqAHqHH6C/2bbpw4DHf++b9GWDGJwnDSbjjyXgkfjUeM+fDOJU/G0944Mt4Kv+jyiS9l3m8dg08Er8Yj6kojFP5k/GEZy7GU/lvNrREAjtq3mHTxrCrBW9yDUe28lFpaI7bWlDR03G43lEVAYcn1zbHSvF/3p/zLMhYKrzqSmVUfXeo+tgE5/PCrZztFflFtsx8Uaro1t/WcpG9Xoe/OE0c9rMOcd/2nSvz4mbvL7EuORF4nGNgZsALAAB9AAQ\u003d)"},{"lineNumber":309,"author":{"gitId":"uyencfi"},"content":"      format(\"woff\"),"},{"lineNumber":310,"author":{"gitId":"uyencfi"},"content":"    url(data:application/x-font-ttf;charset\u003dutf-8;base64,AAEAAAANAIAAAwBQRkZUTWhkaqAAAA9wAAAAHEdERUYARwAGAAAPUAAAACBPUy8yL7vcIAAAAVgAAABWY21hcODA1NYAAAHwAAABfmdhc3D//wADAAAPSAAAAAhnbHlmMPUBFgAAA6gAAAkIaGVhZP1GCI0AAADcAAAANmhoZWEEEf/lAAABFAAAACRobXR4BQoBEQAAAbAAAAA+bG9jYR04G1IAAANwAAAANm1heHAAZQCTAAABOAAAACBuYW1lNHbrqwAADLAAAAGGcG9zdFMv72QAAA44AAABDgABAAAAAQAABST+1l8PPPUACwIAAAAAAM4TY+gAAAAAzhNj6AAA/98CAAHhAAAACAACAAAAAAAAAAEAAAHh/98ALgIAAAD+AAIAAAEAAAAAAAAAAAAAAAAAAAAFAAEAAAAaAJAACQAAAAAAAgAAAAEAAQAAAEAAAAAAAAAAAQIAAZAABQAIAUwBZgAAAEcBTAFmAAAA9QAZAIQAAAIABQMAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUGZFZABA4ADwAAHg/+AALgHhACGAAAABAAAAAAAAAgAAAAAAAAAAqgAAAAAAAAIAAGAAQABgAAAAAAAAACAAAAAAAAAAAAAAAAAAIAAxAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAHAABAAAAAAB4AAMAAQAAABwABABcAAAACAAIAAIAAAAA4BXwAP//AAAAAOAA8AD//wAAAAAQAwABAAAABgAAAAAABAAFAAYABwAIAAkACgALAAwADQAOAA8AEAARABIAGQATABQAFQAWABcAGAAAAQYAAAEAAAAAAAAAAQIAAAACAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4APgBWAHwAugF0AbAB7AISAjgCXgKEAq4DFAM0A1QDfgOoA+AEDAQ2BGAEhAAAAAEAAP/gAgAB4AACAAARASECAP4AAeD+AAAAAAADAGAAAAGgAcAAEQAZACEAACU2NTQmKwMROwIyNjU0JiczMhYUBisBFyM1MzIWFAYBYh5LNUBAICBAYDVLIr4zFR4eFTNQUFAVHx/uIy81S/5ASzUiO6MmNCbAgCY0JgABAEAAAAHAAcAACwAAARUjAzMVIzUzEyM1AcBAoEDgQKBAAcAg/oAgIAGAIAAAAAACAGAAAAGgAcAAEQAVAAABMxUUBiImPQEzFRQXFjI3NjUFIRUhAWBAXoReQBocVBwa/wABQP7AAcDQPFRUPNDQHxcaGhcfsEAAAAAAAQAAAAACAAHAACoAACUVIxYVFAcGIicmNTMUFjI2NCYjITUzJicmNDc2MhcWFSM0JiIGFBYzMhcCAHUVMi6ALjJAOU45OSf/AJYCAjIyLoAuMkA5Tjk5Jz0t4CAeIjglIyMlOBomJjQmIAECJXAlIyMlOBomJjQmIAAAAAkAAP/gAgAB4AAPAB8ALwA/AE8AXwBvAH8AjwAANyMiBh0BFBY7ATI2PQE0JgcUBisBIiY9ATQ2OwEyFhUlISIGHQEUFjMhMjY9ATQmJyEiBh0BFBYzITI2PQE0JiUjIgYdARQWOwEyNj0BNCYHFAYrASImPQE0NjsBMhYVFyMiBh0BFBY7ATI2PQE0JgcUBisBIiY9ATQ2OwEyFhUlISIGHQEUFjMhMjY9ATQmcGAHCQkHYAcJCRcJByAHCQkHIAcJAZD+4AcJCQcBIAcJCQf+4AcJCQcBIAcJCf55YAcJCQdgBgoJFwkHIAcJCQcgBwkQYAcJCQdgBwkJFwkHIAcJCQcgBwkBkP7gBwkJBwEgBwkJYAkHYAcJCQdgBwlQBwkJByAHCQkHEAkHIAcJCQcgBwnACQcgBwkJByAHCeAJB2AHCRgIUAcJUAcJCQcgBwkJB5AJB2AHCQkHYAcJUAcJCQcgBwkJB9AJByAHCQkHIAcJAAYAAP/gAgAB4AADAAcACwATABsAIwAAEyEVIRUhFSEVIRUhAhQWMjY0JiIGFBYyNjQmIgYUFjI2NCYiwAFA/sABQP7AAUD+wMAmNCYmNCYmNCYmNCYmNCYmNAHAQIBAgEABujQmJjQm5jQmJjQm5jQmJjQmAAAAAAYAIP/gAgAB4AADAAcACwARAB0AKQAANyEVIREhFSERIRUhJxUjNSM1ExUzFSM1NzUjNTMdAiM1MzUjNTM1IzXAAUD+wAFA/sABQP7AYCAgIEBgQEBgYEBAQEBAQAEAQAEAQGCAYCD++RkgSR4ZIEl3oCAgICAgAAUAAAAAAgABwAADAAcACwAPABMAABEhFSEVIRUhFSEVITUhFSEVIRUhAgD+AAFA/sABQP7AAgD+AAIA/gABwEAgQIBAoECAQAAAAAAFAAAAAAIAAcAAAwAHAAsADwATAAARIRUhFyEVIRUhFSEnIRUhFSEVIQIA/gBgAUD+wAFA/sBgAgD+AAIA/gABwEAgQIBAoECAQAAABQAAAAACAAHAAAMABwALAA8AEwAAESEVIRchFSEVIRUhJyEVIRUhFSECAP4AwAFA/sABQP7AwAIA/gACAP4AAcBAIECAQKBAgEAAAAUAAAAAAgABwAADAAcACwAPABMAABEhFSEVIRUhFSEVIRUhFSEVIRUhAgD+AAIA/gACAP4AAgD+AAIA/gABwEAgQCBAIEAgQAAAAAAGAAAAIAIAAYAAAwAHAAsADwASABUAABEhFSE1IRUhFSEVIRUhFSElFzc1JwcBYP6gAWD+oAFg/qABYP6gAYBAQEBAASBAoECAQCBAoGBgIGBgAAACAAD/4AIAAeEAIABBAAABJyYiDwEGFB8BFhc3Ji8BJjQ/ATYyHwEWFA8BFgc3NjQHJicHFh8BFhQPAQYiLwEmND8BJjcHBhQfARYyPwE2NCcB3QIkZCNuIyMCBgcoCAUCExNtEzYTAhQUMQ0BTSPEBgcoCAUCExNtEzYTAhQUMQ0BTSMjAiRkI24jIwG7AiMjbSRkJAIFBSgEBgITNhNtFBQCEzYTMh8jTSNkeQUFKAQGAhM2E20UFAITNhMyHyNNI2QkAiMjbSRkJAABACD/4AHPAeAAEAAABT4BLgIHFSc3FTYeAg4BAX0SEwclVkDAwEFiOBkLKSAhREY1IAF/wMB8ASM8UVdZAAAAAQAx/98B4AHgABAAAAE1Fwc1Jg4CFhcuAj4CASDAwEBWJQcTEiMpCxk4YgFkfMDAfwEgNUZEISVZV1E8IwAAAAMAAAAAAgABwAALABIAFgAAASEHERQWMyEyNjURASczNTMVMyU3IRcBoP7AYAkHAeAHCf8AoGCAYP6tIAEmIAHAYP6wBwkJBwFQ/uCAYGDAICAAAAMAAAAAAgABwAALABIAFgAAASEHERQWMyEyNjURBxUjNSM3FyU3IRcBoP7AYAkHAeAHCcCAYKCg/q0gASYgAcBg/rAHCQkHAVDAYGCAgOAgIAAAAAQAAAAAAgABwAADABcAGwAjAAATIRUhBSEiBh0BFBY7ARUhNTMyNj0BNCYDIzUzNhQGIiY0NjKAAQD/AAFg/kANExMNYAEAYA0TE43AwIcNFA0NFAHAQCATDaANE4CAEw2gDRP+wKB6FA0NFA0AAAAGAAAAAAIAAcAAAwAHAAsADwATABYAABEhFSEXIRUhFSEVIRUhFSEHIRUhExUnAgD+AMABQP7AAUD+wAFA/sDAAgD+AICAAcBAIEAgQCBAIEABQMBgAAAABgAAAAACAAHAAAMABwALAA8AEwAWAAARIRUhFyEVIRUhFSEVIRUhByEVIT0BFwIA/gDAAUD+wAFA/sABQP7AwAIA/gCAAcBAIEAgQCBAIECAwGAABAAAAAACAAGgAAMABwAPABQAABkBIREDIREhBhQWMjY0JiITIRMXNwIAIP5AAcCAHCgcHChE/oBggEABoP5gAaD+gAFgPCgcHCgc/uABAKAwAAAAAQAA/+ACAAHAABQAABIyFhQGIyInDgEHNT4BNTQnLgE1NJbUlpZqFBQmWTkcJAEsMwHAeqx6AyYbAg4NLBkHBx5UMFYAAAAAAAAMAJYAAQAAAAAAAQAHABAAAQAAAAAAAgAHACgAAQAAAAAAAwAjAHgAAQAAAAAABAAHAKwAAQAAAAAABQALAMwAAQAAAAAABgAHAOgAAwABBAkAAQAOAAAAAwABBAkAAgAOABgAAwABBAkAAwBGADAAAwABBAkABAAOAJwAAwABBAkABQAWALQAAwABBAkABgAOANgAZgBpAHIAZQBwAGEAZAAAZmlyZXBhZAAAUgBlAGcAdQBsAGEAcgAAUmVndWxhcgAARgBvAG4AdABGAG8AcgBnAGUAIAAyAC4AMAAgADoAIABmAGkAcgBlAHAAYQBkACAAOgAgADIAMwAtADcALQAyADAAMQAzAABGb250Rm9yZ2UgMi4wIDogZmlyZXBhZCA6IDIzLTctMjAxMwAAZgBpAHIAZQBwAGEAZAAAZmlyZXBhZAAAVgBlAHIAcwBpAG8AbgAgADEALgAwAABWZXJzaW9uIDEuMAAAZgBpAHIAZQBwAGEAZAAAZmlyZXBhZAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABoAAAABAAIBAgEDAQQBBQEGAQcBCAEJAQoBCwEMAQ0BDgEPARABEQESARMBFAEVARYBFwEYB3VuaUYwMDAHdW5pRTAwMAd1bmlFMDAxB3VuaUUwMDIHdW5pRTAwMwd1bmlFMDA0B3VuaUUwMDUHdW5pRTAwNgd1bmlFMDA3B3VuaUUwMDgHdW5pRTAwOQd1bmlFMDBBB3VuaUUwMEIHdW5pRTAwQwd1bmlFMDBEB3VuaUUwMEUHdW5pRTAxMAd1bmlFMDExB3VuaUUwMTIHdW5pRTAxMwd1bmlFMDE0B3VuaUUwMTUHdW5pRTAwRgAAAAAAAf//AAIAAQAAAA4AAAAYAAAAAAACAAEAAwAZAAEABAAAAAIAAAAAAAEAAAAAzD2izwAAAADOE2PoAAAAAM4TY+g\u003d)"},{"lineNumber":311,"author":{"gitId":"uyencfi"},"content":"      format(\"truetype\");"},{"lineNumber":312,"author":{"gitId":"uyencfi"},"content":"  font-weight: normal;"},{"lineNumber":313,"author":{"gitId":"uyencfi"},"content":"  font-style: normal;"},{"lineNumber":314,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":315,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":316,"author":{"gitId":"uyencfi"},"content":".firepad-tb-bold,"},{"lineNumber":317,"author":{"gitId":"uyencfi"},"content":".firepad-tb-italic,"},{"lineNumber":318,"author":{"gitId":"uyencfi"},"content":".firepad-tb-underline,"},{"lineNumber":319,"author":{"gitId":"uyencfi"},"content":".firepad-tb-strikethrough,"},{"lineNumber":320,"author":{"gitId":"uyencfi"},"content":".firepad-tb-list,"},{"lineNumber":321,"author":{"gitId":"uyencfi"},"content":".firepad-tb-list-2,"},{"lineNumber":322,"author":{"gitId":"uyencfi"},"content":".firepad-tb-numbered-list,"},{"lineNumber":323,"author":{"gitId":"uyencfi"},"content":".firepad-tb-paragraph-left,"},{"lineNumber":324,"author":{"gitId":"uyencfi"},"content":".firepad-tb-paragraph-center,"},{"lineNumber":325,"author":{"gitId":"uyencfi"},"content":".firepad-tb-paragraph-right,"},{"lineNumber":326,"author":{"gitId":"uyencfi"},"content":".firepad-tb-paragraph-justify,"},{"lineNumber":327,"author":{"gitId":"uyencfi"},"content":".firepad-tb-menu,"},{"lineNumber":328,"author":{"gitId":"uyencfi"},"content":".firepad-tb-link,"},{"lineNumber":329,"author":{"gitId":"uyencfi"},"content":".firepad-tb-undo,"},{"lineNumber":330,"author":{"gitId":"uyencfi"},"content":".firepad-tb-redo,"},{"lineNumber":331,"author":{"gitId":"uyencfi"},"content":".firepad-tb-box-add,"},{"lineNumber":332,"author":{"gitId":"uyencfi"},"content":".firepad-tb-box-remove,"},{"lineNumber":333,"author":{"gitId":"uyencfi"},"content":".firepad-tb-print,"},{"lineNumber":334,"author":{"gitId":"uyencfi"},"content":".firepad-tb-indent-decrease,"},{"lineNumber":335,"author":{"gitId":"uyencfi"},"content":".firepad-tb-indent-increase,"},{"lineNumber":336,"author":{"gitId":"uyencfi"},"content":".firepad-tb-insert-image,"},{"lineNumber":337,"author":{"gitId":"uyencfi"},"content":".firepad-tb-bubble {"},{"lineNumber":338,"author":{"gitId":"uyencfi"},"content":"  font-family: \"firepad\";"},{"lineNumber":339,"author":{"gitId":"uyencfi"},"content":"  speak: none;"},{"lineNumber":340,"author":{"gitId":"uyencfi"},"content":"  font-style: normal;"},{"lineNumber":341,"author":{"gitId":"uyencfi"},"content":"  font-weight: normal;"},{"lineNumber":342,"author":{"gitId":"uyencfi"},"content":"  font-variant: normal;"},{"lineNumber":343,"author":{"gitId":"uyencfi"},"content":"  text-transform: none;"},{"lineNumber":344,"author":{"gitId":"uyencfi"},"content":"  line-height: 1;"},{"lineNumber":345,"author":{"gitId":"uyencfi"},"content":"  -webkit-font-smoothing: antialiased;"},{"lineNumber":346,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":347,"author":{"gitId":"uyencfi"},"content":".firepad-tb-bold:before {"},{"lineNumber":348,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e000\";"},{"lineNumber":349,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":350,"author":{"gitId":"uyencfi"},"content":".firepad-tb-italic:before {"},{"lineNumber":351,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e001\";"},{"lineNumber":352,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":353,"author":{"gitId":"uyencfi"},"content":".firepad-tb-underline:before {"},{"lineNumber":354,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e002\";"},{"lineNumber":355,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":356,"author":{"gitId":"uyencfi"},"content":".firepad-tb-strikethrough:before {"},{"lineNumber":357,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e003\";"},{"lineNumber":358,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":359,"author":{"gitId":"uyencfi"},"content":".firepad-tb-list:before {"},{"lineNumber":360,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e004\";"},{"lineNumber":361,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":362,"author":{"gitId":"uyencfi"},"content":".firepad-tb-list-2:before {"},{"lineNumber":363,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e005\";"},{"lineNumber":364,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":365,"author":{"gitId":"uyencfi"},"content":".firepad-tb-numbered-list:before {"},{"lineNumber":366,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e006\";"},{"lineNumber":367,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":368,"author":{"gitId":"uyencfi"},"content":".firepad-tb-paragraph-left:before {"},{"lineNumber":369,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e007\";"},{"lineNumber":370,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":371,"author":{"gitId":"uyencfi"},"content":".firepad-tb-paragraph-center:before {"},{"lineNumber":372,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e008\";"},{"lineNumber":373,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":374,"author":{"gitId":"uyencfi"},"content":".firepad-tb-paragraph-right:before {"},{"lineNumber":375,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e009\";"},{"lineNumber":376,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":377,"author":{"gitId":"uyencfi"},"content":".firepad-tb-paragraph-justify:before {"},{"lineNumber":378,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e00a\";"},{"lineNumber":379,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":380,"author":{"gitId":"uyencfi"},"content":".firepad-tb-menu:before {"},{"lineNumber":381,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e00b\";"},{"lineNumber":382,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":383,"author":{"gitId":"uyencfi"},"content":".firepad-tb-link:before {"},{"lineNumber":384,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e00c\";"},{"lineNumber":385,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":386,"author":{"gitId":"uyencfi"},"content":".firepad-tb-undo:before {"},{"lineNumber":387,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e00d\";"},{"lineNumber":388,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":389,"author":{"gitId":"uyencfi"},"content":".firepad-tb-redo:before {"},{"lineNumber":390,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e00e\";"},{"lineNumber":391,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":392,"author":{"gitId":"uyencfi"},"content":".firepad-tb-box-add:before {"},{"lineNumber":393,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e010\";"},{"lineNumber":394,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":395,"author":{"gitId":"uyencfi"},"content":".firepad-tb-box-remove:before {"},{"lineNumber":396,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e011\";"},{"lineNumber":397,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":398,"author":{"gitId":"uyencfi"},"content":".firepad-tb-print:before {"},{"lineNumber":399,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e012\";"},{"lineNumber":400,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":401,"author":{"gitId":"uyencfi"},"content":".firepad-tb-indent-decrease:before {"},{"lineNumber":402,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e013\";"},{"lineNumber":403,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":404,"author":{"gitId":"uyencfi"},"content":".firepad-tb-indent-increase:before {"},{"lineNumber":405,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e014\";"},{"lineNumber":406,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":407,"author":{"gitId":"uyencfi"},"content":".firepad-tb-insert-image:before {"},{"lineNumber":408,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e015\";"},{"lineNumber":409,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":410,"author":{"gitId":"uyencfi"},"content":".firepad-tb-bubble:before {"},{"lineNumber":411,"author":{"gitId":"uyencfi"},"content":"  content: \"\\e00f\";"},{"lineNumber":412,"author":{"gitId":"uyencfi"},"content":"}"}],"authorContributionMap":{"uyencfi":412}},{"path":"frontend/src/components/collaboration/lib/firepad.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"/*!"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":" * This file, and the entire ../lib directory is copied from https://github.com/lucafabbian/firepad."},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":" * lucafabbian\u0027s Firepad offers support for CodeMirror and Ace editors. Our project"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":" * only uses CodeMirror6, but the Ace adapter source code generates some webpack "},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":" * warnings when compiled, causing our project to fail the CI. Since a PR can take "},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":" * time to be merged and resolve the issue, we decide to copy over relevant CodeMirror6"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":" * source files only."},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":" * "},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":" * Some other files also violate eslint rules, which are silenced by eslint-disable-next-line."},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":" * "},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":" * Firepad is an open-source, collaborative code and text editor. It was designed"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":" * to be embedded inside larger applications. Since it uses Firebase as a backend,"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":" * it requires no server-side code and can be added to any web app simply by"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":" * including a couple JavaScript files."},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":" *"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":" * http://www.firepad.io/"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":" * License: MIT"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":" * Copyright: 2014 Firebase"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":" * With code from ot.js (Copyright 2012-2013 Tim Baumann)"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"import { TextOperation } from \"./text-operation.js\""},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"import { FirebaseAdapter } from \"./firebase-adapter.js\""},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"import { EntityManager } from \"./entity-manager.js\""},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"import { ParseHtml } from \"./parse-html.js\""},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"import { utils } from \"./utils.js\""},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"import { LineFormatting } from \"./line-formatting.js\""},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"import { SerializeHtml } from \"./serialize-html.js\""},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"import { ATTR } from \"./constants.js\""},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"import { textPiecesToInserts } from \"./text-pieces-to-inserts.js\""},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"import { EditorClient } from \"./editor-client.js\""},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"import { Text } from \"./text.js\""},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"import { Entity } from \"./entity.js\""},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"import { Line } from \"./line.js\""},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"import { Formatting } from \"./formatting.js\""},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"import { CodeMirror6Adapter } from \"./codemirror6-adapter.js\""},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"// TODO - change this hack to a real solution"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"// https://stackoverflow.com/questions/3277182/how-to-get-the-global-object-in-javascript"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"let global"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"try {"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"  // eslint-disable-next-line no-new-func"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"  global \u003d Function(\"return this\")()"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"} catch (e) {"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"  global \u003d window"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"const Firepad \u003d (function () {"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"  var CodeMirror \u003d global.CodeMirror"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"  var ace \u003d global.ace"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"  function Firepad(ref, place, options) {"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"    if (!(this instanceof Firepad)) {"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"      return new Firepad(ref, place, options)"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"    if ("},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"      !CodeMirror \u0026\u0026"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"      !ace \u0026\u0026"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"      !global.monaco \u0026\u0026"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"      !(place.type \u003d\u003d\u003d \"CodeMirror6\")"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"    ) {"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"      throw new Error("},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"        \"Couldn\u0027t find CodeMirror, ACE or Monaco.  Did you forget to include codemirror.js/ace.js or import monaco?\""},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"    this.zombie_ \u003d false"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"    if (place.type \u003d\u003d\u003d \"CodeMirror6\") {"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror6_ \u003d this.editor_ \u003d place.editor"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"      const curValue \u003d this.codeMirror6_.state.doc.toString()"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"      if (curValue !\u003d\u003d \"\") {"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"        throw new Error("},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"          \"Can\u0027t initialize Firepad with a CodeMirror6 instance that already contains text.\""},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"    } else if (CodeMirror \u0026\u0026 place instanceof CodeMirror) {"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror_ \u003d this.editor_ \u003d place"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"      var curValue \u003d this.codeMirror_.getValue()"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"      if (curValue !\u003d\u003d \"\") {"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"        throw new Error("},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"          \"Can\u0027t initialize Firepad with a CodeMirror instance that already contains text.\""},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"    } else if (ace \u0026\u0026 place \u0026\u0026 place.session instanceof ace.EditSession) {"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"      this.ace_ \u003d this.editor_ \u003d place"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"      curValue \u003d this.ace_.getValue()"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"      if (curValue !\u003d\u003d \"\") {"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"        throw new Error("},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"          \"Can\u0027t initialize Firepad with an ACE instance that already contains text.\""},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror_ \u003d this.editor_ \u003d new CodeMirror(place)"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"    var editorWrapper"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"    if (this.codeMirror6_) {"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"      editorWrapper \u003d this.codeMirror6_.dom"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"    } else if (this.codeMirror_) {"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"      editorWrapper \u003d this.codeMirror_.getWrapperElement()"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"    } else if (this.ace_) {"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"      editorWrapper \u003d this.ace_.container"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"      editorWrapper \u003d this.monaco_.getDomNode()"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"    // var editorWrapper \u003d this.codeMirror_ ? this.codeMirror_.getWrapperElement() : this.ace_.container;"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"    this.firepadWrapper_ \u003d utils.elt(\"div\", null, { class: \"firepad\" })"},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"    editorWrapper.parentNode.replaceChild(this.firepadWrapper_, editorWrapper)"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"    this.firepadWrapper_.appendChild(editorWrapper)"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"    // Provide an easy way to get the firepad instance associated with this CodeMirror instance."},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"    this.editor_.firepad \u003d this"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"    this.options_ \u003d options || {}"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"    if (this.getOption(\"richTextShortcuts\", false)) {"},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"      if (!CodeMirror.keyMap[\"richtext\"]) {"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"        this.initializeKeyMap_()"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror_.setOption(\"keyMap\", \"richtext\")"},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"      this.firepadWrapper_.className +\u003d \" firepad-richtext\""},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"    this.imageInsertionUI \u003d this.getOption(\"imageInsertionUI\", true)"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"    if (this.getOption(\"richTextToolbar\", false)) {"},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\"does not support Rich text, let alone Rich Text Toolbar!\")"},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":"    this.addPoweredByLogo_()"},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"    // Now that we\u0027ve mucked with CodeMirror, refresh it."},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":"    if (this.codeMirror_) this.codeMirror_.refresh()"},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"    var userId \u003d this.getOption(\"userId\", ref.push().key)"},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":"    var userColor \u003d this.getOption(\"userColor\", colorFromUserId(userId))"},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":"    this.entityManager_ \u003d new EntityManager()"},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":"    this.firebaseAdapter_ \u003d new FirebaseAdapter(ref, userId, userColor)"},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":"    if (this.codeMirror6_) {"},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"      this.editorAdapter_ \u003d new CodeMirror6Adapter("},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":"        this.codeMirror6_,"},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"        this.options_"},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"    this.client_ \u003d new EditorClient(this.firebaseAdapter_, this.editorAdapter_)"},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":"    this.firebaseAdapter_.on(\"cursor\", function () {"},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":"      self.trigger.apply(self, [\"cursor\"].concat([].slice.call(arguments)))"},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":"    if (this.codeMirror_) {"},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":"      this.richTextCodeMirror_.on(\"newLine\", function () {"},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":"        self.trigger.apply(self, [\"newLine\"].concat([].slice.call(arguments)))"},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":161,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":162,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":163,"author":{"gitId":"uyencfi"},"content":"    this.firebaseAdapter_.on(\"ready\", function () {"},{"lineNumber":164,"author":{"gitId":"uyencfi"},"content":"      self.ready_ \u003d true"},{"lineNumber":165,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":166,"author":{"gitId":"uyencfi"},"content":"      if (self.ace_) {"},{"lineNumber":167,"author":{"gitId":"uyencfi"},"content":"        self.editorAdapter_.grabDocumentState()"},{"lineNumber":168,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":169,"author":{"gitId":"uyencfi"},"content":"      if (self.monaco_) {"},{"lineNumber":170,"author":{"gitId":"uyencfi"},"content":"        self.editorAdapter_.grabDocumentState()"},{"lineNumber":171,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":172,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":173,"author":{"gitId":"uyencfi"},"content":"      var defaultText \u003d self.getOption(\"defaultText\", null)"},{"lineNumber":174,"author":{"gitId":"uyencfi"},"content":"      if (defaultText \u0026\u0026 self.isHistoryEmpty()) {"},{"lineNumber":175,"author":{"gitId":"uyencfi"},"content":"        self.setText(defaultText)"},{"lineNumber":176,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":177,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":178,"author":{"gitId":"uyencfi"},"content":"      self.trigger(\"ready\")"},{"lineNumber":179,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":180,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":181,"author":{"gitId":"uyencfi"},"content":"    this.client_.on(\"synced\", function (isSynced) {"},{"lineNumber":182,"author":{"gitId":"uyencfi"},"content":"      self.trigger(\"synced\", isSynced)"},{"lineNumber":183,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":184,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":185,"author":{"gitId":"uyencfi"},"content":"    // Hack for IE8 to make font icons work more reliably."},{"lineNumber":186,"author":{"gitId":"uyencfi"},"content":"    // http://stackoverflow.com/questions/9809351/ie8-css-font-face-fonts-only-working-for-before-content-on-over-and-sometimes"},{"lineNumber":187,"author":{"gitId":"uyencfi"},"content":"    if ("},{"lineNumber":188,"author":{"gitId":"uyencfi"},"content":"      navigator.appName \u003d\u003d\u003d \"Microsoft Internet Explorer\" \u0026\u0026"},{"lineNumber":189,"author":{"gitId":"uyencfi"},"content":"      navigator.userAgent.match(/MSIE 8\\./)"},{"lineNumber":190,"author":{"gitId":"uyencfi"},"content":"    ) {"},{"lineNumber":191,"author":{"gitId":"uyencfi"},"content":"      window.onload \u003d function () {"},{"lineNumber":192,"author":{"gitId":"uyencfi"},"content":"        var head \u003d document.getElementsByTagName(\"head\")[0],"},{"lineNumber":193,"author":{"gitId":"uyencfi"},"content":"          style \u003d document.createElement(\"style\")"},{"lineNumber":194,"author":{"gitId":"uyencfi"},"content":"        style.type \u003d \"text/css\""},{"lineNumber":195,"author":{"gitId":"uyencfi"},"content":"        style.styleSheet.cssText \u003d \":before,:after{content:none !important;}\""},{"lineNumber":196,"author":{"gitId":"uyencfi"},"content":"        head.appendChild(style)"},{"lineNumber":197,"author":{"gitId":"uyencfi"},"content":"        setTimeout(function () {"},{"lineNumber":198,"author":{"gitId":"uyencfi"},"content":"          head.removeChild(style)"},{"lineNumber":199,"author":{"gitId":"uyencfi"},"content":"        }, 0)"},{"lineNumber":200,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":201,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":202,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":203,"author":{"gitId":"uyencfi"},"content":"  utils.makeEventEmitter(Firepad)"},{"lineNumber":204,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":205,"author":{"gitId":"uyencfi"},"content":"  // For readability, these are the primary \"constructors\", even though right now they\u0027re just aliases for Firepad."},{"lineNumber":206,"author":{"gitId":"uyencfi"},"content":"  Firepad.fromCodeMirror \u003d Firepad"},{"lineNumber":207,"author":{"gitId":"uyencfi"},"content":"  Firepad.fromACE \u003d Firepad"},{"lineNumber":208,"author":{"gitId":"uyencfi"},"content":"  Firepad.fromMonaco \u003d Firepad"},{"lineNumber":209,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":210,"author":{"gitId":"uyencfi"},"content":"  Firepad.fromCodeMirror6 \u003d (ref, editor, ...e) \u003d\u003e"},{"lineNumber":211,"author":{"gitId":"uyencfi"},"content":"    Firepad("},{"lineNumber":212,"author":{"gitId":"uyencfi"},"content":"      ref,"},{"lineNumber":213,"author":{"gitId":"uyencfi"},"content":"      {"},{"lineNumber":214,"author":{"gitId":"uyencfi"},"content":"        type: \"CodeMirror6\","},{"lineNumber":215,"author":{"gitId":"uyencfi"},"content":"        editor,"},{"lineNumber":216,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":217,"author":{"gitId":"uyencfi"},"content":"      ...e"},{"lineNumber":218,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":219,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":220,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.dispose \u003d function () {"},{"lineNumber":221,"author":{"gitId":"uyencfi"},"content":"    this.zombie_ \u003d true // We\u0027ve been disposed.  No longer valid to do anything."},{"lineNumber":222,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":223,"author":{"gitId":"uyencfi"},"content":"    // Unwrap the editor."},{"lineNumber":224,"author":{"gitId":"uyencfi"},"content":"    var editorWrapper"},{"lineNumber":225,"author":{"gitId":"uyencfi"},"content":"    if (this.codeMirror_) {"},{"lineNumber":226,"author":{"gitId":"uyencfi"},"content":"      editorWrapper \u003d this.codeMirror_.getWrapperElement()"},{"lineNumber":227,"author":{"gitId":"uyencfi"},"content":"    } else if (this.ace_) {"},{"lineNumber":228,"author":{"gitId":"uyencfi"},"content":"      editorWrapper \u003d this.ace_.container"},{"lineNumber":229,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":230,"author":{"gitId":"uyencfi"},"content":"      editorWrapper \u003d this.monaco_.getDomNode()"},{"lineNumber":231,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":232,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":233,"author":{"gitId":"uyencfi"},"content":"    this.firepadWrapper_.removeChild(editorWrapper)"},{"lineNumber":234,"author":{"gitId":"uyencfi"},"content":"    this.firepadWrapper_.parentNode.replaceChild("},{"lineNumber":235,"author":{"gitId":"uyencfi"},"content":"      editorWrapper,"},{"lineNumber":236,"author":{"gitId":"uyencfi"},"content":"      this.firepadWrapper_"},{"lineNumber":237,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":238,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":239,"author":{"gitId":"uyencfi"},"content":"    this.editor_.firepad \u003d null"},{"lineNumber":240,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":241,"author":{"gitId":"uyencfi"},"content":"    if ("},{"lineNumber":242,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror_ \u0026\u0026"},{"lineNumber":243,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror_.getOption(\"keyMap\") \u003d\u003d\u003d \"richtext\""},{"lineNumber":244,"author":{"gitId":"uyencfi"},"content":"    ) {"},{"lineNumber":245,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror_.setOption(\"keyMap\", \"default\")"},{"lineNumber":246,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":247,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":248,"author":{"gitId":"uyencfi"},"content":"    this.firebaseAdapter_.dispose()"},{"lineNumber":249,"author":{"gitId":"uyencfi"},"content":"    this.editorAdapter_.detach()"},{"lineNumber":250,"author":{"gitId":"uyencfi"},"content":"    if (this.richTextCodeMirror_) this.richTextCodeMirror_.detach()"},{"lineNumber":251,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":252,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":253,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.setUserId \u003d function (userId) {"},{"lineNumber":254,"author":{"gitId":"uyencfi"},"content":"    this.firebaseAdapter_.setUserId(userId)"},{"lineNumber":255,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":256,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":257,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.setUserColor \u003d function (color) {"},{"lineNumber":258,"author":{"gitId":"uyencfi"},"content":"    this.firebaseAdapter_.setColor(color)"},{"lineNumber":259,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":260,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":261,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.getText \u003d function () {"},{"lineNumber":262,"author":{"gitId":"uyencfi"},"content":"    this.assertReady_(\"getText\")"},{"lineNumber":263,"author":{"gitId":"uyencfi"},"content":"    if (this.codeMirror6_) return this.codeMirror6_.state.doc.text.join(\u0027\\n\u0027)"},{"lineNumber":264,"author":{"gitId":"uyencfi"},"content":"    if (this.codeMirror_) return this.richTextCodeMirror_.getText()"},{"lineNumber":265,"author":{"gitId":"uyencfi"},"content":"    throw new Error(\u0027Firepad cannot find CodeMirror instance\u0027)"},{"lineNumber":266,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":267,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":268,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.setText \u003d function (textPieces) {"},{"lineNumber":269,"author":{"gitId":"uyencfi"},"content":"    this.assertReady_(\"setText\")"},{"lineNumber":270,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":271,"author":{"gitId":"uyencfi"},"content":"    if (this.codeMirror6_) {"},{"lineNumber":272,"author":{"gitId":"uyencfi"},"content":"      return this.codeMirror6_.dispatch({"},{"lineNumber":273,"author":{"gitId":"uyencfi"},"content":"        changes: {from: 0, to: this.codeMirror6_.state.doc.length, insert: textPieces}"},{"lineNumber":274,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":275,"author":{"gitId":"uyencfi"},"content":"      "},{"lineNumber":276,"author":{"gitId":"uyencfi"},"content":"    } else if (this.monaco_) {"},{"lineNumber":277,"author":{"gitId":"uyencfi"},"content":"      return this.monaco_.getModel().setValue(textPieces)"},{"lineNumber":278,"author":{"gitId":"uyencfi"},"content":"    } else if (this.ace_) {"},{"lineNumber":279,"author":{"gitId":"uyencfi"},"content":"      return this.ace_.getSession().getDocument().setValue(textPieces)"},{"lineNumber":280,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":281,"author":{"gitId":"uyencfi"},"content":"      // HACK: Hide CodeMirror during setText to prevent lots of extra renders."},{"lineNumber":282,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror_.getWrapperElement().style.display \u003d \"none\""},{"lineNumber":283,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror_.setValue(\"\")"},{"lineNumber":284,"author":{"gitId":"uyencfi"},"content":"      this.insertText(0, textPieces)"},{"lineNumber":285,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror_.getWrapperElement().style.display \u003d \"\""},{"lineNumber":286,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror_.refresh()"},{"lineNumber":287,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":288,"author":{"gitId":"uyencfi"},"content":"    this.editorAdapter_.setCursor({ position: 0, selectionEnd: 0 })"},{"lineNumber":289,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":290,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":291,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.insertTextAtCursor \u003d function (textPieces) {"},{"lineNumber":292,"author":{"gitId":"uyencfi"},"content":"    this.insertText("},{"lineNumber":293,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror_.indexFromPos(this.codeMirror_.getCursor()),"},{"lineNumber":294,"author":{"gitId":"uyencfi"},"content":"      textPieces"},{"lineNumber":295,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":296,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":297,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":298,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.insertText \u003d function (index, textPieces) {"},{"lineNumber":299,"author":{"gitId":"uyencfi"},"content":"    utils.assert(!this.ace_, \"Not supported for ace yet.\")"},{"lineNumber":300,"author":{"gitId":"uyencfi"},"content":"    utils.assert(!this.monaco_, \"Not supported for monaco yet.\")"},{"lineNumber":301,"author":{"gitId":"uyencfi"},"content":"    this.assertReady_(\"insertText\")"},{"lineNumber":302,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":303,"author":{"gitId":"uyencfi"},"content":"    // Wrap it in an array if it\u0027s not already."},{"lineNumber":304,"author":{"gitId":"uyencfi"},"content":"    if (Object.prototype.toString.call(textPieces) !\u003d\u003d \"[object Array]\") {"},{"lineNumber":305,"author":{"gitId":"uyencfi"},"content":"      textPieces \u003d [textPieces]"},{"lineNumber":306,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":307,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":308,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":309,"author":{"gitId":"uyencfi"},"content":"    self.codeMirror_.operation(function () {"},{"lineNumber":310,"author":{"gitId":"uyencfi"},"content":"      // HACK: We should check if we\u0027re actually at the beginning of a line; but checking for index \u003d\u003d 0 is sufficient"},{"lineNumber":311,"author":{"gitId":"uyencfi"},"content":"      // for the setText() case."},{"lineNumber":312,"author":{"gitId":"uyencfi"},"content":"      var atNewLine \u003d index \u003d\u003d\u003d 0"},{"lineNumber":313,"author":{"gitId":"uyencfi"},"content":"      var inserts \u003d textPiecesToInserts(atNewLine, textPieces)"},{"lineNumber":314,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":315,"author":{"gitId":"uyencfi"},"content":"      for (var i \u003d 0; i \u003c inserts.length; i++) {"},{"lineNumber":316,"author":{"gitId":"uyencfi"},"content":"        var string \u003d inserts[i].string"},{"lineNumber":317,"author":{"gitId":"uyencfi"},"content":"        var attributes \u003d inserts[i].attributes"},{"lineNumber":318,"author":{"gitId":"uyencfi"},"content":"        self.richTextCodeMirror_.insertText(index, string, attributes)"},{"lineNumber":319,"author":{"gitId":"uyencfi"},"content":"        index +\u003d string.length"},{"lineNumber":320,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":321,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":322,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":323,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":324,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.getOperationForSpan \u003d function (start, end) {"},{"lineNumber":325,"author":{"gitId":"uyencfi"},"content":"    var text \u003d this.richTextCodeMirror_.getRange(start, end)"},{"lineNumber":326,"author":{"gitId":"uyencfi"},"content":"    var spans \u003d this.richTextCodeMirror_.getAttributeSpans(start, end)"},{"lineNumber":327,"author":{"gitId":"uyencfi"},"content":"    var pos \u003d 0"},{"lineNumber":328,"author":{"gitId":"uyencfi"},"content":"    var op \u003d new TextOperation()"},{"lineNumber":329,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c spans.length; i++) {"},{"lineNumber":330,"author":{"gitId":"uyencfi"},"content":"      op.insert(text.substr(pos, spans[i].length), spans[i].attributes)"},{"lineNumber":331,"author":{"gitId":"uyencfi"},"content":"      pos +\u003d spans[i].length"},{"lineNumber":332,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":333,"author":{"gitId":"uyencfi"},"content":"    return op"},{"lineNumber":334,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":335,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":336,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.getHtml \u003d function () {"},{"lineNumber":337,"author":{"gitId":"uyencfi"},"content":"    return this.getHtmlFromRange(null, null)"},{"lineNumber":338,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":339,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":340,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.getHtmlFromSelection \u003d function () {"},{"lineNumber":341,"author":{"gitId":"uyencfi"},"content":"    var startPos \u003d this.codeMirror_.getCursor(\"start\"),"},{"lineNumber":342,"author":{"gitId":"uyencfi"},"content":"      endPos \u003d this.codeMirror_.getCursor(\"end\")"},{"lineNumber":343,"author":{"gitId":"uyencfi"},"content":"    var startIndex \u003d this.codeMirror_.indexFromPos(startPos),"},{"lineNumber":344,"author":{"gitId":"uyencfi"},"content":"      endIndex \u003d this.codeMirror_.indexFromPos(endPos)"},{"lineNumber":345,"author":{"gitId":"uyencfi"},"content":"    return this.getHtmlFromRange(startIndex, endIndex)"},{"lineNumber":346,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":347,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":348,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.getHtmlFromRange \u003d function (start, end) {"},{"lineNumber":349,"author":{"gitId":"uyencfi"},"content":"    this.assertReady_(\"getHtmlFromRange\")"},{"lineNumber":350,"author":{"gitId":"uyencfi"},"content":"    var doc \u003d"},{"lineNumber":351,"author":{"gitId":"uyencfi"},"content":"      start !\u003d null \u0026\u0026 end !\u003d null"},{"lineNumber":352,"author":{"gitId":"uyencfi"},"content":"        ? this.getOperationForSpan(start, end)"},{"lineNumber":353,"author":{"gitId":"uyencfi"},"content":"        : this.getOperationForSpan(0, this.codeMirror_.getValue().length)"},{"lineNumber":354,"author":{"gitId":"uyencfi"},"content":"    return SerializeHtml(doc, this.entityManager_)"},{"lineNumber":355,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":356,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":357,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.insertHtml \u003d function (index, html) {"},{"lineNumber":358,"author":{"gitId":"uyencfi"},"content":"    var lines \u003d ParseHtml(html, this.entityManager_)"},{"lineNumber":359,"author":{"gitId":"uyencfi"},"content":"    this.insertText(index, lines)"},{"lineNumber":360,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":361,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":362,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.insertHtmlAtCursor \u003d function (html) {"},{"lineNumber":363,"author":{"gitId":"uyencfi"},"content":"    this.insertHtml("},{"lineNumber":364,"author":{"gitId":"uyencfi"},"content":"      this.codeMirror_.indexFromPos(this.codeMirror_.getCursor()),"},{"lineNumber":365,"author":{"gitId":"uyencfi"},"content":"      html"},{"lineNumber":366,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":367,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":368,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":369,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.setHtml \u003d function (html) {"},{"lineNumber":370,"author":{"gitId":"uyencfi"},"content":"    var lines \u003d ParseHtml(html, this.entityManager_)"},{"lineNumber":371,"author":{"gitId":"uyencfi"},"content":"    this.setText(lines)"},{"lineNumber":372,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":373,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":374,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.isHistoryEmpty \u003d function () {"},{"lineNumber":375,"author":{"gitId":"uyencfi"},"content":"    this.assertReady_(\"isHistoryEmpty\")"},{"lineNumber":376,"author":{"gitId":"uyencfi"},"content":"    return this.firebaseAdapter_.isHistoryEmpty()"},{"lineNumber":377,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":378,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":379,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.bold \u003d function () {"},{"lineNumber":380,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.toggleAttribute(ATTR.BOLD)"},{"lineNumber":381,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":382,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":383,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":384,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.italic \u003d function () {"},{"lineNumber":385,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.toggleAttribute(ATTR.ITALIC)"},{"lineNumber":386,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":387,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":388,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":389,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.underline \u003d function () {"},{"lineNumber":390,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.toggleAttribute(ATTR.UNDERLINE)"},{"lineNumber":391,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":392,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":393,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":394,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.strike \u003d function () {"},{"lineNumber":395,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.toggleAttribute(ATTR.STRIKE)"},{"lineNumber":396,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":397,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":398,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":399,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.fontSize \u003d function (size) {"},{"lineNumber":400,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.setAttribute(ATTR.FONT_SIZE, size)"},{"lineNumber":401,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":402,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":403,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":404,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.font \u003d function (font) {"},{"lineNumber":405,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.setAttribute(ATTR.FONT, font)"},{"lineNumber":406,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":407,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":408,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":409,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.color \u003d function (color) {"},{"lineNumber":410,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.setAttribute(ATTR.COLOR, color)"},{"lineNumber":411,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":412,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":413,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":414,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.highlight \u003d function () {"},{"lineNumber":415,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.toggleAttribute("},{"lineNumber":416,"author":{"gitId":"uyencfi"},"content":"      ATTR.BACKGROUND_COLOR,"},{"lineNumber":417,"author":{"gitId":"uyencfi"},"content":"      \"rgba(255,255,0,.65)\""},{"lineNumber":418,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":419,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":420,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":421,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":422,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.align \u003d function (alignment) {"},{"lineNumber":423,"author":{"gitId":"uyencfi"},"content":"    if ("},{"lineNumber":424,"author":{"gitId":"uyencfi"},"content":"      alignment !\u003d\u003d \"left\" \u0026\u0026"},{"lineNumber":425,"author":{"gitId":"uyencfi"},"content":"      alignment !\u003d\u003d \"center\" \u0026\u0026"},{"lineNumber":426,"author":{"gitId":"uyencfi"},"content":"      alignment !\u003d\u003d \"right\""},{"lineNumber":427,"author":{"gitId":"uyencfi"},"content":"    ) {"},{"lineNumber":428,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\u0027align() must be passed \"left\", \"center\", or \"right\".\u0027)"},{"lineNumber":429,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":430,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.setLineAttribute(ATTR.LINE_ALIGN, alignment)"},{"lineNumber":431,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":432,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":433,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":434,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.orderedList \u003d function () {"},{"lineNumber":435,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.toggleLineAttribute(ATTR.LIST_TYPE, \"o\")"},{"lineNumber":436,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":437,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":438,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":439,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.unorderedList \u003d function () {"},{"lineNumber":440,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.toggleLineAttribute(ATTR.LIST_TYPE, \"u\")"},{"lineNumber":441,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":442,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":443,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":444,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.todo \u003d function () {"},{"lineNumber":445,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.toggleTodo()"},{"lineNumber":446,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":447,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":448,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":449,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.newline \u003d function () {"},{"lineNumber":450,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.newline()"},{"lineNumber":451,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":452,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":453,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.deleteLeft \u003d function () {"},{"lineNumber":454,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.deleteLeft()"},{"lineNumber":455,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":456,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":457,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.deleteRight \u003d function () {"},{"lineNumber":458,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.deleteRight()"},{"lineNumber":459,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":460,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":461,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.indent \u003d function () {"},{"lineNumber":462,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.indent()"},{"lineNumber":463,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":464,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":465,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":466,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.unindent \u003d function () {"},{"lineNumber":467,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.unindent()"},{"lineNumber":468,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.focus()"},{"lineNumber":469,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":470,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":471,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.undo \u003d function () {"},{"lineNumber":472,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.undo()"},{"lineNumber":473,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":474,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":475,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.redo \u003d function () {"},{"lineNumber":476,"author":{"gitId":"uyencfi"},"content":"    this.codeMirror_.redo()"},{"lineNumber":477,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":478,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":479,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.insertEntity \u003d function (type, info, origin) {"},{"lineNumber":480,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.insertEntityAtCursor(type, info, origin)"},{"lineNumber":481,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":482,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":483,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.insertEntityAt \u003d function (index, type, info, origin) {"},{"lineNumber":484,"author":{"gitId":"uyencfi"},"content":"    this.richTextCodeMirror_.insertEntityAt(index, type, info, origin)"},{"lineNumber":485,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":486,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":487,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.registerEntity \u003d function (type, options) {"},{"lineNumber":488,"author":{"gitId":"uyencfi"},"content":"    this.entityManager_.register(type, options)"},{"lineNumber":489,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":490,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":491,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.getOption \u003d function (option, def) {"},{"lineNumber":492,"author":{"gitId":"uyencfi"},"content":"    return option in this.options_ ? this.options_[option] : def"},{"lineNumber":493,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":494,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":495,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.assertReady_ \u003d function (funcName) {"},{"lineNumber":496,"author":{"gitId":"uyencfi"},"content":"    if (!this.ready_) {"},{"lineNumber":497,"author":{"gitId":"uyencfi"},"content":"      throw new Error("},{"lineNumber":498,"author":{"gitId":"uyencfi"},"content":"        \u0027You must wait for the \"ready\" event before calling \u0027 + funcName + \".\""},{"lineNumber":499,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":500,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":501,"author":{"gitId":"uyencfi"},"content":"    if (this.zombie_) {"},{"lineNumber":502,"author":{"gitId":"uyencfi"},"content":"      throw new Error("},{"lineNumber":503,"author":{"gitId":"uyencfi"},"content":"        \"You can\u0027t use a Firepad after calling dispose()!  [called \" +"},{"lineNumber":504,"author":{"gitId":"uyencfi"},"content":"          funcName +"},{"lineNumber":505,"author":{"gitId":"uyencfi"},"content":"          \"]\""},{"lineNumber":506,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":507,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":508,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":509,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":510,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.makeImageDialog_ \u003d function () {"},{"lineNumber":511,"author":{"gitId":"uyencfi"},"content":"    this.makeDialog_(\"img\", \"Insert image url\")"},{"lineNumber":512,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":513,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":514,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.makeDialog_ \u003d function (id, placeholder) {"},{"lineNumber":515,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":516,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":517,"author":{"gitId":"uyencfi"},"content":"    var hideDialog \u003d function () {"},{"lineNumber":518,"author":{"gitId":"uyencfi"},"content":"      var dialog \u003d document.getElementById(\"overlay\")"},{"lineNumber":519,"author":{"gitId":"uyencfi"},"content":"      dialog.style.visibility \u003d \"hidden\""},{"lineNumber":520,"author":{"gitId":"uyencfi"},"content":"      self.firepadWrapper_.removeChild(dialog)"},{"lineNumber":521,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":522,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":523,"author":{"gitId":"uyencfi"},"content":"    var cb \u003d function () {"},{"lineNumber":524,"author":{"gitId":"uyencfi"},"content":"      var dialog \u003d document.getElementById(\"overlay\")"},{"lineNumber":525,"author":{"gitId":"uyencfi"},"content":"      dialog.style.visibility \u003d \"hidden\""},{"lineNumber":526,"author":{"gitId":"uyencfi"},"content":"      var src \u003d document.getElementById(id).value"},{"lineNumber":527,"author":{"gitId":"uyencfi"},"content":"      if (src !\u003d\u003d null) self.insertEntity(id, { src: src })"},{"lineNumber":528,"author":{"gitId":"uyencfi"},"content":"      self.firepadWrapper_.removeChild(dialog)"},{"lineNumber":529,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":530,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":531,"author":{"gitId":"uyencfi"},"content":"    var input \u003d utils.elt(\"input\", null, {"},{"lineNumber":532,"author":{"gitId":"uyencfi"},"content":"      class: \"firepad-dialog-input\","},{"lineNumber":533,"author":{"gitId":"uyencfi"},"content":"      id: id,"},{"lineNumber":534,"author":{"gitId":"uyencfi"},"content":"      type: \"text\","},{"lineNumber":535,"author":{"gitId":"uyencfi"},"content":"      placeholder: placeholder,"},{"lineNumber":536,"author":{"gitId":"uyencfi"},"content":"      autofocus: \"autofocus\","},{"lineNumber":537,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":538,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":539,"author":{"gitId":"uyencfi"},"content":"    var submit \u003d utils.elt(\"a\", \"Submit\", {"},{"lineNumber":540,"author":{"gitId":"uyencfi"},"content":"      class: \"firepad-btn\","},{"lineNumber":541,"author":{"gitId":"uyencfi"},"content":"      id: \"submitbtn\","},{"lineNumber":542,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":543,"author":{"gitId":"uyencfi"},"content":"    utils.on(submit, \"click\", utils.stopEventAnd(cb))"},{"lineNumber":544,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":545,"author":{"gitId":"uyencfi"},"content":"    var cancel \u003d utils.elt(\"a\", \"Cancel\", { class: \"firepad-btn\" })"},{"lineNumber":546,"author":{"gitId":"uyencfi"},"content":"    utils.on(cancel, \"click\", utils.stopEventAnd(hideDialog))"},{"lineNumber":547,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":548,"author":{"gitId":"uyencfi"},"content":"    var buttonsdiv \u003d utils.elt(\"div\", [submit, cancel], {"},{"lineNumber":549,"author":{"gitId":"uyencfi"},"content":"      class: \"firepad-btn-group\","},{"lineNumber":550,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":551,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":552,"author":{"gitId":"uyencfi"},"content":"    var div \u003d utils.elt(\"div\", [input, buttonsdiv], {"},{"lineNumber":553,"author":{"gitId":"uyencfi"},"content":"      class: \"firepad-dialog-div\","},{"lineNumber":554,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":555,"author":{"gitId":"uyencfi"},"content":"    var dialog \u003d utils.elt(\"div\", [div], {"},{"lineNumber":556,"author":{"gitId":"uyencfi"},"content":"      class: \"firepad-dialog\","},{"lineNumber":557,"author":{"gitId":"uyencfi"},"content":"      id: \"overlay\","},{"lineNumber":558,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":559,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":560,"author":{"gitId":"uyencfi"},"content":"    this.firepadWrapper_.appendChild(dialog)"},{"lineNumber":561,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":562,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":563,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.addPoweredByLogo_ \u003d function () {"},{"lineNumber":564,"author":{"gitId":"uyencfi"},"content":"    var poweredBy \u003d utils.elt(\"a\", null, { class: \"powered-by-firepad\" })"},{"lineNumber":565,"author":{"gitId":"uyencfi"},"content":"    poweredBy.setAttribute(\"href\", \"http://www.firepad.io/\")"},{"lineNumber":566,"author":{"gitId":"uyencfi"},"content":"    poweredBy.setAttribute(\"target\", \"_blank\")"},{"lineNumber":567,"author":{"gitId":"uyencfi"},"content":"    this.firepadWrapper_.appendChild(poweredBy)"},{"lineNumber":568,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":569,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":570,"author":{"gitId":"uyencfi"},"content":"  Firepad.prototype.initializeKeyMap_ \u003d function () {"},{"lineNumber":571,"author":{"gitId":"uyencfi"},"content":"    function binder(fn) {"},{"lineNumber":572,"author":{"gitId":"uyencfi"},"content":"      return function (cm) {"},{"lineNumber":573,"author":{"gitId":"uyencfi"},"content":"        // HACK: CodeMirror will often call our key handlers within a cm.operation(), and that"},{"lineNumber":574,"author":{"gitId":"uyencfi"},"content":"        // can mess us up (we rely on events being triggered synchronously when we make CodeMirror"},{"lineNumber":575,"author":{"gitId":"uyencfi"},"content":"        // edits).  So to escape any cm.operation(), we do a setTimeout."},{"lineNumber":576,"author":{"gitId":"uyencfi"},"content":"        setTimeout(function () {"},{"lineNumber":577,"author":{"gitId":"uyencfi"},"content":"          fn.call(cm.firepad)"},{"lineNumber":578,"author":{"gitId":"uyencfi"},"content":"        }, 0)"},{"lineNumber":579,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":580,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":581,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":582,"author":{"gitId":"uyencfi"},"content":"    CodeMirror.keyMap[\"richtext\"] \u003d {"},{"lineNumber":583,"author":{"gitId":"uyencfi"},"content":"      \"Ctrl-B\": binder(this.bold),"},{"lineNumber":584,"author":{"gitId":"uyencfi"},"content":"      \"Cmd-B\": binder(this.bold),"},{"lineNumber":585,"author":{"gitId":"uyencfi"},"content":"      \"Ctrl-I\": binder(this.italic),"},{"lineNumber":586,"author":{"gitId":"uyencfi"},"content":"      \"Cmd-I\": binder(this.italic),"},{"lineNumber":587,"author":{"gitId":"uyencfi"},"content":"      \"Ctrl-U\": binder(this.underline),"},{"lineNumber":588,"author":{"gitId":"uyencfi"},"content":"      \"Cmd-U\": binder(this.underline),"},{"lineNumber":589,"author":{"gitId":"uyencfi"},"content":"      \"Ctrl-H\": binder(this.highlight),"},{"lineNumber":590,"author":{"gitId":"uyencfi"},"content":"      \"Cmd-H\": binder(this.highlight),"},{"lineNumber":591,"author":{"gitId":"uyencfi"},"content":"      Enter: binder(this.newline),"},{"lineNumber":592,"author":{"gitId":"uyencfi"},"content":"      Delete: binder(this.deleteRight),"},{"lineNumber":593,"author":{"gitId":"uyencfi"},"content":"      Backspace: binder(this.deleteLeft),"},{"lineNumber":594,"author":{"gitId":"uyencfi"},"content":"      Tab: binder(this.indent),"},{"lineNumber":595,"author":{"gitId":"uyencfi"},"content":"      \"Shift-Tab\": binder(this.unindent),"},{"lineNumber":596,"author":{"gitId":"uyencfi"},"content":"      fallthrough: [\"default\"],"},{"lineNumber":597,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":598,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":599,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":600,"author":{"gitId":"uyencfi"},"content":"  function colorFromUserId(userId) {"},{"lineNumber":601,"author":{"gitId":"uyencfi"},"content":"    var a \u003d 1"},{"lineNumber":602,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c userId.length; i++) {"},{"lineNumber":603,"author":{"gitId":"uyencfi"},"content":"      a \u003d (17 * (a + userId.charCodeAt(i))) % 360"},{"lineNumber":604,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":605,"author":{"gitId":"uyencfi"},"content":"    var hue \u003d a / 360"},{"lineNumber":606,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":607,"author":{"gitId":"uyencfi"},"content":"    return hsl2hex(hue, 1, 0.75)"},{"lineNumber":608,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":609,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":610,"author":{"gitId":"uyencfi"},"content":"  function rgb2hex(r, g, b) {"},{"lineNumber":611,"author":{"gitId":"uyencfi"},"content":"    function digits(n) {"},{"lineNumber":612,"author":{"gitId":"uyencfi"},"content":"      var m \u003d Math.round(255 * n).toString(16)"},{"lineNumber":613,"author":{"gitId":"uyencfi"},"content":"      return m.length \u003d\u003d\u003d 1 ? \"0\" + m : m"},{"lineNumber":614,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":615,"author":{"gitId":"uyencfi"},"content":"    return \"#\" + digits(r) + digits(g) + digits(b)"},{"lineNumber":616,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":617,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":618,"author":{"gitId":"uyencfi"},"content":"  function hsl2hex(h, s, l) {"},{"lineNumber":619,"author":{"gitId":"uyencfi"},"content":"    if (s \u003d\u003d\u003d 0) {"},{"lineNumber":620,"author":{"gitId":"uyencfi"},"content":"      return rgb2hex(l, l, l)"},{"lineNumber":621,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":622,"author":{"gitId":"uyencfi"},"content":"    var var2 \u003d l \u003c 0.5 ? l * (1 + s) : l + s - s * l"},{"lineNumber":623,"author":{"gitId":"uyencfi"},"content":"    var var1 \u003d 2 * l - var2"},{"lineNumber":624,"author":{"gitId":"uyencfi"},"content":"    var hue2rgb \u003d function (hue) {"},{"lineNumber":625,"author":{"gitId":"uyencfi"},"content":"      if (hue \u003c 0) {"},{"lineNumber":626,"author":{"gitId":"uyencfi"},"content":"        hue +\u003d 1"},{"lineNumber":627,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":628,"author":{"gitId":"uyencfi"},"content":"      if (hue \u003e 1) {"},{"lineNumber":629,"author":{"gitId":"uyencfi"},"content":"        hue -\u003d 1"},{"lineNumber":630,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":631,"author":{"gitId":"uyencfi"},"content":"      if (6 * hue \u003c 1) {"},{"lineNumber":632,"author":{"gitId":"uyencfi"},"content":"        return var1 + (var2 - var1) * 6 * hue"},{"lineNumber":633,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":634,"author":{"gitId":"uyencfi"},"content":"      if (2 * hue \u003c 1) {"},{"lineNumber":635,"author":{"gitId":"uyencfi"},"content":"        return var2"},{"lineNumber":636,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":637,"author":{"gitId":"uyencfi"},"content":"      if (3 * hue \u003c 2) {"},{"lineNumber":638,"author":{"gitId":"uyencfi"},"content":"        return var1 + (var2 - var1) * 6 * (2 / 3 - hue)"},{"lineNumber":639,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":640,"author":{"gitId":"uyencfi"},"content":"      return var1"},{"lineNumber":641,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":642,"author":{"gitId":"uyencfi"},"content":"    return rgb2hex(hue2rgb(h + 1 / 3), hue2rgb(h), hue2rgb(h - 1 / 3))"},{"lineNumber":643,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":644,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":645,"author":{"gitId":"uyencfi"},"content":"  return Firepad"},{"lineNumber":646,"author":{"gitId":"uyencfi"},"content":"})()"},{"lineNumber":647,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":648,"author":{"gitId":"uyencfi"},"content":"Object.assign(Firepad, {"},{"lineNumber":649,"author":{"gitId":"uyencfi"},"content":"  // Export Text classes"},{"lineNumber":650,"author":{"gitId":"uyencfi"},"content":"  Formatting,"},{"lineNumber":651,"author":{"gitId":"uyencfi"},"content":"  Text,"},{"lineNumber":652,"author":{"gitId":"uyencfi"},"content":"  Entity,"},{"lineNumber":653,"author":{"gitId":"uyencfi"},"content":"  LineFormatting,"},{"lineNumber":654,"author":{"gitId":"uyencfi"},"content":"  Line,"},{"lineNumber":655,"author":{"gitId":"uyencfi"},"content":"  TextOperation,"},{"lineNumber":656,"author":{"gitId":"uyencfi"},"content":"})"},{"lineNumber":657,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":658,"author":{"gitId":"uyencfi"},"content":"export default Firepad"},{"lineNumber":659,"author":{"gitId":"uyencfi"},"content":"export { Headless } from \"./headless.js\""}],"authorContributionMap":{"uyencfi":659}},{"path":"frontend/src/components/collaboration/lib/formatting.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { ATTR } from \"./constants.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":" * Immutable object to represent text formatting.  Formatting can be modified by chaining method calls."},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":" *"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":" * @constructor"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":" * @type {Function}"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"export const Formatting \u003d (function () {"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"  function Formatting(attributes) {"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    // Allow calling without new."},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"    if (!(this instanceof Formatting)) {"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"      return new Formatting(attributes)"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"    this.attributes \u003d attributes || {}"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"  Formatting.prototype.cloneWithNewAttribute_ \u003d function (attribute, value) {"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    var attributes \u003d {}"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"    // Copy existing."},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    for (var attr in this.attributes) {"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"      attributes[attr] \u003d this.attributes[attr]"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"    // Add new one."},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"    if (value \u003d\u003d\u003d false) {"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"      delete attributes[attribute]"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"      attributes[attribute] \u003d value"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"    return new Formatting(attributes)"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"  Formatting.prototype.bold \u003d function (val) {"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"    return this.cloneWithNewAttribute_(ATTR.BOLD, val)"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"  Formatting.prototype.italic \u003d function (val) {"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"    return this.cloneWithNewAttribute_(ATTR.ITALIC, val)"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"  Formatting.prototype.underline \u003d function (val) {"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"    return this.cloneWithNewAttribute_(ATTR.UNDERLINE, val)"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"  Formatting.prototype.strike \u003d function (val) {"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"    return this.cloneWithNewAttribute_(ATTR.STRIKE, val)"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"  Formatting.prototype.font \u003d function (font) {"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"    return this.cloneWithNewAttribute_(ATTR.FONT, font)"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"  Formatting.prototype.fontSize \u003d function (size) {"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"    return this.cloneWithNewAttribute_(ATTR.FONT_SIZE, size)"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"  Formatting.prototype.color \u003d function (color) {"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"    return this.cloneWithNewAttribute_(ATTR.COLOR, color)"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"  Formatting.prototype.backgroundColor \u003d function (color) {"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"    return this.cloneWithNewAttribute_(ATTR.BACKGROUND_COLOR, color)"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"  return Formatting"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":70}},{"path":"frontend/src/components/collaboration/lib/headless.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { TextOperation } from \"./text-operation.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { FirebaseAdapter } from \"./firebase-adapter.js\""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import { EntityManager } from \"./entity-manager.js\""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"import { ParseHtml } from \"./parse-html.js\""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"import { SerializeHtml } from \"./serialize-html.js\""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"import { sentinelConstants } from \"./constants.js\""},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"import { textPiecesToInserts } from \"./text-pieces-to-inserts.js\""},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"import { getDocument, setDocument } from \"./document.js\""},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"import firebase from \"firebase/compat/app\""},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"import \"firebase/compat/database\""},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":" * Instance of headless Firepad for use in NodeJS. Supports get/set on text/html."},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"export const Headless \u003d (function () {"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"  function Headless(refOrPath) {"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"    // Allow calling without new."},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"    if (!(this instanceof Headless)) {"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"      return new Headless(refOrPath)"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    var ref"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"    if (typeof refOrPath \u003d\u003d\u003d \"string\") {"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"      ref \u003d firebase.database().refFromURL(refOrPath)"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"      ref \u003d refOrPath"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    this.entityManager_ \u003d new EntityManager()"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    this.firebaseAdapter_ \u003d new FirebaseAdapter(ref)"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"    this.ready_ \u003d false"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"    this.zombie_ \u003d false"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"  Headless.prototype.getDocument \u003d function (callback) {"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"    if (self.ready_) {"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"      return callback(self.firebaseAdapter_.getDocument())"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"    self.firebaseAdapter_.on(\"ready\", function () {"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"      self.ready_ \u003d true"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"      callback(self.firebaseAdapter_.getDocument())"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"  Headless.prototype.getText \u003d function (callback) {"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    if (this.zombie_) {"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"      throw new Error("},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"        \"You can\u0027t use a firepad.Headless after calling dispose()!\""},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"    this.getDocument(function (doc) {"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"      var text \u003d doc.apply(\"\")"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"      // Strip out any special characters from Rich Text formatting"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"      for (var key in sentinelConstants) {"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"        text \u003d text.replace(new RegExp(sentinelConstants[key], \"g\"), \"\")"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"      callback(text)"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"  Headless.prototype.setText \u003d function (text, callback) {"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"    if (this.zombie_) {"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"      throw new Error("},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"        \"You can\u0027t use a firepad.Headless after calling dispose()!\""},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"    var op \u003d TextOperation().insert(text)"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"    this.sendOperationWithRetry(op, callback)"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"  Headless.prototype.initializeFakeDom \u003d function (callback) {"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"    if (typeof getDocument() \u003d\u003d\u003d \"object\") {"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"      callback()"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"      const require \u003d global.require"},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"      const jsdom \u003d require(\"jsdom\")"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"      const { JSDOM } \u003d jsdom"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"      const { window } \u003d new JSDOM(\"\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003c/body\u003e\")"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"      if (getDocument()) {"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"        // Return if we\u0027ve already made a jsdom to avoid making more than one"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"        // This would be easier with promises but we want to avoid introducing"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"        // another dependency for just headless mode."},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"        window.close()"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"        return callback()"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"      setDocument(window.document)"},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"      callback()"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"  Headless.prototype.getHtml \u003d function (callback) {"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"    if (this.zombie_) {"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"      throw new Error("},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"        \"You can\u0027t use a firepad.Headless after calling dispose()!\""},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"    self.initializeFakeDom(function () {"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"      self.getDocument(function (doc) {"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"        callback(SerializeHtml(doc, self.entityManager_))"},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"  Headless.prototype.setHtml \u003d function (html, callback) {"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"    if (this.zombie_) {"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"      throw new Error("},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"        \"You can\u0027t use a firepad.Headless after calling dispose()!\""},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"    self.initializeFakeDom(function () {"},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"      var textPieces \u003d ParseHtml(html, self.entityManager_)"},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":"      var inserts \u003d textPiecesToInserts(true, textPieces)"},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"      var op \u003d new TextOperation()"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"      for (var i \u003d 0; i \u003c inserts.length; i++) {"},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"        op.insert(inserts[i].string, inserts[i].attributes)"},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":"      self.sendOperationWithRetry(op, callback)"},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":"  Headless.prototype.sendOperationWithRetry \u003d function (operation, callback) {"},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"    var self \u003d this"},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":"    self.getDocument(function (doc) {"},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":"      var op \u003d operation.clone()[\"delete\"](doc.targetLength)"},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"      self.firebaseAdapter_.sendOperation(op, function (err, committed) {"},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":"        if (committed) {"},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":"          if (typeof callback !\u003d\u003d \"undefined\") {"},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"            callback(null, committed)"},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":"          self.sendOperationWithRetry(operation, callback)"},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":"  Headless.prototype.dispose \u003d function () {"},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":"    this.zombie_ \u003d true // We\u0027ve been disposed.  No longer valid to do anything."},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":"    this.firebaseAdapter_.dispose()"},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"  return Headless"},{"lineNumber":161,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":161}},{"path":"frontend/src/components/collaboration/lib/line-formatting.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { utils } from \"./utils.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { ATTR } from \"./constants.js\""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":" * Immutable object to represent line formatting.  Formatting can be modified by chaining method calls."},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":" *"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":" * @constructor"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":" * @type {Function}"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"export const LineFormatting \u003d (function () {"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"  function LineFormatting(attributes) {"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"    // Allow calling without new."},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"    if (!(this instanceof LineFormatting)) {"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"      return new LineFormatting(attributes)"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"    this.attributes \u003d attributes || {}"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"    this.attributes[ATTR.LINE_SENTINEL] \u003d true"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"  LineFormatting.LIST_TYPE \u003d {"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"    NONE: false,"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    ORDERED: \"o\","},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"    UNORDERED: \"u\","},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    TODO: \"t\","},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"    TODOCHECKED: \"tc\","},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"  LineFormatting.prototype.cloneWithNewAttribute_ \u003d function ("},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    attribute,"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"    value"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"  ) {"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"    var attributes \u003d {}"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"    // Copy existing."},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"    for (var attr in this.attributes) {"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"      attributes[attr] \u003d this.attributes[attr]"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"    // Add new one."},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"    if (value \u003d\u003d\u003d false) {"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"      delete attributes[attribute]"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"      attributes[attribute] \u003d value"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"    return new LineFormatting(attributes)"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"  LineFormatting.prototype.indent \u003d function (indent) {"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    return this.cloneWithNewAttribute_(ATTR.LINE_INDENT, indent)"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"  LineFormatting.prototype.align \u003d function (align) {"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"    return this.cloneWithNewAttribute_(ATTR.LINE_ALIGN, align)"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"  LineFormatting.prototype.listItem \u003d function (val) {"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"    utils.assert("},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"      val \u003d\u003d\u003d false || val \u003d\u003d\u003d \"u\" || val \u003d\u003d\u003d \"o\" || val \u003d\u003d\u003d \"t\" || val \u003d\u003d\u003d \"tc\""},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"    return this.cloneWithNewAttribute_(ATTR.LIST_TYPE, val)"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"  LineFormatting.prototype.getIndent \u003d function () {"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"    return this.attributes[ATTR.LINE_INDENT] || 0"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"  LineFormatting.prototype.getAlign \u003d function () {"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"    return this.attributes[ATTR.LINE_ALIGN] || 0"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"  LineFormatting.prototype.getListItem \u003d function () {"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"    return this.attributes[ATTR.LIST_TYPE] || false"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"  return LineFormatting"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":78}},{"path":"frontend/src/components/collaboration/lib/line.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { LineFormatting } from \"./line-formatting.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":" * Object to represent Formatted line."},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":" *"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":" * @type {Function}"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"export const Line \u003d (function () {"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  function Line(textPieces, formatting) {"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"    // Allow calling without new."},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    if (!(this instanceof Line)) {"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"      return new Line(textPieces, formatting)"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    if (Object.prototype.toString.call(textPieces) !\u003d\u003d \"[object Array]\") {"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"      if (typeof textPieces \u003d\u003d\u003d \"undefined\") {"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"        textPieces \u003d []"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"        textPieces \u003d [textPieces]"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    this.textPieces \u003d textPieces"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"    this.formatting \u003d formatting || LineFormatting()"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"  return Line"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":28}},{"path":"frontend/src/components/collaboration/lib/parse-html.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { utils } from \"./utils.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { LineFormatting } from \"./line-formatting.js\""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import { sentinelConstants } from \"./constants.js\""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"import { Text } from \"./text.js\""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"import { getDocument } from \"./document.js\""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"import { Formatting } from \"./formatting.js\""},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"import { Line } from \"./line.js\""},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":" * Helper to parse html into Firepad-compatible lines / text."},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":" * @type {*}"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"export const ParseHtml \u003d (function () {"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"  var { LIST_TYPE } \u003d LineFormatting"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"   * Represents the current parse state as an immutable structure.  To create a new ParseState, use"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"   * the withXXX methods."},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"   *"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"   * @param opt_listType"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"   * @param opt_lineFormatting"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"   * @param opt_textFormatting"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"   * @constructor"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"  function ParseState(opt_listType, opt_lineFormatting, opt_textFormatting) {"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"    this.listType \u003d opt_listType || LIST_TYPE.UNORDERED"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"    this.lineFormatting \u003d opt_lineFormatting || LineFormatting()"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"    this.textFormatting \u003d opt_textFormatting || Formatting()"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"  ParseState.prototype.withTextFormatting \u003d function (textFormatting) {"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    return new ParseState(this.listType, this.lineFormatting, textFormatting)"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"  ParseState.prototype.withLineFormatting \u003d function (lineFormatting) {"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"    return new ParseState(this.listType, lineFormatting, this.textFormatting)"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"  ParseState.prototype.withListType \u003d function (listType) {"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"    return new ParseState(listType, this.lineFormatting, this.textFormatting)"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"  ParseState.prototype.withIncreasedIndent \u003d function () {"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"    var lineFormatting \u003d this.lineFormatting.indent("},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"      this.lineFormatting.getIndent() + 1"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"    return new ParseState(this.listType, lineFormatting, this.textFormatting)"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"  ParseState.prototype.withAlign \u003d function (align) {"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    var lineFormatting \u003d this.lineFormatting.align(align)"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"    return new ParseState(this.listType, lineFormatting, this.textFormatting)"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"  /**"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"   * Mutable structure representing the current parse output."},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"   * @constructor"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"   */"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"  function ParseOutput() {"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"    this.lines \u003d []"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"    this.currentLine \u003d []"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"    this.currentLineListItemType \u003d null"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"  ParseOutput.prototype.newlineIfNonEmpty \u003d function (state) {"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"    this.cleanLine_()"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"    if (this.currentLine.length \u003e 0) {"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"      this.newline(state)"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"  ParseOutput.prototype.newlineIfNonEmptyOrListItem \u003d function (state) {"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"    this.cleanLine_()"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"    if (this.currentLine.length \u003e 0 || this.currentLineListItemType !\u003d\u003d null) {"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"      this.newline(state)"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"  ParseOutput.prototype.newline \u003d function (state) {"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"    this.cleanLine_()"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"    var lineFormatting \u003d state.lineFormatting"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"    if (this.currentLineListItemType !\u003d\u003d null) {"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"      lineFormatting \u003d lineFormatting.listItem(this.currentLineListItemType)"},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"      this.currentLineListItemType \u003d null"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"    this.lines.push(Line(this.currentLine, lineFormatting))"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"    this.currentLine \u003d []"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"  ParseOutput.prototype.makeListItem \u003d function (type) {"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"    this.currentLineListItemType \u003d type"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"  ParseOutput.prototype.cleanLine_ \u003d function () {"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"    // Kinda\u0027 a hack, but we remove leading and trailing spaces (since these aren\u0027t significant in html) and"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"    // replaces nbsp\u0027s with normal spaces."},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"    if (this.currentLine.length \u003e 0) {"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"      var last \u003d this.currentLine.length - 1"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"      this.currentLine[0].text \u003d this.currentLine[0].text.replace(/^ +/, \"\")"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"      this.currentLine[last].text \u003d this.currentLine[last].text.replace("},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"        / +$/g,"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"        \"\""},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"      for (var i \u003d 0; i \u003c this.currentLine.length; i++) {"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"        this.currentLine[i].text \u003d this.currentLine[i].text.replace("},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"          /\\u00a0/g,"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"          \" \""},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"    // If after stripping trailing whitespace, there\u0027s nothing left, clear currentLine out."},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"    if (this.currentLine.length \u003d\u003d\u003d 1 \u0026\u0026 this.currentLine[0].text \u003d\u003d\u003d \"\") {"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"      this.currentLine \u003d []"},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"  var entityManager_"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"  function parseHtml(html, entityManager) {"},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"    // Create DIV with HTML (as a convenient way to parse it)."},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"    var div \u003d getDocument().createElement(\"div\")"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"    div.innerHTML \u003d html"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"    // HACK until I refactor this."},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"    entityManager_ \u003d entityManager"},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"    var output \u003d new ParseOutput()"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"    var state \u003d new ParseState()"},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"    parseNode(div, state, output)"},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"    return output.lines"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"  // Fix IE8."},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"  // eslint-disable-next-line no-use-before-define"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":"  var Node \u003d Node || {"},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":"    ELEMENT_NODE: 1,"},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"    TEXT_NODE: 3,"},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":"  function parseNode(node, state, output) {"},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"    // Give entity manager first crack at it."},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":"    if (node.nodeType \u003d\u003d\u003d Node.ELEMENT_NODE) {"},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":"      var entity \u003d entityManager_.fromElement(node)"},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"      if (entity) {"},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":"        output.currentLine.push("},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"          new Text("},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":"            sentinelConstants.ENTITY_SENTINEL_CHARACTER,"},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":"            new Formatting(entity.toAttributes())"},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"          )"},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":"        return"},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":"    switch (node.nodeType) {"},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":"      case Node.TEXT_NODE:"},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":"        // This probably isn\u0027t exactly right, but mostly works..."},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":"        var text \u003d node.nodeValue.replace(/[ \\n\\t]+/g, \" \")"},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"        output.currentLine.push(Text(text, state.textFormatting))"},{"lineNumber":161,"author":{"gitId":"uyencfi"},"content":"        break"},{"lineNumber":162,"author":{"gitId":"uyencfi"},"content":"      case Node.ELEMENT_NODE:"},{"lineNumber":163,"author":{"gitId":"uyencfi"},"content":"        var style \u003d node.getAttribute(\"style\") || \"\""},{"lineNumber":164,"author":{"gitId":"uyencfi"},"content":"        state \u003d parseStyle(state, style)"},{"lineNumber":165,"author":{"gitId":"uyencfi"},"content":"        switch (node.nodeName.toLowerCase()) {"},{"lineNumber":166,"author":{"gitId":"uyencfi"},"content":"          case \"div\":"},{"lineNumber":167,"author":{"gitId":"uyencfi"},"content":"          case \"h1\":"},{"lineNumber":168,"author":{"gitId":"uyencfi"},"content":"          case \"h2\":"},{"lineNumber":169,"author":{"gitId":"uyencfi"},"content":"          case \"h3\":"},{"lineNumber":170,"author":{"gitId":"uyencfi"},"content":"          case \"p\":"},{"lineNumber":171,"author":{"gitId":"uyencfi"},"content":"            output.newlineIfNonEmpty(state)"},{"lineNumber":172,"author":{"gitId":"uyencfi"},"content":"            parseChildren(node, state, output)"},{"lineNumber":173,"author":{"gitId":"uyencfi"},"content":"            output.newlineIfNonEmpty(state)"},{"lineNumber":174,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":175,"author":{"gitId":"uyencfi"},"content":"          case \"center\":"},{"lineNumber":176,"author":{"gitId":"uyencfi"},"content":"            state \u003d state.withAlign(\"center\")"},{"lineNumber":177,"author":{"gitId":"uyencfi"},"content":"            output.newlineIfNonEmpty(state)"},{"lineNumber":178,"author":{"gitId":"uyencfi"},"content":"            parseChildren(node, state.withAlign(\"center\"), output)"},{"lineNumber":179,"author":{"gitId":"uyencfi"},"content":"            output.newlineIfNonEmpty(state)"},{"lineNumber":180,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":181,"author":{"gitId":"uyencfi"},"content":"          case \"b\":"},{"lineNumber":182,"author":{"gitId":"uyencfi"},"content":"          case \"strong\":"},{"lineNumber":183,"author":{"gitId":"uyencfi"},"content":"            parseChildren("},{"lineNumber":184,"author":{"gitId":"uyencfi"},"content":"              node,"},{"lineNumber":185,"author":{"gitId":"uyencfi"},"content":"              state.withTextFormatting(state.textFormatting.bold(true)),"},{"lineNumber":186,"author":{"gitId":"uyencfi"},"content":"              output"},{"lineNumber":187,"author":{"gitId":"uyencfi"},"content":"            )"},{"lineNumber":188,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":189,"author":{"gitId":"uyencfi"},"content":"          case \"u\":"},{"lineNumber":190,"author":{"gitId":"uyencfi"},"content":"            parseChildren("},{"lineNumber":191,"author":{"gitId":"uyencfi"},"content":"              node,"},{"lineNumber":192,"author":{"gitId":"uyencfi"},"content":"              state.withTextFormatting(state.textFormatting.underline(true)),"},{"lineNumber":193,"author":{"gitId":"uyencfi"},"content":"              output"},{"lineNumber":194,"author":{"gitId":"uyencfi"},"content":"            )"},{"lineNumber":195,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":196,"author":{"gitId":"uyencfi"},"content":"          case \"i\":"},{"lineNumber":197,"author":{"gitId":"uyencfi"},"content":"          case \"em\":"},{"lineNumber":198,"author":{"gitId":"uyencfi"},"content":"            parseChildren("},{"lineNumber":199,"author":{"gitId":"uyencfi"},"content":"              node,"},{"lineNumber":200,"author":{"gitId":"uyencfi"},"content":"              state.withTextFormatting(state.textFormatting.italic(true)),"},{"lineNumber":201,"author":{"gitId":"uyencfi"},"content":"              output"},{"lineNumber":202,"author":{"gitId":"uyencfi"},"content":"            )"},{"lineNumber":203,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":204,"author":{"gitId":"uyencfi"},"content":"          case \"s\":"},{"lineNumber":205,"author":{"gitId":"uyencfi"},"content":"            parseChildren("},{"lineNumber":206,"author":{"gitId":"uyencfi"},"content":"              node,"},{"lineNumber":207,"author":{"gitId":"uyencfi"},"content":"              state.withTextFormatting(state.textFormatting.strike(true)),"},{"lineNumber":208,"author":{"gitId":"uyencfi"},"content":"              output"},{"lineNumber":209,"author":{"gitId":"uyencfi"},"content":"            )"},{"lineNumber":210,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":211,"author":{"gitId":"uyencfi"},"content":"          case \"font\":"},{"lineNumber":212,"author":{"gitId":"uyencfi"},"content":"            var face \u003d node.getAttribute(\"face\")"},{"lineNumber":213,"author":{"gitId":"uyencfi"},"content":"            var color \u003d node.getAttribute(\"color\")"},{"lineNumber":214,"author":{"gitId":"uyencfi"},"content":"            var size \u003d parseInt(node.getAttribute(\"size\"))"},{"lineNumber":215,"author":{"gitId":"uyencfi"},"content":"            if (face) {"},{"lineNumber":216,"author":{"gitId":"uyencfi"},"content":"              state \u003d state.withTextFormatting(state.textFormatting.font(face))"},{"lineNumber":217,"author":{"gitId":"uyencfi"},"content":"            }"},{"lineNumber":218,"author":{"gitId":"uyencfi"},"content":"            if (color) {"},{"lineNumber":219,"author":{"gitId":"uyencfi"},"content":"              state \u003d state.withTextFormatting("},{"lineNumber":220,"author":{"gitId":"uyencfi"},"content":"                state.textFormatting.color(color)"},{"lineNumber":221,"author":{"gitId":"uyencfi"},"content":"              )"},{"lineNumber":222,"author":{"gitId":"uyencfi"},"content":"            }"},{"lineNumber":223,"author":{"gitId":"uyencfi"},"content":"            if (size) {"},{"lineNumber":224,"author":{"gitId":"uyencfi"},"content":"              state \u003d state.withTextFormatting("},{"lineNumber":225,"author":{"gitId":"uyencfi"},"content":"                state.textFormatting.fontSize(size)"},{"lineNumber":226,"author":{"gitId":"uyencfi"},"content":"              )"},{"lineNumber":227,"author":{"gitId":"uyencfi"},"content":"            }"},{"lineNumber":228,"author":{"gitId":"uyencfi"},"content":"            parseChildren(node, state, output)"},{"lineNumber":229,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":230,"author":{"gitId":"uyencfi"},"content":"          case \"br\":"},{"lineNumber":231,"author":{"gitId":"uyencfi"},"content":"            output.newline(state)"},{"lineNumber":232,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":233,"author":{"gitId":"uyencfi"},"content":"          case \"ul\":"},{"lineNumber":234,"author":{"gitId":"uyencfi"},"content":"            output.newlineIfNonEmptyOrListItem(state)"},{"lineNumber":235,"author":{"gitId":"uyencfi"},"content":"            var listType \u003d"},{"lineNumber":236,"author":{"gitId":"uyencfi"},"content":"              node.getAttribute(\"class\") \u003d\u003d\u003d \"firepad-todo\""},{"lineNumber":237,"author":{"gitId":"uyencfi"},"content":"                ? LIST_TYPE.TODO"},{"lineNumber":238,"author":{"gitId":"uyencfi"},"content":"                : LIST_TYPE.UNORDERED"},{"lineNumber":239,"author":{"gitId":"uyencfi"},"content":"            parseChildren("},{"lineNumber":240,"author":{"gitId":"uyencfi"},"content":"              node,"},{"lineNumber":241,"author":{"gitId":"uyencfi"},"content":"              state.withListType(listType).withIncreasedIndent(),"},{"lineNumber":242,"author":{"gitId":"uyencfi"},"content":"              output"},{"lineNumber":243,"author":{"gitId":"uyencfi"},"content":"            )"},{"lineNumber":244,"author":{"gitId":"uyencfi"},"content":"            output.newlineIfNonEmpty(state)"},{"lineNumber":245,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":246,"author":{"gitId":"uyencfi"},"content":"          case \"ol\":"},{"lineNumber":247,"author":{"gitId":"uyencfi"},"content":"            output.newlineIfNonEmptyOrListItem(state)"},{"lineNumber":248,"author":{"gitId":"uyencfi"},"content":"            parseChildren("},{"lineNumber":249,"author":{"gitId":"uyencfi"},"content":"              node,"},{"lineNumber":250,"author":{"gitId":"uyencfi"},"content":"              state.withListType(LIST_TYPE.ORDERED).withIncreasedIndent(),"},{"lineNumber":251,"author":{"gitId":"uyencfi"},"content":"              output"},{"lineNumber":252,"author":{"gitId":"uyencfi"},"content":"            )"},{"lineNumber":253,"author":{"gitId":"uyencfi"},"content":"            output.newlineIfNonEmpty(state)"},{"lineNumber":254,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":255,"author":{"gitId":"uyencfi"},"content":"          case \"li\":"},{"lineNumber":256,"author":{"gitId":"uyencfi"},"content":"            parseListItem(node, state, output)"},{"lineNumber":257,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":258,"author":{"gitId":"uyencfi"},"content":"          case \"style\": // ignore."},{"lineNumber":259,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":260,"author":{"gitId":"uyencfi"},"content":"          default:"},{"lineNumber":261,"author":{"gitId":"uyencfi"},"content":"            parseChildren(node, state, output)"},{"lineNumber":262,"author":{"gitId":"uyencfi"},"content":"            break"},{"lineNumber":263,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":264,"author":{"gitId":"uyencfi"},"content":"        break"},{"lineNumber":265,"author":{"gitId":"uyencfi"},"content":"      default:"},{"lineNumber":266,"author":{"gitId":"uyencfi"},"content":"        // Ignore other nodes (comments, etc.)"},{"lineNumber":267,"author":{"gitId":"uyencfi"},"content":"        break"},{"lineNumber":268,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":269,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":270,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":271,"author":{"gitId":"uyencfi"},"content":"  function parseChildren(node, state, output) {"},{"lineNumber":272,"author":{"gitId":"uyencfi"},"content":"    if (node.hasChildNodes()) {"},{"lineNumber":273,"author":{"gitId":"uyencfi"},"content":"      for (var i \u003d 0; i \u003c node.childNodes.length; i++) {"},{"lineNumber":274,"author":{"gitId":"uyencfi"},"content":"        parseNode(node.childNodes[i], state, output)"},{"lineNumber":275,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":276,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":277,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":278,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":279,"author":{"gitId":"uyencfi"},"content":"  function parseListItem(node, state, output) {"},{"lineNumber":280,"author":{"gitId":"uyencfi"},"content":"    // Note: \u003cli\u003e is weird:"},{"lineNumber":281,"author":{"gitId":"uyencfi"},"content":"    // * Only the first line in the \u003cli\u003e tag should be a list item (i.e. with a bullet or number next to it)."},{"lineNumber":282,"author":{"gitId":"uyencfi"},"content":"    // * \u003cli\u003e\u003c/li\u003e should create an empty list item line; \u003cli\u003e\u003col\u003e\u003cli\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/li\u003e should create two."},{"lineNumber":283,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":284,"author":{"gitId":"uyencfi"},"content":"    output.newlineIfNonEmptyOrListItem(state)"},{"lineNumber":285,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":286,"author":{"gitId":"uyencfi"},"content":"    var listType \u003d"},{"lineNumber":287,"author":{"gitId":"uyencfi"},"content":"      node.getAttribute(\"class\") \u003d\u003d\u003d \"firepad-checked\""},{"lineNumber":288,"author":{"gitId":"uyencfi"},"content":"        ? LIST_TYPE.TODOCHECKED"},{"lineNumber":289,"author":{"gitId":"uyencfi"},"content":"        : state.listType"},{"lineNumber":290,"author":{"gitId":"uyencfi"},"content":"    output.makeListItem(listType)"},{"lineNumber":291,"author":{"gitId":"uyencfi"},"content":"    var oldLine \u003d output.currentLine"},{"lineNumber":292,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":293,"author":{"gitId":"uyencfi"},"content":"    parseChildren(node, state, output)"},{"lineNumber":294,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":295,"author":{"gitId":"uyencfi"},"content":"    if (oldLine \u003d\u003d\u003d output.currentLine || output.currentLine.length \u003e 0) {"},{"lineNumber":296,"author":{"gitId":"uyencfi"},"content":"      output.newline(state)"},{"lineNumber":297,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":298,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":299,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":300,"author":{"gitId":"uyencfi"},"content":"  function parseStyle(state, styleString) {"},{"lineNumber":301,"author":{"gitId":"uyencfi"},"content":"    var textFormatting \u003d state.textFormatting"},{"lineNumber":302,"author":{"gitId":"uyencfi"},"content":"    var lineFormatting \u003d state.lineFormatting"},{"lineNumber":303,"author":{"gitId":"uyencfi"},"content":"    var styles \u003d styleString.split(\";\")"},{"lineNumber":304,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c styles.length; i++) {"},{"lineNumber":305,"author":{"gitId":"uyencfi"},"content":"      var stylePieces \u003d styles[i].split(\":\")"},{"lineNumber":306,"author":{"gitId":"uyencfi"},"content":"      if (stylePieces.length !\u003d\u003d 2) continue"},{"lineNumber":307,"author":{"gitId":"uyencfi"},"content":"      var prop \u003d utils.trim(stylePieces[0]).toLowerCase()"},{"lineNumber":308,"author":{"gitId":"uyencfi"},"content":"      var val \u003d utils.trim(stylePieces[1]).toLowerCase()"},{"lineNumber":309,"author":{"gitId":"uyencfi"},"content":"      switch (prop) {"},{"lineNumber":310,"author":{"gitId":"uyencfi"},"content":"        case \"text-decoration\":"},{"lineNumber":311,"author":{"gitId":"uyencfi"},"content":"          var underline \u003d val.indexOf(\"underline\") \u003e\u003d 0"},{"lineNumber":312,"author":{"gitId":"uyencfi"},"content":"          var strike \u003d val.indexOf(\"line-through\") \u003e\u003d 0"},{"lineNumber":313,"author":{"gitId":"uyencfi"},"content":"          textFormatting \u003d textFormatting.underline(underline).strike(strike)"},{"lineNumber":314,"author":{"gitId":"uyencfi"},"content":"          break"},{"lineNumber":315,"author":{"gitId":"uyencfi"},"content":"        case \"font-weight\":"},{"lineNumber":316,"author":{"gitId":"uyencfi"},"content":"          var bold \u003d val \u003d\u003d\u003d \"bold\" || parseInt(val) \u003e\u003d 600"},{"lineNumber":317,"author":{"gitId":"uyencfi"},"content":"          textFormatting \u003d textFormatting.bold(bold)"},{"lineNumber":318,"author":{"gitId":"uyencfi"},"content":"          break"},{"lineNumber":319,"author":{"gitId":"uyencfi"},"content":"        case \"font-style\":"},{"lineNumber":320,"author":{"gitId":"uyencfi"},"content":"          var italic \u003d val \u003d\u003d\u003d \"italic\" || val \u003d\u003d\u003d \"oblique\""},{"lineNumber":321,"author":{"gitId":"uyencfi"},"content":"          textFormatting \u003d textFormatting.italic(italic)"},{"lineNumber":322,"author":{"gitId":"uyencfi"},"content":"          break"},{"lineNumber":323,"author":{"gitId":"uyencfi"},"content":"        case \"color\":"},{"lineNumber":324,"author":{"gitId":"uyencfi"},"content":"          textFormatting \u003d textFormatting.color(val)"},{"lineNumber":325,"author":{"gitId":"uyencfi"},"content":"          break"},{"lineNumber":326,"author":{"gitId":"uyencfi"},"content":"        case \"background-color\":"},{"lineNumber":327,"author":{"gitId":"uyencfi"},"content":"          textFormatting \u003d textFormatting.backgroundColor(val)"},{"lineNumber":328,"author":{"gitId":"uyencfi"},"content":"          break"},{"lineNumber":329,"author":{"gitId":"uyencfi"},"content":"        case \"text-align\":"},{"lineNumber":330,"author":{"gitId":"uyencfi"},"content":"          lineFormatting \u003d lineFormatting.align(val)"},{"lineNumber":331,"author":{"gitId":"uyencfi"},"content":"          break"},{"lineNumber":332,"author":{"gitId":"uyencfi"},"content":"        case \"font-size\":"},{"lineNumber":333,"author":{"gitId":"uyencfi"},"content":"          var size \u003d null"},{"lineNumber":334,"author":{"gitId":"uyencfi"},"content":"          var allowedValues \u003d ["},{"lineNumber":335,"author":{"gitId":"uyencfi"},"content":"            \"px\","},{"lineNumber":336,"author":{"gitId":"uyencfi"},"content":"            \"pt\","},{"lineNumber":337,"author":{"gitId":"uyencfi"},"content":"            \"%\","},{"lineNumber":338,"author":{"gitId":"uyencfi"},"content":"            \"em\","},{"lineNumber":339,"author":{"gitId":"uyencfi"},"content":"            \"xx-small\","},{"lineNumber":340,"author":{"gitId":"uyencfi"},"content":"            \"x-small\","},{"lineNumber":341,"author":{"gitId":"uyencfi"},"content":"            \"small\","},{"lineNumber":342,"author":{"gitId":"uyencfi"},"content":"            \"medium\","},{"lineNumber":343,"author":{"gitId":"uyencfi"},"content":"            \"large\","},{"lineNumber":344,"author":{"gitId":"uyencfi"},"content":"            \"x-large\","},{"lineNumber":345,"author":{"gitId":"uyencfi"},"content":"            \"xx-large\","},{"lineNumber":346,"author":{"gitId":"uyencfi"},"content":"            \"smaller\","},{"lineNumber":347,"author":{"gitId":"uyencfi"},"content":"            \"larger\","},{"lineNumber":348,"author":{"gitId":"uyencfi"},"content":"          ]"},{"lineNumber":349,"author":{"gitId":"uyencfi"},"content":"          if (utils.stringEndsWith(val, allowedValues)) {"},{"lineNumber":350,"author":{"gitId":"uyencfi"},"content":"            size \u003d val"},{"lineNumber":351,"author":{"gitId":"uyencfi"},"content":"          } else if (parseInt(val)) {"},{"lineNumber":352,"author":{"gitId":"uyencfi"},"content":"            size \u003d parseInt(val) + \"px\""},{"lineNumber":353,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":354,"author":{"gitId":"uyencfi"},"content":"          if (size) {"},{"lineNumber":355,"author":{"gitId":"uyencfi"},"content":"            textFormatting \u003d textFormatting.fontSize(size)"},{"lineNumber":356,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":357,"author":{"gitId":"uyencfi"},"content":"          break"},{"lineNumber":358,"author":{"gitId":"uyencfi"},"content":"        case \"font-family\":"},{"lineNumber":359,"author":{"gitId":"uyencfi"},"content":"          var font \u003d utils.trim(val.split(\",\")[0]) // get first font."},{"lineNumber":360,"author":{"gitId":"uyencfi"},"content":"          font \u003d font.replace(/[\u0027\"]/g, \"\") // remove quotes."},{"lineNumber":361,"author":{"gitId":"uyencfi"},"content":"          font \u003d font.replace(/\\w\\S*/g, function (txt) {"},{"lineNumber":362,"author":{"gitId":"uyencfi"},"content":"            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()"},{"lineNumber":363,"author":{"gitId":"uyencfi"},"content":"          })"},{"lineNumber":364,"author":{"gitId":"uyencfi"},"content":"          textFormatting \u003d textFormatting.font(font)"},{"lineNumber":365,"author":{"gitId":"uyencfi"},"content":"          break"},{"lineNumber":366,"author":{"gitId":"uyencfi"},"content":"        default:"},{"lineNumber":367,"author":{"gitId":"uyencfi"},"content":"          break"},{"lineNumber":368,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":369,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":370,"author":{"gitId":"uyencfi"},"content":"    return state"},{"lineNumber":371,"author":{"gitId":"uyencfi"},"content":"      .withLineFormatting(lineFormatting)"},{"lineNumber":372,"author":{"gitId":"uyencfi"},"content":"      .withTextFormatting(textFormatting)"},{"lineNumber":373,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":374,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":375,"author":{"gitId":"uyencfi"},"content":"  return parseHtml"},{"lineNumber":376,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":376}},{"path":"frontend/src/components/collaboration/lib/serialize-html.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { utils } from \"./utils.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { LineFormatting } from \"./line-formatting.js\""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import { ATTR } from \"./constants.js\""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"import { TextOp } from \"./text-op.js\""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"import { Entity } from \"./entity.js\""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":" * Helper to turn Firebase contents into HMTL."},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":" * Takes a doc and an entity manager"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"export const SerializeHtml \u003d (function () {"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"  var { LIST_TYPE } \u003d LineFormatting"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"  var TODO_STYLE \u003d"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"    \u0027\u003cstyle\u003eul.firepad-todo { list-style: none; margin-left: 0; padding-left: 0; } ul.firepad-todo \u003e li { padding-left: 1em; text-indent: -1em; } ul.firepad-todo \u003e li:before { content: \"\\\\2610\"; padding-right: 5px; } ul.firepad-todo \u003e li.firepad-checked:before { content: \"\\\\2611\"; padding-right: 5px; }\u003c/style\u003e\\n\u0027"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"  function open(listType) {"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"    return listType \u003d\u003d\u003d LIST_TYPE.ORDERED"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"      ? \"\u003col\u003e\""},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"      : listType \u003d\u003d\u003d LIST_TYPE.UNORDERED"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"      ? \"\u003cul\u003e\""},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"      : \u0027\u003cul class\u003d\"firepad-todo\"\u003e\u0027"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"  function close(listType) {"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    return listType \u003d\u003d\u003d LIST_TYPE.ORDERED ? \"\u003c/ol\u003e\" : \"\u003c/ul\u003e\""},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"  function compatibleListType(l1, l2) {"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"    return ("},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"      l1 \u003d\u003d\u003d l2 ||"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"      (l1 \u003d\u003d\u003d LIST_TYPE.TODO \u0026\u0026 l2 \u003d\u003d\u003d LIST_TYPE.TODOCHECKED) ||"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"      (l1 \u003d\u003d\u003d LIST_TYPE.TODOCHECKED \u0026\u0026 l2 \u003d\u003d\u003d LIST_TYPE.TODO)"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"  function textToHtml(text) {"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"    return text"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"      .replace(/\u0026/g, \"\u0026amp;\")"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"      .replace(/\"/g, \"\u0026quot;\")"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"      .replace(/\u0027/g, \"\u0026#39;\")"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"      .replace(/\u003c/g, \"\u0026lt;\")"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"      .replace(/\u003e/g, \"\u0026gt;\")"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"      .replace(/\\u00a0/g, \"\u0026nbsp;\")"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"  function serializeHtml(doc, entityManager) {"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"    var html \u003d \"\""},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"    var newLine \u003d true"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"    var listTypeStack \u003d []"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"    var inListItem \u003d false"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    var firstLine \u003d true"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"    var emptyLine \u003d true"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"    var i \u003d 0,"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"      op \u003d doc.ops[i]"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"    var usesTodo \u003d false"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"    while (op) {"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"      utils.assert(op.isInsert())"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"      var attrs \u003d op.attributes"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"      if (newLine) {"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"        newLine \u003d false"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"        var indent \u003d 0,"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"          listType \u003d null,"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"          lineAlign \u003d \"left\""},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"        if (ATTR.LINE_SENTINEL in attrs) {"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"          indent \u003d attrs[ATTR.LINE_INDENT] || 0"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"          listType \u003d attrs[ATTR.LIST_TYPE] || null"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"          lineAlign \u003d attrs[ATTR.LINE_ALIGN] || \"left\""},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"        if (listType) {"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"          indent \u003d indent || 1 // lists are automatically indented at least 1."},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"        if (inListItem) {"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"          html +\u003d \"\u003c/li\u003e\""},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"          inListItem \u003d false"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"        } else if (!firstLine) {"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"          if (emptyLine) {"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"            html +\u003d \"\u003cbr/\u003e\""},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"          html +\u003d \"\u003c/div\u003e\""},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"        firstLine \u003d false"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"        // Close any extra lists."},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"        utils.assert(indent \u003e\u003d 0, \"Indent must not be negative.\")"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"        while ("},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"          listTypeStack.length \u003e indent ||"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"          (indent \u003d\u003d\u003d listTypeStack.length \u0026\u0026"},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"            listType !\u003d\u003d null \u0026\u0026"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"            !compatibleListType("},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"              listType,"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"              listTypeStack[listTypeStack.length - 1]"},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"            ))"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"        ) {"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"          html +\u003d close(listTypeStack.pop())"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"        // Open any needed lists."},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"        while (listTypeStack.length \u003c indent) {"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"          var toOpen \u003d listType || LIST_TYPE.UNORDERED // default to unordered lists for indenting non-list-item lines."},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"          usesTodo \u003d"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"            listType \u003d\u003d\u003d LIST_TYPE.TODO ||"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"            listType \u003d\u003d\u003d LIST_TYPE.TODOCHECKED ||"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"            usesTodo"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"          html +\u003d open(toOpen)"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"          listTypeStack.push(toOpen)"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"        var style \u003d"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"          lineAlign !\u003d\u003d \"left\" ? \u0027 style\u003d\"text-align:\u0027 + lineAlign + \u0027\"\u0027 : \"\""},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"        if (listType) {"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"          var clazz \u003d \"\""},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"          switch (listType) {"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"            case LIST_TYPE.TODOCHECKED:"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"              clazz \u003d \u0027 class\u003d\"firepad-checked\"\u0027"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"              break"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"            case LIST_TYPE.TODO:"},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"              clazz \u003d \u0027 class\u003d\"firepad-unchecked\"\u0027"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"              break"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"            default:"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"              break"},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"          html +\u003d \"\u003cli\" + clazz + style + \"\u003e\""},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":"          inListItem \u003d true"},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"          // start line div."},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"          html +\u003d \"\u003cdiv\" + style + \"\u003e\""},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"        emptyLine \u003d true"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"      if (ATTR.LINE_SENTINEL in attrs) {"},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"        op \u003d doc.ops[++i]"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":"        continue"},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":"      if (ATTR.ENTITY_SENTINEL in attrs) {"},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":"        for (var j \u003d 0; j \u003c op.text.length; j++) {"},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":"          var entity \u003d Entity.fromAttributes(attrs)"},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"          var element \u003d entityManager.exportToElement(entity)"},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":"          html +\u003d element.outerHTML"},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":"        op \u003d doc.ops[++i]"},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"        continue"},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"      var prefix \u003d \"\","},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":"        suffix \u003d \"\""},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":"      for (var attr in attrs) {"},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":"        var value \u003d attrs[attr]"},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":"        var start, end"},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":"        if ("},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":"          attr \u003d\u003d\u003d ATTR.BOLD ||"},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":"          attr \u003d\u003d\u003d ATTR.ITALIC ||"},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":"          attr \u003d\u003d\u003d ATTR.UNDERLINE ||"},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":"          attr \u003d\u003d\u003d ATTR.STRIKE"},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"        ) {"},{"lineNumber":161,"author":{"gitId":"uyencfi"},"content":"          utils.assert(value \u003d\u003d\u003d true)"},{"lineNumber":162,"author":{"gitId":"uyencfi"},"content":"          start \u003d end \u003d attr"},{"lineNumber":163,"author":{"gitId":"uyencfi"},"content":"        } else if (attr \u003d\u003d\u003d ATTR.FONT_SIZE) {"},{"lineNumber":164,"author":{"gitId":"uyencfi"},"content":"          start \u003d \u0027span style\u003d\"font-size: \u0027 + value"},{"lineNumber":165,"author":{"gitId":"uyencfi"},"content":"          start +\u003d"},{"lineNumber":166,"author":{"gitId":"uyencfi"},"content":"            typeof value !\u003d\u003d \"string\" ||"},{"lineNumber":167,"author":{"gitId":"uyencfi"},"content":"            value.indexOf(\"px\", value.length - 2) \u003d\u003d\u003d -1"},{"lineNumber":168,"author":{"gitId":"uyencfi"},"content":"              ? \u0027px\"\u0027"},{"lineNumber":169,"author":{"gitId":"uyencfi"},"content":"              : \u0027\"\u0027"},{"lineNumber":170,"author":{"gitId":"uyencfi"},"content":"          end \u003d \"span\""},{"lineNumber":171,"author":{"gitId":"uyencfi"},"content":"        } else if (attr \u003d\u003d\u003d ATTR.FONT) {"},{"lineNumber":172,"author":{"gitId":"uyencfi"},"content":"          start \u003d \u0027span style\u003d\"font-family: \u0027 + value + \u0027\"\u0027"},{"lineNumber":173,"author":{"gitId":"uyencfi"},"content":"          end \u003d \"span\""},{"lineNumber":174,"author":{"gitId":"uyencfi"},"content":"        } else if (attr \u003d\u003d\u003d ATTR.COLOR) {"},{"lineNumber":175,"author":{"gitId":"uyencfi"},"content":"          start \u003d \u0027span style\u003d\"color: \u0027 + value + \u0027\"\u0027"},{"lineNumber":176,"author":{"gitId":"uyencfi"},"content":"          end \u003d \"span\""},{"lineNumber":177,"author":{"gitId":"uyencfi"},"content":"        } else if (attr \u003d\u003d\u003d ATTR.BACKGROUND_COLOR) {"},{"lineNumber":178,"author":{"gitId":"uyencfi"},"content":"          start \u003d \u0027span style\u003d\"background-color: \u0027 + value + \u0027\"\u0027"},{"lineNumber":179,"author":{"gitId":"uyencfi"},"content":"          end \u003d \"span\""},{"lineNumber":180,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":181,"author":{"gitId":"uyencfi"},"content":"          utils.log("},{"lineNumber":182,"author":{"gitId":"uyencfi"},"content":"            false,"},{"lineNumber":183,"author":{"gitId":"uyencfi"},"content":"            \"Encountered unknown attribute while rendering html: \" + attr"},{"lineNumber":184,"author":{"gitId":"uyencfi"},"content":"          )"},{"lineNumber":185,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":186,"author":{"gitId":"uyencfi"},"content":"        if (start) prefix +\u003d \"\u003c\" + start + \"\u003e\""},{"lineNumber":187,"author":{"gitId":"uyencfi"},"content":"        if (end) suffix \u003d \"\u003c/\" + end + \"\u003e\" + suffix"},{"lineNumber":188,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":189,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":190,"author":{"gitId":"uyencfi"},"content":"      var text \u003d op.text"},{"lineNumber":191,"author":{"gitId":"uyencfi"},"content":"      var newLineIndex \u003d text.indexOf(\"\\n\")"},{"lineNumber":192,"author":{"gitId":"uyencfi"},"content":"      if (newLineIndex \u003e\u003d 0) {"},{"lineNumber":193,"author":{"gitId":"uyencfi"},"content":"        newLine \u003d true"},{"lineNumber":194,"author":{"gitId":"uyencfi"},"content":"        if (newLineIndex \u003c text.length - 1) {"},{"lineNumber":195,"author":{"gitId":"uyencfi"},"content":"          // split op."},{"lineNumber":196,"author":{"gitId":"uyencfi"},"content":"          op \u003d new TextOp(\"insert\", text.substr(newLineIndex + 1), attrs)"},{"lineNumber":197,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":198,"author":{"gitId":"uyencfi"},"content":"          op \u003d doc.ops[++i]"},{"lineNumber":199,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":200,"author":{"gitId":"uyencfi"},"content":"        text \u003d text.substr(0, newLineIndex)"},{"lineNumber":201,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":202,"author":{"gitId":"uyencfi"},"content":"        op \u003d doc.ops[++i]"},{"lineNumber":203,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":204,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":205,"author":{"gitId":"uyencfi"},"content":"      // Replace leading, trailing, and consecutive spaces with nbsp\u0027s to make sure they\u0027re preserved."},{"lineNumber":206,"author":{"gitId":"uyencfi"},"content":"      text \u003d text"},{"lineNumber":207,"author":{"gitId":"uyencfi"},"content":"        .replace(/  +/g, function (str) {"},{"lineNumber":208,"author":{"gitId":"uyencfi"},"content":"          return new Array(str.length + 1).join(\"\\u00a0\")"},{"lineNumber":209,"author":{"gitId":"uyencfi"},"content":"        })"},{"lineNumber":210,"author":{"gitId":"uyencfi"},"content":"        .replace(/^ /, \"\\u00a0\")"},{"lineNumber":211,"author":{"gitId":"uyencfi"},"content":"        .replace(/ $/, \"\\u00a0\")"},{"lineNumber":212,"author":{"gitId":"uyencfi"},"content":"      if (text.length \u003e 0) {"},{"lineNumber":213,"author":{"gitId":"uyencfi"},"content":"        emptyLine \u003d false"},{"lineNumber":214,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":215,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":216,"author":{"gitId":"uyencfi"},"content":"      html +\u003d prefix + textToHtml(text) + suffix"},{"lineNumber":217,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":218,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":219,"author":{"gitId":"uyencfi"},"content":"    if (inListItem) {"},{"lineNumber":220,"author":{"gitId":"uyencfi"},"content":"      html +\u003d \"\u003c/li\u003e\""},{"lineNumber":221,"author":{"gitId":"uyencfi"},"content":"    } else if (!firstLine) {"},{"lineNumber":222,"author":{"gitId":"uyencfi"},"content":"      if (emptyLine) {"},{"lineNumber":223,"author":{"gitId":"uyencfi"},"content":"        html +\u003d \"\u0026nbsp;\""},{"lineNumber":224,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":225,"author":{"gitId":"uyencfi"},"content":"      html +\u003d \"\u003c/div\u003e\""},{"lineNumber":226,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":227,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":228,"author":{"gitId":"uyencfi"},"content":"    // Close any extra lists."},{"lineNumber":229,"author":{"gitId":"uyencfi"},"content":"    while (listTypeStack.length \u003e 0) {"},{"lineNumber":230,"author":{"gitId":"uyencfi"},"content":"      html +\u003d close(listTypeStack.pop())"},{"lineNumber":231,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":232,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":233,"author":{"gitId":"uyencfi"},"content":"    if (usesTodo) {"},{"lineNumber":234,"author":{"gitId":"uyencfi"},"content":"      html \u003d TODO_STYLE + html"},{"lineNumber":235,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":236,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":237,"author":{"gitId":"uyencfi"},"content":"    return html"},{"lineNumber":238,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":239,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":240,"author":{"gitId":"uyencfi"},"content":"  return serializeHtml"},{"lineNumber":241,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":241}},{"path":"frontend/src/components/collaboration/lib/span.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"export const Span \u003d (function () {"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"  function Span(pos, length) {"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"    this.pos \u003d pos"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"    this.length \u003d length"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  Span.prototype.end \u003d function () {"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    return this.pos + this.length"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"  return Span"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":12}},{"path":"frontend/src/components/collaboration/lib/text-op.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { utils } from \"./utils.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"export const TextOp \u003d (function () {"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"  // Operation are essentially lists of ops. There are three types of ops:"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"  //"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  // * Retain ops: Advance the cursor position by a given number of characters."},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  //   Represented by positive ints."},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"  // * Insert ops: Insert a given string at the current cursor position."},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  //   Represented by strings."},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"  // * Delete ops: Delete the next n characters. Represented by negative ints."},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"  function TextOp(type) {"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"    this.type \u003d type"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"    this.chars \u003d null"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"    this.text \u003d null"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    this.attributes \u003d null"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"    if (type \u003d\u003d\u003d \"insert\") {"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"      this.text \u003d arguments[1]"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"      utils.assert(typeof this.text \u003d\u003d\u003d \"string\")"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"      this.attributes \u003d arguments[2] || {}"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"      utils.assert(typeof this.attributes \u003d\u003d\u003d \"object\")"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"    } else if (type \u003d\u003d\u003d \"delete\") {"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"      this.chars \u003d arguments[1]"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"      utils.assert(typeof this.chars \u003d\u003d\u003d \"number\")"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    } else if (type \u003d\u003d\u003d \"retain\") {"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"      this.chars \u003d arguments[1]"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"      utils.assert(typeof this.chars \u003d\u003d\u003d \"number\")"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"      this.attributes \u003d arguments[2] || {}"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"      utils.assert(typeof this.attributes \u003d\u003d\u003d \"object\")"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"  TextOp.prototype.isInsert \u003d function () {"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"    return this.type \u003d\u003d\u003d \"insert\""},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"  TextOp.prototype.isDelete \u003d function () {"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"    return this.type \u003d\u003d\u003d \"delete\""},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"  TextOp.prototype.isRetain \u003d function () {"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"    return this.type \u003d\u003d\u003d \"retain\""},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"  TextOp.prototype.equals \u003d function (other) {"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"    return ("},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"      this.type \u003d\u003d\u003d other.type \u0026\u0026"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"      this.text \u003d\u003d\u003d other.text \u0026\u0026"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"      this.chars \u003d\u003d\u003d other.chars \u0026\u0026"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"      this.attributesEqual(other.attributes)"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"  TextOp.prototype.attributesEqual \u003d function (otherAttributes) {"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"    for (var attr in this.attributes) {"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"      if (this.attributes[attr] !\u003d\u003d otherAttributes[attr]) {"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"        return false"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"    for (attr in otherAttributes) {"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"      if (this.attributes[attr] !\u003d\u003d otherAttributes[attr]) {"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"        return false"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"    return true"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"  TextOp.prototype.hasEmptyAttributes \u003d function () {"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"    var empty \u003d true"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"    // eslint-disable-next-line no-unused-vars"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"    for (var attr in this.attributes) {"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"      empty \u003d false"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"      break"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"    return empty"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"  return TextOp"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":80}},{"path":"frontend/src/components/collaboration/lib/text-operation.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { utils } from \"./utils.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { TextOp } from \"./text-op.js\""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"export const TextOperation \u003d (function () {"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  // Constructor for new operations."},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  function TextOperation() {"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    if (!this || this.constructor !\u003d\u003d TextOperation) {"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"      // \u003d\u003e function was called without \u0027new\u0027"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"      return new TextOperation()"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"    // When an operation is applied to an input string, you can think of this as"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"    // if an imaginary cursor runs over the entire string and skips over some"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    // parts, deletes some parts and inserts characters at some positions. These"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"    // actions (skip/delete/insert) are stored as an array in the \"ops\" property."},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"    this.ops \u003d []"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"    // An operation\u0027s baseLength is the length of every string the operation"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"    // can be applied to."},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    this.baseLength \u003d 0"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"    // The targetLength is the length of every string that results from applying"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"    // the operation on a valid input string."},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    this.targetLength \u003d 0"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.equals \u003d function (other) {"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"    if (this.baseLength !\u003d\u003d other.baseLength) {"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"      return false"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    if (this.targetLength !\u003d\u003d other.targetLength) {"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"      return false"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"    if (this.ops.length !\u003d\u003d other.ops.length) {"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"      return false"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c this.ops.length; i++) {"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"      if (!this.ops[i].equals(other.ops[i])) {"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"        return false"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"    return true"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"  // After an operation is constructed, the user of the library can specify the"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"  // actions of an operation (skip/insert/delete) with these three builder"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"  // methods. They all return the operation for convenient chaining."},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"  // Skip over a given number of characters."},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.retain \u003d function (n, attributes) {"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"    if (typeof n !\u003d\u003d \"number\" || n \u003c 0) {"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\"retain expects a positive integer.\")"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"    if (n \u003d\u003d\u003d 0) {"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"      return this"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"    this.baseLength +\u003d n"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"    this.targetLength +\u003d n"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"    attributes \u003d attributes || {}"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"    var prevOp \u003d this.ops.length \u003e 0 ? this.ops[this.ops.length - 1] : null"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"    if (prevOp \u0026\u0026 prevOp.isRetain() \u0026\u0026 prevOp.attributesEqual(attributes)) {"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"      // The last op is a retain op with the same attributes \u003d\u003e we can merge them into one op."},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"      prevOp.chars +\u003d n"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"      // Create a new op."},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"      this.ops.push(new TextOp(\"retain\", n, attributes))"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"    return this"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"  // Insert a string at the current position."},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.insert \u003d function (str, attributes) {"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"    if (typeof str !\u003d\u003d \"string\") {"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\"insert expects a string\")"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"    if (str \u003d\u003d\u003d \"\") {"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"      return this"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"    attributes \u003d attributes || {}"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"    this.targetLength +\u003d str.length"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"    var prevOp \u003d this.ops.length \u003e 0 ? this.ops[this.ops.length - 1] : null"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"    var prevPrevOp \u003d this.ops.length \u003e 1 ? this.ops[this.ops.length - 2] : null"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"    if (prevOp \u0026\u0026 prevOp.isInsert() \u0026\u0026 prevOp.attributesEqual(attributes)) {"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"      // Merge insert op."},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"      prevOp.text +\u003d str"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"    } else if (prevOp \u0026\u0026 prevOp.isDelete()) {"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"      // It doesn\u0027t matter when an operation is applied whether the operation"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"      // is delete(3), insert(\"something\") or insert(\"something\"), delete(3)."},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"      // Here we enforce that in this case, the insert op always comes first."},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"      // This makes all operations that have the same effect when applied to"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"      // a document of the right length equal in respect to the `equals` method."},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"      if ("},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"        prevPrevOp \u0026\u0026"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"        prevPrevOp.isInsert() \u0026\u0026"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"        prevPrevOp.attributesEqual(attributes)"},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"      ) {"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"        prevPrevOp.text +\u003d str"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"        this.ops[this.ops.length - 1] \u003d new TextOp(\"insert\", str, attributes)"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"        this.ops.push(prevOp)"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"      this.ops.push(new TextOp(\"insert\", str, attributes))"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"    return this"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"  // Delete a string at the current position."},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype[\"delete\"] \u003d function (n) {"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"    if (typeof n \u003d\u003d\u003d \"string\") {"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"      n \u003d n.length"},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"    if (typeof n !\u003d\u003d \"number\" || n \u003c 0) {"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\"delete expects a positive integer or a string\")"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"    if (n \u003d\u003d\u003d 0) {"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"      return this"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"    this.baseLength +\u003d n"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"    var prevOp \u003d this.ops.length \u003e 0 ? this.ops[this.ops.length - 1] : null"},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"    if (prevOp \u0026\u0026 prevOp.isDelete()) {"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"      prevOp.chars +\u003d n"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"      this.ops.push(new TextOp(\"delete\", n))"},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"    return this"},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"  // Tests whether this operation has no effect."},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.isNoop \u003d function () {"},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"    return ("},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"      this.ops.length \u003d\u003d\u003d 0 ||"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"      (this.ops.length \u003d\u003d\u003d 1 \u0026\u0026"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":"        this.ops[0].isRetain() \u0026\u0026"},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"        this.ops[0].hasEmptyAttributes())"},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.clone \u003d function () {"},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":"    var clone \u003d new TextOperation()"},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c this.ops.length; i++) {"},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":"      if (this.ops[i].isRetain()) {"},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"        clone.retain(this.ops[i].chars, this.ops[i].attributes)"},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":"      } else if (this.ops[i].isInsert()) {"},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":"        clone.insert(this.ops[i].text, this.ops[i].attributes)"},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":"        clone[\"delete\"](this.ops[i].chars)"},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"    return clone"},{"lineNumber":151,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":152,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":153,"author":{"gitId":"uyencfi"},"content":"  // Pretty printing."},{"lineNumber":154,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.toString \u003d function () {"},{"lineNumber":155,"author":{"gitId":"uyencfi"},"content":"    // map: build a new array by applying a function to every element in an old"},{"lineNumber":156,"author":{"gitId":"uyencfi"},"content":"    // array."},{"lineNumber":157,"author":{"gitId":"uyencfi"},"content":"    var map \u003d"},{"lineNumber":158,"author":{"gitId":"uyencfi"},"content":"      Array.prototype.map ||"},{"lineNumber":159,"author":{"gitId":"uyencfi"},"content":"      function (fn) {"},{"lineNumber":160,"author":{"gitId":"uyencfi"},"content":"        var arr \u003d this"},{"lineNumber":161,"author":{"gitId":"uyencfi"},"content":"        var newArr \u003d []"},{"lineNumber":162,"author":{"gitId":"uyencfi"},"content":"        for (var i \u003d 0, l \u003d arr.length; i \u003c l; i++) {"},{"lineNumber":163,"author":{"gitId":"uyencfi"},"content":"          newArr[i] \u003d fn(arr[i])"},{"lineNumber":164,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":165,"author":{"gitId":"uyencfi"},"content":"        return newArr"},{"lineNumber":166,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":167,"author":{"gitId":"uyencfi"},"content":"    return map"},{"lineNumber":168,"author":{"gitId":"uyencfi"},"content":"      .call(this.ops, function (op) {"},{"lineNumber":169,"author":{"gitId":"uyencfi"},"content":"        if (op.isRetain()) {"},{"lineNumber":170,"author":{"gitId":"uyencfi"},"content":"          return \"retain \" + op.chars"},{"lineNumber":171,"author":{"gitId":"uyencfi"},"content":"        } else if (op.isInsert()) {"},{"lineNumber":172,"author":{"gitId":"uyencfi"},"content":"          return \"insert \u0027\" + op.text + \"\u0027\""},{"lineNumber":173,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":174,"author":{"gitId":"uyencfi"},"content":"          return \"delete \" + op.chars"},{"lineNumber":175,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":176,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":177,"author":{"gitId":"uyencfi"},"content":"      .join(\", \")"},{"lineNumber":178,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":179,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":180,"author":{"gitId":"uyencfi"},"content":"  // Converts operation into a JSON value."},{"lineNumber":181,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.toJSON \u003d function () {"},{"lineNumber":182,"author":{"gitId":"uyencfi"},"content":"    var ops \u003d []"},{"lineNumber":183,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c this.ops.length; i++) {"},{"lineNumber":184,"author":{"gitId":"uyencfi"},"content":"      // We prefix ops with their attributes if non-empty."},{"lineNumber":185,"author":{"gitId":"uyencfi"},"content":"      if (!this.ops[i].hasEmptyAttributes()) {"},{"lineNumber":186,"author":{"gitId":"uyencfi"},"content":"        ops.push(this.ops[i].attributes)"},{"lineNumber":187,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":188,"author":{"gitId":"uyencfi"},"content":"      if (this.ops[i].type \u003d\u003d\u003d \"retain\") {"},{"lineNumber":189,"author":{"gitId":"uyencfi"},"content":"        ops.push(this.ops[i].chars)"},{"lineNumber":190,"author":{"gitId":"uyencfi"},"content":"      } else if (this.ops[i].type \u003d\u003d\u003d \"insert\") {"},{"lineNumber":191,"author":{"gitId":"uyencfi"},"content":"        ops.push(this.ops[i].text)"},{"lineNumber":192,"author":{"gitId":"uyencfi"},"content":"      } else if (this.ops[i].type \u003d\u003d\u003d \"delete\") {"},{"lineNumber":193,"author":{"gitId":"uyencfi"},"content":"        ops.push(-this.ops[i].chars)"},{"lineNumber":194,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":195,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":196,"author":{"gitId":"uyencfi"},"content":"    // Return an array with /something/ in it, since an empty array will be treated as null by Firebase."},{"lineNumber":197,"author":{"gitId":"uyencfi"},"content":"    if (ops.length \u003d\u003d\u003d 0) {"},{"lineNumber":198,"author":{"gitId":"uyencfi"},"content":"      ops.push(0)"},{"lineNumber":199,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":200,"author":{"gitId":"uyencfi"},"content":"    return ops"},{"lineNumber":201,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":202,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":203,"author":{"gitId":"uyencfi"},"content":"  // Converts a plain JS object into an operation and validates it."},{"lineNumber":204,"author":{"gitId":"uyencfi"},"content":"  TextOperation.fromJSON \u003d function (ops) {"},{"lineNumber":205,"author":{"gitId":"uyencfi"},"content":"    var o \u003d new TextOperation()"},{"lineNumber":206,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0, l \u003d ops.length; i \u003c l; i++) {"},{"lineNumber":207,"author":{"gitId":"uyencfi"},"content":"      var op \u003d ops[i]"},{"lineNumber":208,"author":{"gitId":"uyencfi"},"content":"      var attributes \u003d {}"},{"lineNumber":209,"author":{"gitId":"uyencfi"},"content":"      if (typeof op \u003d\u003d\u003d \"object\") {"},{"lineNumber":210,"author":{"gitId":"uyencfi"},"content":"        attributes \u003d op"},{"lineNumber":211,"author":{"gitId":"uyencfi"},"content":"        i++"},{"lineNumber":212,"author":{"gitId":"uyencfi"},"content":"        op \u003d ops[i]"},{"lineNumber":213,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":214,"author":{"gitId":"uyencfi"},"content":"      if (typeof op \u003d\u003d\u003d \"number\") {"},{"lineNumber":215,"author":{"gitId":"uyencfi"},"content":"        if (op \u003e 0) {"},{"lineNumber":216,"author":{"gitId":"uyencfi"},"content":"          o.retain(op, attributes)"},{"lineNumber":217,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":218,"author":{"gitId":"uyencfi"},"content":"          o[\"delete\"](-op)"},{"lineNumber":219,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":220,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":221,"author":{"gitId":"uyencfi"},"content":"        utils.assert(typeof op \u003d\u003d\u003d \"string\")"},{"lineNumber":222,"author":{"gitId":"uyencfi"},"content":"        o.insert(op, attributes)"},{"lineNumber":223,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":224,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":225,"author":{"gitId":"uyencfi"},"content":"    return o"},{"lineNumber":226,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":227,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":228,"author":{"gitId":"uyencfi"},"content":"  // Apply an operation to a string, returning a new string. Throws an error if"},{"lineNumber":229,"author":{"gitId":"uyencfi"},"content":"  // there\u0027s a mismatch between the input string and the operation."},{"lineNumber":230,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.apply \u003d function (str, oldAttributes, newAttributes) {"},{"lineNumber":231,"author":{"gitId":"uyencfi"},"content":"    var operation \u003d this"},{"lineNumber":232,"author":{"gitId":"uyencfi"},"content":"    oldAttributes \u003d oldAttributes || []"},{"lineNumber":233,"author":{"gitId":"uyencfi"},"content":"    newAttributes \u003d newAttributes || []"},{"lineNumber":234,"author":{"gitId":"uyencfi"},"content":"    if (str.length !\u003d\u003d operation.baseLength) {"},{"lineNumber":235,"author":{"gitId":"uyencfi"},"content":"      throw new Error("},{"lineNumber":236,"author":{"gitId":"uyencfi"},"content":"        \"The operation\u0027s base length must be equal to the string\u0027s length.\""},{"lineNumber":237,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":238,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":239,"author":{"gitId":"uyencfi"},"content":"    var newStringParts \u003d [],"},{"lineNumber":240,"author":{"gitId":"uyencfi"},"content":"      j \u003d 0,"},{"lineNumber":241,"author":{"gitId":"uyencfi"},"content":"      k,"},{"lineNumber":242,"author":{"gitId":"uyencfi"},"content":"      attr"},{"lineNumber":243,"author":{"gitId":"uyencfi"},"content":"    var oldIndex \u003d 0"},{"lineNumber":244,"author":{"gitId":"uyencfi"},"content":"    var ops \u003d this.ops"},{"lineNumber":245,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0, l \u003d ops.length; i \u003c l; i++) {"},{"lineNumber":246,"author":{"gitId":"uyencfi"},"content":"      var op \u003d ops[i]"},{"lineNumber":247,"author":{"gitId":"uyencfi"},"content":"      if (op.isRetain()) {"},{"lineNumber":248,"author":{"gitId":"uyencfi"},"content":"        if (oldIndex + op.chars \u003e str.length) {"},{"lineNumber":249,"author":{"gitId":"uyencfi"},"content":"          throw new Error("},{"lineNumber":250,"author":{"gitId":"uyencfi"},"content":"            \"Operation can\u0027t retain more characters than are left in the string.\""},{"lineNumber":251,"author":{"gitId":"uyencfi"},"content":"          )"},{"lineNumber":252,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":253,"author":{"gitId":"uyencfi"},"content":"        // Copy skipped part of the retained string."},{"lineNumber":254,"author":{"gitId":"uyencfi"},"content":"        newStringParts[j++] \u003d str.slice(oldIndex, oldIndex + op.chars)"},{"lineNumber":255,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":256,"author":{"gitId":"uyencfi"},"content":"        // Copy (and potentially update) attributes for each char in retained string."},{"lineNumber":257,"author":{"gitId":"uyencfi"},"content":"        for (k \u003d 0; k \u003c op.chars; k++) {"},{"lineNumber":258,"author":{"gitId":"uyencfi"},"content":"          var currAttributes \u003d oldAttributes[oldIndex + k] || {},"},{"lineNumber":259,"author":{"gitId":"uyencfi"},"content":"            updatedAttributes \u003d {}"},{"lineNumber":260,"author":{"gitId":"uyencfi"},"content":"          for (attr in currAttributes) {"},{"lineNumber":261,"author":{"gitId":"uyencfi"},"content":"            updatedAttributes[attr] \u003d currAttributes[attr]"},{"lineNumber":262,"author":{"gitId":"uyencfi"},"content":"            utils.assert(updatedAttributes[attr] !\u003d\u003d false)"},{"lineNumber":263,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":264,"author":{"gitId":"uyencfi"},"content":"          for (attr in op.attributes) {"},{"lineNumber":265,"author":{"gitId":"uyencfi"},"content":"            if (op.attributes[attr] \u003d\u003d\u003d false) {"},{"lineNumber":266,"author":{"gitId":"uyencfi"},"content":"              delete updatedAttributes[attr]"},{"lineNumber":267,"author":{"gitId":"uyencfi"},"content":"            } else {"},{"lineNumber":268,"author":{"gitId":"uyencfi"},"content":"              updatedAttributes[attr] \u003d op.attributes[attr]"},{"lineNumber":269,"author":{"gitId":"uyencfi"},"content":"            }"},{"lineNumber":270,"author":{"gitId":"uyencfi"},"content":"            utils.assert(updatedAttributes[attr] !\u003d\u003d false)"},{"lineNumber":271,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":272,"author":{"gitId":"uyencfi"},"content":"          newAttributes.push(updatedAttributes)"},{"lineNumber":273,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":274,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":275,"author":{"gitId":"uyencfi"},"content":"        oldIndex +\u003d op.chars"},{"lineNumber":276,"author":{"gitId":"uyencfi"},"content":"      } else if (op.isInsert()) {"},{"lineNumber":277,"author":{"gitId":"uyencfi"},"content":"        // Insert string."},{"lineNumber":278,"author":{"gitId":"uyencfi"},"content":"        newStringParts[j++] \u003d op.text"},{"lineNumber":279,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":280,"author":{"gitId":"uyencfi"},"content":"        // Insert attributes for each char."},{"lineNumber":281,"author":{"gitId":"uyencfi"},"content":"        for (k \u003d 0; k \u003c op.text.length; k++) {"},{"lineNumber":282,"author":{"gitId":"uyencfi"},"content":"          var insertedAttributes \u003d {}"},{"lineNumber":283,"author":{"gitId":"uyencfi"},"content":"          for (attr in op.attributes) {"},{"lineNumber":284,"author":{"gitId":"uyencfi"},"content":"            insertedAttributes[attr] \u003d op.attributes[attr]"},{"lineNumber":285,"author":{"gitId":"uyencfi"},"content":"            utils.assert(insertedAttributes[attr] !\u003d\u003d false)"},{"lineNumber":286,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":287,"author":{"gitId":"uyencfi"},"content":"          newAttributes.push(insertedAttributes)"},{"lineNumber":288,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":289,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":290,"author":{"gitId":"uyencfi"},"content":"        // delete op"},{"lineNumber":291,"author":{"gitId":"uyencfi"},"content":"        oldIndex +\u003d op.chars"},{"lineNumber":292,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":293,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":294,"author":{"gitId":"uyencfi"},"content":"    if (oldIndex !\u003d\u003d str.length) {"},{"lineNumber":295,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\"The operation didn\u0027t operate on the whole string.\")"},{"lineNumber":296,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":297,"author":{"gitId":"uyencfi"},"content":"    var newString \u003d newStringParts.join(\"\")"},{"lineNumber":298,"author":{"gitId":"uyencfi"},"content":"    utils.assert(newString.length \u003d\u003d\u003d newAttributes.length)"},{"lineNumber":299,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":300,"author":{"gitId":"uyencfi"},"content":"    return newString"},{"lineNumber":301,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":302,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":303,"author":{"gitId":"uyencfi"},"content":"  // Computes the inverse of an operation. The inverse of an operation is the"},{"lineNumber":304,"author":{"gitId":"uyencfi"},"content":"  // operation that reverts the effects of the operation, e.g. when you have an"},{"lineNumber":305,"author":{"gitId":"uyencfi"},"content":"  // operation \u0027insert(\"hello \"); skip(6);\u0027 then the inverse is \u0027delete(\"hello \");"},{"lineNumber":306,"author":{"gitId":"uyencfi"},"content":"  // skip(6);\u0027. The inverse should be used for implementing undo."},{"lineNumber":307,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.invert \u003d function (str) {"},{"lineNumber":308,"author":{"gitId":"uyencfi"},"content":"    var strIndex \u003d 0"},{"lineNumber":309,"author":{"gitId":"uyencfi"},"content":"    var inverse \u003d new TextOperation()"},{"lineNumber":310,"author":{"gitId":"uyencfi"},"content":"    var ops \u003d this.ops"},{"lineNumber":311,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0, l \u003d ops.length; i \u003c l; i++) {"},{"lineNumber":312,"author":{"gitId":"uyencfi"},"content":"      var op \u003d ops[i]"},{"lineNumber":313,"author":{"gitId":"uyencfi"},"content":"      if (op.isRetain()) {"},{"lineNumber":314,"author":{"gitId":"uyencfi"},"content":"        inverse.retain(op.chars)"},{"lineNumber":315,"author":{"gitId":"uyencfi"},"content":"        strIndex +\u003d op.chars"},{"lineNumber":316,"author":{"gitId":"uyencfi"},"content":"      } else if (op.isInsert()) {"},{"lineNumber":317,"author":{"gitId":"uyencfi"},"content":"        inverse[\"delete\"](op.text.length)"},{"lineNumber":318,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":319,"author":{"gitId":"uyencfi"},"content":"        // delete op"},{"lineNumber":320,"author":{"gitId":"uyencfi"},"content":"        inverse.insert(str.slice(strIndex, strIndex + op.chars))"},{"lineNumber":321,"author":{"gitId":"uyencfi"},"content":"        strIndex +\u003d op.chars"},{"lineNumber":322,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":323,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":324,"author":{"gitId":"uyencfi"},"content":"    return inverse"},{"lineNumber":325,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":326,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":327,"author":{"gitId":"uyencfi"},"content":"  // Compose merges two consecutive operations into one operation, that"},{"lineNumber":328,"author":{"gitId":"uyencfi"},"content":"  // preserves the changes of both. Or, in other words, for each input string S"},{"lineNumber":329,"author":{"gitId":"uyencfi"},"content":"  // and a pair of consecutive operations A and B,"},{"lineNumber":330,"author":{"gitId":"uyencfi"},"content":"  // apply(apply(S, A), B) \u003d apply(S, compose(A, B)) must hold."},{"lineNumber":331,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.compose \u003d function (operation2) {"},{"lineNumber":332,"author":{"gitId":"uyencfi"},"content":"    var operation1 \u003d this"},{"lineNumber":333,"author":{"gitId":"uyencfi"},"content":"    if (operation1.targetLength !\u003d\u003d operation2.baseLength) {"},{"lineNumber":334,"author":{"gitId":"uyencfi"},"content":"      throw new Error("},{"lineNumber":335,"author":{"gitId":"uyencfi"},"content":"        \"The base length of the second operation has to be the target length of the first operation\""},{"lineNumber":336,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":337,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":338,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":339,"author":{"gitId":"uyencfi"},"content":"    function composeAttributes(first, second, firstOpIsInsert) {"},{"lineNumber":340,"author":{"gitId":"uyencfi"},"content":"      var merged \u003d {},"},{"lineNumber":341,"author":{"gitId":"uyencfi"},"content":"        attr"},{"lineNumber":342,"author":{"gitId":"uyencfi"},"content":"      for (attr in first) {"},{"lineNumber":343,"author":{"gitId":"uyencfi"},"content":"        merged[attr] \u003d first[attr]"},{"lineNumber":344,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":345,"author":{"gitId":"uyencfi"},"content":"      for (attr in second) {"},{"lineNumber":346,"author":{"gitId":"uyencfi"},"content":"        if (firstOpIsInsert \u0026\u0026 second[attr] \u003d\u003d\u003d false) {"},{"lineNumber":347,"author":{"gitId":"uyencfi"},"content":"          delete merged[attr]"},{"lineNumber":348,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":349,"author":{"gitId":"uyencfi"},"content":"          merged[attr] \u003d second[attr]"},{"lineNumber":350,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":351,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":352,"author":{"gitId":"uyencfi"},"content":"      return merged"},{"lineNumber":353,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":354,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":355,"author":{"gitId":"uyencfi"},"content":"    var operation \u003d new TextOperation() // the combined operation"},{"lineNumber":356,"author":{"gitId":"uyencfi"},"content":"    var ops1 \u003d operation1.clone().ops,"},{"lineNumber":357,"author":{"gitId":"uyencfi"},"content":"      ops2 \u003d operation2.clone().ops"},{"lineNumber":358,"author":{"gitId":"uyencfi"},"content":"    var i1 \u003d 0,"},{"lineNumber":359,"author":{"gitId":"uyencfi"},"content":"      i2 \u003d 0 // current index into ops1 respectively ops2"},{"lineNumber":360,"author":{"gitId":"uyencfi"},"content":"    var op1 \u003d ops1[i1++],"},{"lineNumber":361,"author":{"gitId":"uyencfi"},"content":"      op2 \u003d ops2[i2++] // current ops"},{"lineNumber":362,"author":{"gitId":"uyencfi"},"content":"    var attributes"},{"lineNumber":363,"author":{"gitId":"uyencfi"},"content":"    while (true) {"},{"lineNumber":364,"author":{"gitId":"uyencfi"},"content":"      // Dispatch on the type of op1 and op2"},{"lineNumber":365,"author":{"gitId":"uyencfi"},"content":"      if (typeof op1 \u003d\u003d\u003d \"undefined\" \u0026\u0026 typeof op2 \u003d\u003d\u003d \"undefined\") {"},{"lineNumber":366,"author":{"gitId":"uyencfi"},"content":"        // end condition: both ops1 and ops2 have been processed"},{"lineNumber":367,"author":{"gitId":"uyencfi"},"content":"        break"},{"lineNumber":368,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":369,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":370,"author":{"gitId":"uyencfi"},"content":"      if (op1 \u0026\u0026 op1.isDelete()) {"},{"lineNumber":371,"author":{"gitId":"uyencfi"},"content":"        operation[\"delete\"](op1.chars)"},{"lineNumber":372,"author":{"gitId":"uyencfi"},"content":"        op1 \u003d ops1[i1++]"},{"lineNumber":373,"author":{"gitId":"uyencfi"},"content":"        continue"},{"lineNumber":374,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":375,"author":{"gitId":"uyencfi"},"content":"      if (op2 \u0026\u0026 op2.isInsert()) {"},{"lineNumber":376,"author":{"gitId":"uyencfi"},"content":"        operation.insert(op2.text, op2.attributes)"},{"lineNumber":377,"author":{"gitId":"uyencfi"},"content":"        op2 \u003d ops2[i2++]"},{"lineNumber":378,"author":{"gitId":"uyencfi"},"content":"        continue"},{"lineNumber":379,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":380,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":381,"author":{"gitId":"uyencfi"},"content":"      if (typeof op1 \u003d\u003d\u003d \"undefined\") {"},{"lineNumber":382,"author":{"gitId":"uyencfi"},"content":"        throw new Error("},{"lineNumber":383,"author":{"gitId":"uyencfi"},"content":"          \"Cannot compose operations: first operation is too short.\""},{"lineNumber":384,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":385,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":386,"author":{"gitId":"uyencfi"},"content":"      if (typeof op2 \u003d\u003d\u003d \"undefined\") {"},{"lineNumber":387,"author":{"gitId":"uyencfi"},"content":"        throw new Error("},{"lineNumber":388,"author":{"gitId":"uyencfi"},"content":"          \"Cannot compose operations: first operation is too long.\""},{"lineNumber":389,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":390,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":391,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":392,"author":{"gitId":"uyencfi"},"content":"      if (op1.isRetain() \u0026\u0026 op2.isRetain()) {"},{"lineNumber":393,"author":{"gitId":"uyencfi"},"content":"        attributes \u003d composeAttributes(op1.attributes, op2.attributes)"},{"lineNumber":394,"author":{"gitId":"uyencfi"},"content":"        if (op1.chars \u003e op2.chars) {"},{"lineNumber":395,"author":{"gitId":"uyencfi"},"content":"          operation.retain(op2.chars, attributes)"},{"lineNumber":396,"author":{"gitId":"uyencfi"},"content":"          op1.chars -\u003d op2.chars"},{"lineNumber":397,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":398,"author":{"gitId":"uyencfi"},"content":"        } else if (op1.chars \u003d\u003d\u003d op2.chars) {"},{"lineNumber":399,"author":{"gitId":"uyencfi"},"content":"          operation.retain(op1.chars, attributes)"},{"lineNumber":400,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":401,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":402,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":403,"author":{"gitId":"uyencfi"},"content":"          operation.retain(op1.chars, attributes)"},{"lineNumber":404,"author":{"gitId":"uyencfi"},"content":"          op2.chars -\u003d op1.chars"},{"lineNumber":405,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":406,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":407,"author":{"gitId":"uyencfi"},"content":"      } else if (op1.isInsert() \u0026\u0026 op2.isDelete()) {"},{"lineNumber":408,"author":{"gitId":"uyencfi"},"content":"        if (op1.text.length \u003e op2.chars) {"},{"lineNumber":409,"author":{"gitId":"uyencfi"},"content":"          op1.text \u003d op1.text.slice(op2.chars)"},{"lineNumber":410,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":411,"author":{"gitId":"uyencfi"},"content":"        } else if (op1.text.length \u003d\u003d\u003d op2.chars) {"},{"lineNumber":412,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":413,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":414,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":415,"author":{"gitId":"uyencfi"},"content":"          op2.chars -\u003d op1.text.length"},{"lineNumber":416,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":417,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":418,"author":{"gitId":"uyencfi"},"content":"      } else if (op1.isInsert() \u0026\u0026 op2.isRetain()) {"},{"lineNumber":419,"author":{"gitId":"uyencfi"},"content":"        attributes \u003d composeAttributes("},{"lineNumber":420,"author":{"gitId":"uyencfi"},"content":"          op1.attributes,"},{"lineNumber":421,"author":{"gitId":"uyencfi"},"content":"          op2.attributes,"},{"lineNumber":422,"author":{"gitId":"uyencfi"},"content":"          /*firstOpIsInsert\u003d*/ true"},{"lineNumber":423,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":424,"author":{"gitId":"uyencfi"},"content":"        if (op1.text.length \u003e op2.chars) {"},{"lineNumber":425,"author":{"gitId":"uyencfi"},"content":"          operation.insert(op1.text.slice(0, op2.chars), attributes)"},{"lineNumber":426,"author":{"gitId":"uyencfi"},"content":"          op1.text \u003d op1.text.slice(op2.chars)"},{"lineNumber":427,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":428,"author":{"gitId":"uyencfi"},"content":"        } else if (op1.text.length \u003d\u003d\u003d op2.chars) {"},{"lineNumber":429,"author":{"gitId":"uyencfi"},"content":"          operation.insert(op1.text, attributes)"},{"lineNumber":430,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":431,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":432,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":433,"author":{"gitId":"uyencfi"},"content":"          operation.insert(op1.text, attributes)"},{"lineNumber":434,"author":{"gitId":"uyencfi"},"content":"          op2.chars -\u003d op1.text.length"},{"lineNumber":435,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":436,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":437,"author":{"gitId":"uyencfi"},"content":"      } else if (op1.isRetain() \u0026\u0026 op2.isDelete()) {"},{"lineNumber":438,"author":{"gitId":"uyencfi"},"content":"        if (op1.chars \u003e op2.chars) {"},{"lineNumber":439,"author":{"gitId":"uyencfi"},"content":"          operation[\"delete\"](op2.chars)"},{"lineNumber":440,"author":{"gitId":"uyencfi"},"content":"          op1.chars -\u003d op2.chars"},{"lineNumber":441,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":442,"author":{"gitId":"uyencfi"},"content":"        } else if (op1.chars \u003d\u003d\u003d op2.chars) {"},{"lineNumber":443,"author":{"gitId":"uyencfi"},"content":"          operation[\"delete\"](op2.chars)"},{"lineNumber":444,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":445,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":446,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":447,"author":{"gitId":"uyencfi"},"content":"          operation[\"delete\"](op1.chars)"},{"lineNumber":448,"author":{"gitId":"uyencfi"},"content":"          op2.chars -\u003d op1.chars"},{"lineNumber":449,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":450,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":451,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":452,"author":{"gitId":"uyencfi"},"content":"        throw new Error("},{"lineNumber":453,"author":{"gitId":"uyencfi"},"content":"          \"This shouldn\u0027t happen: op1: \" +"},{"lineNumber":454,"author":{"gitId":"uyencfi"},"content":"            JSON.stringify(op1) +"},{"lineNumber":455,"author":{"gitId":"uyencfi"},"content":"            \", op2: \" +"},{"lineNumber":456,"author":{"gitId":"uyencfi"},"content":"            JSON.stringify(op2)"},{"lineNumber":457,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":458,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":459,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":460,"author":{"gitId":"uyencfi"},"content":"    return operation"},{"lineNumber":461,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":462,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":463,"author":{"gitId":"uyencfi"},"content":"  function getSimpleOp(operation) {"},{"lineNumber":464,"author":{"gitId":"uyencfi"},"content":"    var ops \u003d operation.ops"},{"lineNumber":465,"author":{"gitId":"uyencfi"},"content":"    // eslint-disable-next-line default-case"},{"lineNumber":466,"author":{"gitId":"uyencfi"},"content":"    switch (ops.length) {"},{"lineNumber":467,"author":{"gitId":"uyencfi"},"content":"      case 1:"},{"lineNumber":468,"author":{"gitId":"uyencfi"},"content":"        return ops[0]"},{"lineNumber":469,"author":{"gitId":"uyencfi"},"content":"      case 2:"},{"lineNumber":470,"author":{"gitId":"uyencfi"},"content":"        return ops[0].isRetain() ? ops[1] : ops[1].isRetain() ? ops[0] : null"},{"lineNumber":471,"author":{"gitId":"uyencfi"},"content":"      case 3:"},{"lineNumber":472,"author":{"gitId":"uyencfi"},"content":"        if (ops[0].isRetain() \u0026\u0026 ops[2].isRetain()) {"},{"lineNumber":473,"author":{"gitId":"uyencfi"},"content":"          return ops[1]"},{"lineNumber":474,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":475,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":476,"author":{"gitId":"uyencfi"},"content":"    return null"},{"lineNumber":477,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":478,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":479,"author":{"gitId":"uyencfi"},"content":"  function getStartIndex(operation) {"},{"lineNumber":480,"author":{"gitId":"uyencfi"},"content":"    if (operation.ops[0].isRetain()) {"},{"lineNumber":481,"author":{"gitId":"uyencfi"},"content":"      return operation.ops[0].chars"},{"lineNumber":482,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":483,"author":{"gitId":"uyencfi"},"content":"    return 0"},{"lineNumber":484,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":485,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":486,"author":{"gitId":"uyencfi"},"content":"  // When you use ctrl-z to undo your latest changes, you expect the program not"},{"lineNumber":487,"author":{"gitId":"uyencfi"},"content":"  // to undo every single keystroke but to undo your last sentence you wrote at"},{"lineNumber":488,"author":{"gitId":"uyencfi"},"content":"  // a stretch or the deletion you did by holding the backspace key down. This"},{"lineNumber":489,"author":{"gitId":"uyencfi"},"content":"  // This can be implemented by composing operations on the undo stack. This"},{"lineNumber":490,"author":{"gitId":"uyencfi"},"content":"  // method can help decide whether two operations should be composed. It"},{"lineNumber":491,"author":{"gitId":"uyencfi"},"content":"  // returns true if the operations are consecutive insert operations or both"},{"lineNumber":492,"author":{"gitId":"uyencfi"},"content":"  // operations delete text at the same position. You may want to include other"},{"lineNumber":493,"author":{"gitId":"uyencfi"},"content":"  // factors like the time since the last change in your decision."},{"lineNumber":494,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.shouldBeComposedWith \u003d function (other) {"},{"lineNumber":495,"author":{"gitId":"uyencfi"},"content":"    if (this.isNoop() || other.isNoop()) {"},{"lineNumber":496,"author":{"gitId":"uyencfi"},"content":"      return true"},{"lineNumber":497,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":498,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":499,"author":{"gitId":"uyencfi"},"content":"    var startA \u003d getStartIndex(this),"},{"lineNumber":500,"author":{"gitId":"uyencfi"},"content":"      startB \u003d getStartIndex(other)"},{"lineNumber":501,"author":{"gitId":"uyencfi"},"content":"    var simpleA \u003d getSimpleOp(this),"},{"lineNumber":502,"author":{"gitId":"uyencfi"},"content":"      simpleB \u003d getSimpleOp(other)"},{"lineNumber":503,"author":{"gitId":"uyencfi"},"content":"    if (!simpleA || !simpleB) {"},{"lineNumber":504,"author":{"gitId":"uyencfi"},"content":"      return false"},{"lineNumber":505,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":506,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":507,"author":{"gitId":"uyencfi"},"content":"    if (simpleA.isInsert() \u0026\u0026 simpleB.isInsert()) {"},{"lineNumber":508,"author":{"gitId":"uyencfi"},"content":"      return startA + simpleA.text.length \u003d\u003d\u003d startB"},{"lineNumber":509,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":510,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":511,"author":{"gitId":"uyencfi"},"content":"    if (simpleA.isDelete() \u0026\u0026 simpleB.isDelete()) {"},{"lineNumber":512,"author":{"gitId":"uyencfi"},"content":"      // there are two possibilities to delete: with backspace and with the"},{"lineNumber":513,"author":{"gitId":"uyencfi"},"content":"      // delete key."},{"lineNumber":514,"author":{"gitId":"uyencfi"},"content":"      return startB + simpleB.chars \u003d\u003d\u003d startA || startA \u003d\u003d\u003d startB"},{"lineNumber":515,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":516,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":517,"author":{"gitId":"uyencfi"},"content":"    return false"},{"lineNumber":518,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":519,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":520,"author":{"gitId":"uyencfi"},"content":"  // Decides whether two operations should be composed with each other"},{"lineNumber":521,"author":{"gitId":"uyencfi"},"content":"  // if they were inverted, that is"},{"lineNumber":522,"author":{"gitId":"uyencfi"},"content":"  // `shouldBeComposedWith(a, b) \u003d shouldBeComposedWithInverted(b^{-1}, a^{-1})`."},{"lineNumber":523,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.shouldBeComposedWithInverted \u003d function (other) {"},{"lineNumber":524,"author":{"gitId":"uyencfi"},"content":"    if (this.isNoop() || other.isNoop()) {"},{"lineNumber":525,"author":{"gitId":"uyencfi"},"content":"      return true"},{"lineNumber":526,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":527,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":528,"author":{"gitId":"uyencfi"},"content":"    var startA \u003d getStartIndex(this),"},{"lineNumber":529,"author":{"gitId":"uyencfi"},"content":"      startB \u003d getStartIndex(other)"},{"lineNumber":530,"author":{"gitId":"uyencfi"},"content":"    var simpleA \u003d getSimpleOp(this),"},{"lineNumber":531,"author":{"gitId":"uyencfi"},"content":"      simpleB \u003d getSimpleOp(other)"},{"lineNumber":532,"author":{"gitId":"uyencfi"},"content":"    if (!simpleA || !simpleB) {"},{"lineNumber":533,"author":{"gitId":"uyencfi"},"content":"      return false"},{"lineNumber":534,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":535,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":536,"author":{"gitId":"uyencfi"},"content":"    if (simpleA.isInsert() \u0026\u0026 simpleB.isInsert()) {"},{"lineNumber":537,"author":{"gitId":"uyencfi"},"content":"      return startA + simpleA.text.length \u003d\u003d\u003d startB || startA \u003d\u003d\u003d startB"},{"lineNumber":538,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":539,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":540,"author":{"gitId":"uyencfi"},"content":"    if (simpleA.isDelete() \u0026\u0026 simpleB.isDelete()) {"},{"lineNumber":541,"author":{"gitId":"uyencfi"},"content":"      return startB + simpleB.chars \u003d\u003d\u003d startA"},{"lineNumber":542,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":543,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":544,"author":{"gitId":"uyencfi"},"content":"    return false"},{"lineNumber":545,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":546,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":547,"author":{"gitId":"uyencfi"},"content":"  TextOperation.transformAttributes \u003d function (attributes1, attributes2) {"},{"lineNumber":548,"author":{"gitId":"uyencfi"},"content":"    var attributes1prime \u003d {},"},{"lineNumber":549,"author":{"gitId":"uyencfi"},"content":"      attributes2prime \u003d {}"},{"lineNumber":550,"author":{"gitId":"uyencfi"},"content":"    var attr,"},{"lineNumber":551,"author":{"gitId":"uyencfi"},"content":"      allAttrs \u003d {}"},{"lineNumber":552,"author":{"gitId":"uyencfi"},"content":"    for (attr in attributes1) {"},{"lineNumber":553,"author":{"gitId":"uyencfi"},"content":"      allAttrs[attr] \u003d true"},{"lineNumber":554,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":555,"author":{"gitId":"uyencfi"},"content":"    for (attr in attributes2) {"},{"lineNumber":556,"author":{"gitId":"uyencfi"},"content":"      allAttrs[attr] \u003d true"},{"lineNumber":557,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":558,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":559,"author":{"gitId":"uyencfi"},"content":"    for (attr in allAttrs) {"},{"lineNumber":560,"author":{"gitId":"uyencfi"},"content":"      var attr1 \u003d attributes1[attr],"},{"lineNumber":561,"author":{"gitId":"uyencfi"},"content":"        attr2 \u003d attributes2[attr]"},{"lineNumber":562,"author":{"gitId":"uyencfi"},"content":"      utils.assert(attr1 !\u003d null || attr2 !\u003d null)"},{"lineNumber":563,"author":{"gitId":"uyencfi"},"content":"      if (attr1 \u003d\u003d null) {"},{"lineNumber":564,"author":{"gitId":"uyencfi"},"content":"        // Only modified by attributes2; keep it."},{"lineNumber":565,"author":{"gitId":"uyencfi"},"content":"        attributes2prime[attr] \u003d attr2"},{"lineNumber":566,"author":{"gitId":"uyencfi"},"content":"      } else if (attr2 \u003d\u003d null) {"},{"lineNumber":567,"author":{"gitId":"uyencfi"},"content":"        // only modified by attributes1; keep it"},{"lineNumber":568,"author":{"gitId":"uyencfi"},"content":"        attributes1prime[attr] \u003d attr1"},{"lineNumber":569,"author":{"gitId":"uyencfi"},"content":"      } else if (attr1 \u003d\u003d\u003d attr2) {"},{"lineNumber":570,"author":{"gitId":"uyencfi"},"content":"        // Both set it to the same value.  Nothing to do."},{"lineNumber":571,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":572,"author":{"gitId":"uyencfi"},"content":"        // attr1 and attr2 are different. Prefer attr1."},{"lineNumber":573,"author":{"gitId":"uyencfi"},"content":"        attributes1prime[attr] \u003d attr1"},{"lineNumber":574,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":575,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":576,"author":{"gitId":"uyencfi"},"content":"    return [attributes1prime, attributes2prime]"},{"lineNumber":577,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":578,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":579,"author":{"gitId":"uyencfi"},"content":"  // Transform takes two operations A and B that happened concurrently and"},{"lineNumber":580,"author":{"gitId":"uyencfi"},"content":"  // produces two operations A\u0027 and B\u0027 (in an array) such that"},{"lineNumber":581,"author":{"gitId":"uyencfi"},"content":"  // `apply(apply(S, A), B\u0027) \u003d apply(apply(S, B), A\u0027)`. This function is the"},{"lineNumber":582,"author":{"gitId":"uyencfi"},"content":"  // heart of OT."},{"lineNumber":583,"author":{"gitId":"uyencfi"},"content":"  TextOperation.transform \u003d function (operation1, operation2) {"},{"lineNumber":584,"author":{"gitId":"uyencfi"},"content":"    if (operation1.baseLength !\u003d\u003d operation2.baseLength) {"},{"lineNumber":585,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\"Both operations have to have the same base length\")"},{"lineNumber":586,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":587,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":588,"author":{"gitId":"uyencfi"},"content":"    var operation1prime \u003d new TextOperation()"},{"lineNumber":589,"author":{"gitId":"uyencfi"},"content":"    var operation2prime \u003d new TextOperation()"},{"lineNumber":590,"author":{"gitId":"uyencfi"},"content":"    var ops1 \u003d operation1.clone().ops,"},{"lineNumber":591,"author":{"gitId":"uyencfi"},"content":"      ops2 \u003d operation2.clone().ops"},{"lineNumber":592,"author":{"gitId":"uyencfi"},"content":"    var i1 \u003d 0,"},{"lineNumber":593,"author":{"gitId":"uyencfi"},"content":"      i2 \u003d 0"},{"lineNumber":594,"author":{"gitId":"uyencfi"},"content":"    var op1 \u003d ops1[i1++],"},{"lineNumber":595,"author":{"gitId":"uyencfi"},"content":"      op2 \u003d ops2[i2++]"},{"lineNumber":596,"author":{"gitId":"uyencfi"},"content":"    while (true) {"},{"lineNumber":597,"author":{"gitId":"uyencfi"},"content":"      // At every iteration of the loop, the imaginary cursor that both"},{"lineNumber":598,"author":{"gitId":"uyencfi"},"content":"      // operation1 and operation2 have that operates on the input string must"},{"lineNumber":599,"author":{"gitId":"uyencfi"},"content":"      // have the same position in the input string."},{"lineNumber":600,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":601,"author":{"gitId":"uyencfi"},"content":"      if (typeof op1 \u003d\u003d\u003d \"undefined\" \u0026\u0026 typeof op2 \u003d\u003d\u003d \"undefined\") {"},{"lineNumber":602,"author":{"gitId":"uyencfi"},"content":"        // end condition: both ops1 and ops2 have been processed"},{"lineNumber":603,"author":{"gitId":"uyencfi"},"content":"        break"},{"lineNumber":604,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":605,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":606,"author":{"gitId":"uyencfi"},"content":"      // next two cases: one or both ops are insert ops"},{"lineNumber":607,"author":{"gitId":"uyencfi"},"content":"      // \u003d\u003e insert the string in the corresponding prime operation, skip it in"},{"lineNumber":608,"author":{"gitId":"uyencfi"},"content":"      // the other one. If both op1 and op2 are insert ops, prefer op1."},{"lineNumber":609,"author":{"gitId":"uyencfi"},"content":"      if (op1 \u0026\u0026 op1.isInsert()) {"},{"lineNumber":610,"author":{"gitId":"uyencfi"},"content":"        operation1prime.insert(op1.text, op1.attributes)"},{"lineNumber":611,"author":{"gitId":"uyencfi"},"content":"        operation2prime.retain(op1.text.length)"},{"lineNumber":612,"author":{"gitId":"uyencfi"},"content":"        op1 \u003d ops1[i1++]"},{"lineNumber":613,"author":{"gitId":"uyencfi"},"content":"        continue"},{"lineNumber":614,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":615,"author":{"gitId":"uyencfi"},"content":"      if (op2 \u0026\u0026 op2.isInsert()) {"},{"lineNumber":616,"author":{"gitId":"uyencfi"},"content":"        operation1prime.retain(op2.text.length)"},{"lineNumber":617,"author":{"gitId":"uyencfi"},"content":"        operation2prime.insert(op2.text, op2.attributes)"},{"lineNumber":618,"author":{"gitId":"uyencfi"},"content":"        op2 \u003d ops2[i2++]"},{"lineNumber":619,"author":{"gitId":"uyencfi"},"content":"        continue"},{"lineNumber":620,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":621,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":622,"author":{"gitId":"uyencfi"},"content":"      if (typeof op1 \u003d\u003d\u003d \"undefined\") {"},{"lineNumber":623,"author":{"gitId":"uyencfi"},"content":"        throw new Error("},{"lineNumber":624,"author":{"gitId":"uyencfi"},"content":"          \"Cannot transform operations: first operation is too short.\""},{"lineNumber":625,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":626,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":627,"author":{"gitId":"uyencfi"},"content":"      if (typeof op2 \u003d\u003d\u003d \"undefined\") {"},{"lineNumber":628,"author":{"gitId":"uyencfi"},"content":"        throw new Error("},{"lineNumber":629,"author":{"gitId":"uyencfi"},"content":"          \"Cannot transform operations: first operation is too long.\""},{"lineNumber":630,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":631,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":632,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":633,"author":{"gitId":"uyencfi"},"content":"      var minl"},{"lineNumber":634,"author":{"gitId":"uyencfi"},"content":"      if (op1.isRetain() \u0026\u0026 op2.isRetain()) {"},{"lineNumber":635,"author":{"gitId":"uyencfi"},"content":"        // Simple case: retain/retain"},{"lineNumber":636,"author":{"gitId":"uyencfi"},"content":"        var attributesPrime \u003d TextOperation.transformAttributes("},{"lineNumber":637,"author":{"gitId":"uyencfi"},"content":"          op1.attributes,"},{"lineNumber":638,"author":{"gitId":"uyencfi"},"content":"          op2.attributes"},{"lineNumber":639,"author":{"gitId":"uyencfi"},"content":"        )"},{"lineNumber":640,"author":{"gitId":"uyencfi"},"content":"        if (op1.chars \u003e op2.chars) {"},{"lineNumber":641,"author":{"gitId":"uyencfi"},"content":"          minl \u003d op2.chars"},{"lineNumber":642,"author":{"gitId":"uyencfi"},"content":"          op1.chars -\u003d op2.chars"},{"lineNumber":643,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":644,"author":{"gitId":"uyencfi"},"content":"        } else if (op1.chars \u003d\u003d\u003d op2.chars) {"},{"lineNumber":645,"author":{"gitId":"uyencfi"},"content":"          minl \u003d op2.chars"},{"lineNumber":646,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":647,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":648,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":649,"author":{"gitId":"uyencfi"},"content":"          minl \u003d op1.chars"},{"lineNumber":650,"author":{"gitId":"uyencfi"},"content":"          op2.chars -\u003d op1.chars"},{"lineNumber":651,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":652,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":653,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":654,"author":{"gitId":"uyencfi"},"content":"        operation1prime.retain(minl, attributesPrime[0])"},{"lineNumber":655,"author":{"gitId":"uyencfi"},"content":"        operation2prime.retain(minl, attributesPrime[1])"},{"lineNumber":656,"author":{"gitId":"uyencfi"},"content":"      } else if (op1.isDelete() \u0026\u0026 op2.isDelete()) {"},{"lineNumber":657,"author":{"gitId":"uyencfi"},"content":"        // Both operations delete the same string at the same position. We don\u0027t"},{"lineNumber":658,"author":{"gitId":"uyencfi"},"content":"        // need to produce any operations, we just skip over the delete ops and"},{"lineNumber":659,"author":{"gitId":"uyencfi"},"content":"        // handle the case that one operation deletes more than the other."},{"lineNumber":660,"author":{"gitId":"uyencfi"},"content":"        if (op1.chars \u003e op2.chars) {"},{"lineNumber":661,"author":{"gitId":"uyencfi"},"content":"          op1.chars -\u003d op2.chars"},{"lineNumber":662,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":663,"author":{"gitId":"uyencfi"},"content":"        } else if (op1.chars \u003d\u003d\u003d op2.chars) {"},{"lineNumber":664,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":665,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":666,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":667,"author":{"gitId":"uyencfi"},"content":"          op2.chars -\u003d op1.chars"},{"lineNumber":668,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":669,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":670,"author":{"gitId":"uyencfi"},"content":"        // next two cases: delete/retain and retain/delete"},{"lineNumber":671,"author":{"gitId":"uyencfi"},"content":"      } else if (op1.isDelete() \u0026\u0026 op2.isRetain()) {"},{"lineNumber":672,"author":{"gitId":"uyencfi"},"content":"        if (op1.chars \u003e op2.chars) {"},{"lineNumber":673,"author":{"gitId":"uyencfi"},"content":"          minl \u003d op2.chars"},{"lineNumber":674,"author":{"gitId":"uyencfi"},"content":"          op1.chars -\u003d op2.chars"},{"lineNumber":675,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":676,"author":{"gitId":"uyencfi"},"content":"        } else if (op1.chars \u003d\u003d\u003d op2.chars) {"},{"lineNumber":677,"author":{"gitId":"uyencfi"},"content":"          minl \u003d op2.chars"},{"lineNumber":678,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":679,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":680,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":681,"author":{"gitId":"uyencfi"},"content":"          minl \u003d op1.chars"},{"lineNumber":682,"author":{"gitId":"uyencfi"},"content":"          op2.chars -\u003d op1.chars"},{"lineNumber":683,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":684,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":685,"author":{"gitId":"uyencfi"},"content":"        operation1prime[\"delete\"](minl)"},{"lineNumber":686,"author":{"gitId":"uyencfi"},"content":"      } else if (op1.isRetain() \u0026\u0026 op2.isDelete()) {"},{"lineNumber":687,"author":{"gitId":"uyencfi"},"content":"        if (op1.chars \u003e op2.chars) {"},{"lineNumber":688,"author":{"gitId":"uyencfi"},"content":"          minl \u003d op2.chars"},{"lineNumber":689,"author":{"gitId":"uyencfi"},"content":"          op1.chars -\u003d op2.chars"},{"lineNumber":690,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":691,"author":{"gitId":"uyencfi"},"content":"        } else if (op1.chars \u003d\u003d\u003d op2.chars) {"},{"lineNumber":692,"author":{"gitId":"uyencfi"},"content":"          minl \u003d op1.chars"},{"lineNumber":693,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":694,"author":{"gitId":"uyencfi"},"content":"          op2 \u003d ops2[i2++]"},{"lineNumber":695,"author":{"gitId":"uyencfi"},"content":"        } else {"},{"lineNumber":696,"author":{"gitId":"uyencfi"},"content":"          minl \u003d op1.chars"},{"lineNumber":697,"author":{"gitId":"uyencfi"},"content":"          op2.chars -\u003d op1.chars"},{"lineNumber":698,"author":{"gitId":"uyencfi"},"content":"          op1 \u003d ops1[i1++]"},{"lineNumber":699,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":700,"author":{"gitId":"uyencfi"},"content":"        operation2prime[\"delete\"](minl)"},{"lineNumber":701,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":702,"author":{"gitId":"uyencfi"},"content":"        throw new Error(\"The two operations aren\u0027t compatible\")"},{"lineNumber":703,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":704,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":705,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":706,"author":{"gitId":"uyencfi"},"content":"    return [operation1prime, operation2prime]"},{"lineNumber":707,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":708,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":709,"author":{"gitId":"uyencfi"},"content":"  // convenience method to write transform(a, b) as a.transform(b)"},{"lineNumber":710,"author":{"gitId":"uyencfi"},"content":"  TextOperation.prototype.transform \u003d function (other) {"},{"lineNumber":711,"author":{"gitId":"uyencfi"},"content":"    return TextOperation.transform(this, other)"},{"lineNumber":712,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":713,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":714,"author":{"gitId":"uyencfi"},"content":"  return TextOperation"},{"lineNumber":715,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":715}},{"path":"frontend/src/components/collaboration/lib/text-pieces-to-inserts.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { sentinelConstants } from \"./constants.js\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { Text } from \"./text.js\""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import { Line } from \"./line.js\""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":" * Helper to turn pieces of text into insertable operations"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"export const textPiecesToInserts \u003d function (atNewLine, textPieces) {"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  var inserts \u003d []"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"  function insert(string, attributes) {"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"    if (string instanceof Text) {"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"      attributes \u003d string.formatting.attributes"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"      string \u003d string.text"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"    inserts.push({ string: string, attributes: attributes })"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"    atNewLine \u003d string[string.length - 1] \u003d\u003d\u003d \"\\n\""},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"  function insertLine(line, withNewline) {"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"    // HACK: We should probably force a newline if there isn\u0027t one already.  But due to"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    // the way this is used for inserting HTML, we end up inserting a \"line\" in the middle"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"    // of text, in which case we don\u0027t want to actually insert a newline."},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    if (atNewLine) {"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"      insert("},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"        sentinelConstants.LINE_SENTINEL_CHARACTER,"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"        line.formatting.attributes"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c line.textPieces.length; i++) {"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"      insert(line.textPieces[i])"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"    if (withNewline) insert(\"\\n\")"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"  for (var i \u003d 0; i \u003c textPieces.length; i++) {"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"    if (textPieces[i] instanceof Line) {"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"      insertLine(textPieces[i], i \u003c textPieces.length - 1)"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"      insert(textPieces[i])"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"  return inserts"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"}"}],"authorContributionMap":{"uyencfi":48}},{"path":"frontend/src/components/collaboration/lib/text.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { Formatting } from \"./formatting\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":" * Object to represent Formatted text."},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":" *"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":" * @type {Function}"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"export const Text \u003d (function () {"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  function Text(text, formatting) {"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"    // Allow calling without new."},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    if (!(this instanceof Text)) {"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"      return new Text(text, formatting)"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    this.text \u003d text"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"    this.formatting \u003d formatting || Formatting()"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"  return Text"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":20}},{"path":"frontend/src/components/collaboration/lib/undo-manager.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"export const UndoManager \u003d (function () {"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"  var NORMAL_STATE \u003d \"normal\""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"  var UNDOING_STATE \u003d \"undoing\""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"  var REDOING_STATE \u003d \"redoing\""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  // Create a new UndoManager with an optional maximum history size."},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"  function UndoManager(maxItems) {"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"    this.maxItems \u003d maxItems || 50"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"    this.state \u003d NORMAL_STATE"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    this.dontCompose \u003d false"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"    this.undoStack \u003d []"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"    this.redoStack \u003d []"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"  // Add an operation to the undo or redo stack, depending on the current state"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"  // of the UndoManager. The operation added must be the inverse of the last"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"  // edit. When `compose` is true, compose the operation with the last operation"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"  // unless the last operation was alread pushed on the redo stack or was hidden"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"  // by a newer operation on the undo stack."},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"  UndoManager.prototype.add \u003d function (operation, compose) {"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"    if (this.state \u003d\u003d\u003d UNDOING_STATE) {"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"      this.redoStack.push(operation)"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"      this.dontCompose \u003d true"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    } else if (this.state \u003d\u003d\u003d REDOING_STATE) {"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"      this.undoStack.push(operation)"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"      this.dontCompose \u003d true"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"    } else {"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"      var undoStack \u003d this.undoStack"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"      if (!this.dontCompose \u0026\u0026 compose \u0026\u0026 undoStack.length \u003e 0) {"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"        undoStack.push(operation.compose(undoStack.pop()))"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"      } else {"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"        undoStack.push(operation)"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"        if (undoStack.length \u003e this.maxItems) {"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"          undoStack.shift()"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"      this.dontCompose \u003d false"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"      this.redoStack \u003d []"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"  function transformStack(stack, operation) {"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"    var newStack \u003d []"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"    var Operation \u003d operation.constructor"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d stack.length - 1; i \u003e\u003d 0; i--) {"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"      var pair \u003d Operation.transform(stack[i], operation)"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"      if (typeof pair[0].isNoop !\u003d\u003d \"function\" || !pair[0].isNoop()) {"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"        newStack.push(pair[0])"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"      operation \u003d pair[1]"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"    return newStack.reverse()"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"  // Transform the undo and redo stacks against a operation by another client."},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"  UndoManager.prototype.transform \u003d function (operation) {"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"    this.undoStack \u003d transformStack(this.undoStack, operation)"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"    this.redoStack \u003d transformStack(this.redoStack, operation)"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"  // Perform an undo by calling a function with the latest operation on the undo"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"  // stack. The function is expected to call the `add` method with the inverse"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"  // of the operation, which pushes the inverse on the redo stack."},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"  UndoManager.prototype.performUndo \u003d function (fn) {"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"    this.state \u003d UNDOING_STATE"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"    if (this.undoStack.length \u003d\u003d\u003d 0) {"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\"undo not possible\")"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"    fn(this.undoStack.pop())"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"    this.state \u003d NORMAL_STATE"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"  // The inverse of `performUndo`."},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"  UndoManager.prototype.performRedo \u003d function (fn) {"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"    this.state \u003d REDOING_STATE"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"    if (this.redoStack.length \u003d\u003d\u003d 0) {"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"      throw new Error(\"redo not possible\")"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"    fn(this.redoStack.pop())"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"    this.state \u003d NORMAL_STATE"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"  // Is the undo stack not empty?"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"  UndoManager.prototype.canUndo \u003d function () {"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"    return this.undoStack.length !\u003d\u003d 0"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"  // Is the redo stack not empty?"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":"  UndoManager.prototype.canRedo \u003d function () {"},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"    return this.redoStack.length !\u003d\u003d 0"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"  // Whether the UndoManager is currently performing an undo."},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"  UndoManager.prototype.isUndoing \u003d function () {"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"    return this.state \u003d\u003d\u003d UNDOING_STATE"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"  // Whether the UndoManager is currently performing a redo."},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"  UndoManager.prototype.isRedoing \u003d function () {"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"    return this.state \u003d\u003d\u003d REDOING_STATE"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"  return UndoManager"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":105}},{"path":"frontend/src/components/collaboration/lib/utils.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"const utils \u003d {}"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"utils.makeEventEmitter \u003d function (clazz, opt_allowedEVents) {"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"  clazz.prototype.allowedEvents_ \u003d opt_allowedEVents"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  clazz.prototype.on \u003d function (eventType, callback, context) {"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"    this.validateEventType_(eventType)"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    this.eventListeners_ \u003d this.eventListeners_ || {}"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"    this.eventListeners_[eventType] \u003d this.eventListeners_[eventType] || []"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"    this.eventListeners_[eventType].push({"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"      callback: callback,"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"      context: context,"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"  clazz.prototype.off \u003d function (eventType, callback) {"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"    this.validateEventType_(eventType)"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"    this.eventListeners_ \u003d this.eventListeners_ || {}"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"    var listeners \u003d this.eventListeners_[eventType] || []"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c listeners.length; i++) {"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"      if (listeners[i].callback \u003d\u003d\u003d callback) {"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"        listeners.splice(i, 1)"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"        return"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"  clazz.prototype.trigger \u003d function (eventType /*, args ... */) {"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"    this.eventListeners_ \u003d this.eventListeners_ || {}"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    var listeners \u003d this.eventListeners_[eventType] || []"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c listeners.length; i++) {"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"      listeners[i].callback.apply("},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"        listeners[i].context,"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"        Array.prototype.slice.call(arguments, 1)"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"      )"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"  clazz.prototype.validateEventType_ \u003d function (eventType) {"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"    if (this.allowedEvents_) {"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"      var allowed \u003d false"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"      for (var i \u003d 0; i \u003c this.allowedEvents_.length; i++) {"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"        if (this.allowedEvents_[i] \u003d\u003d\u003d eventType) {"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"          allowed \u003d true"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"          break"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"      if (!allowed) {"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"        throw new Error(\u0027Unknown event \"\u0027 + eventType + \u0027\"\u0027)"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"utils.elt \u003d function (tag, content, attrs) {"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"  var e \u003d document.createElement(tag)"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"  if (typeof content \u003d\u003d\u003d \"string\") {"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"    utils.setTextContent(e, content)"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"  } else if (content) {"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c content.length; ++i) {"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"      e.appendChild(content[i])"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"  for (var attr in attrs || {}) {"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"    e.setAttribute(attr, attrs[attr])"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"  return e"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"utils.setTextContent \u003d function (e, str) {"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"  e.innerHTML \u003d \"\""},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"  e.appendChild(document.createTextNode(str))"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"utils.on \u003d function (emitter, type, f, capture) {"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"  if (emitter.addEventListener) {"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"    emitter.addEventListener(type, f, capture || false)"},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"  } else if (emitter.attachEvent) {"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"    emitter.attachEvent(\"on\" + type, f)"},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"utils.off \u003d function (emitter, type, f, capture) {"},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"  if (emitter.removeEventListener) {"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"    emitter.removeEventListener(type, f, capture || false)"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":"  } else if (emitter.detachEvent) {"},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"    emitter.detachEvent(\"on\" + type, f)"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"utils.preventDefault \u003d function (e) {"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"  if (e.preventDefault) {"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"    e.preventDefault()"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"  } else {"},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"    e.returnValue \u003d false"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"utils.stopPropagation \u003d function (e) {"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"  if (e.stopPropagation) {"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"    e.stopPropagation()"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"  } else {"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"    e.cancelBubble \u003d true"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"utils.stopEvent \u003d function (e) {"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"  utils.preventDefault(e)"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"  utils.stopPropagation(e)"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"utils.stopEventAnd \u003d function (fn) {"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"  return function (e) {"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"    fn(e)"},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"    utils.stopEvent(e)"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"    return false"},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"utils.trim \u003d function (str) {"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"  return str.replace(/^\\s+/g, \"\").replace(/\\s+$/g, \"\")"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"utils.stringEndsWith \u003d function (str, suffix) {"},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"  var list \u003d typeof suffix \u003d\u003d \"string\" ? [suffix] : suffix"},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":"  for (var i \u003d 0; i \u003c list.length; i++) {"},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"    // eslint-disable-next-line no-redeclare"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"    var suffix \u003d list[i]"},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"    if (str.indexOf(suffix, str.length - suffix.length) !\u003d\u003d -1) return true"},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"  return false"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"utils.assert \u003d function assert(b, msg) {"},{"lineNumber":135,"author":{"gitId":"uyencfi"},"content":"  if (!b) {"},{"lineNumber":136,"author":{"gitId":"uyencfi"},"content":"    throw new Error(msg || \"assertion error\")"},{"lineNumber":137,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":138,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":139,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":140,"author":{"gitId":"uyencfi"},"content":"utils.log \u003d function () {"},{"lineNumber":141,"author":{"gitId":"uyencfi"},"content":"  if (typeof console !\u003d\u003d \"undefined\" \u0026\u0026 typeof console.log !\u003d\u003d \"undefined\") {"},{"lineNumber":142,"author":{"gitId":"uyencfi"},"content":"    var args \u003d [\"Firepad:\"]"},{"lineNumber":143,"author":{"gitId":"uyencfi"},"content":"    for (var i \u003d 0; i \u003c arguments.length; i++) {"},{"lineNumber":144,"author":{"gitId":"uyencfi"},"content":"      args.push(arguments[i])"},{"lineNumber":145,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":146,"author":{"gitId":"uyencfi"},"content":"    console.log.apply(console, args)"},{"lineNumber":147,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":148,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":149,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":150,"author":{"gitId":"uyencfi"},"content":"export { utils }"}],"authorContributionMap":{"uyencfi":150}},{"path":"frontend/src/components/collaboration/lib/wrapped-operation.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"export const WrappedOperation \u003d (function (global) {"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"  // A WrappedOperation contains an operation and corresponing metadata."},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"  function WrappedOperation(operation, meta) {"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"    this.wrapped \u003d operation"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"    this.meta \u003d meta"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  WrappedOperation.prototype.apply \u003d function () {"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"    return this.wrapped.apply.apply(this.wrapped, arguments)"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"  WrappedOperation.prototype.invert \u003d function () {"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"    var meta \u003d this.meta"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    return new WrappedOperation("},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"      this.wrapped.invert.apply(this.wrapped, arguments),"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"      meta \u0026\u0026 typeof meta \u003d\u003d\u003d \"object\" \u0026\u0026 typeof meta.invert \u003d\u003d\u003d \"function\""},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"        ? meta.invert.apply(meta, arguments)"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"        : meta"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"  // Copy all properties from source to target."},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"  function copy(source, target) {"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    for (var key in source) {"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"      if (source.hasOwnProperty(key)) {"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"        target[key] \u003d source[key]"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"  function composeMeta(a, b) {"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"    if (a \u0026\u0026 typeof a \u003d\u003d\u003d \"object\") {"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"      if (typeof a.compose \u003d\u003d\u003d \"function\") {"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"        return a.compose(b)"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"      var meta \u003d {}"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"      copy(a, meta)"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"      copy(b, meta)"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"      return meta"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"    return b"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"  WrappedOperation.prototype.compose \u003d function (other) {"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"    return new WrappedOperation("},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"      this.wrapped.compose(other.wrapped),"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"      composeMeta(this.meta, other.meta)"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"  function transformMeta(meta, operation) {"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"    if (meta \u0026\u0026 typeof meta \u003d\u003d\u003d \"object\") {"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"      if (typeof meta.transform \u003d\u003d\u003d \"function\") {"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"        return meta.transform(operation)"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"    return meta"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"  WrappedOperation.transform \u003d function (a, b) {"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"    var pair \u003d a.wrapped.transform(b.wrapped)"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"    return ["},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"      new WrappedOperation(pair[0], transformMeta(a.meta, b.wrapped)),"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"      new WrappedOperation(pair[1], transformMeta(b.meta, a.wrapped)),"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"    ]"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"  // convenience method to write transform(a, b) as a.transform(b)"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"  WrappedOperation.prototype.transform \u003d function (other) {"},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"    return WrappedOperation.transform(this, other)"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"  return WrappedOperation"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"})()"}],"authorContributionMap":{"uyencfi":75}},{"path":"frontend/src/components/collaboration/selectionDecor.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { Decoration } from \u0027@codemirror/view\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":" * Returns a CodeMirror Decoration for the other person\u0027s selection."},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":" * Basically, the returned decoration object specifies how the"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":" * selected text should be styled (text color, background color, etc.)"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"const getOtherSelectionDecor \u003d (uid) \u003d\u003e {"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  return Decoration.mark({"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"    inclusiveStart: true,"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    attributes: {"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"      class: \u0027cm-other-selection\u0027,"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"    },"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"    uid: uid,"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"  })"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"export default getOtherSelectionDecor"}],"authorContributionMap":{"uyencfi":18}},{"path":"frontend/src/components/collaboration/selectionExtension.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { StateField } from \u0027@codemirror/state\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { EditorView, Decoration } from \u0027@codemirror/view\u0027"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import { addCursor, rmCursor } from \u0027./cursorEffects\u0027"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"import getOtherSelectionDecor from \u0027./selectionDecor\u0027"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"// This extension must be added to the set of extensions in the Editor component."},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"// It manages a set of Decoration objects representing the selections of the other user,"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"// and updates the editor to reflect their selection."},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"// Why is it a Selection extension, but the effects used are addCursor/rmCursor?"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"// Because selection IS a cursor, only with from !\u003d to. All selection changes are"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"// reported as cursor changes, we distinguish selection from cursor by checking from !\u003d to."},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":" * Returns the extension to manage the other person\u0027s selection."},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":" * @param uid The current user\u0027s id (NOT the other user!)"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"const getSelectionExtension \u003d (uid) \u003d\u003e {"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"  return StateField.define({"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    // Start with an empty set of decorations"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"    create() {"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"      return Decoration.none"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    },"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"    // This is called whenever the editor updates"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    update(selections, tx) {"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"      // map adjusts the previous selections to account for document changes, using operational transformation"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"      selections \u003d selections.map(tx.changes)"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"      // If this transaction adds or removes selections, apply those changes"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"      for (let e of tx.effects) {"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"        if (e.is(addCursor)) {"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"          // Skip my own selection"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"          if (e.value.uid \u003d\u003d\u003d uid) {"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"            continue"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"          let arr \u003d []"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"          // Verify that this is actually a selection (if from \u003d\u003d to, no text selected)"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"          if (e.value.from !\u003d\u003d e.value.to) {"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"            let from \u003d e.value.from, to \u003d e.value.to"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"            if (from \u003e to) {"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"              [from, to] \u003d [to, from]   // Swap to ensure from \u003c to"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"            }"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"            const otherSel \u003d getOtherSelectionDecor(e.value.uid)"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"            arr.push(otherSel.range(from, to))"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"          selections \u003d selections.update({"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"            add: arr,"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"          })"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"        } else if (e.is(rmCursor)) {"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"          if (e.value.uid \u003d\u003d\u003d uid) {"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"            continue"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"          selections \u003d selections.update({"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"            filter: (from, to, decoration) \u003d\u003e {"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"              // Remove a cursor by filtering it out"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"              // decoration.spec contains the uid associated with that cursor."},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"              // See getOtherSelectionMark() for the definition of our Decoration."},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"              return decoration.spec.uid !\u003d\u003d e.value.uid"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"            },"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"          })"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"      return selections"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"    },"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"    // Indicate that this StateField obj provides a set of decorations"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"    provide: (f) \u003d\u003e EditorView.decorations.from(f),"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":"  })"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"export default getSelectionExtension"}],"authorContributionMap":{"uyencfi":69}},{"path":"frontend/src/components/match/MatchDialog.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"import {"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"  Modal,"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"  ModalOverlay,"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"  ModalContent,"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  Button,"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  useDisclosure,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"} from \u0027@chakra-ui/react\u0027"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"import { useState, useEffect } from \u0027react\u0027"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"import MatchForm from \u0027./MatchForm\u0027"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"import io from \u0027socket.io-client\u0027"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"import MatchTimer from \u0027./MatchTimer\u0027"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"import MatchTimeout from \u0027./MatchTimeout\u0027"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"import { useNavigate } from \u0027react-router-dom\u0027"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"import {"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"  URI_MATCHING_SERVICE_SOCKET_PATH,"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"  EVENT_EMIT,"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"  EVENT_LISTEN,"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"  URI_MATCHING_SERVICE,"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"} from \u0027../../constants\u0027"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"import MatchError from \u0027./MatchError\u0027"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"import useAuth from \u0027../../hooks/useAuth\u0027"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"const PHASES \u003d {"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"  SELECT: \u0027SELECT\u0027,"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"  FINDING: \u0027FINDING\u0027,"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"  TIMEOUT: \u0027TIMEOUT\u0027,"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"  ERROR: \u0027ERROR\u0027,"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"const MatchDialog \u003d ({ isDisabled }) \u003d\u003e {"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"const difficultyList \u003d [\u0027easy\u0027, \u0027medium\u0027, \u0027hard\u0027]"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"  const { isOpen, onOpen, onClose } \u003d useDisclosure()"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"  const [difficulty, setDifficulty] \u003d useState(\u0027\u0027)"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"  const [type, setType] \u003d useState(\u0027\u0027)"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"  const [phase, setPhase] \u003d useState(PHASES.SELECT)"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"  const [socket, setSocket] \u003d useState()"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"  const navigate \u003d useNavigate()"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"  const { auth } \u003d useAuth()"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"    const newSocket \u003d io(URI_MATCHING_SERVICE, {"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"      path: URI_MATCHING_SERVICE_SOCKET_PATH,"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":"      auth: {"},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"        token: auth.accessToken,"},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":"    })"},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":"    setSocket(newSocket)"},{"lineNumber":50,"author":{"gitId":"MarcusTXK"},"content":"    newSocket.on(EVENT_LISTEN.MATCHING, () \u003d\u003e console.log(\u0027matching\u0027))"},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"    newSocket.on(EVENT_LISTEN.MATCH_SUCCESS, (payload) \u003d\u003e {"},{"lineNumber":52,"author":{"gitId":"MarcusTXK"},"content":"      console.log(\u0027match success\u0027)"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"      navigate(`/room/${payload.room}`)"},{"lineNumber":54,"author":{"gitId":"MarcusTXK"},"content":"    })"},{"lineNumber":55,"author":{"gitId":"MarcusTXK"},"content":"    newSocket.on(EVENT_LISTEN.MATCH_FAIL, () \u003d\u003e {"},{"lineNumber":56,"author":{"gitId":"MarcusTXK"},"content":"      console.log(\u0027match error\u0027)"},{"lineNumber":57,"author":{"gitId":"MarcusTXK"},"content":"      setPhase(PHASES.ERROR)"},{"lineNumber":58,"author":{"gitId":"MarcusTXK"},"content":"    })"},{"lineNumber":59,"author":{"gitId":"MarcusTXK"},"content":"    newSocket.on(EVENT_LISTEN.MATCH_TIMEOUT, () \u003d\u003e {"},{"lineNumber":60,"author":{"gitId":"MarcusTXK"},"content":"      console.log(\u0027timed out\u0027)"},{"lineNumber":61,"author":{"gitId":"MarcusTXK"},"content":"      setPhase(PHASES.TIMEOUT)"},{"lineNumber":62,"author":{"gitId":"MarcusTXK"},"content":"    })"},{"lineNumber":63,"author":{"gitId":"MarcusTXK"},"content":"    return () \u003d\u003e newSocket.close()"},{"lineNumber":64,"author":{"gitId":"MarcusTXK"},"content":"  }, [auth.accessToken, navigate])"},{"lineNumber":65,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":66,"author":{"gitId":"MarcusTXK"},"content":"  const handleSubmit \u003d (e) \u003d\u003e {"},{"lineNumber":67,"author":{"gitId":"MarcusTXK"},"content":"    e.preventDefault()"},{"lineNumber":68,"author":{"gitId":"Hzxin"},"content":"    if (difficulty) {"},{"lineNumber":69,"author":{"gitId":"MarcusTXK"},"content":"      socket.emit(EVENT_EMIT.MATCH_FIND, { difficulty: difficulty })"},{"lineNumber":70,"author":{"gitId":"Hzxin"},"content":"    } else {"},{"lineNumber":71,"author":{"gitId":"Hzxin"},"content":"      socket.emit(EVENT_EMIT.MATCH_FIND, { type: type })"},{"lineNumber":72,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":73,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":74,"author":{"gitId":"MarcusTXK"},"content":"    setPhase(PHASES.FINDING)"},{"lineNumber":75,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":76,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":77,"author":{"gitId":"MarcusTXK"},"content":"  const handleOpen \u003d () \u003d\u003e {"},{"lineNumber":78,"author":{"gitId":"MarcusTXK"},"content":"    setPhase(PHASES.SELECT)"},{"lineNumber":79,"author":{"gitId":"MarcusTXK"},"content":"    onOpen()"},{"lineNumber":80,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":81,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":82,"author":{"gitId":"MarcusTXK"},"content":"  const handleClose \u003d () \u003d\u003e {"},{"lineNumber":83,"author":{"gitId":"MarcusTXK"},"content":"    socket.emit(EVENT_EMIT.MATCH_CANCEL, () \u003d\u003e console.log(\u0027Cancelled\u0027))"},{"lineNumber":84,"author":{"gitId":"MarcusTXK"},"content":"    onClose()"},{"lineNumber":85,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":86,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":87,"author":{"gitId":"MarcusTXK"},"content":"  const renderBody \u003d () \u003d\u003e {"},{"lineNumber":88,"author":{"gitId":"MarcusTXK"},"content":"    switch (phase) {"},{"lineNumber":89,"author":{"gitId":"MarcusTXK"},"content":"      case PHASES.SELECT:"},{"lineNumber":90,"author":{"gitId":"MarcusTXK"},"content":"        return ("},{"lineNumber":91,"author":{"gitId":"MarcusTXK"},"content":"          \u003cMatchForm"},{"lineNumber":92,"author":{"gitId":"MarcusTXK"},"content":"            onClose\u003d{handleClose}"},{"lineNumber":93,"author":{"gitId":"MarcusTXK"},"content":"            onSubmit\u003d{handleSubmit}"},{"lineNumber":94,"author":{"gitId":"Hzxin"},"content":"            onChange\u003d{(e) \u003d\u003e {"},{"lineNumber":95,"author":{"gitId":"Hzxin"},"content":"              if (difficultyList.includes(e.target.value)) {"},{"lineNumber":96,"author":{"gitId":"Hzxin"},"content":"                setDifficulty(e.target.value)"},{"lineNumber":97,"author":{"gitId":"Hzxin"},"content":"              } else {"},{"lineNumber":98,"author":{"gitId":"Hzxin"},"content":"                setType(e.target.value)"},{"lineNumber":99,"author":{"gitId":"Hzxin"},"content":"              }"},{"lineNumber":100,"author":{"gitId":"Hzxin"},"content":"            }}"},{"lineNumber":101,"author":{"gitId":"MarcusTXK"},"content":"          /\u003e"},{"lineNumber":102,"author":{"gitId":"MarcusTXK"},"content":"        )"},{"lineNumber":103,"author":{"gitId":"MarcusTXK"},"content":"      case PHASES.FINDING:"},{"lineNumber":104,"author":{"gitId":"MarcusTXK"},"content":"        return \u003cMatchTimer currDate\u003d{new Date()} onClose\u003d{handleClose} /\u003e"},{"lineNumber":105,"author":{"gitId":"MarcusTXK"},"content":"      case PHASES.TIMEOUT:"},{"lineNumber":106,"author":{"gitId":"MarcusTXK"},"content":"        return ("},{"lineNumber":107,"author":{"gitId":"MarcusTXK"},"content":"          \u003cMatchTimeout"},{"lineNumber":108,"author":{"gitId":"MarcusTXK"},"content":"            onClose\u003d{handleClose}"},{"lineNumber":109,"author":{"gitId":"MarcusTXK"},"content":"            handleRetry\u003d{() \u003d\u003e setPhase(PHASES.SELECT)}"},{"lineNumber":110,"author":{"gitId":"MarcusTXK"},"content":"          /\u003e"},{"lineNumber":111,"author":{"gitId":"MarcusTXK"},"content":"        )"},{"lineNumber":112,"author":{"gitId":"MarcusTXK"},"content":"      default:"},{"lineNumber":113,"author":{"gitId":"MarcusTXK"},"content":"        return ("},{"lineNumber":114,"author":{"gitId":"MarcusTXK"},"content":"          \u003cMatchError"},{"lineNumber":115,"author":{"gitId":"MarcusTXK"},"content":"            onClose\u003d{handleClose}"},{"lineNumber":116,"author":{"gitId":"MarcusTXK"},"content":"            handleRetry\u003d{() \u003d\u003e setPhase(PHASES.SELECT)}"},{"lineNumber":117,"author":{"gitId":"MarcusTXK"},"content":"          /\u003e"},{"lineNumber":118,"author":{"gitId":"MarcusTXK"},"content":"        )"},{"lineNumber":119,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":120,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":121,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":122,"author":{"gitId":"MarcusTXK"},"content":"  return ("},{"lineNumber":123,"author":{"gitId":"MarcusTXK"},"content":"    \u003c\u003e"},{"lineNumber":124,"author":{"gitId":"MarcusTXK"},"content":"      \u003cButton onClick\u003d{handleOpen} disabled\u003d{isDisabled}\u003e"},{"lineNumber":125,"author":{"gitId":"MarcusTXK"},"content":"        Find Match"},{"lineNumber":126,"author":{"gitId":"MarcusTXK"},"content":"      \u003c/Button\u003e"},{"lineNumber":127,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":128,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModal isOpen\u003d{isOpen} onClose\u003d{handleClose}\u003e"},{"lineNumber":129,"author":{"gitId":"MarcusTXK"},"content":"        \u003cModalOverlay /\u003e"},{"lineNumber":130,"author":{"gitId":"MarcusTXK"},"content":"        \u003cModalContent\u003e{renderBody()}\u003c/ModalContent\u003e"},{"lineNumber":131,"author":{"gitId":"MarcusTXK"},"content":"      \u003c/Modal\u003e"},{"lineNumber":132,"author":{"gitId":"MarcusTXK"},"content":"    \u003c/\u003e"},{"lineNumber":133,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":134,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":135,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":136,"author":{"gitId":"MarcusTXK"},"content":"export default MatchDialog"}],"authorContributionMap":{"MarcusTXK":120,"Hzxin":15,"uyencfi":1}},{"path":"frontend/src/components/match/MatchError.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"import {"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"  ModalHeader,"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"  ModalFooter,"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"  ModalBody,"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  ModalCloseButton,"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  Button,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"} from \u0027@chakra-ui/react\u0027"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"const MatchError \u003d ({ onClose, handleRetry }) \u003d\u003e {"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"  return ("},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"    \u003c\u003e"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModalHeader\u003eMatch Error\u003c/ModalHeader\u003e"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModalCloseButton /\u003e"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModalBody\u003e"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"        Something went wrong, please wait for a while before trying again."},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"      \u003c/ModalBody\u003e"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModalFooter\u003e"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"        \u003cButton variant\u003d\"ghost\" mr\u003d{3} onClick\u003d{onClose}\u003e"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"          Cancel"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"        \u003c/Button\u003e"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"        \u003cButton colorScheme\u003d\"blue\" onClick\u003d{handleRetry}\u003e"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"          Retry"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"        \u003c/Button\u003e"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"      \u003c/ModalFooter\u003e"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"    \u003c/\u003e"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"export default MatchError"}],"authorContributionMap":{"MarcusTXK":31}},{"path":"frontend/src/components/match/MatchForm.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"import axios from \u0027../../api/axios\u0027"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"import {"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"  ModalHeader,"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"  ModalFooter,"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  ModalBody,"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  ModalCloseButton,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  Button,"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"  Select,"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"  FormControl,"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"  FormLabel,"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"  Tabs,"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"  Tab,"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"  TabList,"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"  TabPanels,"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"  TabPanel,"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"} from \u0027@chakra-ui/react\u0027"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"import { useEffect, useState } from \u0027react\u0027;"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"import { URL_QUESTION_SERVICE } from \u0027../../constants\u0027"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"const MatchForm \u003d ({ onClose, onSubmit, onChange }) \u003d\u003e {"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"  const [data, setData] \u003d useState()"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"    const fetchData \u003d async () \u003d\u003e {"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"      try {"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"        const { data: response } \u003d await axios.get("},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"          URL_QUESTION_SERVICE + \u0027/allTypes\u0027"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"        )"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"        const optionList \u003d response.types.map((types) \u003d\u003e "},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"            \u003coption key\u003d{types} value\u003d{types}\u003e{types}\u003c/option\u003e"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"      )"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"        setData(optionList)"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"      } catch (error) {"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"        console.error(error)"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"      }"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"    if (!data || data.length \u003d\u003d\u003d 0) {"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"      fetchData()"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"  })"},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"  return ("},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":"    \u003cTabs\u003e"},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"      \u003cTabList\u003e"},{"lineNumber":45,"author":{"gitId":"Hzxin"},"content":"        \u003cTab\u003eDifficulty\u003c/Tab\u003e"},{"lineNumber":46,"author":{"gitId":"Hzxin"},"content":"        \u003cTab\u003eCategory\u003c/Tab\u003e"},{"lineNumber":47,"author":{"gitId":"Hzxin"},"content":"      \u003c/TabList\u003e"},{"lineNumber":48,"author":{"gitId":"Hzxin"},"content":"      \u003cTabPanels\u003e"},{"lineNumber":49,"author":{"gitId":"Hzxin"},"content":"        \u003cTabPanel\u003e"},{"lineNumber":50,"author":{"gitId":"MarcusTXK"},"content":"          \u003cform onSubmit\u003d{onSubmit}\u003e"},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"            \u003cModalHeader\u003eSelect match criterias\u003c/ModalHeader\u003e"},{"lineNumber":52,"author":{"gitId":"MarcusTXK"},"content":"            \u003cModalCloseButton /\u003e"},{"lineNumber":53,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":54,"author":{"gitId":"MarcusTXK"},"content":"            \u003cModalBody\u003e"},{"lineNumber":55,"author":{"gitId":"MarcusTXK"},"content":"              \u003cFormControl isRequired\u003e"},{"lineNumber":56,"author":{"gitId":"MarcusTXK"},"content":"                \u003cFormLabel\u003eQuestion difficulty\u003c/FormLabel\u003e"},{"lineNumber":57,"author":{"gitId":"MarcusTXK"},"content":"                \u003cSelect placeholder\u003d\"Select a difficulty\" onChange\u003d{onChange}\u003e"},{"lineNumber":58,"author":{"gitId":"MarcusTXK"},"content":"                  \u003coption value\u003d\"easy\"\u003eEasy\u003c/option\u003e"},{"lineNumber":59,"author":{"gitId":"MarcusTXK"},"content":"                  \u003coption value\u003d\"medium\"\u003eMedium\u003c/option\u003e"},{"lineNumber":60,"author":{"gitId":"MarcusTXK"},"content":"                  \u003coption value\u003d\"hard\"\u003eHard\u003c/option\u003e"},{"lineNumber":61,"author":{"gitId":"MarcusTXK"},"content":"                \u003c/Select\u003e"},{"lineNumber":62,"author":{"gitId":"MarcusTXK"},"content":"              \u003c/FormControl\u003e"},{"lineNumber":63,"author":{"gitId":"Hzxin"},"content":"              \u003cFormControl isRequired\u003e\u003c/FormControl\u003e"},{"lineNumber":64,"author":{"gitId":"Hzxin"},"content":"            \u003c/ModalBody\u003e"},{"lineNumber":65,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":66,"author":{"gitId":"Hzxin"},"content":"            \u003cModalFooter\u003e"},{"lineNumber":67,"author":{"gitId":"Hzxin"},"content":"              \u003cButton variant\u003d\"ghost\" mr\u003d{3} onClick\u003d{onClose}\u003e"},{"lineNumber":68,"author":{"gitId":"Hzxin"},"content":"                Cancel"},{"lineNumber":69,"author":{"gitId":"Hzxin"},"content":"              \u003c/Button\u003e"},{"lineNumber":70,"author":{"gitId":"Hzxin"},"content":"              \u003cButton colorScheme\u003d\"blue\" type\u003d\"submit\"\u003e"},{"lineNumber":71,"author":{"gitId":"Hzxin"},"content":"                Match"},{"lineNumber":72,"author":{"gitId":"Hzxin"},"content":"              \u003c/Button\u003e"},{"lineNumber":73,"author":{"gitId":"Hzxin"},"content":"            \u003c/ModalFooter\u003e"},{"lineNumber":74,"author":{"gitId":"Hzxin"},"content":"          \u003c/form\u003e"},{"lineNumber":75,"author":{"gitId":"Hzxin"},"content":"        \u003c/TabPanel\u003e"},{"lineNumber":76,"author":{"gitId":"Hzxin"},"content":"          "},{"lineNumber":77,"author":{"gitId":"Hzxin"},"content":"        \u003cTabPanel\u003e"},{"lineNumber":78,"author":{"gitId":"Hzxin"},"content":"        \u003cform onSubmit\u003d{onSubmit}\u003e"},{"lineNumber":79,"author":{"gitId":"Hzxin"},"content":"            \u003cModalHeader\u003eSelect match criterias\u003c/ModalHeader\u003e"},{"lineNumber":80,"author":{"gitId":"Hzxin"},"content":"            \u003cModalCloseButton /\u003e"},{"lineNumber":81,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":82,"author":{"gitId":"Hzxin"},"content":"            \u003cModalBody\u003e"},{"lineNumber":83,"author":{"gitId":"Hzxin"},"content":"              \u003cFormControl isRequired\u003e"},{"lineNumber":84,"author":{"gitId":"Hzxin"},"content":"                \u003cFormLabel\u003eQuestion Category\u003c/FormLabel\u003e"},{"lineNumber":85,"author":{"gitId":"Hzxin"},"content":"                \u003cSelect placeholder\u003d\"Select a category\" onChange\u003d{onChange}\u003e"},{"lineNumber":86,"author":{"gitId":"Hzxin"},"content":"                  {data}"},{"lineNumber":87,"author":{"gitId":"Hzxin"},"content":"                \u003c/Select\u003e"},{"lineNumber":88,"author":{"gitId":"Hzxin"},"content":"              \u003c/FormControl\u003e"},{"lineNumber":89,"author":{"gitId":"Hzxin"},"content":"              \u003cFormControl isRequired\u003e\u003c/FormControl\u003e"},{"lineNumber":90,"author":{"gitId":"MarcusTXK"},"content":"            \u003c/ModalBody\u003e"},{"lineNumber":91,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":92,"author":{"gitId":"MarcusTXK"},"content":"            \u003cModalFooter\u003e"},{"lineNumber":93,"author":{"gitId":"MarcusTXK"},"content":"              \u003cButton variant\u003d\"ghost\" mr\u003d{3} onClick\u003d{onClose}\u003e"},{"lineNumber":94,"author":{"gitId":"MarcusTXK"},"content":"                Cancel"},{"lineNumber":95,"author":{"gitId":"MarcusTXK"},"content":"              \u003c/Button\u003e"},{"lineNumber":96,"author":{"gitId":"MarcusTXK"},"content":"              \u003cButton colorScheme\u003d\"blue\" type\u003d\"submit\"\u003e"},{"lineNumber":97,"author":{"gitId":"MarcusTXK"},"content":"                Match"},{"lineNumber":98,"author":{"gitId":"MarcusTXK"},"content":"              \u003c/Button\u003e"},{"lineNumber":99,"author":{"gitId":"MarcusTXK"},"content":"            \u003c/ModalFooter\u003e"},{"lineNumber":100,"author":{"gitId":"MarcusTXK"},"content":"          \u003c/form\u003e"},{"lineNumber":101,"author":{"gitId":"Hzxin"},"content":"        \u003c/TabPanel\u003e"},{"lineNumber":102,"author":{"gitId":"Hzxin"},"content":"      \u003c/TabPanels\u003e"},{"lineNumber":103,"author":{"gitId":"Hzxin"},"content":"    \u003c/Tabs\u003e"},{"lineNumber":104,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":105,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":106,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":107,"author":{"gitId":"MarcusTXK"},"content":"export default MatchForm"}],"authorContributionMap":{"MarcusTXK":41,"Hzxin":66}},{"path":"frontend/src/components/match/MatchTimeout.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"import {"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"  ModalHeader,"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"  ModalFooter,"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"  ModalBody,"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  ModalCloseButton,"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  Button,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"} from \u0027@chakra-ui/react\u0027"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"const MatchTimeout \u003d ({ onClose, handleRetry }) \u003d\u003e {"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"  return ("},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"    \u003c\u003e"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModalHeader\u003eNo match found\u003c/ModalHeader\u003e"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModalCloseButton /\u003e"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModalBody\u003e"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"        Please try again. Consider relaxing your matching critera(s)."},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"      \u003c/ModalBody\u003e"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModalFooter\u003e"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"        \u003cButton variant\u003d\"ghost\" mr\u003d{3} onClick\u003d{onClose}\u003e"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"          Cancel"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"        \u003c/Button\u003e"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"        \u003cButton colorScheme\u003d\"blue\" onClick\u003d{handleRetry}\u003e"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"          Retry"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"        \u003c/Button\u003e"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"      \u003c/ModalFooter\u003e"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"    \u003c/\u003e"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"export default MatchTimeout"}],"authorContributionMap":{"MarcusTXK":31}},{"path":"frontend/src/components/match/MatchTimer.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"import {"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"  ModalHeader,"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"  ModalFooter,"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"  ModalBody,"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  ModalCloseButton,"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  Button,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  CircularProgress,"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"  CircularProgressLabel,"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"} from \u0027@chakra-ui/react\u0027"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"import { useCountdown } from \u0027../../hooks/useCountdown\u0027"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"const MATCH_TIMEOUT_SECONDS \u003d 30"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"const MATCH_TIMEOUT \u003d MATCH_TIMEOUT_SECONDS * 1000"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"const MatchTimer \u003d ({ currDate, onClose }) \u003d\u003e {"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"  const [, , , seconds] \u003d useCountdown("},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"    new Date(currDate.getTime() + MATCH_TIMEOUT)"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"  return ("},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"    \u003c\u003e"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModalHeader\u003eFinding a Match\u003c/ModalHeader\u003e"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModalCloseButton /\u003e"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModalBody\u003e"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"        \u003cdiv className\u003d\"flex justify-center\"\u003e"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"          {seconds \u003e\u003d 0 ? ("},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"            \u003cCircularProgress"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"              value\u003d{"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"                ((MATCH_TIMEOUT_SECONDS - seconds) / MATCH_TIMEOUT_SECONDS) *"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"                100"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"              }"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"              size\u003d\"120px\""},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"            \u003e"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"              \u003cCircularProgressLabel\u003e{`${seconds}s`}\u003c/CircularProgressLabel\u003e"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"            \u003c/CircularProgress\u003e"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"          ) : ("},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"            \u003cCircularProgress isIndeterminate size\u003d\"120px\" /\u003e"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"          )}"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"        \u003c/div\u003e"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"      \u003c/ModalBody\u003e"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModalFooter\u003e"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"        \u003cButton variant\u003d\"ghost\" mr\u003d{3} onClick\u003d{onClose}\u003e"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"          Cancel"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"        \u003c/Button\u003e"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"      \u003c/ModalFooter\u003e"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":"    \u003c/\u003e"},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":"export default MatchTimer"}],"authorContributionMap":{"MarcusTXK":49}},{"path":"frontend/src/components/room/RoomEndDialog.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"import {"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"  Modal,"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"  ModalOverlay,"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"  ModalContent,"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  Button,"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  useDisclosure,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  ModalHeader,"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"  ModalCloseButton,"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"  ModalBody,"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"  ModalFooter,"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"} from \u0027@chakra-ui/react\u0027"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"import React from \u0027react\u0027"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"const RoomEndDialog \u003d ({ handleClick }) \u003d\u003e {"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"  const { isOpen, onOpen, onClose } \u003d useDisclosure()"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"  return ("},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"    \u003c\u003e"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"      \u003cButton onClick\u003d{onOpen}\u003eEnd Session\u003c/Button\u003e"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"      \u003cModal isOpen\u003d{isOpen} onClose\u003d{onClose}\u003e"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"        \u003cModalOverlay /\u003e"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"        \u003cModalContent\u003e"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"          \u003cModalHeader\u003eAre you sure?\u003c/ModalHeader\u003e"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"          \u003cModalCloseButton /\u003e"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"          \u003cModalBody\u003e"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"            Ending the session will close the room for both users and questions"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"            completed will be reflected in your match history."},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"          \u003c/ModalBody\u003e"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"          \u003cModalFooter\u003e"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"            \u003cButton variant\u003d\"ghost\" mr\u003d{3} onClick\u003d{onClose}\u003e"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"              Cancel"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"            \u003c/Button\u003e"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"            \u003cButton"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"              colorScheme\u003d\"blue\""},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"              onClick\u003d{() \u003d\u003e {"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"                onClose()"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"                handleClick()"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"              }}"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"            \u003e"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"              Confirm"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"            \u003c/Button\u003e"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"          \u003c/ModalFooter\u003e"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"        \u003c/ModalContent\u003e"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":"      \u003c/Modal\u003e"},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"    \u003c/\u003e"},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":50,"author":{"gitId":"MarcusTXK"},"content":"export default RoomEndDialog"}],"authorContributionMap":{"MarcusTXK":50}},{"path":"frontend/src/components/room/VideoChat.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"import { Peer } from \u0027peerjs\u0027"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"import {"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"  AspectRatio,"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"  HStack,"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  Button,"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  ButtonGroup,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  Stack,"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"  useColorModeValue,"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"} from \u0027@chakra-ui/react\u0027"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"import { useEffect } from \u0027react\u0027"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"import { useState } from \u0027react\u0027"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"import {"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"  FaMicrophone,"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"  FaMicrophoneSlash,"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"  FaVideo,"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"  FaVideoSlash,"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"} from \u0027react-icons/fa\u0027"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"const VideoChat \u003d ({ userId, otherUserId, roomId, socket }) \u003d\u003e {"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"  const [isShowOther, setShowOther] \u003d useState(true)"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"  const [isAudio, setAudio] \u003d useState(false)"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"  const [isVideo, setVideo] \u003d useState(false)"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"  const [peer, setPeer] \u003d useState()"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"  const [myStream, setMyStream] \u003d useState()"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"  const [otherStream, setOtherStream] \u003d useState()"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"  const buttonColour \u003d useColorModeValue(\u0027blackAlpha\u0027, \u0027gray\u0027)"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"    if (!peer) {"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"      console.log(\u0027userId: \u0027, userId)"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"      const newPeer \u003d new Peer(userId)"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"      setPeer(newPeer)"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"      console.log(\u0027newPeer: \u0027, newPeer)"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"      const selfVideo \u003d document.getElementById(\u0027self\u0027)"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"      const otherVideo \u003d document.getElementById(\u0027other\u0027)"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"      const getUserMedia \u003d"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"        navigator.getUserMedia ||"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"        navigator.webkitGetUserMedia ||"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"        navigator.mozGetUserMedia"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"      getUserMedia("},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"        { video: true, audio: isAudio },"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"        function (stream) {"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"          stream.getVideoTracks()[0].enabled \u003d isVideo"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"          setMyStream(stream)"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"          selfVideo.srcObject \u003d stream"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":"          console.log(\u0027hi over here\u0027, stream.getVideoTracks())"},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"          const call \u003d newPeer.call(otherUserId, stream)"},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"          call.on(\u0027stream\u0027, function (remoteStream) {"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":"            // Show stream in some video/canvas element."},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":"            setUpOtherStream(remoteStream, true)"},{"lineNumber":50,"author":{"gitId":"MarcusTXK"},"content":"            otherVideo.srcObject \u003d remoteStream"},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"          })"},{"lineNumber":52,"author":{"gitId":"MarcusTXK"},"content":"          console.log(\u0027otheruser: \u0027, otherUserId)"},{"lineNumber":53,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":54,"author":{"gitId":"MarcusTXK"},"content":"          socket.on(\u0027user-connected\u0027, (otherUserId) \u003d\u003e {"},{"lineNumber":55,"author":{"gitId":"MarcusTXK"},"content":"            console.log(\u0027user-connected: peer\u0027, newPeer)"},{"lineNumber":56,"author":{"gitId":"MarcusTXK"},"content":"            console.log(\u0027otherUserId\u0027, otherUserId)"},{"lineNumber":57,"author":{"gitId":"MarcusTXK"},"content":"            const call \u003d newPeer.call(otherUserId, stream)"},{"lineNumber":58,"author":{"gitId":"MarcusTXK"},"content":"            call.on(\u0027stream\u0027, function (remoteStream) {"},{"lineNumber":59,"author":{"gitId":"MarcusTXK"},"content":"              console.log(\u0027user connected and called back\u0027)"},{"lineNumber":60,"author":{"gitId":"MarcusTXK"},"content":"              setUpOtherStream(remoteStream, true)"},{"lineNumber":61,"author":{"gitId":"MarcusTXK"},"content":"              console.log(remoteStream)"},{"lineNumber":62,"author":{"gitId":"MarcusTXK"},"content":"              otherVideo.srcObject \u003d remoteStream"},{"lineNumber":63,"author":{"gitId":"MarcusTXK"},"content":"            })"},{"lineNumber":64,"author":{"gitId":"MarcusTXK"},"content":"          })"},{"lineNumber":65,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":66,"author":{"gitId":"MarcusTXK"},"content":"          socket.on(\u0027user-disconnected\u0027, (otherUserId) \u003d\u003e {"},{"lineNumber":67,"author":{"gitId":"MarcusTXK"},"content":"            console.log(\u0027user-disconnected: peer\u0027, peer)"},{"lineNumber":68,"author":{"gitId":"MarcusTXK"},"content":"            console.log(\u0027otherUserId\u0027, otherUserId)"},{"lineNumber":69,"author":{"gitId":"MarcusTXK"},"content":"            setUpOtherStream(null, false)"},{"lineNumber":70,"author":{"gitId":"MarcusTXK"},"content":"            otherVideo.srcObject \u003d null"},{"lineNumber":71,"author":{"gitId":"MarcusTXK"},"content":"          })"},{"lineNumber":72,"author":{"gitId":"MarcusTXK"},"content":"        },"},{"lineNumber":73,"author":{"gitId":"MarcusTXK"},"content":"        function (err) {"},{"lineNumber":74,"author":{"gitId":"MarcusTXK"},"content":"          console.log(\u0027Failed to get local stream\u0027, err)"},{"lineNumber":75,"author":{"gitId":"MarcusTXK"},"content":"        }"},{"lineNumber":76,"author":{"gitId":"MarcusTXK"},"content":"      )"},{"lineNumber":77,"author":{"gitId":"MarcusTXK"},"content":"      newPeer.on(\u0027call\u0027, function (call) {"},{"lineNumber":78,"author":{"gitId":"MarcusTXK"},"content":"        getUserMedia("},{"lineNumber":79,"author":{"gitId":"MarcusTXK"},"content":"          { video: true, audio: isAudio },"},{"lineNumber":80,"author":{"gitId":"MarcusTXK"},"content":"          function (stream) {"},{"lineNumber":81,"author":{"gitId":"MarcusTXK"},"content":"            console.log(\u0027Hi, I just got a call\u0027)"},{"lineNumber":82,"author":{"gitId":"MarcusTXK"},"content":"            stream.getVideoTracks()[0].enabled \u003d isVideo"},{"lineNumber":83,"author":{"gitId":"MarcusTXK"},"content":"            call.answer(stream) // Answer the call with an A/V stream."},{"lineNumber":84,"author":{"gitId":"MarcusTXK"},"content":"            call.on(\u0027stream\u0027, function (remoteStream) {"},{"lineNumber":85,"author":{"gitId":"MarcusTXK"},"content":"              // Show stream in some video/canvas element."},{"lineNumber":86,"author":{"gitId":"MarcusTXK"},"content":"              console.log(\u0027remote stream from call\u0027, remoteStream)"},{"lineNumber":87,"author":{"gitId":"MarcusTXK"},"content":"              otherVideo.srcObject \u003d remoteStream"},{"lineNumber":88,"author":{"gitId":"MarcusTXK"},"content":"              setUpOtherStream(remoteStream, true)"},{"lineNumber":89,"author":{"gitId":"MarcusTXK"},"content":"            })"},{"lineNumber":90,"author":{"gitId":"MarcusTXK"},"content":"          },"},{"lineNumber":91,"author":{"gitId":"MarcusTXK"},"content":"          function (err) {"},{"lineNumber":92,"author":{"gitId":"MarcusTXK"},"content":"            console.log(\u0027Failed to get local stream\u0027, err)"},{"lineNumber":93,"author":{"gitId":"MarcusTXK"},"content":"          }"},{"lineNumber":94,"author":{"gitId":"MarcusTXK"},"content":"        )"},{"lineNumber":95,"author":{"gitId":"MarcusTXK"},"content":"      })"},{"lineNumber":96,"author":{"gitId":"MarcusTXK"},"content":"      newPeer.on(\u0027close\u0027, function () {"},{"lineNumber":97,"author":{"gitId":"MarcusTXK"},"content":"        console.log(\u0027close\u0027)"},{"lineNumber":98,"author":{"gitId":"MarcusTXK"},"content":"      })"},{"lineNumber":99,"author":{"gitId":"MarcusTXK"},"content":"      newPeer.on(\u0027open\u0027, (userId) \u003d\u003e {"},{"lineNumber":100,"author":{"gitId":"MarcusTXK"},"content":"        console.log(\u0027opened with: \u0027, userId)"},{"lineNumber":101,"author":{"gitId":"MarcusTXK"},"content":"        socket.emit(\u0027join-room\u0027, { roomId, userId })"},{"lineNumber":102,"author":{"gitId":"MarcusTXK"},"content":"      })"},{"lineNumber":103,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":104,"author":{"gitId":"MarcusTXK"},"content":"  }, [isAudio, isVideo, otherUserId, peer, roomId, socket, userId])"},{"lineNumber":105,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":106,"author":{"gitId":"MarcusTXK"},"content":"  const setUpOtherStream \u003d (stream, isShow) \u003d\u003e {"},{"lineNumber":107,"author":{"gitId":"MarcusTXK"},"content":"    setOtherStream(stream)"},{"lineNumber":108,"author":{"gitId":"MarcusTXK"},"content":"    setShowOther(isShow)"},{"lineNumber":109,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":110,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":111,"author":{"gitId":"MarcusTXK"},"content":"  const toggleAudioVideo \u003d (isAudio, isVideo) \u003d\u003e {"},{"lineNumber":112,"author":{"gitId":"MarcusTXK"},"content":"    setAudio(isAudio)"},{"lineNumber":113,"author":{"gitId":"MarcusTXK"},"content":"    setVideo(isVideo)"},{"lineNumber":114,"author":{"gitId":"MarcusTXK"},"content":"    const selfVideo \u003d document.getElementById(\u0027self\u0027)"},{"lineNumber":115,"author":{"gitId":"MarcusTXK"},"content":"    const getUserMedia \u003d"},{"lineNumber":116,"author":{"gitId":"MarcusTXK"},"content":"      navigator.getUserMedia ||"},{"lineNumber":117,"author":{"gitId":"MarcusTXK"},"content":"      navigator.webkitGetUserMedia ||"},{"lineNumber":118,"author":{"gitId":"MarcusTXK"},"content":"      navigator.mozGetUserMedia"},{"lineNumber":119,"author":{"gitId":"MarcusTXK"},"content":"    console.log(\u0027toggleAudioVideo\u0027)"},{"lineNumber":120,"author":{"gitId":"MarcusTXK"},"content":"    getUserMedia("},{"lineNumber":121,"author":{"gitId":"MarcusTXK"},"content":"      { video: true, audio: isAudio },"},{"lineNumber":122,"author":{"gitId":"MarcusTXK"},"content":"      function (stream) {"},{"lineNumber":123,"author":{"gitId":"MarcusTXK"},"content":"        console.log(\u0027toggleAudioVideo send new stream isVideo\u0027, isVideo)"},{"lineNumber":124,"author":{"gitId":"MarcusTXK"},"content":"        stream.getVideoTracks()[0].enabled \u003d isVideo"},{"lineNumber":125,"author":{"gitId":"MarcusTXK"},"content":"        setMyStream(stream)"},{"lineNumber":126,"author":{"gitId":"MarcusTXK"},"content":"        selfVideo.srcObject \u003d stream"},{"lineNumber":127,"author":{"gitId":"MarcusTXK"},"content":"        peer.call(otherUserId, stream)"},{"lineNumber":128,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":129,"author":{"gitId":"MarcusTXK"},"content":"      function (err) {"},{"lineNumber":130,"author":{"gitId":"MarcusTXK"},"content":"        console.log(\u0027Failed to get local stream\u0027, err)"},{"lineNumber":131,"author":{"gitId":"MarcusTXK"},"content":"      }"},{"lineNumber":132,"author":{"gitId":"MarcusTXK"},"content":"    )"},{"lineNumber":133,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":134,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":135,"author":{"gitId":"MarcusTXK"},"content":"  return ("},{"lineNumber":136,"author":{"gitId":"MarcusTXK"},"content":"    \u003c\u003e"},{"lineNumber":137,"author":{"gitId":"MarcusTXK"},"content":"      \u003cHStack spacing\u003d\"5px\" position\u003d\"fixed\" bottom\u003d{5} right\u003d{5} zIndex\u003d{1000}\u003e"},{"lineNumber":138,"author":{"gitId":"MarcusTXK"},"content":"        {isShowOther \u0026\u0026 ("},{"lineNumber":139,"author":{"gitId":"MarcusTXK"},"content":"          \u003cStack spacing\u003d{-10} background\u003d\"black\"\u003e"},{"lineNumber":140,"author":{"gitId":"MarcusTXK"},"content":"            \u003cAspectRatio w\u003d\"200px\" ratio\u003d{4 / 3}\u003e"},{"lineNumber":141,"author":{"gitId":"MarcusTXK"},"content":"              \u003cvideo id\u003d\"other\" autoPlay\u003d{true} /\u003e"},{"lineNumber":142,"author":{"gitId":"MarcusTXK"},"content":"            \u003c/AspectRatio\u003e"},{"lineNumber":143,"author":{"gitId":"MarcusTXK"},"content":"            \u003cButtonGroup colorScheme\u003d{buttonColour} spacing\u003d\"0\"\u003e"},{"lineNumber":144,"author":{"gitId":"MarcusTXK"},"content":"              \u003cButton width\u003d\"full\"\u003e"},{"lineNumber":145,"author":{"gitId":"MarcusTXK"},"content":"                {otherStream \u0026\u0026 otherStream.getAudioTracks().length \u003e 0 ? ("},{"lineNumber":146,"author":{"gitId":"MarcusTXK"},"content":"                  \u003cFaMicrophone /\u003e"},{"lineNumber":147,"author":{"gitId":"MarcusTXK"},"content":"                ) : ("},{"lineNumber":148,"author":{"gitId":"MarcusTXK"},"content":"                  \u003cFaMicrophoneSlash /\u003e"},{"lineNumber":149,"author":{"gitId":"MarcusTXK"},"content":"                )}"},{"lineNumber":150,"author":{"gitId":"MarcusTXK"},"content":"              \u003c/Button\u003e"},{"lineNumber":151,"author":{"gitId":"MarcusTXK"},"content":"              \u003cButton width\u003d\"full\"\u003e{otherUserId}\u003c/Button\u003e"},{"lineNumber":152,"author":{"gitId":"MarcusTXK"},"content":"            \u003c/ButtonGroup\u003e"},{"lineNumber":153,"author":{"gitId":"MarcusTXK"},"content":"          \u003c/Stack\u003e"},{"lineNumber":154,"author":{"gitId":"MarcusTXK"},"content":"        )}"},{"lineNumber":155,"author":{"gitId":"MarcusTXK"},"content":"        \u003cStack spacing\u003d{-10} background\u003d\"black\"\u003e"},{"lineNumber":156,"author":{"gitId":"MarcusTXK"},"content":"          \u003cAspectRatio w\u003d\"200px\" ratio\u003d{4 / 3}\u003e"},{"lineNumber":157,"author":{"gitId":"MarcusTXK"},"content":"            \u003cvideo id\u003d\"self\" muted\u003d{true} autoPlay\u003d{true} /\u003e"},{"lineNumber":158,"author":{"gitId":"MarcusTXK"},"content":"          \u003c/AspectRatio\u003e"},{"lineNumber":159,"author":{"gitId":"MarcusTXK"},"content":"          \u003cButtonGroup colorScheme\u003d{buttonColour} spacing\u003d\"0\"\u003e"},{"lineNumber":160,"author":{"gitId":"MarcusTXK"},"content":"            \u003cButton"},{"lineNumber":161,"author":{"gitId":"MarcusTXK"},"content":"              width\u003d\"full\""},{"lineNumber":162,"author":{"gitId":"MarcusTXK"},"content":"              onClick\u003d{() \u003d\u003e {"},{"lineNumber":163,"author":{"gitId":"MarcusTXK"},"content":"                toggleAudioVideo(!isAudio, isVideo)"},{"lineNumber":164,"author":{"gitId":"MarcusTXK"},"content":"              }}"},{"lineNumber":165,"author":{"gitId":"MarcusTXK"},"content":"            \u003e"},{"lineNumber":166,"author":{"gitId":"MarcusTXK"},"content":"              {isAudio ? \u003cFaMicrophone /\u003e : \u003cFaMicrophoneSlash /\u003e}"},{"lineNumber":167,"author":{"gitId":"MarcusTXK"},"content":"            \u003c/Button\u003e"},{"lineNumber":168,"author":{"gitId":"MarcusTXK"},"content":"            \u003cButton"},{"lineNumber":169,"author":{"gitId":"MarcusTXK"},"content":"              width\u003d\"full\""},{"lineNumber":170,"author":{"gitId":"MarcusTXK"},"content":"              onClick\u003d{() \u003d\u003e {"},{"lineNumber":171,"author":{"gitId":"MarcusTXK"},"content":"                console.log(myStream)"},{"lineNumber":172,"author":{"gitId":"MarcusTXK"},"content":"                toggleAudioVideo(isAudio, !isVideo)"},{"lineNumber":173,"author":{"gitId":"MarcusTXK"},"content":"              }}"},{"lineNumber":174,"author":{"gitId":"MarcusTXK"},"content":"            \u003e"},{"lineNumber":175,"author":{"gitId":"MarcusTXK"},"content":"              {isVideo ? \u003cFaVideo /\u003e : \u003cFaVideoSlash /\u003e}"},{"lineNumber":176,"author":{"gitId":"MarcusTXK"},"content":"            \u003c/Button\u003e"},{"lineNumber":177,"author":{"gitId":"MarcusTXK"},"content":"          \u003c/ButtonGroup\u003e"},{"lineNumber":178,"author":{"gitId":"MarcusTXK"},"content":"        \u003c/Stack\u003e"},{"lineNumber":179,"author":{"gitId":"MarcusTXK"},"content":"      \u003c/HStack\u003e"},{"lineNumber":180,"author":{"gitId":"MarcusTXK"},"content":"    \u003c/\u003e"},{"lineNumber":181,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":182,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":183,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":184,"author":{"gitId":"MarcusTXK"},"content":"export default VideoChat"}],"authorContributionMap":{"MarcusTXK":184}},{"path":"frontend/src/constants.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"export const STATUS_CODE_CREATED \u003d 201"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"export const STATUS_CODE_SUCCESS \u003d 200"},{"lineNumber":3,"author":{"gitId":"-"},"content":"export const STATUS_CODE_CONFLICT \u003d 409"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"export const STATUS_CODE_BAD_REQUEST \u003d 400"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"// USER SERVICE API"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"const URI_USER_SERVICE \u003d"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"  process.env.NODE_ENV \u003d\u003d\u003d \u0027production\u0027"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    ? \u0027\u0027"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"    : \u0027http://localhost:8000\u0027"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"const PREFIX_USER_SERVICE \u003d \u0027/api/v1/user\u0027"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"export const URL_USER_SERVICE \u003d URI_USER_SERVICE + PREFIX_USER_SERVICE"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"export const URL_USER_LOGIN \u003d URL_USER_SERVICE + \u0027/login\u0027"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"export const URL_USER_LOGOUT \u003d URL_USER_SERVICE + \u0027/logout\u0027"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"export const URL_USER_SIGNUP \u003d URL_USER_SERVICE + \u0027/signup\u0027"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"export const URL_USER_TOKEN \u003d URL_USER_SERVICE + \u0027/token\u0027"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"export const URL_USER_TOKEN_TEST \u003d URL_USER_SERVICE + \u0027/testToken\u0027"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"// QUESTION SERVICE API"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"const URI_QUESTION_SERVICE \u003d"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"  process.env.NODE_ENV \u003d\u003d\u003d \u0027production\u0027"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"    ? \u0027\u0027"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"    : \u0027http://localhost:8500\u0027"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"export const URL_QUESTION_SERVICE \u003d URI_QUESTION_SERVICE + \u0027/api/v1/question\u0027"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"export const PASSWORD_REGEX \u003d"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"  /^(?\u003d.*[a-z])(?\u003d.*[A-Z])(?\u003d.*[0-9])(?\u003d.*[!@#$%]).{8,24}$/"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"export const USER_REGEX \u003d /^[A-z][A-z0-9-_]{3,23}$/"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"export const EMAIL_REGEX \u003d /^\\S+@\\S+\\.\\S+$/"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"export const URI_MATCHING_SERVICE \u003d"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"  process.env.NODE_ENV \u003d\u003d\u003d \u0027production\u0027"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"    ? \u0027\u0027"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"    : \u0027http://localhost:8001\u0027"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"export const URI_MATCHING_SERVICE_SOCKET_PATH \u003d \u0027/socket.io/matching\u0027"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"const PREFIX_MATCHING_SERVICE \u003d \u0027/api/v1/matching\u0027"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"export const URL_MATCHING_SERVICE \u003d"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"  URI_MATCHING_SERVICE + PREFIX_MATCHING_SERVICE"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"export const URI_ROOM_SERVICE \u003d"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"  process.env.NODE_ENV \u003d\u003d\u003d \u0027production\u0027"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"    ? \u0027\u0027"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":"    : \u0027http://localhost:8022\u0027"},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"export const URI_ROOM_SERVICE_SOCKET_PATH \u003d \u0027/socket.io/room\u0027"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":"const PREFIX_ROOM_SERVICE \u003d \u0027/api/v1/room\u0027"},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":"export const URL_ROOM_SERVICE \u003d URI_ROOM_SERVICE + PREFIX_ROOM_SERVICE"},{"lineNumber":50,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"export const EVENT_LISTEN \u003d {"},{"lineNumber":52,"author":{"gitId":"MarcusTXK"},"content":"  MATCHING: \u0027matching\u0027,"},{"lineNumber":53,"author":{"gitId":"MarcusTXK"},"content":"  MATCH_SUCCESS: \u0027matchSuccess\u0027,"},{"lineNumber":54,"author":{"gitId":"MarcusTXK"},"content":"  MATCH_FAIL: \u0027matchFail\u0027,"},{"lineNumber":55,"author":{"gitId":"MarcusTXK"},"content":"  MATCH_TIMEOUT: \u0027matchTimeout\u0027,"},{"lineNumber":56,"author":{"gitId":"MarcusTXK"},"content":"  ROOM_END: \u0027roomEnd\u0027,"},{"lineNumber":57,"author":{"gitId":"MarcusTXK"},"content":"  ROOM_UPDATE: \u0027roomUpdate\u0027,"},{"lineNumber":58,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":59,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":60,"author":{"gitId":"MarcusTXK"},"content":"export const EVENT_EMIT \u003d {"},{"lineNumber":61,"author":{"gitId":"MarcusTXK"},"content":"  MATCH_FIND: \u0027matchFind\u0027,"},{"lineNumber":62,"author":{"gitId":"MarcusTXK"},"content":"  MATCH_CANCEL: \u0027matchCancel\u0027,"},{"lineNumber":63,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"export const RANDOM_AVATAR_URL \u003d \u0027https://avatars.dicebear.com/api/bottts/\u0027"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"// HISTORY SERVICE API"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"const URI_HISTORY_SERVICE \u003d"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"  process.env.NODE_ENV \u003d\u003d\u003d \u0027production\u0027"},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"    ? \u0027\u0027"},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"    : \u0027http://localhost:8080\u0027"},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"const PREFIX_HISTORY_SERVICE \u003d \u0027/api/v1/history\u0027"},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"export const URL_HISTORY_USER \u003d"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"  URI_HISTORY_SERVICE + PREFIX_HISTORY_SERVICE + \u0027/user\u0027"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":"export const URL_HISTORY_ROOM \u003d"},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"  URI_HISTORY_SERVICE + PREFIX_HISTORY_SERVICE + \u0027/room\u0027"}],"authorContributionMap":{"MarcusTXK":40,"Hzxin":3,"tlylt":21,"-":2,"uyencfi":11}},{"path":"frontend/src/context/AuthProvider.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { createContext, useState } from \"react\";"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"const AuthContext \u003d createContext({});"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"export const AuthProvider \u003d ({ children }) \u003d\u003e {"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    const [auth, setAuth] \u003d useState({"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"        accessToken: \"\","},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"        username: \"\","},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"        email: \"\","},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        school: \"\","},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"        isLoggedIn: false,"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"    });"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    const [persist, setPersist] \u003d useState(JSON.parse(localStorage.getItem(\"persist:peerprep\")) || false);"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    return ("},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        \u003cAuthContext.Provider value\u003d{{ auth, setAuth, persist, setPersist }}\u003e"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"            {children}"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"        \u003c/AuthContext.Provider\u003e"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"    )"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"export default AuthContext;"}],"authorContributionMap":{"tlylt":22}},{"path":"frontend/src/hooks/useAuth.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { useContext, useDebugValue } from \"react\";"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import AuthContext from \"../context/AuthProvider\";"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"const useAuth \u003d () \u003d\u003e {"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"    const { auth } \u003d useContext(AuthContext);"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    useDebugValue(auth, auth \u003d\u003e auth?.username ? \"Logged In\" : \"Logged Out\")"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    return useContext(AuthContext);"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"export default useAuth;"}],"authorContributionMap":{"tlylt":10}},{"path":"frontend/src/hooks/useAxiosPrivate.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import axios from \u0027../api/axios.js\u0027;"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { useEffect } from \"react\";"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import useRefreshToken from \"./useRefreshToken\";"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import useAuth from \"./useAuth\";"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"const axiosPrivate \u003d axios.create({"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    withCredentials: true,"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    headers: {"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"        \u0027Content-Type\u0027: \u0027application/json\u0027,"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"});"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"const useAxiosPrivate \u003d () \u003d\u003e {"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    const refresh \u003d useRefreshToken();"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    const { auth } \u003d useAuth();"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"    useEffect(() \u003d\u003e {"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"        const requestIntercept \u003d axiosPrivate.interceptors.request.use("},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"            config \u003d\u003e {"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"                if (!config.headers[\u0027Authorization\u0027]) {"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"                    config.headers[\u0027Authorization\u0027] \u003d `Bearer ${auth?.accessToken}`;"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"                }"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"                return config;"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"            }, (error) \u003d\u003e Promise.reject(error)"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        );"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"        const responseIntercept \u003d axiosPrivate.interceptors.response.use("},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"            response \u003d\u003e response,"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"            async (error) \u003d\u003e {"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"                const prevRequest \u003d error?.config;"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"                if (error?.response?.status \u003d\u003d\u003d 401 \u0026\u0026 !prevRequest?.sent) {"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"                    prevRequest.sent \u003d true;"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"                    const newAccessToken \u003d await refresh();"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"                    prevRequest.headers[\u0027Authorization\u0027] \u003d `Bearer ${newAccessToken}`;"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"                    return axiosPrivate(prevRequest);"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"                }"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"                return Promise.reject(error);"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"            }"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"        );"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"        return () \u003d\u003e {"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"            axiosPrivate.interceptors.request.eject(requestIntercept);"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"            axiosPrivate.interceptors.response.eject(responseIntercept);"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"    }, [auth, refresh])"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"    return axiosPrivate;"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"export default useAxiosPrivate;"}],"authorContributionMap":{"tlylt":50}},{"path":"frontend/src/hooks/useCountdown.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"import { useEffect, useState } from \u0027react\u0027"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"// Credit to https://blog.greenroots.info/how-to-create-a-countdown-timer-using-react-hooks"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"const useCountdown \u003d (targetDate) \u003d\u003e {"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  const countDownDate \u003d new Date(targetDate).getTime()"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"  const [countDown, setCountDown] \u003d useState("},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"    countDownDate - new Date().getTime()"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"    const interval \u003d setInterval(() \u003d\u003e {"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"      setCountDown(countDownDate - new Date().getTime())"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"    }, 1000)"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"    return () \u003d\u003e clearInterval(interval)"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"  }, [countDownDate])"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"  return getReturnValues(countDown)"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"const getReturnValues \u003d (countDown) \u003d\u003e {"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"  // calculate time left"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"  const days \u003d Math.floor(countDown / (1000 * 60 * 60 * 24))"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"  const hours \u003d Math.floor("},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"    (countDown % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"  const minutes \u003d Math.floor((countDown % (1000 * 60 * 60)) / (1000 * 60))"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"  const seconds \u003d Math.floor((countDown % (1000 * 60)) / 1000)"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"  return [days, hours, minutes, seconds]"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"export { useCountdown }"}],"authorContributionMap":{"MarcusTXK":35}},{"path":"frontend/src/hooks/useFetchQuestionById.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"import axios from \u0027../api/axios\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"import { useState, useEffect } from \u0027react\u0027"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"import { URL_QUESTION_SERVICE } from \u0027../constants\u0027"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"const useFetchQuestionById \u003d (questionId) \u003d\u003e {"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  const [loading, setLoading] \u003d useState(true)"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  const [data, setData] \u003d useState()"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"    const fetchData \u003d async () \u003d\u003e {"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"      setLoading(true)"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"      try {"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"        const { data: response } \u003d await axios.get("},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"          URL_QUESTION_SERVICE + \u0027?id\u003d\u0027 + (questionId ? questionId : \u00271\u0027)"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"        )"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"        setData(response)"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"      } catch (error) {"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"        //todo toast"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"        console.error(error)"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"      }"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"      setLoading(false)"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"    fetchData()"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"  }, [questionId])"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"  return {"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"    data,"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"    loading,"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"export default useFetchQuestionById"}],"authorContributionMap":{"MarcusTXK":15,"Hzxin":17}},{"path":"frontend/src/hooks/useLanguage.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { useEffect, useState } from \u0027react\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { db } from \u0027../api/firebase\u0027"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"const DEFAULT_LANGUAGE \u003d \u0027Python\u0027"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"/** "},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":" * Hook used in collaborative editor to sync the editor\u0027s coding language between users."},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":" * Returns the current language, and a function to update it."},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"const useLanguage \u003d (docPath) \u003d\u003e {"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"  const [language, setLanguageLocally] \u003d useState(DEFAULT_LANGUAGE)"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"    const dbRef \u003d db.ref(`${docPath}/language`)"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    // Listen to change from the other user"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"    dbRef.on(\u0027value\u0027, (snapshot) \u003d\u003e {"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"      if (snapshot.exists() \u0026\u0026 snapshot.val() !\u003d\u003d language) {"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"        setLanguageLocally(snapshot.val())"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"    // Cleanup effect: Detach listener"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"    return () \u003d\u003e dbRef.off()"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"  })"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"  const updateLang \u003d (newLang) \u003d\u003e {"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"    if (newLang \u003d\u003d\u003d language) return"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"    setLanguageLocally(newLang)"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"    return db.ref(`${docPath}/language`).set(newLang).catch(console.log)"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"  return [language, updateLang]"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"export default useLanguage"}],"authorContributionMap":{"uyencfi":34}},{"path":"frontend/src/hooks/useLocalStorage.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"// https://usehooks.com/useLocalStorage"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { useState } from \"react\";"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"function useLocalStorage(key, initialValue) {"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"    // State to store our value"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    // Pass initial state function to useState so logic is only executed once"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    const [storedValue, setStoredValue] \u003d useState(() \u003d\u003e {"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"        if (typeof window \u003d\u003d\u003d \"undefined\") {"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"            return initialValue;"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"        try {"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"            // Get from local storage by key"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"            const item \u003d window.localStorage.getItem(key);"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"            // Parse stored json or if none return initialValue"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"            return item ? JSON.parse(item) : initialValue;"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        } catch (error) {"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"            // If error also return initialValue"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"            console.log(error);"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"            return initialValue;"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"    });"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"    // Return a wrapped version of useState\u0027s setter function that ..."},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"    // ... persists the new value to localStorage."},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"    const setValue \u003d (value) \u003d\u003e {"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        try {"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"            // Allow value to be a function so we have same API as useState"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"            const valueToStore \u003d"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"                value instanceof Function ? value(storedValue) : value;"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"            // Save state"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"            setStoredValue(valueToStore);"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"            // Save to local storage"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"            if (typeof window !\u003d\u003d \"undefined\") {"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"                window.localStorage.setItem(key, JSON.stringify(valueToStore));"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"            }"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"        } catch (error) {"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"            // A more advanced implementation would handle the error case"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"            console.log(error);"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"    };"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"    return [storedValue, setValue];"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"export default useLocalStorage;"}],"authorContributionMap":{"tlylt":43}},{"path":"frontend/src/hooks/useLogout.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { useNavigate } from \"react-router-dom\";"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { STATUS_CODE_SUCCESS, URL_USER_LOGOUT } from \"../constants\";"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import useAuth from \"./useAuth\";"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import useAxiosPrivate from \"./useAxiosPrivate\";"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"const useLogout \u003d () \u003d\u003e {"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    const { setAuth } \u003d useAuth();"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    const axiosPrivate \u003d useAxiosPrivate()"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    const navigate \u003d useNavigate()"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    const logout \u003d async () \u003d\u003e {"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"        try {"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"            const res \u003d await axiosPrivate.post(URL_USER_LOGOUT, {"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"                withCredentials: true"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"            }).catch((err) \u003d\u003e {"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"                console.log(err.response.data.message)"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"            })"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"            if (res \u0026\u0026 res.status \u003d\u003d\u003d STATUS_CODE_SUCCESS) {"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"                setAuth({"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"                    accessToken: \u0027\u0027,"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"                    username: \u0027\u0027,"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"                    email: \u0027\u0027,"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"                    school: \u0027\u0027,"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"                    isLoggedIn: false"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"                })"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"                navigate(\u0027/login\u0027)"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"            }"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"        } catch (err) {"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"            console.error(err);"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"    return logout;"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"export default useLogout"}],"authorContributionMap":{"tlylt":36}},{"path":"frontend/src/hooks/useMedia.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"// https://usehooks.com/useMedia"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { useState, useEffect } from \"react\";"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"function useMedia(queries, values, defaultValue) {"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"    // Array containing a media query list for each query"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    const mediaQueryLists \u003d queries.map((q) \u003d\u003e window.matchMedia(q));"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    // Function that gets value based on matching media query"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    const getValue \u003d () \u003d\u003e {"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"        // Get index of first media query that matches"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        const index \u003d mediaQueryLists.findIndex((mql) \u003d\u003e mql.matches);"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"        // Return related value or defaultValue if none"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"        return typeof values[index] !\u003d\u003d \"undefined\" ? values[index] : defaultValue;"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    };"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    // State and setter for matched value"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    const [value, setValue] \u003d useState(getValue);"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"    useEffect("},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"        () \u003d\u003e {"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"            // Event listener callback"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"            // Note: By defining getValue outside of useEffect we ensure that it has ..."},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"            // ... current values of hook args (as this hook callback is created once on mount)."},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"            const handler \u003d () \u003d\u003e setValue(getValue);"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"            // Set a listener for each media query with above handler as callback."},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"            mediaQueryLists.forEach((mql) \u003d\u003e mql.addListener(handler));"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"            // Remove listeners on cleanup"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"            return () \u003d\u003e"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"                mediaQueryLists.forEach((mql) \u003d\u003e mql.removeListener(handler));"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"        },"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"        // eslint-disable-next-line react-hooks/exhaustive-deps"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"        [] // Empty array ensures effect is only run on mount and unmount"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"    );"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"    return value;"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"export default useMedia;"}],"authorContributionMap":{"tlylt":34}},{"path":"frontend/src/hooks/useRefreshToken.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import axios from \u0027../api/axios\u0027;"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { URL_USER_TOKEN } from \u0027../constants\u0027;"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import useAuth from \u0027./useAuth\u0027;"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"const useRefreshToken \u003d () \u003d\u003e {"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    const { setAuth } \u003d useAuth();"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    const refresh \u003d async () \u003d\u003e {"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"        const response \u003d await axios.post(URL_USER_TOKEN);"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        if (response.status \u003d\u003d\u003d 200) {"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"            setAuth(prev \u003d\u003e {"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"                return {"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"                    ...prev,"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"                    accessToken: response.data.data.accessToken,"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"                    username: response.data.data.username,"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"                    email: response.data.data.email,"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"                    school: response.data.data.school,"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"                    isLoggedIn: true"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"                }"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"            })"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"            return response.data.data.accessToken;"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"        console.error(response.data.message);"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"        setAuth({"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"            accessToken: \u0027\u0027,"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"            username: \u0027\u0027,"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"            email: \u0027\u0027,"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"            school: \u0027\u0027,"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"            isLoggedIn: false"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"        })"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"        return null;"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"    return refresh;"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"};"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"export default useRefreshToken;"}],"authorContributionMap":{"tlylt":36}},{"path":"frontend/src/hooks/useTabSize.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { useEffect, useState } from \u0027react\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { db } from \u0027../api/firebase\u0027"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"const DEFAULT_TAB \u003d 4"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"/** "},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":" * Hook used in collaborative editor to sync tabSize between users."},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":" * Returns the current tab size, and a function to update it."},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"const useTabSize \u003d (docPath) \u003d\u003e {"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"  const [tab, setTabLocally] \u003d useState(DEFAULT_TAB)"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"    const dbRef \u003d db.ref(`${docPath}/tab`)"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    // Listen to tabSize change from the other user"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"    dbRef.on(\u0027value\u0027, (snapshot) \u003d\u003e {"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"      if (snapshot.exists() \u0026\u0026 snapshot.val() !\u003d\u003d tab) {"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"        setTabLocally(snapshot.val())"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"    // Cleanup effect: Detach listener"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"    return () \u003d\u003e dbRef.off()"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"  })"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"  const updateTab \u003d (newTab) \u003d\u003e {"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"    if (newTab \u003d\u003d\u003d tab) return"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"    setTabLocally(newTab)"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"    return db.ref(`${docPath}/tab`).set(newTab).catch(console.log)"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"  return [tab, updateTab]"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"export default useTabSize"}],"authorContributionMap":{"uyencfi":34}},{"path":"frontend/src/index.css","fileType":"css","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":".errormsg {"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"  background-color: lightpink;"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"  color: firebrick;"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  font-weight: bold;"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  padding: 0.5rem;"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  margin-bottom: 0.5rem;"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"html {"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  margin-left: calc(100vw - 100%); /* Prevent scrollbar jumping */"},{"lineNumber":11,"author":{"gitId":"-"},"content":"}"}],"authorContributionMap":{"tlylt":10,"-":1}},{"path":"frontend/src/index.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import React from \u0027react\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import ReactDOM from \u0027react-dom/client\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import \u0027./index.css\u0027"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import \u0027./styles/tailwind.css\u0027"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"import App from \u0027./App\u0027"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"import reportWebVitals from \u0027./reportWebVitals\u0027"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"import { ChakraProvider, ColorModeScript } from \u0027@chakra-ui/react\u0027"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"import { HelmetProvider } from \u0027react-helmet-async\u0027"},{"lineNumber":9,"author":{"gitId":"-"},"content":""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"import { AuthProvider } from \u0027./context/AuthProvider\u0027"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"import theme from \u0027./theme\u0027"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"const root \u003d ReactDOM.createRoot(document.getElementById(\u0027root\u0027))"},{"lineNumber":14,"author":{"gitId":"-"},"content":"root.render("},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"  \u003cReact.StrictMode\u003e"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"    \u003cChakraProvider theme\u003d{theme}\u003e"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"      \u003cColorModeScript initialColorMode\u003d{theme.config.initialColorMode} /\u003e"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"      \u003cHelmetProvider\u003e"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"        \u003cAuthProvider\u003e"},{"lineNumber":20,"author":{"gitId":"-"},"content":"          \u003cApp /\u003e"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"        \u003c/AuthProvider\u003e"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"      \u003c/HelmetProvider\u003e"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"    \u003c/ChakraProvider\u003e"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"  \u003c/React.StrictMode\u003e"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":")"},{"lineNumber":26,"author":{"gitId":"-"},"content":""},{"lineNumber":27,"author":{"gitId":"-"},"content":"// If you want to start measuring performance in your app, pass a function"},{"lineNumber":28,"author":{"gitId":"-"},"content":"// to log results (for example: reportWebVitals(console.log))"},{"lineNumber":29,"author":{"gitId":"-"},"content":"// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"reportWebVitals()"}],"authorContributionMap":{"tlylt":23,"-":7}},{"path":"frontend/src/pages/History.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import useAuth from \u0027../hooks/useAuth\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { Helmet } from \u0027react-helmet-async\u0027"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import { useState, useEffect } from \u0027react\u0027"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"import useAxiosPrivate from \u0027../hooks/useAxiosPrivate\u0027"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"import {"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  URL_HISTORY_USER,"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  STATUS_CODE_BAD_REQUEST,"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  STATUS_CODE_SUCCESS,"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"} from \u0027../constants\u0027"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"import {"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"  Table,"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"  Thead,"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"  Tbody,"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"  Tr,"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"  Th,"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"  Td,"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"  TableContainer,"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"  Spinner,"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"  Button,"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"} from \u0027@chakra-ui/react\u0027"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"import { useNavigate } from \u0027react-router-dom\u0027"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"const History \u003d () \u003d\u003e {"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"  const { auth } \u003d useAuth()"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"  const axiosPrivate \u003d useAxiosPrivate()"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"  const [hist, setHist] \u003d useState([])"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"  const [isValid, setIsValid] \u003d useState(false)"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"  const [isLoading, setIsLoading] \u003d useState(true)"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"    const fetchHist \u003d async () \u003d\u003e {"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"      const res \u003d await axiosPrivate"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"        .get(`${URL_HISTORY_USER}/${auth.username}`)"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"        .catch((e) \u003d\u003e {"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"          if (e.response.status \u003d\u003d\u003d STATUS_CODE_BAD_REQUEST) {"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"            setIsValid(false) // no username given"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"            return setIsLoading(false)"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"          }"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"        })"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"      if (res \u0026\u0026 res.status \u003d\u003d\u003d STATUS_CODE_SUCCESS) {"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"        setHist(res.data.data)"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"        setIsValid(true)"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"        setIsLoading(false)"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"    fetchHist()"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"    // eslint-disable-next-line react-hooks/exhaustive-deps"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"  }, [])"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"  const getHelmet \u003d () \u003d\u003e {"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    return ("},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"      \u003cHelmet\u003e"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"        \u003ctitle\u003eHistory | LeetWithFriend\u003c/title\u003e"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"        \u003cmeta charSet\u003d\"utf-8\" /\u003e"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"        \u003cmeta"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"          name\u003d\"description\""},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"          content\u003d\"An interview preparation platform and peer matching system, where students can find peers to practice whiteboard-style interview questions together.\""},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"        /\u003e"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"      \u003c/Helmet\u003e"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"  return ("},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"    \u003c\u003e"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"      {getHelmet()}"},{"lineNumber":66,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"      \u003cmain className\u003d\"flex flex-col items-center justify-start h-full\"\u003e"},{"lineNumber":68,"author":{"gitId":"uyencfi"},"content":"        {isLoading \u0026\u0026 ("},{"lineNumber":69,"author":{"gitId":"uyencfi"},"content":"          \u003cSpinner"},{"lineNumber":70,"author":{"gitId":"uyencfi"},"content":"            thickness\u003d\"4px\""},{"lineNumber":71,"author":{"gitId":"uyencfi"},"content":"            speed\u003d\"0.65s\""},{"lineNumber":72,"author":{"gitId":"uyencfi"},"content":"            emptyColor\u003d\"gray.200\""},{"lineNumber":73,"author":{"gitId":"uyencfi"},"content":"            color\u003d\"blue.500\""},{"lineNumber":74,"author":{"gitId":"uyencfi"},"content":"          /\u003e"},{"lineNumber":75,"author":{"gitId":"uyencfi"},"content":"        )}"},{"lineNumber":76,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":77,"author":{"gitId":"uyencfi"},"content":"        {!isLoading \u0026\u0026 !isValid ? ("},{"lineNumber":78,"author":{"gitId":"uyencfi"},"content":"          \u003ch1\u003eUnable to retrieve your learning history\u003c/h1\u003e"},{"lineNumber":79,"author":{"gitId":"uyencfi"},"content":"        ) : ("},{"lineNumber":80,"author":{"gitId":"uyencfi"},"content":"          \u003cHistTable questions\u003d{hist} /\u003e"},{"lineNumber":81,"author":{"gitId":"uyencfi"},"content":"        )}"},{"lineNumber":82,"author":{"gitId":"uyencfi"},"content":"      \u003c/main\u003e"},{"lineNumber":83,"author":{"gitId":"uyencfi"},"content":"    \u003c/\u003e"},{"lineNumber":84,"author":{"gitId":"uyencfi"},"content":"  )"},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":86,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":87,"author":{"gitId":"uyencfi"},"content":"const HistTable \u003d ({ questions }) \u003d\u003e {"},{"lineNumber":88,"author":{"gitId":"uyencfi"},"content":"  const navigate \u003d useNavigate()"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"  return ("},{"lineNumber":90,"author":{"gitId":"tlylt"},"content":"    \u003cTableContainer overflowY\u003d\"auto\" whiteSpace\u003d\"pre-wrap\" maxHeight\u003d\"100vh\"\u003e"},{"lineNumber":91,"author":{"gitId":"tlylt"},"content":"      \u003cTable variant\u003d\"striped\" className\u003d\"max-w-full table-fixed\"\u003e"},{"lineNumber":92,"author":{"gitId":"tlylt"},"content":"        \u003cThead className\u003d\"sticky top-0 bg-blue-200 dark:bg-blue-900\"\u003e"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"          \u003cTr\u003e"},{"lineNumber":94,"author":{"gitId":"tlylt"},"content":"            \u003cTh className\u003d\"w-1/6\"\u003ePartner\u003c/Th\u003e"},{"lineNumber":95,"author":{"gitId":"tlylt"},"content":"            \u003cTh className\u003d\"w-1/5\"\u003eQuestion id\u003c/Th\u003e"},{"lineNumber":96,"author":{"gitId":"tlylt"},"content":"            \u003cTh className\u003d\"w-1/2\"\u003eAnswer\u003c/Th\u003e"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"            \u003cTh\u003eCompleted at\u003c/Th\u003e"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"          \u003c/Tr\u003e"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"        \u003c/Thead\u003e"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"        \u003cTbody\u003e"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"          {questions.map((q, idx) \u003d\u003e {"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"            return ("},{"lineNumber":103,"author":{"gitId":"tlylt"},"content":"              \u003cTr"},{"lineNumber":104,"author":{"gitId":"tlylt"},"content":"                key\u003d{q.roomId + q.id + idx}"},{"lineNumber":105,"author":{"gitId":"tlylt"},"content":"                className\u003d\"text-gray-700 dark:text-gray-300\""},{"lineNumber":106,"author":{"gitId":"tlylt"},"content":"              \u003e"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"                \u003cTd\u003e{q.partner}\u003c/Td\u003e"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"                \u003cTd\u003e"},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"                  \u003cButton"},{"lineNumber":110,"author":{"gitId":"tlylt"},"content":"                    variant\u003d\"link\""},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"                    onClick\u003d{() \u003d\u003e navigate(`/question/${q.id}`)}"},{"lineNumber":112,"author":{"gitId":"tlylt"},"content":"                    className\u003d\"dark:text-gray-500\""},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"                  \u003e"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"                    {q.name}"},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"                  \u003c/Button\u003e"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":"                \u003c/Td\u003e"},{"lineNumber":117,"author":{"gitId":"tlylt"},"content":"                \u003cTd className\u003d\"font-mono text-sm\"\u003e{q.answer}\u003c/Td\u003e"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"                \u003cTd\u003e"},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"                  {new Date(q.completedAt).toLocaleString(\u0027en-GB\u0027, {"},{"lineNumber":120,"author":{"gitId":"uyencfi"},"content":"                    hour12: \u0027true\u0027,"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"                    dateStyle: \u0027medium\u0027,"},{"lineNumber":122,"author":{"gitId":"uyencfi"},"content":"                    timeStyle: \u0027medium\u0027,"},{"lineNumber":123,"author":{"gitId":"uyencfi"},"content":"                  })}"},{"lineNumber":124,"author":{"gitId":"uyencfi"},"content":"                \u003c/Td\u003e"},{"lineNumber":125,"author":{"gitId":"uyencfi"},"content":"              \u003c/Tr\u003e"},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":"            )"},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"          })}"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"        \u003c/Tbody\u003e"},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":"      \u003c/Table\u003e"},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"    \u003c/TableContainer\u003e"},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"  )"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":134,"author":{"gitId":"uyencfi"},"content":"export default History"}],"authorContributionMap":{"tlylt":35,"uyencfi":99}},{"path":"frontend/src/pages/Home.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import useAuth from \u0027../hooks/useAuth\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { Helmet } from \u0027react-helmet-async\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"const Home \u003d () \u003d\u003e {"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  const { auth } \u003d useAuth()"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    \u003cdiv\u003e"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      \u003cHelmet\u003e"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        \u003ctitle\u003eHome | LeetWithFriend\u003c/title\u003e"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"        \u003cmeta charSet\u003d\"utf-8\" /\u003e"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"        \u003cmeta"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"          name\u003d\"description\""},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"          content\u003d\"An interview preparation platform and peer matching system, where students can find peers to practice whiteboard-style interview questions together.\""},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"        /\u003e"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"      \u003c/Helmet\u003e"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"      \u003cmain className\u003d\"flex flex-col items-center justify-center h-full\"\u003e"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"        \u003ch1\u003eHome\u003c/h1\u003e"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"        \u003cbr /\u003e"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"        \u003cp\u003eUsername: {auth.username}\u003c/p\u003e"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"        \u003cp\u003eYou are logged in!\u003c/p\u003e"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"        \u003cbr /\u003e"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"        \u003cbr /\u003e"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"      \u003c/main\u003e"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"    \u003c/div\u003e"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"export default Home"}],"authorContributionMap":{"tlylt":29}},{"path":"frontend/src/pages/Login.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { AuthLayout } from \u0027../components/AuthLayout\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { Button } from \u0027../components/Button\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import { TextField } from \u0027../components/Fields\u0027"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import { useEffect, useRef, useState } from \u0027react\u0027"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"import axios from \u0027../api/axios\u0027"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"import { Link, useLocation, useNavigate } from \u0027react-router-dom\u0027"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"import {"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  URL_USER_LOGIN,"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  STATUS_CODE_SUCCESS,"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  STATUS_CODE_BAD_REQUEST,"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"} from \u0027../constants\u0027"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"import useAuth from \u0027../hooks/useAuth\u0027"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"import { Helmet } from \u0027react-helmet-async\u0027"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"function Login() {"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"  const { auth, setAuth, persist, setPersist } \u003d useAuth()"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"  const navigate \u003d useNavigate()"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"  const location \u003d useLocation()"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"  const from \u003d location.state?.from?.pathname || \u0027/\u0027"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"  const errRef \u003d useRef()"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"  const togglePersist \u003d () \u003d\u003e {"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"    setPersist((prev) \u003d\u003e !prev)"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"  }"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"    localStorage.setItem(\u0027persist:peerprep\u0027, persist)"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"  }, [persist])"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"  const [username, setUsername] \u003d useState(\u0027\u0027)"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"  const [password, setPassword] \u003d useState(\u0027\u0027)"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"  const [errorMsg, setErrorMsg] \u003d useState(\u0027\u0027)"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"  const handleLogin \u003d async () \u003d\u003e {"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"    const res \u003d await axios"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"      .post(URL_USER_LOGIN, { username, password })"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"      .catch((err) \u003d\u003e {"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"        if (err.response.status \u003d\u003d\u003d STATUS_CODE_BAD_REQUEST) {"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"          setErrorMsg(err.response.data.message)"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"        } else {"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"          setErrorMsg(\u0027Server Error\u0027)"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"    if (res \u0026\u0026 res.status \u003d\u003d\u003d STATUS_CODE_SUCCESS) {"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"      setAuth({"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"        username,"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"        school: res.data.data.school,"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"        email: res.data.data.email,"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"        accessToken: res.data.data.accessToken,"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"        isLoggedIn: true,"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"      setUsername(\u0027\u0027)"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"      setPassword(\u0027\u0027)"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"      navigate(from, { replace: true })"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"  }"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"    setErrorMsg(\u0027\u0027)"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"  }, [username, password])"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"    console.log(auth)"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"  }, [auth])"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"    \u003c\u003e"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"      \u003cHelmet\u003e"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"        \u003ctitle\u003eLogin | LeetWithFriend\u003c/title\u003e"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"        \u003cmeta charSet\u003d\"utf-8\" /\u003e"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"        \u003cmeta"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"          name\u003d\"description\""},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"          content\u003d\"An interview preparation platform and peer matching system, where students can find peers to practice whiteboard-style interview questions together.\""},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"        /\u003e"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"      \u003c/Helmet\u003e"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"      {auth?.username \u003d\u003d\u003d \u0027\u0027 ? ("},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":"        \u003cAuthLayout"},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"          title\u003d\"Sign in to account\""},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"          subtitle\u003d{"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"            \u003c\u003e"},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"              Dont have an account?{\u0027 \u0027}"},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"              \u003cLink to\u003d\"/signup\" className\u003d\"text-cyan-600\"\u003e"},{"lineNumber":80,"author":{"gitId":"tlylt"},"content":"                Sign up"},{"lineNumber":81,"author":{"gitId":"tlylt"},"content":"              \u003c/Link\u003e"},{"lineNumber":82,"author":{"gitId":"tlylt"},"content":"            \u003c/\u003e"},{"lineNumber":83,"author":{"gitId":"tlylt"},"content":"          }"},{"lineNumber":84,"author":{"gitId":"tlylt"},"content":"        \u003e"},{"lineNumber":85,"author":{"gitId":"tlylt"},"content":"          \u003cdiv\u003e"},{"lineNumber":86,"author":{"gitId":"tlylt"},"content":"            \u003cdiv className\u003d\"space-y-6\"\u003e"},{"lineNumber":87,"author":{"gitId":"tlylt"},"content":"              \u003cTextField"},{"lineNumber":88,"author":{"gitId":"tlylt"},"content":"                label\u003d\"Username\""},{"lineNumber":89,"author":{"gitId":"tlylt"},"content":"                value\u003d{username}"},{"lineNumber":90,"author":{"gitId":"tlylt"},"content":"                autoComplete\u003d\"off\""},{"lineNumber":91,"author":{"gitId":"tlylt"},"content":"                onChange\u003d{(e) \u003d\u003e setUsername(e.target.value)}"},{"lineNumber":92,"author":{"gitId":"tlylt"},"content":"                sx\u003d{{ marginBottom: \u00271rem\u0027 }}"},{"lineNumber":93,"author":{"gitId":"tlylt"},"content":"                autoFocus"},{"lineNumber":94,"author":{"gitId":"tlylt"},"content":"                required"},{"lineNumber":95,"author":{"gitId":"tlylt"},"content":"              /\u003e"},{"lineNumber":96,"author":{"gitId":"tlylt"},"content":"              \u003cTextField"},{"lineNumber":97,"author":{"gitId":"tlylt"},"content":"                label\u003d\"Password\""},{"lineNumber":98,"author":{"gitId":"tlylt"},"content":"                id\u003d\"password\""},{"lineNumber":99,"author":{"gitId":"tlylt"},"content":"                name\u003d\"password\""},{"lineNumber":100,"author":{"gitId":"tlylt"},"content":"                type\u003d\"password\""},{"lineNumber":101,"author":{"gitId":"tlylt"},"content":"                autoComplete\u003d\"current-password\""},{"lineNumber":102,"author":{"gitId":"tlylt"},"content":"                required"},{"lineNumber":103,"author":{"gitId":"tlylt"},"content":"                value\u003d{password}"},{"lineNumber":104,"author":{"gitId":"tlylt"},"content":"                onChange\u003d{(e) \u003d\u003e setPassword(e.target.value)}"},{"lineNumber":105,"author":{"gitId":"tlylt"},"content":"                sx\u003d{{ marginBottom: \u00272rem\u0027 }}"},{"lineNumber":106,"author":{"gitId":"tlylt"},"content":"              /\u003e"},{"lineNumber":107,"author":{"gitId":"tlylt"},"content":"            \u003c/div\u003e"},{"lineNumber":108,"author":{"gitId":"tlylt"},"content":"            \u003cdiv className\u003d\"flex items-center justify-center gap-2 mt-2\"\u003e"},{"lineNumber":109,"author":{"gitId":"tlylt"},"content":"              \u003cinput"},{"lineNumber":110,"author":{"gitId":"tlylt"},"content":"                type\u003d\"checkbox\""},{"lineNumber":111,"author":{"gitId":"tlylt"},"content":"                id\u003d\"persist\""},{"lineNumber":112,"author":{"gitId":"tlylt"},"content":"                onChange\u003d{togglePersist}"},{"lineNumber":113,"author":{"gitId":"tlylt"},"content":"                checked\u003d{persist}"},{"lineNumber":114,"author":{"gitId":"tlylt"},"content":"              /\u003e"},{"lineNumber":115,"author":{"gitId":"tlylt"},"content":"              \u003clabel htmlFor\u003d\"persist\" className\u003d\"dark:text-black\"\u003e"},{"lineNumber":116,"author":{"gitId":"tlylt"},"content":"                Trust This Device (Persist Sign In)"},{"lineNumber":117,"author":{"gitId":"tlylt"},"content":"              \u003c/label\u003e"},{"lineNumber":118,"author":{"gitId":"tlylt"},"content":"            \u003c/div\u003e"},{"lineNumber":119,"author":{"gitId":"tlylt"},"content":"            \u003cButton color\u003d\"cyan\" className\u003d\"w-full mt-8\" onClick\u003d{handleLogin}\u003e"},{"lineNumber":120,"author":{"gitId":"tlylt"},"content":"              Sign In"},{"lineNumber":121,"author":{"gitId":"tlylt"},"content":"            \u003c/Button\u003e"},{"lineNumber":122,"author":{"gitId":"tlylt"},"content":"            \u003cdiv"},{"lineNumber":123,"author":{"gitId":"tlylt"},"content":"              ref\u003d{errRef}"},{"lineNumber":124,"author":{"gitId":"tlylt"},"content":"              className\u003d{`mt-2 text-center ${errorMsg ? \u0027errormsg\u0027 : \u0027hidden\u0027}`}"},{"lineNumber":125,"author":{"gitId":"tlylt"},"content":"              aria-live\u003d\"assertive\""},{"lineNumber":126,"author":{"gitId":"tlylt"},"content":"            \u003e"},{"lineNumber":127,"author":{"gitId":"tlylt"},"content":"              {errorMsg}"},{"lineNumber":128,"author":{"gitId":"tlylt"},"content":"            \u003c/div\u003e"},{"lineNumber":129,"author":{"gitId":"tlylt"},"content":"          \u003c/div\u003e"},{"lineNumber":130,"author":{"gitId":"tlylt"},"content":"        \u003c/AuthLayout\u003e"},{"lineNumber":131,"author":{"gitId":"tlylt"},"content":"      ) : ("},{"lineNumber":132,"author":{"gitId":"tlylt"},"content":"        \u003cdiv className\u003d\"mx-auto text-center\"\u003eYou have logged in!\u003c/div\u003e"},{"lineNumber":133,"author":{"gitId":"tlylt"},"content":"      )}"},{"lineNumber":134,"author":{"gitId":"tlylt"},"content":"    \u003c/\u003e"},{"lineNumber":135,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":136,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":137,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":138,"author":{"gitId":"tlylt"},"content":"export default Login"}],"authorContributionMap":{"tlylt":138}},{"path":"frontend/src/pages/Match.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"import { useEffect, useState } from \u0027react\u0027"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"import MatchDialog from \u0027../components/match/MatchDialog\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import { Helmet } from \u0027react-helmet-async\u0027"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"import useAxiosPrivate from \u0027../hooks/useAxiosPrivate\u0027"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"import { URL_ROOM_SERVICE, STATUS_CODE_SUCCESS } from \u0027../constants\u0027"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"import { Button } from \u0027@chakra-ui/react\u0027"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"const Match \u003d () \u003d\u003e {"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"  const [roomId, setRoomId] \u003d useState()"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"  const [isInRoom, setInRoom] \u003d useState(false)"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"  const axiosPrivate \u003d useAxiosPrivate()"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"    axiosPrivate"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"      .get(URL_ROOM_SERVICE)"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"      .then((res) \u003d\u003e {"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"        if (res \u0026\u0026 res.status \u003d\u003d\u003d STATUS_CODE_SUCCESS) {"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"          setRoomId(res.data.data.roomId)"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"          setInRoom(res.data.data.isInRoom)"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"        }"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"      })"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"      .catch((e) \u003d\u003e {"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"        console.log(e)"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"      })"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"  }, [axiosPrivate])"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"  return ("},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"    \u003cdiv\u003e"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"      \u003cHelmet\u003e"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"        \u003ctitle\u003eMatch | LeetWithFriend\u003c/title\u003e"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"        \u003cmeta charSet\u003d\"utf-8\" /\u003e"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"        \u003cmeta"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"          name\u003d\"description\""},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"          content\u003d\"An interview preparation platform and peer matching system, where students can find peers to practice whiteboard-style interview questions together.\""},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"        /\u003e"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"      \u003c/Helmet\u003e"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"      \u003cmain className\u003d\"flex flex-col items-center justify-center h-full\"\u003e"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"        {isInRoom ? ("},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"          \u003c\u003e"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"            \u003ch1\u003eYou are already in a room, please rejoin it. \u003c/h1\u003e{\u0027 \u0027}"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"            \u003ch1\u003eEnd Session to start a new match. \u003c/h1\u003e"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"            \u003cbr /\u003e"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"            \u003cButton as\u003d\"a\" href\u003d{`/room/${roomId}`}\u003e"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"              Rejoin"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"            \u003c/Button\u003e"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":"          \u003c/\u003e"},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"        ) : ("},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"          \u003c\u003e"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":"            \u003ch1\u003eSelect your criterias and find a match within 30s!\u003c/h1\u003e"},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":"            \u003cbr /\u003e"},{"lineNumber":50,"author":{"gitId":"MarcusTXK"},"content":"            \u003cMatchDialog isDisabled\u003d{isInRoom} /\u003e"},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"          \u003c/\u003e"},{"lineNumber":52,"author":{"gitId":"MarcusTXK"},"content":"        )}"},{"lineNumber":53,"author":{"gitId":"MarcusTXK"},"content":"      \u003c/main\u003e"},{"lineNumber":54,"author":{"gitId":"MarcusTXK"},"content":"    \u003c/div\u003e"},{"lineNumber":55,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":56,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":57,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":58,"author":{"gitId":"MarcusTXK"},"content":"export default Match"}],"authorContributionMap":{"MarcusTXK":47,"tlylt":11}},{"path":"frontend/src/pages/PageNotFound.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { Helmet } from \u0027react-helmet-async\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { Link } from \u0027react-router-dom\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"const PageNotFound \u003d () \u003d\u003e {"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    \u003cmain className\u003d\"flex h-screen w-full flex-col items-center justify-center bg-[#1A2238]\"\u003e"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"      \u003cHelmet\u003e"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"        \u003ctitle\u003e404 | LeetWithFriend\u003c/title\u003e"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"        \u003cmeta charSet\u003d\"utf-8\" /\u003e"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        \u003cmeta"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"          name\u003d\"description\""},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"          content\u003d\"An interview preparation platform and peer matching system, where students can find peers to practice whiteboard-style interview questions together.\""},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        /\u003e"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"      \u003c/Helmet\u003e"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      \u003ch1 className\u003d\"font-extrabold tracking-widest text-white text-9xl\"\u003e"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        404"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"      \u003c/h1\u003e"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"      \u003cdiv className\u003d\"absolute rotate-12 rounded bg-[#FF6A3D] px-2 text-sm\"\u003e"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"        Page Not Found"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"      \u003c/div\u003e"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"      \u003cdiv className\u003d\"group relative mt-5 inline-block text-sm font-medium text-[#FF6A3D] focus:outline-none focus:ring active:text-orange-500\"\u003e"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"        \u003cspan className\u003d\"absolute inset-0 translate-x-0.5 translate-y-0.5 bg-[#FF6A3D] transition-transform group-hover:translate-y-0 group-hover:translate-x-0\"\u003e\u003c/span\u003e"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"        \u003cspan className\u003d\"relative block border border-current bg-[#1A2238] px-8 py-3\"\u003e"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"          \u003cLink to\u003d\"/home\"\u003eHome\u003c/Link\u003e"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"        \u003c/span\u003e"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"      \u003c/div\u003e"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"      \u003cdiv className\u003d\"group relative mt-5 inline-block text-sm font-medium text-[#FF6A3D] focus:outline-none focus:ring active:text-orange-500\"\u003e"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"        \u003cspan className\u003d\"absolute inset-0 translate-x-0.5 translate-y-0.5 bg-[#FF6A3D] transition-transform group-hover:translate-y-0 group-hover:translate-x-0\"\u003e\u003c/span\u003e"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"        \u003cspan className\u003d\"relative block border border-current bg-[#1A2238] px-8 py-3\"\u003e"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"          \u003cLink to\u003d\"/login\"\u003eLogin\u003c/Link\u003e"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"        \u003c/span\u003e"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"      \u003c/div\u003e"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"    \u003c/main\u003e"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"export default PageNotFound"}],"authorContributionMap":{"tlylt":38}},{"path":"frontend/src/pages/Profile.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { useNavigate } from \u0027react-router-dom\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import {"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"  STATUS_CODE_BAD_REQUEST,"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  STATUS_CODE_SUCCESS,"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  URL_USER_SERVICE,"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  PASSWORD_REGEX,"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  EMAIL_REGEX,"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"} from \u0027../constants\u0027"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"import useAuth from \u0027../hooks/useAuth\u0027"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"import useAxiosPrivate from \u0027../hooks/useAxiosPrivate\u0027"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"import { Tooltip } from \u0027@chakra-ui/react\u0027"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"import { useState } from \u0027react\u0027"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"import { useToast } from \u0027@chakra-ui/react\u0027"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"import { Helmet } from \u0027react-helmet-async\u0027"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"import { getUserProfileUrl } from \u0027../utils\u0027"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"const Profile \u003d () \u003d\u003e {"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"  const { auth, setAuth } \u003d useAuth()"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"  const [deleteConfirmation, setDeleteConfirmation] \u003d useState(\u0027\u0027)"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"  const toast \u003d useToast()"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"  const navigate \u003d useNavigate()"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"  const axiosPrivate \u003d useAxiosPrivate()"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"  const [school, setSchool] \u003d useState(auth.school)"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"  const [email, setEmail] \u003d useState(auth.email)"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"  const [currentPassword, setCurrentPassword] \u003d useState(\u0027\u0027)"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"  const [newPassword, setNewPassword] \u003d useState(\u0027\u0027)"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"  const [repeatPassword, setRepeatPassword] \u003d useState(\u0027\u0027)"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"  const updateAccountInfo \u003d async (e) \u003d\u003e {"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"    e.preventDefault()"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"    if (school \u003d\u003d\u003d auth.school \u0026\u0026 email \u003d\u003d\u003d auth.email) {"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"      toast({"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"        title: `Nothing to update!`,"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"        status: \u0027warning\u0027,"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"        isClosable: true,"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"      return"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"    if (!EMAIL_REGEX.test(email)) {"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"      toast({"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"        title: \u0027Invalid email!\u0027,"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"        status: \u0027error\u0027,"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"        isClosable: true,"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"      return"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"    const res \u003d await axiosPrivate"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"      .put(URL_USER_SERVICE, {"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"        school,"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"        email,"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"      .catch((err) \u003d\u003e {"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"        if (err.response.status \u003d\u003d\u003d STATUS_CODE_BAD_REQUEST) {"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"          console.log(err.response.data.message)"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"        } else {"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"          console.log(\u0027Server Error\u0027)"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"    if (res \u0026\u0026 res.status \u003d\u003d\u003d STATUS_CODE_SUCCESS) {"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"      toast({"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"        title: `Account info changed!`,"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"        status: \u0027success\u0027,"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"        isClosable: true,"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"      setAuth({"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"        ...auth,"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"        school,"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"        email,"},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"  }"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"  const updateAccountPassword \u003d async () \u003d\u003e {"},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"    if (newPassword !\u003d\u003d repeatPassword) {"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"      toast({"},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"        title: `New password doesn\u0027t match`,"},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"        status: \u0027warning\u0027,"},{"lineNumber":80,"author":{"gitId":"tlylt"},"content":"        isClosable: true,"},{"lineNumber":81,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":82,"author":{"gitId":"tlylt"},"content":"      return"},{"lineNumber":83,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":84,"author":{"gitId":"tlylt"},"content":"    if (!PASSWORD_REGEX.test(newPassword)) {"},{"lineNumber":85,"author":{"gitId":"tlylt"},"content":"      toast({"},{"lineNumber":86,"author":{"gitId":"tlylt"},"content":"        title: `New password not valid`,"},{"lineNumber":87,"author":{"gitId":"tlylt"},"content":"        status: \u0027warning\u0027,"},{"lineNumber":88,"author":{"gitId":"tlylt"},"content":"        isClosable: true,"},{"lineNumber":89,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":90,"author":{"gitId":"tlylt"},"content":"      return"},{"lineNumber":91,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":92,"author":{"gitId":"tlylt"},"content":"    const res \u003d await axiosPrivate"},{"lineNumber":93,"author":{"gitId":"tlylt"},"content":"      .put(URL_USER_SERVICE, {"},{"lineNumber":94,"author":{"gitId":"tlylt"},"content":"        previousPassword: currentPassword,"},{"lineNumber":95,"author":{"gitId":"tlylt"},"content":"        updatedPassword: newPassword,"},{"lineNumber":96,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":97,"author":{"gitId":"tlylt"},"content":"      .catch((err) \u003d\u003e {"},{"lineNumber":98,"author":{"gitId":"tlylt"},"content":"        if (err.response.status \u003d\u003d\u003d STATUS_CODE_BAD_REQUEST) {"},{"lineNumber":99,"author":{"gitId":"tlylt"},"content":"          console.log(err.response.data.message)"},{"lineNumber":100,"author":{"gitId":"tlylt"},"content":"        } else {"},{"lineNumber":101,"author":{"gitId":"tlylt"},"content":"          console.log(\u0027Server Error\u0027)"},{"lineNumber":102,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":103,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":104,"author":{"gitId":"tlylt"},"content":"    if (res \u0026\u0026 res.status \u003d\u003d\u003d STATUS_CODE_SUCCESS) {"},{"lineNumber":105,"author":{"gitId":"tlylt"},"content":"      toast({"},{"lineNumber":106,"author":{"gitId":"tlylt"},"content":"        title: `Account password changed!`,"},{"lineNumber":107,"author":{"gitId":"tlylt"},"content":"        status: \u0027success\u0027,"},{"lineNumber":108,"author":{"gitId":"tlylt"},"content":"        isClosable: true,"},{"lineNumber":109,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":110,"author":{"gitId":"tlylt"},"content":"      setTimeout(() \u003d\u003e {"},{"lineNumber":111,"author":{"gitId":"tlylt"},"content":"        setAuth({"},{"lineNumber":112,"author":{"gitId":"tlylt"},"content":"          accessToken: \u0027\u0027,"},{"lineNumber":113,"author":{"gitId":"tlylt"},"content":"          username: \u0027\u0027,"},{"lineNumber":114,"author":{"gitId":"tlylt"},"content":"        })"},{"lineNumber":115,"author":{"gitId":"tlylt"},"content":"      }, 2000)"},{"lineNumber":116,"author":{"gitId":"tlylt"},"content":"      setTimeout(() \u003d\u003e {"},{"lineNumber":117,"author":{"gitId":"tlylt"},"content":"        navigate(\u0027/login\u0027)"},{"lineNumber":118,"author":{"gitId":"tlylt"},"content":"      }, 4000)"},{"lineNumber":119,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":120,"author":{"gitId":"tlylt"},"content":"  }"},{"lineNumber":121,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":122,"author":{"gitId":"tlylt"},"content":"  const deleteAccount \u003d async () \u003d\u003e {"},{"lineNumber":123,"author":{"gitId":"tlylt"},"content":"    if (deleteConfirmation !\u003d\u003d auth.username) {"},{"lineNumber":124,"author":{"gitId":"tlylt"},"content":"      toast({"},{"lineNumber":125,"author":{"gitId":"tlylt"},"content":"        title: `Username doesn\u0027t match`,"},{"lineNumber":126,"author":{"gitId":"tlylt"},"content":"        status: \u0027error\u0027,"},{"lineNumber":127,"author":{"gitId":"tlylt"},"content":"        isClosable: true,"},{"lineNumber":128,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":129,"author":{"gitId":"tlylt"},"content":"      return"},{"lineNumber":130,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":131,"author":{"gitId":"tlylt"},"content":"    const res \u003d await axiosPrivate.delete(URL_USER_SERVICE).catch((err) \u003d\u003e {"},{"lineNumber":132,"author":{"gitId":"tlylt"},"content":"      if (err.response.status \u003d\u003d\u003d STATUS_CODE_BAD_REQUEST) {"},{"lineNumber":133,"author":{"gitId":"tlylt"},"content":"        console.log(err.response.data.message)"},{"lineNumber":134,"author":{"gitId":"tlylt"},"content":"      } else {"},{"lineNumber":135,"author":{"gitId":"tlylt"},"content":"        console.log(\u0027Server Error\u0027)"},{"lineNumber":136,"author":{"gitId":"tlylt"},"content":"      }"},{"lineNumber":137,"author":{"gitId":"tlylt"},"content":"    })"},{"lineNumber":138,"author":{"gitId":"tlylt"},"content":"    if (res \u0026\u0026 res.status \u003d\u003d\u003d STATUS_CODE_SUCCESS) {"},{"lineNumber":139,"author":{"gitId":"tlylt"},"content":"      toast({"},{"lineNumber":140,"author":{"gitId":"tlylt"},"content":"        title: `Account deleted!`,"},{"lineNumber":141,"author":{"gitId":"tlylt"},"content":"        status: \u0027success\u0027,"},{"lineNumber":142,"author":{"gitId":"tlylt"},"content":"        isClosable: true,"},{"lineNumber":143,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":144,"author":{"gitId":"tlylt"},"content":"      setTimeout(() \u003d\u003e {"},{"lineNumber":145,"author":{"gitId":"tlylt"},"content":"        setAuth({"},{"lineNumber":146,"author":{"gitId":"tlylt"},"content":"          accessToken: \u0027\u0027,"},{"lineNumber":147,"author":{"gitId":"tlylt"},"content":"          username: \u0027\u0027,"},{"lineNumber":148,"author":{"gitId":"tlylt"},"content":"        })"},{"lineNumber":149,"author":{"gitId":"tlylt"},"content":"      }, 2000)"},{"lineNumber":150,"author":{"gitId":"tlylt"},"content":"      setTimeout(() \u003d\u003e {"},{"lineNumber":151,"author":{"gitId":"tlylt"},"content":"        navigate(\u0027/login\u0027)"},{"lineNumber":152,"author":{"gitId":"tlylt"},"content":"      }, 4000)"},{"lineNumber":153,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":154,"author":{"gitId":"tlylt"},"content":"  }"},{"lineNumber":155,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":156,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":157,"author":{"gitId":"tlylt"},"content":"    \u003cform className\u003d\"container max-w-2xl mx-auto mt-4 shadow-md md:w-3/4\"\u003e"},{"lineNumber":158,"author":{"gitId":"tlylt"},"content":"      \u003cHelmet\u003e"},{"lineNumber":159,"author":{"gitId":"tlylt"},"content":"        \u003ctitle\u003eProfile | LeetWithFriend\u003c/title\u003e"},{"lineNumber":160,"author":{"gitId":"tlylt"},"content":"        \u003cmeta charSet\u003d\"utf-8\" /\u003e"},{"lineNumber":161,"author":{"gitId":"tlylt"},"content":"        \u003cmeta"},{"lineNumber":162,"author":{"gitId":"tlylt"},"content":"          name\u003d\"description\""},{"lineNumber":163,"author":{"gitId":"tlylt"},"content":"          content\u003d\"An interview preparation platform and peer matching system, where students can find peers to practice whiteboard-style interview questions together.\""},{"lineNumber":164,"author":{"gitId":"tlylt"},"content":"        /\u003e"},{"lineNumber":165,"author":{"gitId":"tlylt"},"content":"      \u003c/Helmet\u003e"},{"lineNumber":166,"author":{"gitId":"tlylt"},"content":"      \u003cdiv className\u003d\"p-4 bg-gray-100 border-t-2 rounded-lg bg-opacity-5\"\u003e"},{"lineNumber":167,"author":{"gitId":"tlylt"},"content":"        \u003cdiv className\u003d\"max-w-sm mx-auto md:mx-0 md:w-full\"\u003e"},{"lineNumber":168,"author":{"gitId":"tlylt"},"content":"          \u003cdiv className\u003d\"inline-flex items-center space-x-4\"\u003e"},{"lineNumber":169,"author":{"gitId":"tlylt"},"content":"            \u003cimg"},{"lineNumber":170,"author":{"gitId":"tlylt"},"content":"              alt\u003d\"profil\""},{"lineNumber":171,"author":{"gitId":"tlylt"},"content":"              src\u003d{getUserProfileUrl(auth.username)}"},{"lineNumber":172,"author":{"gitId":"tlylt"},"content":"              className\u003d\"object-cover w-16 h-16 mx-auto rounded-full \""},{"lineNumber":173,"author":{"gitId":"tlylt"},"content":"            /\u003e"},{"lineNumber":174,"author":{"gitId":"tlylt"},"content":"            \u003ch1\u003eUser Profile\u003c/h1\u003e"},{"lineNumber":175,"author":{"gitId":"tlylt"},"content":"          \u003c/div\u003e"},{"lineNumber":176,"author":{"gitId":"tlylt"},"content":"        \u003c/div\u003e"},{"lineNumber":177,"author":{"gitId":"tlylt"},"content":"      \u003c/div\u003e"},{"lineNumber":178,"author":{"gitId":"tlylt"},"content":"      \u003cdiv className\u003d\"space-y-6 bg-white dark:bg-opacity-10\"\u003e"},{"lineNumber":179,"author":{"gitId":"tlylt"},"content":"        \u003cdiv className\u003d\"items-center w-full p-4 space-y-4 text-gray-500 md:inline-flex md:space-y-0\"\u003e"},{"lineNumber":180,"author":{"gitId":"tlylt"},"content":"          \u003ch2 className\u003d\"max-w-sm pl-3 mx-auto md:w-1/3\"\u003eAccount Username\u003c/h2\u003e"},{"lineNumber":181,"author":{"gitId":"tlylt"},"content":"          \u003cdiv className\u003d\"max-w-sm mx-auto md:w-2/3\"\u003e"},{"lineNumber":182,"author":{"gitId":"tlylt"},"content":"            \u003cTooltip"},{"lineNumber":183,"author":{"gitId":"tlylt"},"content":"              hasArrow"},{"lineNumber":184,"author":{"gitId":"tlylt"},"content":"              placement\u003d\"top\""},{"lineNumber":185,"author":{"gitId":"tlylt"},"content":"              label\u003d\"Username cannot be modified\""},{"lineNumber":186,"author":{"gitId":"tlylt"},"content":"              aria-label\u003d\"Username cannot be modified\""},{"lineNumber":187,"author":{"gitId":"tlylt"},"content":"            \u003e"},{"lineNumber":188,"author":{"gitId":"tlylt"},"content":"              \u003cdiv className\u003d\"relative\"\u003e"},{"lineNumber":189,"author":{"gitId":"tlylt"},"content":"                \u003cinput"},{"lineNumber":190,"author":{"gitId":"tlylt"},"content":"                  type\u003d\"text\""},{"lineNumber":191,"author":{"gitId":"tlylt"},"content":"                  disabled\u003d{true}"},{"lineNumber":192,"author":{"gitId":"tlylt"},"content":"                  className\u003d\"flex-1 w-full px-4 py-2 text-base text-gray-700 placeholder-gray-400 bg-white border border-transparent border-gray-300 rounded-lg shadow-sm appearance-none focus:border-transparent focus:outline-none focus:ring-2 focus:ring-purple-600\""},{"lineNumber":193,"author":{"gitId":"tlylt"},"content":"                  placeholder\u003d{auth.username}"},{"lineNumber":194,"author":{"gitId":"tlylt"},"content":"                /\u003e"},{"lineNumber":195,"author":{"gitId":"tlylt"},"content":"              \u003c/div\u003e"},{"lineNumber":196,"author":{"gitId":"tlylt"},"content":"            \u003c/Tooltip\u003e"},{"lineNumber":197,"author":{"gitId":"tlylt"},"content":"          \u003c/div\u003e"},{"lineNumber":198,"author":{"gitId":"tlylt"},"content":"        \u003c/div\u003e"},{"lineNumber":199,"author":{"gitId":"tlylt"},"content":"        \u003chr /\u003e"},{"lineNumber":200,"author":{"gitId":"tlylt"},"content":"        \u003cdiv className\u003d\"items-center w-full p-4 space-y-4 text-gray-500 md:inline-flex md:space-y-0\"\u003e"},{"lineNumber":201,"author":{"gitId":"tlylt"},"content":"          \u003ch2 className\u003d\"max-w-sm pl-3 mx-auto md:w-1/3\"\u003ePersonal info\u003c/h2\u003e"},{"lineNumber":202,"author":{"gitId":"tlylt"},"content":"          \u003cdiv className\u003d\"max-w-sm mx-auto space-y-5 md:w-2/3\"\u003e"},{"lineNumber":203,"author":{"gitId":"tlylt"},"content":"            \u003cdiv\u003e"},{"lineNumber":204,"author":{"gitId":"tlylt"},"content":"              \u003cdiv className\u003d\"relative\"\u003e"},{"lineNumber":205,"author":{"gitId":"tlylt"},"content":"                \u003cinput"},{"lineNumber":206,"author":{"gitId":"tlylt"},"content":"                  type\u003d\"text\""},{"lineNumber":207,"author":{"gitId":"tlylt"},"content":"                  id\u003d\"school\""},{"lineNumber":208,"author":{"gitId":"tlylt"},"content":"                  className\u003d\"flex-1 w-full px-4 py-2 text-base text-gray-700 placeholder-gray-400 bg-white border border-transparent border-gray-300 rounded-lg shadow-sm appearance-none focus:border-transparent focus:outline-none focus:ring-2 focus:ring-purple-600\""},{"lineNumber":209,"author":{"gitId":"tlylt"},"content":"                  placeholder\u003d\"School\""},{"lineNumber":210,"author":{"gitId":"tlylt"},"content":"                  value\u003d{school}"},{"lineNumber":211,"author":{"gitId":"tlylt"},"content":"                  onChange\u003d{(e) \u003d\u003e setSchool(e.target.value)}"},{"lineNumber":212,"author":{"gitId":"tlylt"},"content":"                /\u003e"},{"lineNumber":213,"author":{"gitId":"tlylt"},"content":"              \u003c/div\u003e"},{"lineNumber":214,"author":{"gitId":"tlylt"},"content":"            \u003c/div\u003e"},{"lineNumber":215,"author":{"gitId":"tlylt"},"content":"            \u003cdiv\u003e"},{"lineNumber":216,"author":{"gitId":"tlylt"},"content":"              \u003cdiv className\u003d\"relative\"\u003e"},{"lineNumber":217,"author":{"gitId":"tlylt"},"content":"                \u003cinput"},{"lineNumber":218,"author":{"gitId":"tlylt"},"content":"                  type\u003d\"email\""},{"lineNumber":219,"author":{"gitId":"tlylt"},"content":"                  id\u003d\"email\""},{"lineNumber":220,"author":{"gitId":"tlylt"},"content":"                  className\u003d\"flex-1 w-full px-4 py-2 text-base text-gray-700 placeholder-gray-400 bg-white border border-transparent border-gray-300 rounded-lg shadow-sm appearance-none focus:border-transparent focus:outline-none focus:ring-2 focus:ring-purple-600\""},{"lineNumber":221,"author":{"gitId":"tlylt"},"content":"                  autoComplete\u003d\"off\""},{"lineNumber":222,"author":{"gitId":"tlylt"},"content":"                  placeholder\u003d\"Email\""},{"lineNumber":223,"author":{"gitId":"tlylt"},"content":"                  value\u003d{email}"},{"lineNumber":224,"author":{"gitId":"tlylt"},"content":"                  onChange\u003d{(e) \u003d\u003e setEmail(e.target.value)}"},{"lineNumber":225,"author":{"gitId":"tlylt"},"content":"                /\u003e"},{"lineNumber":226,"author":{"gitId":"tlylt"},"content":"              \u003c/div\u003e"},{"lineNumber":227,"author":{"gitId":"tlylt"},"content":"            \u003c/div\u003e"},{"lineNumber":228,"author":{"gitId":"tlylt"},"content":"          \u003c/div\u003e"},{"lineNumber":229,"author":{"gitId":"tlylt"},"content":"        \u003c/div\u003e"},{"lineNumber":230,"author":{"gitId":"tlylt"},"content":"        \u003cdiv className\u003d\"w-full px-2 ml-auto text-center text-gray-500 md:w-3/12 \"\u003e"},{"lineNumber":231,"author":{"gitId":"tlylt"},"content":"          \u003cbutton"},{"lineNumber":232,"author":{"gitId":"tlylt"},"content":"            onClick\u003d{(e) \u003d\u003e updateAccountInfo(e)}"},{"lineNumber":233,"author":{"gitId":"tlylt"},"content":"            className\u003d\"px-6 py-2 text-base font-semibold text-center text-white transition duration-200 ease-in bg-blue-600 rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-blue-200\""},{"lineNumber":234,"author":{"gitId":"tlylt"},"content":"          \u003e"},{"lineNumber":235,"author":{"gitId":"tlylt"},"content":"            Update"},{"lineNumber":236,"author":{"gitId":"tlylt"},"content":"          \u003c/button\u003e"},{"lineNumber":237,"author":{"gitId":"tlylt"},"content":"        \u003c/div\u003e"},{"lineNumber":238,"author":{"gitId":"tlylt"},"content":"        \u003chr /\u003e"},{"lineNumber":239,"author":{"gitId":"tlylt"},"content":"        \u003cdiv className\u003d\"items-center w-full p-8 space-y-4 text-gray-500 md:inline-flex md:space-y-0\"\u003e"},{"lineNumber":240,"author":{"gitId":"tlylt"},"content":"          \u003ch2 className\u003d\"max-w-sm mx-auto md:w-4/12\"\u003eChange password\u003c/h2\u003e"},{"lineNumber":241,"author":{"gitId":"tlylt"},"content":"          \u003cdiv className\u003d\"flex flex-col w-full max-w-sm pl-2 mx-auto space-y-5 md:inline-flex md:w-7/12 md:pl-12\"\u003e"},{"lineNumber":242,"author":{"gitId":"tlylt"},"content":"            \u003cdiv className\u003d\"\"\u003e"},{"lineNumber":243,"author":{"gitId":"tlylt"},"content":"              \u003cinput"},{"lineNumber":244,"author":{"gitId":"tlylt"},"content":"                type\u003d\"password\""},{"lineNumber":245,"author":{"gitId":"tlylt"},"content":"                id\u003d\"current-password\""},{"lineNumber":246,"author":{"gitId":"tlylt"},"content":"                value\u003d{currentPassword}"},{"lineNumber":247,"author":{"gitId":"tlylt"},"content":"                autoComplete\u003d\"off\""},{"lineNumber":248,"author":{"gitId":"tlylt"},"content":"                onChange\u003d{(e) \u003d\u003e setCurrentPassword(e.target.value)}"},{"lineNumber":249,"author":{"gitId":"tlylt"},"content":"                className\u003d\"flex-1 w-full px-2 py-2 text-base text-gray-700 placeholder-gray-400 bg-white border border-transparent border-gray-300 rounded-lg shadow-sm appearance-none focus:border-transparent focus:outline-none focus:ring-2 focus:ring-purple-600\""},{"lineNumber":250,"author":{"gitId":"tlylt"},"content":"                placeholder\u003d\"Current Password\""},{"lineNumber":251,"author":{"gitId":"tlylt"},"content":"              /\u003e"},{"lineNumber":252,"author":{"gitId":"tlylt"},"content":"            \u003c/div\u003e"},{"lineNumber":253,"author":{"gitId":"tlylt"},"content":"            \u003cdiv className\u003d\"\"\u003e"},{"lineNumber":254,"author":{"gitId":"tlylt"},"content":"              \u003cinput"},{"lineNumber":255,"author":{"gitId":"tlylt"},"content":"                type\u003d\"password\""},{"lineNumber":256,"author":{"gitId":"tlylt"},"content":"                id\u003d\"new-password\""},{"lineNumber":257,"author":{"gitId":"tlylt"},"content":"                value\u003d{newPassword}"},{"lineNumber":258,"author":{"gitId":"tlylt"},"content":"                autoComplete\u003d\"off\""},{"lineNumber":259,"author":{"gitId":"tlylt"},"content":"                onChange\u003d{(e) \u003d\u003e setNewPassword(e.target.value)}"},{"lineNumber":260,"author":{"gitId":"tlylt"},"content":"                className\u003d\"flex-1 w-full px-2 py-2 text-base text-gray-700 placeholder-gray-400 bg-white border border-transparent border-gray-300 rounded-lg shadow-sm appearance-none focus:border-transparent focus:outline-none focus:ring-2 focus:ring-purple-600\""},{"lineNumber":261,"author":{"gitId":"tlylt"},"content":"                placeholder\u003d\"New Password\""},{"lineNumber":262,"author":{"gitId":"tlylt"},"content":"              /\u003e"},{"lineNumber":263,"author":{"gitId":"tlylt"},"content":"            \u003c/div\u003e"},{"lineNumber":264,"author":{"gitId":"tlylt"},"content":"            \u003cdiv className\u003d\"\"\u003e"},{"lineNumber":265,"author":{"gitId":"tlylt"},"content":"              \u003cinput"},{"lineNumber":266,"author":{"gitId":"tlylt"},"content":"                type\u003d\"password\""},{"lineNumber":267,"author":{"gitId":"tlylt"},"content":"                id\u003d\"repeat-password\""},{"lineNumber":268,"author":{"gitId":"tlylt"},"content":"                value\u003d{repeatPassword}"},{"lineNumber":269,"author":{"gitId":"tlylt"},"content":"                autoComplete\u003d\"off\""},{"lineNumber":270,"author":{"gitId":"tlylt"},"content":"                onChange\u003d{(e) \u003d\u003e setRepeatPassword(e.target.value)}"},{"lineNumber":271,"author":{"gitId":"tlylt"},"content":"                className\u003d\"flex-1 w-full px-2 py-2 text-base text-gray-700 placeholder-gray-400 bg-white border border-transparent border-gray-300 rounded-lg shadow-sm appearance-none focus:border-transparent focus:outline-none focus:ring-2 focus:ring-purple-600\""},{"lineNumber":272,"author":{"gitId":"tlylt"},"content":"                placeholder\u003d\"Repeat New Password\""},{"lineNumber":273,"author":{"gitId":"tlylt"},"content":"              /\u003e"},{"lineNumber":274,"author":{"gitId":"tlylt"},"content":"            \u003c/div\u003e"},{"lineNumber":275,"author":{"gitId":"tlylt"},"content":"          \u003c/div\u003e"},{"lineNumber":276,"author":{"gitId":"tlylt"},"content":"          \u003cdiv className\u003d\"text-center md:w-3/12 md:pl-6\"\u003e"},{"lineNumber":277,"author":{"gitId":"tlylt"},"content":"            \u003cbutton"},{"lineNumber":278,"author":{"gitId":"tlylt"},"content":"              type\u003d\"button\""},{"lineNumber":279,"author":{"gitId":"tlylt"},"content":"              onClick\u003d{updateAccountPassword}"},{"lineNumber":280,"author":{"gitId":"tlylt"},"content":"              className\u003d\"w-full px-4 py-2 text-base font-semibold text-center text-white transition duration-200 ease-in bg-pink-600 rounded-lg shadow-md hover:bg-pink-700 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 focus:ring-offset-pink-200 \""},{"lineNumber":281,"author":{"gitId":"tlylt"},"content":"            \u003e"},{"lineNumber":282,"author":{"gitId":"tlylt"},"content":"              Change"},{"lineNumber":283,"author":{"gitId":"tlylt"},"content":"            \u003c/button\u003e"},{"lineNumber":284,"author":{"gitId":"tlylt"},"content":"          \u003c/div\u003e"},{"lineNumber":285,"author":{"gitId":"tlylt"},"content":"        \u003c/div\u003e"},{"lineNumber":286,"author":{"gitId":"tlylt"},"content":"        \u003chr /\u003e"},{"lineNumber":287,"author":{"gitId":"tlylt"},"content":"        \u003cdiv className\u003d\"items-center w-full p-8 space-y-4 text-gray-500 md:inline-flex md:space-y-0\"\u003e"},{"lineNumber":288,"author":{"gitId":"tlylt"},"content":"          \u003ch2 className\u003d\"max-w-sm mx-auto md:w-4/12\"\u003eDelete Account\u003c/h2\u003e"},{"lineNumber":289,"author":{"gitId":"tlylt"},"content":"          \u003cdiv className\u003d\"w-full max-w-sm pl-2 mx-auto space-y-5 md:inline-flex md:w-6/12 md:pl-7\"\u003e"},{"lineNumber":290,"author":{"gitId":"tlylt"},"content":"            \u003cdiv className\u003d\"relative\"\u003e"},{"lineNumber":291,"author":{"gitId":"tlylt"},"content":"              \u003cinput"},{"lineNumber":292,"author":{"gitId":"tlylt"},"content":"                type\u003d\"text\""},{"lineNumber":293,"author":{"gitId":"tlylt"},"content":"                className\u003d\"flex-1 w-full px-4 py-2 text-base text-gray-700 placeholder-gray-400 bg-white border border-transparent border-gray-300 rounded-lg shadow-sm appearance-none focus:border-transparent focus:outline-none focus:ring-2 focus:ring-purple-600\""},{"lineNumber":294,"author":{"gitId":"tlylt"},"content":"                placeholder\u003d\"Type Your Username\""},{"lineNumber":295,"author":{"gitId":"tlylt"},"content":"                value\u003d{deleteConfirmation}"},{"lineNumber":296,"author":{"gitId":"tlylt"},"content":"                onChange\u003d{(e) \u003d\u003e setDeleteConfirmation(e.target.value)}"},{"lineNumber":297,"author":{"gitId":"tlylt"},"content":"              /\u003e"},{"lineNumber":298,"author":{"gitId":"tlylt"},"content":"            \u003c/div\u003e"},{"lineNumber":299,"author":{"gitId":"tlylt"},"content":"          \u003c/div\u003e"},{"lineNumber":300,"author":{"gitId":"tlylt"},"content":"          \u003cdiv className\u003d\"text-center md:w-3/12 md:pl-8\"\u003e"},{"lineNumber":301,"author":{"gitId":"tlylt"},"content":"            \u003cbutton"},{"lineNumber":302,"author":{"gitId":"tlylt"},"content":"              type\u003d\"button\""},{"lineNumber":303,"author":{"gitId":"tlylt"},"content":"              onClick\u003d{deleteAccount}"},{"lineNumber":304,"author":{"gitId":"tlylt"},"content":"              className\u003d\"py-2 text-base font-semibold text-center text-white transition duration-200 ease-in bg-red-600 rounded-lg shadow-md px-7 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-pink-200 \""},{"lineNumber":305,"author":{"gitId":"tlylt"},"content":"            \u003e"},{"lineNumber":306,"author":{"gitId":"tlylt"},"content":"              Delete"},{"lineNumber":307,"author":{"gitId":"tlylt"},"content":"            \u003c/button\u003e"},{"lineNumber":308,"author":{"gitId":"tlylt"},"content":"          \u003c/div\u003e"},{"lineNumber":309,"author":{"gitId":"tlylt"},"content":"        \u003c/div\u003e"},{"lineNumber":310,"author":{"gitId":"tlylt"},"content":"        \u003chr /\u003e"},{"lineNumber":311,"author":{"gitId":"tlylt"},"content":"      \u003c/div\u003e"},{"lineNumber":312,"author":{"gitId":"tlylt"},"content":"    \u003c/form\u003e"},{"lineNumber":313,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":314,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":315,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":316,"author":{"gitId":"tlylt"},"content":"export default Profile"}],"authorContributionMap":{"tlylt":316}},{"path":"frontend/src/pages/QuestionBank.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"import React, { useMemo } from \u0027react\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"import { Badge, Button, TableContainer } from \u0027@chakra-ui/react\u0027"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"import { useState, useEffect } from \u0027react\u0027"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"import { useNavigate } from \u0027react-router-dom\u0027"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"import QuestionTable from \u0027../components/QuestionTable\u0027"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"import { AuthLayout } from \u0027../components/AuthLayout\u0027"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"import TypesStack from \u0027../components/TypesStack\u0027"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"import axios from \u0027../api/axios\u0027"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"import { URL_QUESTION_SERVICE } from \u0027../constants\u0027"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"const difficultyColorMap \u003d new Map(["},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"  [\u0027easy\u0027, \u0027green\u0027],"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"  [\u0027medium\u0027, \u0027orange\u0027],"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"  [\u0027hard\u0027, \u0027red\u0027],"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"])"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"const QuestionBank \u003d () \u003d\u003e {"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"  const [loading, setLoading] \u003d useState(true)"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"  const [data, setData] \u003d useState()"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"  const navigate \u003d useNavigate()"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"    const fetchData \u003d async () \u003d\u003e {"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"      setLoading(true)"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"      try {"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"        const { data: response } \u003d await axios.get("},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"          URL_QUESTION_SERVICE + \u0027/allQuestions\u0027"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"        )"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"        setData(response.questions)"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"      } catch (error) {"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"        //todo toast"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"        console.error(error)"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"      }"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"      setLoading(false)"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"    if (!data || data.length \u003d\u003d\u003d 0) {"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"      fetchData()"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"  })"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":"  const columns \u003d useMemo("},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":"    () \u003d\u003e ["},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"      {"},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":"        Header: \u0027Title\u0027,"},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"        accessor: (row) \u003d\u003e row,"},{"lineNumber":45,"author":{"gitId":"Hzxin"},"content":"        Cell: ({ cell: { value } }) \u003d\u003e ("},{"lineNumber":46,"author":{"gitId":"Hzxin"},"content":"          \u003cButton"},{"lineNumber":47,"author":{"gitId":"Hzxin"},"content":"            variant\u003d\"link\""},{"lineNumber":48,"author":{"gitId":"Hzxin"},"content":"            fontWeight\u003d\"bold\""},{"lineNumber":49,"author":{"gitId":"Hzxin"},"content":"            color\u003d\"gray.600\""},{"lineNumber":50,"author":{"gitId":"Hzxin"},"content":"            onClick\u003d{() \u003d\u003e navigate(\u0027/question/\u0027 + value.id)}"},{"lineNumber":51,"author":{"gitId":"Hzxin"},"content":"          \u003e"},{"lineNumber":52,"author":{"gitId":"Hzxin"},"content":"            {\u0027 \u0027}"},{"lineNumber":53,"author":{"gitId":"Hzxin"},"content":"            {value.id + \u0027. \u0027 + value.name}{\u0027 \u0027}"},{"lineNumber":54,"author":{"gitId":"Hzxin"},"content":"          \u003c/Button\u003e"},{"lineNumber":55,"author":{"gitId":"Hzxin"},"content":"        ),"},{"lineNumber":56,"author":{"gitId":"Hzxin"},"content":"      },"},{"lineNumber":57,"author":{"gitId":"Hzxin"},"content":"      {"},{"lineNumber":58,"author":{"gitId":"Hzxin"},"content":"        Header: \u0027Types\u0027,"},{"lineNumber":59,"author":{"gitId":"Hzxin"},"content":"        accessor: \u0027Category.types\u0027,"},{"lineNumber":60,"author":{"gitId":"Hzxin"},"content":"        Cell: ({ cell: { value } }) \u003d\u003e TypesStack(value),"},{"lineNumber":61,"author":{"gitId":"Hzxin"},"content":"      },"},{"lineNumber":62,"author":{"gitId":"Hzxin"},"content":"      {"},{"lineNumber":63,"author":{"gitId":"Hzxin"},"content":"        Header: \u0027Difficulty\u0027,"},{"lineNumber":64,"author":{"gitId":"Hzxin"},"content":"        accessor: \u0027Category.difficulty\u0027,"},{"lineNumber":65,"author":{"gitId":"Hzxin"},"content":"        Cell: ({ cell: { value } }) \u003d\u003e ("},{"lineNumber":66,"author":{"gitId":"Hzxin"},"content":"          \u003cBadge"},{"lineNumber":67,"author":{"gitId":"Hzxin"},"content":"            fontWeight\u003d\"bold\""},{"lineNumber":68,"author":{"gitId":"Hzxin"},"content":"            color\u003d\"gray.600\""},{"lineNumber":69,"author":{"gitId":"Hzxin"},"content":"            borderRadius\u003d\"full\""},{"lineNumber":70,"author":{"gitId":"Hzxin"},"content":"            px\u003d\"2\""},{"lineNumber":71,"author":{"gitId":"Hzxin"},"content":"            colorScheme\u003d{difficultyColorMap.get(value)}"},{"lineNumber":72,"author":{"gitId":"Hzxin"},"content":"          \u003e"},{"lineNumber":73,"author":{"gitId":"Hzxin"},"content":"            {value}"},{"lineNumber":74,"author":{"gitId":"Hzxin"},"content":"          \u003c/Badge\u003e"},{"lineNumber":75,"author":{"gitId":"Hzxin"},"content":"        ),"},{"lineNumber":76,"author":{"gitId":"Hzxin"},"content":"      },"},{"lineNumber":77,"author":{"gitId":"Hzxin"},"content":"    ],"},{"lineNumber":78,"author":{"gitId":"Hzxin"},"content":"    [navigate]"},{"lineNumber":79,"author":{"gitId":"Hzxin"},"content":"  )"},{"lineNumber":80,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":81,"author":{"gitId":"Hzxin"},"content":"  return !loading ? ("},{"lineNumber":82,"author":{"gitId":"Hzxin"},"content":"    \u003cTableContainer overflowY\u003d\"auto\" maxHeight\u003d\"100%\"\u003e"},{"lineNumber":83,"author":{"gitId":"Hzxin"},"content":"      \u003cQuestionTable columns\u003d{columns} data\u003d{data} /\u003e"},{"lineNumber":84,"author":{"gitId":"Hzxin"},"content":"    \u003c/TableContainer\u003e"},{"lineNumber":85,"author":{"gitId":"Hzxin"},"content":"  ) : ("},{"lineNumber":86,"author":{"gitId":"Hzxin"},"content":"    \u003cAuthLayout title\u003d\"Retrieving question...\"\u003e"},{"lineNumber":87,"author":{"gitId":"Hzxin"},"content":"      \u003cdiv className\u003d\"text-center text-xl\"\u003e\u003c/div\u003e"},{"lineNumber":88,"author":{"gitId":"Hzxin"},"content":"    \u003c/AuthLayout\u003e"},{"lineNumber":89,"author":{"gitId":"Hzxin"},"content":"  )"},{"lineNumber":90,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":91,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":92,"author":{"gitId":"Hzxin"},"content":"export default QuestionBank"}],"authorContributionMap":{"Hzxin":92}},{"path":"frontend/src/pages/QuestionPage.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"import {"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"  Text,"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"  Code,"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"  HStack,"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"  StackDivider,"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"  VStack,"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"  Box,"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"  useToast,"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"  Image,"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"  Badge,"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"  Heading,"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"  IconButton,"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"} from \u0027@chakra-ui/react\u0027"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"import { ArrowBackIcon, ArrowForwardIcon } from \u0027@chakra-ui/icons\u0027"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"import ChakraUIRenderer from \u0027chakra-ui-markdown-renderer\u0027"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"import { AuthLayout } from \u0027../components/AuthLayout\u0027"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"import ReactMarkdown from \u0027react-markdown\u0027"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"import { URL_QUESTION_SERVICE } from \u0027../constants\u0027"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"import axios from \u0027../api/axios\u0027"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"import { useEffect, useState } from \u0027react\u0027"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"import { useParams, useNavigate } from \u0027react-router-dom\u0027"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"const difficultyColorMap \u003d new Map(["},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"  [\u0027easy\u0027, \u0027green\u0027],"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"  [\u0027medium\u0027, \u0027orange\u0027],"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"  [\u0027hard\u0027, \u0027red\u0027],"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"])"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"const supTheme \u003d {"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"  em: ({ node, ...props }) \u003d\u003e {"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"    if ("},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"      props.children[0] \u0026\u0026"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"      typeof props.children[0] \u003d\u003d\u003d \u0027string\u0027 \u0026\u0026"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"      props.children[0].startsWith(\u0027^\u0027)"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"    ) {"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"      return \u003csup\u003e{props.children[0].substring(1, 2)}\u003c/sup\u003e"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"    if ("},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"      props.children[0] \u0026\u0026"},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":"      typeof props.children[0] \u003d\u003d\u003d \u0027string\u0027 \u0026\u0026"},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":"      props.children[0].startsWith(\u0027~\u0027)"},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"    ) {"},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":"      return \u003csub\u003e{props.children[0].substring(1, 2)}\u003c/sub\u003e"},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":45,"author":{"gitId":"Hzxin"},"content":"    return \u003ci {...props} /\u003e"},{"lineNumber":46,"author":{"gitId":"Hzxin"},"content":"  },"},{"lineNumber":47,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":48,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":49,"author":{"gitId":"Hzxin"},"content":"const newTheme \u003d {"},{"lineNumber":50,"author":{"gitId":"Hzxin"},"content":"  img: ({ node, children, ...props }) \u003d\u003e {"},{"lineNumber":51,"author":{"gitId":"Hzxin"},"content":"    return \u003cImage m\u003d{4} src\u003d{node.properties.src}\u003e\u003c/Image\u003e"},{"lineNumber":52,"author":{"gitId":"Hzxin"},"content":"  },"},{"lineNumber":53,"author":{"gitId":"Hzxin"},"content":"  code: ({ node, inline, children, ...props }) \u003d\u003e {"},{"lineNumber":54,"author":{"gitId":"Hzxin"},"content":"    return !inline ? ("},{"lineNumber":55,"author":{"gitId":"Hzxin"},"content":"      \u003cCode overflow\u003d\"auto\" fontSize\u003d\"lg\" w\u003d\"100%\" p\u003d{2} mt\u003d{4} mb\u003d{4}\u003e"},{"lineNumber":56,"author":{"gitId":"Hzxin"},"content":"        \u003cReactMarkdown"},{"lineNumber":57,"author":{"gitId":"Hzxin"},"content":"          components\u003d{ChakraUIRenderer(supTheme)}"},{"lineNumber":58,"author":{"gitId":"Hzxin"},"content":"          children\u003d{children[0]}"},{"lineNumber":59,"author":{"gitId":"Hzxin"},"content":"        /\u003e"},{"lineNumber":60,"author":{"gitId":"Hzxin"},"content":"      \u003c/Code\u003e"},{"lineNumber":61,"author":{"gitId":"Hzxin"},"content":"    ) : ("},{"lineNumber":62,"author":{"gitId":"Hzxin"},"content":"      \u003cCode fontSize\u003d\"lg\"\u003e"},{"lineNumber":63,"author":{"gitId":"Hzxin"},"content":"        \u003cReactMarkdown"},{"lineNumber":64,"author":{"gitId":"Hzxin"},"content":"          components\u003d{ChakraUIRenderer(supTheme)}"},{"lineNumber":65,"author":{"gitId":"Hzxin"},"content":"          children\u003d{children[0]}"},{"lineNumber":66,"author":{"gitId":"Hzxin"},"content":"        /\u003e"},{"lineNumber":67,"author":{"gitId":"Hzxin"},"content":"      \u003c/Code\u003e"},{"lineNumber":68,"author":{"gitId":"Hzxin"},"content":"    )"},{"lineNumber":69,"author":{"gitId":"Hzxin"},"content":"  },"},{"lineNumber":70,"author":{"gitId":"Hzxin"},"content":"  p: (props) \u003d\u003e {"},{"lineNumber":71,"author":{"gitId":"Hzxin"},"content":"    const { children } \u003d props"},{"lineNumber":72,"author":{"gitId":"Hzxin"},"content":"    return ("},{"lineNumber":73,"author":{"gitId":"Hzxin"},"content":"      \u003cText overflow\u003d\"auto\" mb\u003d{1} className\u003d\"text-lg\"\u003e"},{"lineNumber":74,"author":{"gitId":"Hzxin"},"content":"        {children}"},{"lineNumber":75,"author":{"gitId":"Hzxin"},"content":"      \u003c/Text\u003e"},{"lineNumber":76,"author":{"gitId":"Hzxin"},"content":"    )"},{"lineNumber":77,"author":{"gitId":"Hzxin"},"content":"  },"},{"lineNumber":78,"author":{"gitId":"Hzxin"},"content":"  em: ({ node, ...props }) \u003d\u003e {"},{"lineNumber":79,"author":{"gitId":"Hzxin"},"content":"    if ("},{"lineNumber":80,"author":{"gitId":"Hzxin"},"content":"      props.children[0] \u0026\u0026"},{"lineNumber":81,"author":{"gitId":"Hzxin"},"content":"      typeof props.children[0] \u003d\u003d\u003d \u0027string\u0027 \u0026\u0026"},{"lineNumber":82,"author":{"gitId":"Hzxin"},"content":"      props.children[0].startsWith(\u0027^\u0027)"},{"lineNumber":83,"author":{"gitId":"Hzxin"},"content":"    ) {"},{"lineNumber":84,"author":{"gitId":"Hzxin"},"content":"      return \u003csup\u003e{props.children[0].substring(1, 2)}\u003c/sup\u003e"},{"lineNumber":85,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":86,"author":{"gitId":"Hzxin"},"content":"    if ("},{"lineNumber":87,"author":{"gitId":"Hzxin"},"content":"      props.children[0] \u0026\u0026"},{"lineNumber":88,"author":{"gitId":"Hzxin"},"content":"      typeof props.children[0] \u003d\u003d\u003d \u0027string\u0027 \u0026\u0026"},{"lineNumber":89,"author":{"gitId":"Hzxin"},"content":"      props.children[0].startsWith(\u0027~\u0027)"},{"lineNumber":90,"author":{"gitId":"Hzxin"},"content":"    ) {"},{"lineNumber":91,"author":{"gitId":"Hzxin"},"content":"      return \u003csub\u003e{props.children[0].substring(1, 2)}\u003c/sub\u003e"},{"lineNumber":92,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":93,"author":{"gitId":"Hzxin"},"content":"    return \u003ci {...props} /\u003e"},{"lineNumber":94,"author":{"gitId":"Hzxin"},"content":"  },"},{"lineNumber":95,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":96,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":97,"author":{"gitId":"Hzxin"},"content":"const parse \u003d (text) \u003d\u003e {"},{"lineNumber":98,"author":{"gitId":"Hzxin"},"content":"  text \u003d text.replace(\u0027\\n\u0027, \u0027\\n\\n\u0027)"},{"lineNumber":99,"author":{"gitId":"Hzxin"},"content":"  return text"},{"lineNumber":100,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":101,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":102,"author":{"gitId":"Hzxin"},"content":"const QuestionPage \u003d () \u003d\u003e {"},{"lineNumber":103,"author":{"gitId":"Hzxin"},"content":"  const [questionData, setQuestionData] \u003d useState([])"},{"lineNumber":104,"author":{"gitId":"Hzxin"},"content":"  const [end, setEnd] \u003d useState(false)"},{"lineNumber":105,"author":{"gitId":"Hzxin"},"content":"  const { questionId } \u003d useParams()"},{"lineNumber":106,"author":{"gitId":"Hzxin"},"content":"  const navigate \u003d useNavigate()"},{"lineNumber":107,"author":{"gitId":"Hzxin"},"content":"  const toast \u003d useToast()"},{"lineNumber":108,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":109,"author":{"gitId":"Hzxin"},"content":"  const nextQuestion \u003d async () \u003d\u003e {"},{"lineNumber":110,"author":{"gitId":"Hzxin"},"content":"    if (!end) {"},{"lineNumber":111,"author":{"gitId":"Hzxin"},"content":"      navigate(\u0027/question/\u0027 + (parseInt(questionId) + 1))"},{"lineNumber":112,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":113,"author":{"gitId":"Hzxin"},"content":"  }"},{"lineNumber":114,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":115,"author":{"gitId":"Hzxin"},"content":"  const previousQuestion \u003d async () \u003d\u003e {"},{"lineNumber":116,"author":{"gitId":"Hzxin"},"content":"    if (questionId \u003e 1) {"},{"lineNumber":117,"author":{"gitId":"Hzxin"},"content":"      navigate(\u0027/question/\u0027 + (parseInt(questionId) - 1))"},{"lineNumber":118,"author":{"gitId":"Hzxin"},"content":"    } else {"},{"lineNumber":119,"author":{"gitId":"Hzxin"},"content":"      toast({"},{"lineNumber":120,"author":{"gitId":"Hzxin"},"content":"        title: \u0027You have reached the start of the questions!\u0027,"},{"lineNumber":121,"author":{"gitId":"Hzxin"},"content":"        position: \u0027top\u0027,"},{"lineNumber":122,"author":{"gitId":"Hzxin"},"content":"        status: \u0027warning\u0027,"},{"lineNumber":123,"author":{"gitId":"Hzxin"},"content":"        duration: 3000,"},{"lineNumber":124,"author":{"gitId":"Hzxin"},"content":"        isClosable: true,"},{"lineNumber":125,"author":{"gitId":"Hzxin"},"content":"      })"},{"lineNumber":126,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":127,"author":{"gitId":"Hzxin"},"content":"  }"},{"lineNumber":128,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":129,"author":{"gitId":"Hzxin"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":130,"author":{"gitId":"Hzxin"},"content":"    const getQuestion \u003d async () \u003d\u003e {"},{"lineNumber":131,"author":{"gitId":"Hzxin"},"content":"      await axios"},{"lineNumber":132,"author":{"gitId":"Hzxin"},"content":"        .get(URL_QUESTION_SERVICE + \u0027?id\u003d\u0027 + questionId)"},{"lineNumber":133,"author":{"gitId":"Hzxin"},"content":"        .then((response) \u003d\u003e {"},{"lineNumber":134,"author":{"gitId":"Hzxin"},"content":"          const newData \u003d response.data"},{"lineNumber":135,"author":{"gitId":"Hzxin"},"content":"          setQuestionData(newData)"},{"lineNumber":136,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":137,"author":{"gitId":"Hzxin"},"content":"        .catch((error) \u003d\u003e {"},{"lineNumber":138,"author":{"gitId":"Hzxin"},"content":"          toast({"},{"lineNumber":139,"author":{"gitId":"Hzxin"},"content":"            title: \u0027You have reached the end of the questions!\u0027,"},{"lineNumber":140,"author":{"gitId":"Hzxin"},"content":"            position: \u0027top\u0027,"},{"lineNumber":141,"author":{"gitId":"Hzxin"},"content":"            status: \u0027warning\u0027,"},{"lineNumber":142,"author":{"gitId":"Hzxin"},"content":"            duration: 3000,"},{"lineNumber":143,"author":{"gitId":"Hzxin"},"content":"            isClosable: true,"},{"lineNumber":144,"author":{"gitId":"Hzxin"},"content":"          })"},{"lineNumber":145,"author":{"gitId":"Hzxin"},"content":"          setEnd(true)"},{"lineNumber":146,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":147,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":148,"author":{"gitId":"Hzxin"},"content":"    if ("},{"lineNumber":149,"author":{"gitId":"Hzxin"},"content":"      typeof questionData.id \u003d\u003d\u003d \u0027undefined\u0027 ||"},{"lineNumber":150,"author":{"gitId":"Hzxin"},"content":"      Number(questionData.id) !\u003d\u003d Number(questionId)"},{"lineNumber":151,"author":{"gitId":"Hzxin"},"content":"    ) {"},{"lineNumber":152,"author":{"gitId":"Hzxin"},"content":"      getQuestion()"},{"lineNumber":153,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":154,"author":{"gitId":"Hzxin"},"content":"  }, [questionData, end, questionId, toast])"},{"lineNumber":155,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":156,"author":{"gitId":"Hzxin"},"content":"  if ("},{"lineNumber":157,"author":{"gitId":"Hzxin"},"content":"    !questionData ||"},{"lineNumber":158,"author":{"gitId":"Hzxin"},"content":"    typeof questionData \u003d\u003d\u003d \u0027undefined\u0027 ||"},{"lineNumber":159,"author":{"gitId":"Hzxin"},"content":"    questionData.length \u003d\u003d\u003d 0"},{"lineNumber":160,"author":{"gitId":"Hzxin"},"content":"  ) {"},{"lineNumber":161,"author":{"gitId":"Hzxin"},"content":"    return ("},{"lineNumber":162,"author":{"gitId":"Hzxin"},"content":"      \u003cAuthLayout title\u003d\"Retrieving question...\"\u003e"},{"lineNumber":163,"author":{"gitId":"Hzxin"},"content":"        \u003cdiv className\u003d\"text-center text-xl\"\u003e\u003c/div\u003e"},{"lineNumber":164,"author":{"gitId":"Hzxin"},"content":"      \u003c/AuthLayout\u003e"},{"lineNumber":165,"author":{"gitId":"Hzxin"},"content":"    )"},{"lineNumber":166,"author":{"gitId":"Hzxin"},"content":"  }"},{"lineNumber":167,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":168,"author":{"gitId":"Hzxin"},"content":"  const difficultyColor \u003d (difficulty) \u003d\u003e difficultyColorMap.get(difficulty)"},{"lineNumber":169,"author":{"gitId":"Hzxin"},"content":"  return ("},{"lineNumber":170,"author":{"gitId":"Hzxin"},"content":"    \u003c\u003e"},{"lineNumber":171,"author":{"gitId":"Hzxin"},"content":"      \u003cBox className\u003d\"rounded-lg border\"\u003e"},{"lineNumber":172,"author":{"gitId":"Hzxin"},"content":"        \u003cVStack h\u003d\"100vh\" divider\u003d{\u003cStackDivider borderColor\u003d\"gray.200\" /\u003e}\u003e"},{"lineNumber":173,"author":{"gitId":"Hzxin"},"content":"          \u003cHeading size\u003d\"lg\" fontWeight\u003d\"semibold\" color\u003d\"gray 500\"\u003e"},{"lineNumber":174,"author":{"gitId":"Hzxin"},"content":"            {questionData.name}"},{"lineNumber":175,"author":{"gitId":"Hzxin"},"content":"          \u003c/Heading\u003e"},{"lineNumber":176,"author":{"gitId":"Hzxin"},"content":"          \u003cHStack spacing\u003d{350}\u003e"},{"lineNumber":177,"author":{"gitId":"Hzxin"},"content":"            \u003cIconButton"},{"lineNumber":178,"author":{"gitId":"Hzxin"},"content":"              onClick\u003d{previousQuestion}"},{"lineNumber":179,"author":{"gitId":"Hzxin"},"content":"              aria-label\u003d\"Back\""},{"lineNumber":180,"author":{"gitId":"Hzxin"},"content":"              icon\u003d{\u003cArrowBackIcon /\u003e}"},{"lineNumber":181,"author":{"gitId":"Hzxin"},"content":"            \u003e\u003c/IconButton\u003e"},{"lineNumber":182,"author":{"gitId":"Hzxin"},"content":"            \u003cBadge"},{"lineNumber":183,"author":{"gitId":"Hzxin"},"content":"              align\u003d\"center\""},{"lineNumber":184,"author":{"gitId":"Hzxin"},"content":"              textAlign\u003d\"center\""},{"lineNumber":185,"author":{"gitId":"Hzxin"},"content":"              borderRadius\u003d\"full\""},{"lineNumber":186,"author":{"gitId":"Hzxin"},"content":"              px\u003d\"2\""},{"lineNumber":187,"author":{"gitId":"Hzxin"},"content":"              colorScheme\u003d{difficultyColor(questionData.difficulty)}"},{"lineNumber":188,"author":{"gitId":"Hzxin"},"content":"            \u003e"},{"lineNumber":189,"author":{"gitId":"Hzxin"},"content":"              {questionData.difficulty}"},{"lineNumber":190,"author":{"gitId":"Hzxin"},"content":"            \u003c/Badge\u003e"},{"lineNumber":191,"author":{"gitId":"Hzxin"},"content":"            \u003cIconButton"},{"lineNumber":192,"author":{"gitId":"Hzxin"},"content":"              onClick\u003d{nextQuestion}"},{"lineNumber":193,"author":{"gitId":"Hzxin"},"content":"              aria-label\u003d\"Back\""},{"lineNumber":194,"author":{"gitId":"Hzxin"},"content":"              icon\u003d{\u003cArrowForwardIcon /\u003e}"},{"lineNumber":195,"author":{"gitId":"Hzxin"},"content":"            \u003e\u003c/IconButton\u003e"},{"lineNumber":196,"author":{"gitId":"Hzxin"},"content":"          \u003c/HStack\u003e"},{"lineNumber":197,"author":{"gitId":"Hzxin"},"content":"          \u003cdiv className\u003d\"mx-2 max-h-full overflow-y-auto px-2\"\u003e"},{"lineNumber":198,"author":{"gitId":"Hzxin"},"content":"            \u003cReactMarkdown"},{"lineNumber":199,"author":{"gitId":"Hzxin"},"content":"              components\u003d{ChakraUIRenderer(newTheme)}"},{"lineNumber":200,"author":{"gitId":"Hzxin"},"content":"              children\u003d{parse(questionData.content)}"},{"lineNumber":201,"author":{"gitId":"Hzxin"},"content":"              skipHtml"},{"lineNumber":202,"author":{"gitId":"Hzxin"},"content":"            /\u003e"},{"lineNumber":203,"author":{"gitId":"Hzxin"},"content":"          \u003c/div\u003e"},{"lineNumber":204,"author":{"gitId":"Hzxin"},"content":"        \u003c/VStack\u003e"},{"lineNumber":205,"author":{"gitId":"Hzxin"},"content":"      \u003c/Box\u003e"},{"lineNumber":206,"author":{"gitId":"Hzxin"},"content":"    \u003c/\u003e"},{"lineNumber":207,"author":{"gitId":"Hzxin"},"content":"  )"},{"lineNumber":208,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":209,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":210,"author":{"gitId":"Hzxin"},"content":"export default QuestionPage"}],"authorContributionMap":{"Hzxin":210}},{"path":"frontend/src/pages/Room.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import { useNavigate, useParams } from \u0027react-router-dom\u0027"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"import { useEffect, useState } from \u0027react\u0027"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"import {"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"  EVENT_LISTEN,"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  URL_ROOM_SERVICE,"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  STATUS_CODE_SUCCESS,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  STATUS_CODE_BAD_REQUEST,"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"  URI_ROOM_SERVICE_SOCKET_PATH,"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"  URI_ROOM_SERVICE,"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"  URL_HISTORY_ROOM,"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"} from \u0027../constants\u0027"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"import { Button, useToast, Stack, Text } from \u0027@chakra-ui/react\u0027"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"import { Helmet } from \u0027react-helmet-async\u0027"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"import QuestionPane from \u0027../components/QuestionPane\u0027"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"import Editor from \u0027../components/collaboration/Editor\u0027"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"import RoomEndDialog from \u0027../components/room/RoomEndDialog\u0027"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"import io from \u0027socket.io-client\u0027"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"import useAuth from \u0027../hooks/useAuth\u0027"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"import useAxiosPrivate from \u0027../hooks/useAxiosPrivate\u0027"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"import VideoChat from \u0027../components/room/VideoChat\u0027"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"const Room \u003d () \u003d\u003e {"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"  const navigate \u003d useNavigate()"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"  const { roomId } \u003d useParams()"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"  const [questionId, setQuestionId] \u003d useState()"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"  const [room, setRoom] \u003d useState()"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"  const [socket, setSocket] \u003d useState()"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"  const [editor, setEditor] \u003d useState()"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"  const [isValid, setIsValid] \u003d useState(true)"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"  const toast \u003d useToast()"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"  const { auth } \u003d useAuth()"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"  const axiosPrivate \u003d useAxiosPrivate()"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"    axiosPrivate"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"      .get(`${URL_ROOM_SERVICE}/${roomId}`)"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"      .then((res) \u003d\u003e {"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"        if (res \u0026\u0026 res.status \u003d\u003d\u003d STATUS_CODE_SUCCESS) {"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"          setQuestionId(res.data.data.questionId)"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"          setRoom(res.data.data)"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"        }"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"      })"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"      .catch((e) \u003d\u003e {"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"        if (e.response.status \u003d\u003d\u003d STATUS_CODE_BAD_REQUEST) {"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":"          // Room not found"},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"          setIsValid(false)"},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"        }"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":"      })"},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":"  }, [axiosPrivate, roomId])"},{"lineNumber":50,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":52,"author":{"gitId":"MarcusTXK"},"content":"    const newSocket \u003d io(URI_ROOM_SERVICE, {"},{"lineNumber":53,"author":{"gitId":"MarcusTXK"},"content":"      path: URI_ROOM_SERVICE_SOCKET_PATH,"},{"lineNumber":54,"author":{"gitId":"MarcusTXK"},"content":"      auth: {"},{"lineNumber":55,"author":{"gitId":"MarcusTXK"},"content":"        token: auth.accessToken,"},{"lineNumber":56,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":57,"author":{"gitId":"MarcusTXK"},"content":"    })"},{"lineNumber":58,"author":{"gitId":"MarcusTXK"},"content":"    newSocket.on(`${roomId}-${EVENT_LISTEN.ROOM_END}`, () \u003d\u003e {"},{"lineNumber":59,"author":{"gitId":"MarcusTXK"},"content":"      toast({"},{"lineNumber":60,"author":{"gitId":"MarcusTXK"},"content":"        title: \u0027Session ended!\u0027,"},{"lineNumber":61,"author":{"gitId":"MarcusTXK"},"content":"        description: \u0027Going to Home...\u0027,"},{"lineNumber":62,"author":{"gitId":"MarcusTXK"},"content":"        status: \u0027success\u0027,"},{"lineNumber":63,"author":{"gitId":"MarcusTXK"},"content":"        duration: 4000,"},{"lineNumber":64,"author":{"gitId":"MarcusTXK"},"content":"        isClosable: true,"},{"lineNumber":65,"author":{"gitId":"MarcusTXK"},"content":"      })"},{"lineNumber":66,"author":{"gitId":"MarcusTXK"},"content":"      setTimeout(() \u003d\u003e {"},{"lineNumber":67,"author":{"gitId":"MarcusTXK"},"content":"        navigate(\u0027/\u0027)"},{"lineNumber":68,"author":{"gitId":"MarcusTXK"},"content":"      }, 4000)"},{"lineNumber":69,"author":{"gitId":"MarcusTXK"},"content":"    })"},{"lineNumber":70,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":71,"author":{"gitId":"MarcusTXK"},"content":"    newSocket.on(`${roomId}-${EVENT_LISTEN.ROOM_UPDATE}`, (payload) \u003d\u003e {"},{"lineNumber":72,"author":{"gitId":"MarcusTXK"},"content":"      toast({"},{"lineNumber":73,"author":{"gitId":"MarcusTXK"},"content":"        title: \u0027Next Question\u0027,"},{"lineNumber":74,"author":{"gitId":"MarcusTXK"},"content":"        description: \u0027Fetched new question\u0027,"},{"lineNumber":75,"author":{"gitId":"MarcusTXK"},"content":"        status: \u0027success\u0027,"},{"lineNumber":76,"author":{"gitId":"MarcusTXK"},"content":"        duration: 4000,"},{"lineNumber":77,"author":{"gitId":"MarcusTXK"},"content":"        isClosable: true,"},{"lineNumber":78,"author":{"gitId":"MarcusTXK"},"content":"      })"},{"lineNumber":79,"author":{"gitId":"MarcusTXK"},"content":"      setQuestionId(payload.question)"},{"lineNumber":80,"author":{"gitId":"MarcusTXK"},"content":"    })"},{"lineNumber":81,"author":{"gitId":"MarcusTXK"},"content":"    setSocket(newSocket)"},{"lineNumber":82,"author":{"gitId":"MarcusTXK"},"content":"    return () \u003d\u003e newSocket.close()"},{"lineNumber":83,"author":{"gitId":"MarcusTXK"},"content":"  }, [auth.accessToken, navigate, roomId, toast])"},{"lineNumber":84,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":85,"author":{"gitId":"uyencfi"},"content":"  const endSession \u003d async () \u003d\u003e {"},{"lineNumber":86,"author":{"gitId":"MarcusTXK"},"content":"    await axiosPrivate"},{"lineNumber":87,"author":{"gitId":"MarcusTXK"},"content":"      .delete(`${URL_ROOM_SERVICE}/${roomId}`)"},{"lineNumber":88,"author":{"gitId":"MarcusTXK"},"content":"      .catch(console.log)"},{"lineNumber":89,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":90,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":91,"author":{"gitId":"uyencfi"},"content":"  const markCompleted \u003d async () \u003d\u003e {"},{"lineNumber":92,"author":{"gitId":"uyencfi"},"content":"    console.log(editor.getText());"},{"lineNumber":93,"author":{"gitId":"uyencfi"},"content":"    await axiosPrivate"},{"lineNumber":94,"author":{"gitId":"uyencfi"},"content":"      .put(`${URL_HISTORY_ROOM}/${roomId}`, {"},{"lineNumber":95,"author":{"gitId":"uyencfi"},"content":"        questionId,"},{"lineNumber":96,"author":{"gitId":"uyencfi"},"content":"        answer: editor.getText(),   // accessing Firepad"},{"lineNumber":97,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":98,"author":{"gitId":"uyencfi"},"content":"      .then(() \u003d\u003e {"},{"lineNumber":99,"author":{"gitId":"uyencfi"},"content":"        toast({"},{"lineNumber":100,"author":{"gitId":"uyencfi"},"content":"          title: \u0027Marked question as completed!\u0027,"},{"lineNumber":101,"author":{"gitId":"uyencfi"},"content":"          status: \u0027success\u0027,"},{"lineNumber":102,"author":{"gitId":"uyencfi"},"content":"          duration: 3000,"},{"lineNumber":103,"author":{"gitId":"uyencfi"},"content":"          isClosable: true,"},{"lineNumber":104,"author":{"gitId":"uyencfi"},"content":"        })"},{"lineNumber":105,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":106,"author":{"gitId":"uyencfi"},"content":"      .catch((e) \u003d\u003e {"},{"lineNumber":107,"author":{"gitId":"uyencfi"},"content":"        toast({"},{"lineNumber":108,"author":{"gitId":"uyencfi"},"content":"          title: \"Couldn\u0027t mark as completed...\","},{"lineNumber":109,"author":{"gitId":"uyencfi"},"content":"          status: \u0027error\u0027,"},{"lineNumber":110,"author":{"gitId":"uyencfi"},"content":"          duration: 3000,"},{"lineNumber":111,"author":{"gitId":"uyencfi"},"content":"          isClosable: true,"},{"lineNumber":112,"author":{"gitId":"uyencfi"},"content":"        })"},{"lineNumber":113,"author":{"gitId":"uyencfi"},"content":"        return console.log(e)"},{"lineNumber":114,"author":{"gitId":"uyencfi"},"content":"      })"},{"lineNumber":115,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":116,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":117,"author":{"gitId":"uyencfi"},"content":"  const getHelmet \u003d () \u003d\u003e {"},{"lineNumber":118,"author":{"gitId":"uyencfi"},"content":"    return ("},{"lineNumber":119,"author":{"gitId":"uyencfi"},"content":"      \u003cHelmet\u003e"},{"lineNumber":120,"author":{"gitId":"tlylt"},"content":"        \u003ctitle\u003eRoom | LeetWithFriend\u003c/title\u003e"},{"lineNumber":121,"author":{"gitId":"uyencfi"},"content":"        \u003cmeta charSet\u003d\"utf-8\" /\u003e"},{"lineNumber":122,"author":{"gitId":"tlylt"},"content":"        \u003cmeta"},{"lineNumber":123,"author":{"gitId":"tlylt"},"content":"          name\u003d\"description\""},{"lineNumber":124,"author":{"gitId":"tlylt"},"content":"          content\u003d\"An interview preparation platform and peer matching system, where students can find peers to practice whiteboard-style interview questions together.\""},{"lineNumber":125,"author":{"gitId":"tlylt"},"content":"        /\u003e"},{"lineNumber":126,"author":{"gitId":"uyencfi"},"content":"      \u003c/Helmet\u003e"},{"lineNumber":127,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":128,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":129,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":130,"author":{"gitId":"uyencfi"},"content":"  return ("},{"lineNumber":131,"author":{"gitId":"uyencfi"},"content":"    \u003c\u003e"},{"lineNumber":132,"author":{"gitId":"uyencfi"},"content":"      {getHelmet()}"},{"lineNumber":133,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":134,"author":{"gitId":"MarcusTXK"},"content":"      {!isValid || !questionId ? ("},{"lineNumber":135,"author":{"gitId":"tlylt"},"content":"        \u003cmain className\u003d\"flex flex-col items-center justify-start h-full\"\u003e"},{"lineNumber":136,"author":{"gitId":"MarcusTXK"},"content":"          \u003ch1\u003e"},{"lineNumber":137,"author":{"gitId":"MarcusTXK"},"content":"            {isValid ? ("},{"lineNumber":138,"author":{"gitId":"MarcusTXK"},"content":"              \u0027Retrieving room...\u0027"},{"lineNumber":139,"author":{"gitId":"MarcusTXK"},"content":"            ) : ("},{"lineNumber":140,"author":{"gitId":"MarcusTXK"},"content":"              \u003c\u003e"},{"lineNumber":141,"author":{"gitId":"MarcusTXK"},"content":"                \u003cStack spacing\u003d{10} textAlign\u003d\"center\"\u003e"},{"lineNumber":142,"author":{"gitId":"MarcusTXK"},"content":"                  \u003cText fontSize\u003d\"2xl\"\u003eInvalid Room\u003c/Text\u003e"},{"lineNumber":143,"author":{"gitId":"MarcusTXK"},"content":"                  \u003cText\u003e"},{"lineNumber":144,"author":{"gitId":"MarcusTXK"},"content":"                    The session has ended or you are not a valid participant."},{"lineNumber":145,"author":{"gitId":"MarcusTXK"},"content":"                  \u003c/Text\u003e"},{"lineNumber":146,"author":{"gitId":"MarcusTXK"},"content":"                  \u003cButton as\u003d\"a\" href\u003d\"/\"\u003e"},{"lineNumber":147,"author":{"gitId":"MarcusTXK"},"content":"                    Return Home"},{"lineNumber":148,"author":{"gitId":"MarcusTXK"},"content":"                  \u003c/Button\u003e"},{"lineNumber":149,"author":{"gitId":"MarcusTXK"},"content":"                \u003c/Stack\u003e"},{"lineNumber":150,"author":{"gitId":"MarcusTXK"},"content":"              \u003c/\u003e"},{"lineNumber":151,"author":{"gitId":"MarcusTXK"},"content":"            )}"},{"lineNumber":152,"author":{"gitId":"MarcusTXK"},"content":"          \u003c/h1\u003e"},{"lineNumber":153,"author":{"gitId":"MarcusTXK"},"content":"        \u003c/main\u003e"},{"lineNumber":154,"author":{"gitId":"MarcusTXK"},"content":"      ) : ("},{"lineNumber":155,"author":{"gitId":"MarcusTXK"},"content":"        \u003c\u003e"},{"lineNumber":156,"author":{"gitId":"MarcusTXK"},"content":"          \u003cVideoChat"},{"lineNumber":157,"author":{"gitId":"MarcusTXK"},"content":"            userId\u003d{auth.username}"},{"lineNumber":158,"author":{"gitId":"MarcusTXK"},"content":"            otherUserId\u003d{"},{"lineNumber":159,"author":{"gitId":"MarcusTXK"},"content":"              room.userId1 \u003d\u003d\u003d auth.username ? room.userId2 : room.userId1"},{"lineNumber":160,"author":{"gitId":"MarcusTXK"},"content":"            }"},{"lineNumber":161,"author":{"gitId":"MarcusTXK"},"content":"            roomId\u003d{roomId}"},{"lineNumber":162,"author":{"gitId":"MarcusTXK"},"content":"            socket\u003d{socket}"},{"lineNumber":163,"author":{"gitId":"MarcusTXK"},"content":"          /\u003e"},{"lineNumber":164,"author":{"gitId":"uyencfi"},"content":"          \u003cdiv className\u003d\"grid h-screen grid-cols-2 gap-4\"\u003e"},{"lineNumber":165,"author":{"gitId":"MarcusTXK"},"content":"            \u003cQuestionPane questionId\u003d{questionId} roomId\u003d{roomId} /\u003e"},{"lineNumber":166,"author":{"gitId":"uyencfi"},"content":"            \u003cdiv className\u003d\"flex flex-col justify-start\"\u003e"},{"lineNumber":167,"author":{"gitId":"uyencfi"},"content":"              \u003cEditor roomId\u003d{roomId} setEditorComponent\u003d{setEditor} /\u003e"},{"lineNumber":168,"author":{"gitId":"uyencfi"},"content":"              \u003cdiv className\u003d\"flex flex-row items-center justify-center\"\u003e"},{"lineNumber":169,"author":{"gitId":"uyencfi"},"content":"              \u003cButton className\u003d\u0027mx-2\u0027 onClick\u003d{markCompleted}\u003eMark completed\u003c/Button\u003e"},{"lineNumber":170,"author":{"gitId":"MarcusTXK"},"content":"              \u003cRoomEndDialog handleClick\u003d{endSession} /\u003e"},{"lineNumber":171,"author":{"gitId":"uyencfi"},"content":"            \u003c/div\u003e"},{"lineNumber":172,"author":{"gitId":"uyencfi"},"content":"            \u003c/div\u003e"},{"lineNumber":173,"author":{"gitId":"MarcusTXK"},"content":"          \u003c/div\u003e"},{"lineNumber":174,"author":{"gitId":"MarcusTXK"},"content":"        \u003c/\u003e"},{"lineNumber":175,"author":{"gitId":"MarcusTXK"},"content":"      )}"},{"lineNumber":176,"author":{"gitId":"uyencfi"},"content":"    \u003c/\u003e"},{"lineNumber":177,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":178,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":179,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":180,"author":{"gitId":"MarcusTXK"},"content":"export default Room"}],"authorContributionMap":{"MarcusTXK":113,"tlylt":6,"uyencfi":61}},{"path":"frontend/src/pages/Signup.jsx","fileType":"jsx","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { faInfoCircle } from \u0027@fortawesome/free-solid-svg-icons\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { FontAwesomeIcon } from \u0027@fortawesome/react-fontawesome\u0027"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import { useEffect, useRef, useState } from \u0027react\u0027"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import axios from \u0027../api/axios\u0027"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"import { URL_USER_SERVICE, USER_REGEX, PASSWORD_REGEX } from \u0027../constants\u0027"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"import { STATUS_CODE_CONFLICT, STATUS_CODE_CREATED } from \u0027../constants\u0027"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"import { AuthLayout } from \u0027../components/AuthLayout\u0027"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"import { Button } from \u0027../components/Button\u0027"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"import { FormTextField } from \u0027../components/Fields\u0027"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"import { Link } from \u0027react-router-dom\u0027"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"import { Helmet } from \u0027react-helmet-async\u0027"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"function Signup() {"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"  const [username, setUsername] \u003d useState(\u0027\u0027)"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"  const [password, setPassword] \u003d useState(\u0027\u0027)"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"  const [repeatPassword, setRepeatPassword] \u003d useState(\u0027\u0027)"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"  const [errorMsg, setErrorMsg] \u003d useState(\u0027\u0027)"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"  const [validName, setValidName] \u003d useState(false)"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"  const [validPassword, setValidPassword] \u003d useState(false)"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"  const [validMatch, setValidMatch] \u003d useState(false)"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"  const [usernameFocus, setUsernameFocus] \u003d useState(false)"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"  const [passwordFocus, setPasswordFocus] \u003d useState(false)"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"  const [repeatPasswordFocus, setRepeatPasswordFocus] \u003d useState(false)"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"  const [success, setSuccess] \u003d useState(false)"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"  const errRef \u003d useRef()"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"  const handleSignup \u003d async () \u003d\u003e {"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"    const v1 \u003d USER_REGEX.test(username)"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"    const v2 \u003d PASSWORD_REGEX.test(password)"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"    if (!v1 || !v2) {"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"      setErrorMsg(\u0027Invalid Entry\u0027)"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"      return"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"    const res \u003d await axios"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"      .post(URL_USER_SERVICE, { username, password })"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"      .catch((err) \u003d\u003e {"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"        console.log(err.response.data.message)"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"        if (err.response.status \u003d\u003d\u003d STATUS_CODE_CONFLICT) {"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"          setErrorMsg(\u0027This username already exists\u0027)"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"        } else {"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"          setErrorMsg(\u0027Please try again later\u0027)"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"      })"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"    if (res \u0026\u0026 res.status \u003d\u003d\u003d STATUS_CODE_CREATED) {"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"      setSuccess(true)"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"      setUsername(\u0027\u0027)"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"      setPassword(\u0027\u0027)"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"      setRepeatPassword(\u0027\u0027)"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"  }"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"    setValidName(USER_REGEX.test(username))"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"  }, [username])"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"    setValidPassword(PASSWORD_REGEX.test(password))"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"    setValidMatch(password \u003d\u003d\u003d repeatPassword)"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"  }, [password, repeatPassword])"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"  useEffect(() \u003d\u003e {"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"    setErrorMsg(\u0027\u0027)"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"  }, [username, password, repeatPassword])"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"  return ("},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"    \u003c\u003e"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"      \u003cHelmet\u003e"},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"        \u003ctitle\u003eSignup | LeetWithFriend\u003c/title\u003e"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"        \u003cmeta charSet\u003d\"utf-8\" /\u003e"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"        \u003cmeta"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":"          name\u003d\"description\""},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"          content\u003d\"An interview preparation platform and peer matching system, where students can find peers to practice whiteboard-style interview questions together.\""},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"        /\u003e"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"      \u003c/Helmet\u003e"},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"      {success ? ("},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"        \u003cAuthLayout title\u003d\"Sign up successful!\"\u003e"},{"lineNumber":80,"author":{"gitId":"tlylt"},"content":"          \u003cdiv className\u003d\"text-xl text-center\"\u003e"},{"lineNumber":81,"author":{"gitId":"tlylt"},"content":"            \u003cLink to\u003d\"/login\" className\u003d\"underline text-cyan-600\"\u003e"},{"lineNumber":82,"author":{"gitId":"tlylt"},"content":"              Sign in"},{"lineNumber":83,"author":{"gitId":"tlylt"},"content":"            \u003c/Link\u003e{\u0027 \u0027}"},{"lineNumber":84,"author":{"gitId":"tlylt"},"content":"            to your account now!"},{"lineNumber":85,"author":{"gitId":"tlylt"},"content":"          \u003c/div\u003e"},{"lineNumber":86,"author":{"gitId":"tlylt"},"content":"        \u003c/AuthLayout\u003e"},{"lineNumber":87,"author":{"gitId":"tlylt"},"content":"      ) : ("},{"lineNumber":88,"author":{"gitId":"tlylt"},"content":"        \u003c\u003e"},{"lineNumber":89,"author":{"gitId":"tlylt"},"content":"          \u003cAuthLayout"},{"lineNumber":90,"author":{"gitId":"tlylt"},"content":"            title\u003d\"Sign up for an account\""},{"lineNumber":91,"author":{"gitId":"tlylt"},"content":"            subtitle\u003d{"},{"lineNumber":92,"author":{"gitId":"tlylt"},"content":"              \u003c\u003e"},{"lineNumber":93,"author":{"gitId":"tlylt"},"content":"                Already registered?{\u0027 \u0027}"},{"lineNumber":94,"author":{"gitId":"tlylt"},"content":"                \u003cLink to\u003d\"/login\" className\u003d\"text-cyan-600\"\u003e"},{"lineNumber":95,"author":{"gitId":"tlylt"},"content":"                  Sign in"},{"lineNumber":96,"author":{"gitId":"tlylt"},"content":"                \u003c/Link\u003e{\u0027 \u0027}"},{"lineNumber":97,"author":{"gitId":"tlylt"},"content":"                to your account."},{"lineNumber":98,"author":{"gitId":"tlylt"},"content":"              \u003c/\u003e"},{"lineNumber":99,"author":{"gitId":"tlylt"},"content":"            }"},{"lineNumber":100,"author":{"gitId":"tlylt"},"content":"          \u003e"},{"lineNumber":101,"author":{"gitId":"tlylt"},"content":"            \u003cdiv\u003e"},{"lineNumber":102,"author":{"gitId":"tlylt"},"content":"              \u003cdiv className\u003d\"grid grid-cols-2 gap-2\"\u003e"},{"lineNumber":103,"author":{"gitId":"tlylt"},"content":"                \u003cFormTextField"},{"lineNumber":104,"author":{"gitId":"tlylt"},"content":"                  label\u003d\"Username\""},{"lineNumber":105,"author":{"gitId":"tlylt"},"content":"                  id\u003d\"username\""},{"lineNumber":106,"author":{"gitId":"tlylt"},"content":"                  name\u003d\"username\""},{"lineNumber":107,"author":{"gitId":"tlylt"},"content":"                  minLength\u003d{4}"},{"lineNumber":108,"author":{"gitId":"tlylt"},"content":"                  isValid\u003d{validName}"},{"lineNumber":109,"author":{"gitId":"tlylt"},"content":"                  isFocused\u003d{usernameFocus}"},{"lineNumber":110,"author":{"gitId":"tlylt"},"content":"                  value\u003d{username}"},{"lineNumber":111,"author":{"gitId":"tlylt"},"content":"                  className\u003d\"col-span-full\""},{"lineNumber":112,"author":{"gitId":"tlylt"},"content":"                  type\u003d\"text\""},{"lineNumber":113,"author":{"gitId":"tlylt"},"content":"                  autoComplete\u003d\"off\""},{"lineNumber":114,"author":{"gitId":"tlylt"},"content":"                  required"},{"lineNumber":115,"author":{"gitId":"tlylt"},"content":"                  onChange\u003d{(e) \u003d\u003e setUsername(e.target.value)}"},{"lineNumber":116,"author":{"gitId":"tlylt"},"content":"                  autoFocus"},{"lineNumber":117,"author":{"gitId":"tlylt"},"content":"                  onFocus\u003d{() \u003d\u003e setUsernameFocus(true)}"},{"lineNumber":118,"author":{"gitId":"tlylt"},"content":"                  onBlur\u003d{() \u003d\u003e setUsernameFocus(false)}"},{"lineNumber":119,"author":{"gitId":"tlylt"},"content":"                /\u003e"},{"lineNumber":120,"author":{"gitId":"tlylt"},"content":"                \u003cdiv"},{"lineNumber":121,"author":{"gitId":"tlylt"},"content":"                  id\u003d\"uidnote\""},{"lineNumber":122,"author":{"gitId":"tlylt"},"content":"                  className\u003d{"},{"lineNumber":123,"author":{"gitId":"tlylt"},"content":"                    usernameFocus \u0026\u0026 username \u0026\u0026 !validName"},{"lineNumber":124,"author":{"gitId":"tlylt"},"content":"                      ? \u0027relative col-span-full flex items-center gap-2 bg-slate-500 px-1 text-white\u0027"},{"lineNumber":125,"author":{"gitId":"tlylt"},"content":"                      : \u0027hidden\u0027"},{"lineNumber":126,"author":{"gitId":"tlylt"},"content":"                  }"},{"lineNumber":127,"author":{"gitId":"tlylt"},"content":"                \u003e"},{"lineNumber":128,"author":{"gitId":"tlylt"},"content":"                  \u003cFontAwesomeIcon icon\u003d{faInfoCircle} /\u003e"},{"lineNumber":129,"author":{"gitId":"tlylt"},"content":"                  4 to 24 characters."},{"lineNumber":130,"author":{"gitId":"tlylt"},"content":"                  \u003cbr /\u003e"},{"lineNumber":131,"author":{"gitId":"tlylt"},"content":"                  Must begin with a letter."},{"lineNumber":132,"author":{"gitId":"tlylt"},"content":"                  \u003cbr /\u003e"},{"lineNumber":133,"author":{"gitId":"tlylt"},"content":"                  Letters, numbers, underscores, hyphens allowed."},{"lineNumber":134,"author":{"gitId":"tlylt"},"content":"                \u003c/div\u003e"},{"lineNumber":135,"author":{"gitId":"tlylt"},"content":"                \u003cFormTextField"},{"lineNumber":136,"author":{"gitId":"tlylt"},"content":"                  className\u003d\"col-span-full\""},{"lineNumber":137,"author":{"gitId":"tlylt"},"content":"                  id\u003d\"password\""},{"lineNumber":138,"author":{"gitId":"tlylt"},"content":"                  name\u003d\"password\""},{"lineNumber":139,"author":{"gitId":"tlylt"},"content":"                  type\u003d\"password\""},{"lineNumber":140,"author":{"gitId":"tlylt"},"content":"                  autoComplete\u003d\"off\""},{"lineNumber":141,"author":{"gitId":"tlylt"},"content":"                  required"},{"lineNumber":142,"author":{"gitId":"tlylt"},"content":"                  isValid\u003d{validPassword}"},{"lineNumber":143,"author":{"gitId":"tlylt"},"content":"                  isFocused\u003d{passwordFocus}"},{"lineNumber":144,"author":{"gitId":"tlylt"},"content":"                  label\u003d\"Password\""},{"lineNumber":145,"author":{"gitId":"tlylt"},"content":"                  value\u003d{password}"},{"lineNumber":146,"author":{"gitId":"tlylt"},"content":"                  onChange\u003d{(e) \u003d\u003e setPassword(e.target.value)}"},{"lineNumber":147,"author":{"gitId":"tlylt"},"content":"                  onFocus\u003d{() \u003d\u003e setPasswordFocus(true)}"},{"lineNumber":148,"author":{"gitId":"tlylt"},"content":"                  onBlur\u003d{() \u003d\u003e setPasswordFocus(false)}"},{"lineNumber":149,"author":{"gitId":"tlylt"},"content":"                /\u003e"},{"lineNumber":150,"author":{"gitId":"tlylt"},"content":"                \u003cdiv"},{"lineNumber":151,"author":{"gitId":"tlylt"},"content":"                  className\u003d{"},{"lineNumber":152,"author":{"gitId":"tlylt"},"content":"                    passwordFocus \u0026\u0026 !validPassword"},{"lineNumber":153,"author":{"gitId":"tlylt"},"content":"                      ? \u0027relative col-span-full flex items-center gap-2 bg-slate-500 px-1 text-white\u0027"},{"lineNumber":154,"author":{"gitId":"tlylt"},"content":"                      : \u0027hidden\u0027"},{"lineNumber":155,"author":{"gitId":"tlylt"},"content":"                  }"},{"lineNumber":156,"author":{"gitId":"tlylt"},"content":"                \u003e"},{"lineNumber":157,"author":{"gitId":"tlylt"},"content":"                  \u003cFontAwesomeIcon icon\u003d{faInfoCircle} /\u003e"},{"lineNumber":158,"author":{"gitId":"tlylt"},"content":"                  \u003cdiv\u003e"},{"lineNumber":159,"author":{"gitId":"tlylt"},"content":"                    8 to 24 characters."},{"lineNumber":160,"author":{"gitId":"tlylt"},"content":"                    \u003cbr /\u003e"},{"lineNumber":161,"author":{"gitId":"tlylt"},"content":"                    Must include uppercase and lowercase letters, a number and a"},{"lineNumber":162,"author":{"gitId":"tlylt"},"content":"                    special character."},{"lineNumber":163,"author":{"gitId":"tlylt"},"content":"                    \u003cbr /\u003e"},{"lineNumber":164,"author":{"gitId":"tlylt"},"content":"                    Allowed special characters:{\u0027 \u0027}"},{"lineNumber":165,"author":{"gitId":"tlylt"},"content":"                    \u003cspan aria-label\u003d\"exclamation mark\"\u003e!\u003c/span\u003e"},{"lineNumber":166,"author":{"gitId":"tlylt"},"content":"                    \u003cspan aria-label\u003d\"at symbol\"\u003e@\u003c/span\u003e{\u0027 \u0027}"},{"lineNumber":167,"author":{"gitId":"tlylt"},"content":"                    \u003cspan aria-label\u003d\"hashtag\"\u003e#\u003c/span\u003e{\u0027 \u0027}"},{"lineNumber":168,"author":{"gitId":"tlylt"},"content":"                    \u003cspan aria-label\u003d\"dollar sign\"\u003e$\u003c/span\u003e{\u0027 \u0027}"},{"lineNumber":169,"author":{"gitId":"tlylt"},"content":"                    \u003cspan aria-label\u003d\"percent\"\u003e%\u003c/span\u003e"},{"lineNumber":170,"author":{"gitId":"tlylt"},"content":"                  \u003c/div\u003e"},{"lineNumber":171,"author":{"gitId":"tlylt"},"content":"                \u003c/div\u003e"},{"lineNumber":172,"author":{"gitId":"tlylt"},"content":"                \u003cFormTextField"},{"lineNumber":173,"author":{"gitId":"tlylt"},"content":"                  label\u003d\"Confirm Password\""},{"lineNumber":174,"author":{"gitId":"tlylt"},"content":"                  type\u003d\"password\""},{"lineNumber":175,"author":{"gitId":"tlylt"},"content":"                  required"},{"lineNumber":176,"author":{"gitId":"tlylt"},"content":"                  className\u003d\"col-span-2\""},{"lineNumber":177,"author":{"gitId":"tlylt"},"content":"                  isValid\u003d{validMatch}"},{"lineNumber":178,"author":{"gitId":"tlylt"},"content":"                  isFocused\u003d{repeatPasswordFocus}"},{"lineNumber":179,"author":{"gitId":"tlylt"},"content":"                  value\u003d{repeatPassword}"},{"lineNumber":180,"author":{"gitId":"tlylt"},"content":"                  onChange\u003d{(e) \u003d\u003e setRepeatPassword(e.target.value)}"},{"lineNumber":181,"author":{"gitId":"tlylt"},"content":"                  onFocus\u003d{() \u003d\u003e setRepeatPasswordFocus(true)}"},{"lineNumber":182,"author":{"gitId":"tlylt"},"content":"                  onBlur\u003d{() \u003d\u003e setRepeatPasswordFocus(false)}"},{"lineNumber":183,"author":{"gitId":"tlylt"},"content":"                /\u003e"},{"lineNumber":184,"author":{"gitId":"tlylt"},"content":"                \u003cdiv"},{"lineNumber":185,"author":{"gitId":"tlylt"},"content":"                  className\u003d{"},{"lineNumber":186,"author":{"gitId":"tlylt"},"content":"                    repeatPasswordFocus \u0026\u0026 !validMatch"},{"lineNumber":187,"author":{"gitId":"tlylt"},"content":"                      ? \u0027relative col-span-full flex items-center gap-2 bg-slate-500 px-1 text-white\u0027"},{"lineNumber":188,"author":{"gitId":"tlylt"},"content":"                      : \u0027hidden\u0027"},{"lineNumber":189,"author":{"gitId":"tlylt"},"content":"                  }"},{"lineNumber":190,"author":{"gitId":"tlylt"},"content":"                \u003e"},{"lineNumber":191,"author":{"gitId":"tlylt"},"content":"                  \u003cFontAwesomeIcon icon\u003d{faInfoCircle} /\u003e"},{"lineNumber":192,"author":{"gitId":"tlylt"},"content":"                  Must match the password input field."},{"lineNumber":193,"author":{"gitId":"tlylt"},"content":"                \u003c/div\u003e"},{"lineNumber":194,"author":{"gitId":"tlylt"},"content":"              \u003c/div\u003e"},{"lineNumber":195,"author":{"gitId":"tlylt"},"content":"              \u003cButton"},{"lineNumber":196,"author":{"gitId":"tlylt"},"content":"                className\u003d\"w-full mt-8\""},{"lineNumber":197,"author":{"gitId":"tlylt"},"content":"                color\u003d{`${"},{"lineNumber":198,"author":{"gitId":"tlylt"},"content":"                  !validName || !validPassword || !validMatch ? \u0027gray\u0027 : \u0027cyan\u0027"},{"lineNumber":199,"author":{"gitId":"tlylt"},"content":"                }`}"},{"lineNumber":200,"author":{"gitId":"tlylt"},"content":"                onClick\u003d{handleSignup}"},{"lineNumber":201,"author":{"gitId":"tlylt"},"content":"                disabled\u003d{"},{"lineNumber":202,"author":{"gitId":"tlylt"},"content":"                  !validName || !validPassword || !validMatch ? true : false"},{"lineNumber":203,"author":{"gitId":"tlylt"},"content":"                }"},{"lineNumber":204,"author":{"gitId":"tlylt"},"content":"              \u003e"},{"lineNumber":205,"author":{"gitId":"tlylt"},"content":"                Let\u0027s Go"},{"lineNumber":206,"author":{"gitId":"tlylt"},"content":"              \u003c/Button\u003e"},{"lineNumber":207,"author":{"gitId":"tlylt"},"content":"              \u003cp"},{"lineNumber":208,"author":{"gitId":"tlylt"},"content":"                ref\u003d{errRef}"},{"lineNumber":209,"author":{"gitId":"tlylt"},"content":"                className\u003d{`mt-2 text-center ${"},{"lineNumber":210,"author":{"gitId":"tlylt"},"content":"                  errorMsg ? \u0027errormsg\u0027 : \u0027offscreen\u0027"},{"lineNumber":211,"author":{"gitId":"tlylt"},"content":"                }`}"},{"lineNumber":212,"author":{"gitId":"tlylt"},"content":"                aria-live\u003d\"assertive\""},{"lineNumber":213,"author":{"gitId":"tlylt"},"content":"              \u003e"},{"lineNumber":214,"author":{"gitId":"tlylt"},"content":"                {errorMsg}"},{"lineNumber":215,"author":{"gitId":"tlylt"},"content":"              \u003c/p\u003e"},{"lineNumber":216,"author":{"gitId":"tlylt"},"content":"            \u003c/div\u003e"},{"lineNumber":217,"author":{"gitId":"tlylt"},"content":"          \u003c/AuthLayout\u003e"},{"lineNumber":218,"author":{"gitId":"tlylt"},"content":"        \u003c/\u003e"},{"lineNumber":219,"author":{"gitId":"tlylt"},"content":"      )}"},{"lineNumber":220,"author":{"gitId":"tlylt"},"content":"    \u003c/\u003e"},{"lineNumber":221,"author":{"gitId":"tlylt"},"content":"  )"},{"lineNumber":222,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":223,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":224,"author":{"gitId":"tlylt"},"content":"export default Signup"}],"authorContributionMap":{"tlylt":224}},{"path":"frontend/src/pages/UserTokenTest.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { useEffect } from \"react\";"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import useAxiosPrivate from \"../hooks/useAxiosPrivate\";"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import { useNavigate, useLocation } from \"react-router-dom\";"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import { URL_USER_TOKEN_TEST } from \"../constants\";"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"import useAuth from \"../hooks/useAuth\";"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"const Users \u003d () \u003d\u003e {"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    const { auth } \u003d useAuth()"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    const axiosPrivate \u003d useAxiosPrivate();"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    const navigate \u003d useNavigate();"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    const location \u003d useLocation();"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    useEffect(() \u003d\u003e {"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"        const testToken \u003d async () \u003d\u003e {"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"            try {"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"                const response \u003d await axiosPrivate.post(URL_USER_TOKEN_TEST);"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"                console.log(response.data);"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"            } catch (err) {"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"                console.error(err);"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"                navigate(\u0027/login\u0027, { state: { from: location }, replace: true });"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"            }"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        testToken();"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"    }, [axiosPrivate, navigate, location]);"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"    return ("},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"        \u003carticle\u003e"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"            \u003ch2\u003eUser Token Test\u003c/h2\u003e"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"            {auth.username?.length"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"                ? ("},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"                    \u003cul\u003e"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"                        \u003cp\u003e{auth?.username}\u003c/p\u003e"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"                    \u003c/ul\u003e"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"                ) : \u003cp\u003eUser not ready\u003c/p\u003e"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"            }"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"        \u003c/article\u003e"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"    );"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"};"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"export default Users;"}],"authorContributionMap":{"tlylt":42}},{"path":"frontend/src/prettier.config.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"module.exports \u003d {"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"  singleQuote: true,"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"  semi: false,"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  plugins: [require(\u0027prettier-plugin-tailwindcss\u0027)],"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":5}},{"path":"frontend/src/styles/tailwind.css","fileType":"css","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"@tailwind base;"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"@tailwind components;"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"@tailwind utilities;"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"#__next {"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    min-height: 100%;"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":7}},{"path":"frontend/src/theme.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"// theme.js"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"// 1. import `extendTheme` function"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import { extendTheme } from \u0027@chakra-ui/react\u0027"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"// 2. Add your color mode config"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"const config \u003d {"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    initialColorMode: \u0027system\u0027,"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"// 3. extend the theme"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"const theme \u003d extendTheme({ config })"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"export default theme"}],"authorContributionMap":{"tlylt":14}},{"path":"frontend/src/utils/index.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { RANDOM_AVATAR_URL } from \"../constants\";"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"export function getUserProfileUrl(username) {"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"    return `${RANDOM_AVATAR_URL}${username}.svg`"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":5}},{"path":"frontend/tailwind.config.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"const defaultTheme \u003d require(\u0027tailwindcss/defaultTheme\u0027)"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"/** @type {import(\u0027tailwindcss\u0027).Config} */"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"module.exports \u003d {"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  content: [\u0027./src/**/*.{js,jsx}\u0027],"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  darkMode: [\u0027class\u0027, \u0027[data-theme\u003d\"dark\"]\u0027],"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  theme: {"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    fontSize: {"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      xs: [\u00270.75rem\u0027, { lineHeight: \u00271rem\u0027 }],"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"      sm: [\u00270.875rem\u0027, { lineHeight: \u00271.5rem\u0027 }],"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"      base: [\u00271rem\u0027, { lineHeight: \u00271.5rem\u0027 }],"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      lg: [\u00271.125rem\u0027, { lineHeight: \u00272rem\u0027 }],"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"      xl: [\u00271.25rem\u0027, { lineHeight: \u00271.75rem\u0027 }],"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"      \u00272xl\u0027: [\u00271.5rem\u0027, { lineHeight: \u00272rem\u0027 }],"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      \u00273xl\u0027: [\u00272rem\u0027, { lineHeight: \u00273rem\u0027 }],"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"      \u00274xl\u0027: [\u00272.5rem\u0027, { lineHeight: \u00273rem\u0027 }],"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"      \u00275xl\u0027: [\u00273rem\u0027, { lineHeight: \u00271\u0027 }],"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"      \u00276xl\u0027: [\u00273.75rem\u0027, { lineHeight: \u00271\u0027 }],"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"      \u00277xl\u0027: [\u00274.5rem\u0027, { lineHeight: \u00271\u0027 }],"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"      \u00278xl\u0027: [\u00276rem\u0027, { lineHeight: \u00271\u0027 }],"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"      \u00279xl\u0027: [\u00278rem\u0027, { lineHeight: \u00271\u0027 }],"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"    extend: {"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"      animation: {"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        \u0027fade-in\u0027: \u0027fade-in 0.5s linear forwards\u0027,"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"        marquee: \u0027marquee var(--marquee-duration) linear infinite\u0027,"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"        \u0027spin-slow\u0027: \u0027spin 4s linear infinite\u0027,"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"        \u0027spin-slower\u0027: \u0027spin 6s linear infinite\u0027,"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"        \u0027spin-reverse\u0027: \u0027spin-reverse 1s linear infinite\u0027,"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"        \u0027spin-reverse-slow\u0027: \u0027spin-reverse 4s linear infinite\u0027,"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"        \u0027spin-reverse-slower\u0027: \u0027spin-reverse 6s linear infinite\u0027,"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"      },"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"      borderRadius: {"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"        \u00274xl\u0027: \u00272rem\u0027,"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"        \u00275xl\u0027: \u00272.5rem\u0027,"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"      },"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"      colors: ({ colors }) \u003d\u003e ({"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"        gray: colors.neutral,"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"      }),"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"      fontFamily: {"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"        sans: [\u0027Inter\u0027, ...defaultTheme.fontFamily.sans],"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"      },"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"      height: {"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"        \u002785v\u0027: \u002785vh\u0027,"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"      keyframes: {"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"        \u0027fade-in\u0027: {"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"          from: {"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"            opacity: 0,"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"          },"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"          to: {"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"            opacity: 1,"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"          },"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"        },"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"        marquee: {"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"          \u0027100%\u0027: {"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"            transform: \u0027translateY(-50%)\u0027,"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"          },"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"        },"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"        \u0027spin-reverse\u0027: {"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"          to: {"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"            transform: \u0027rotate(-360deg)\u0027,"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"          },"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"        },"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"      },"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"      maxWidth: {"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"        \u00272xl\u0027: \u002740rem\u0027,"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"      },"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"  },"},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"  plugins: [require(\u0027@tailwindcss/forms\u0027)],"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":69,"uyencfi":3}},{"path":"history-service/.dockerignore","fileType":"dockerignore","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"node_modules"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"npm-debug.log"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":".env"}],"authorContributionMap":{"uyencfi":4}},{"path":"history-service/.env.example","fileType":"example","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"ENV\u003dDEV"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"DB_URI_PROD\u003d"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"DB_URI_DEV\u003d"}],"authorContributionMap":{"uyencfi":3}},{"path":"history-service/.eslintignore","fileType":"eslintignore","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"node_modules/*"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"package-lock.json"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"build"}],"authorContributionMap":{"uyencfi":3}},{"path":"history-service/.gitignore","fileType":"gitignore","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"# See https://help.github.com/articles/ignoring-files/ for more about ignoring files."},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"# dependencies"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"/node_modules"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"/.pnp"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":".pnp.js"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"# testing"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"/coverage"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"# misc"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":".DS_Store"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"*.pem"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"# debug"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"npm-debug.log*"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"yarn-debug.log*"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"yarn-error.log*"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"# local env files"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":".env.local"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":".env.development.local"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":".env.test.local"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":".env.production.local"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":".env"}],"authorContributionMap":{"uyencfi":25}},{"path":"history-service/Dockerfile","fileType":"Dockerfile","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"FROM node:14.17.0"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"# Create the working directory"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"WORKDIR /app"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"# Install dependencies"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"COPY package*.json ./"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"RUN npm ci --quiet"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"# Copy source files"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"COPY . ."},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"EXPOSE 8080"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"# Run the app"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"CMD [\"npm\", \"start\"]"}],"authorContributionMap":{"tlylt":1,"uyencfi":15}},{"path":"history-service/README.md","fileType":"md","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"# History service"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"For recording a user\u0027s matching history and the questions completed in each match."},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"## Usage and Local development"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"1. Install Node 14 and above"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"2. Rename file `.env.example` to `.env`. The default environment is `DEV`, but you can also change to `PROD`. Provide the mongoDB URI for the variable `DB_URI_DEV` or `DB_URI_PROD` accordingly."},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"    * For example, `DB_URI_DEV\u003dmongodb://localhost:27017/peerprep` and make sure mongoDB is running on localhost port 27017"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    * Or, `DB_URI_PROD\u003d\u003cmongoDB Atlas cluster URI\u003e`"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"3. Install dependencies with `npm install`."},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"4. Run with `npm run dev`."},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"## Run with Docker"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"- Via docker-compose: `docker-compose up --build`"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"- Via docker"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"Provide your mongoDB URI in the docker run command. This **must** be a cloud URI (e.g. Atlas cluster). Recommended to encase the URL within quotes like `\u0027your_URI\u0027` to avoid any parsing error in the shell."},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"```bash"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"docker build -t history-service ."},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"docker run -d -p 8080:8080 -e DB_URI_DEV\u003dyour_URI history-service"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"```"}],"authorContributionMap":{"uyencfi":20}},{"path":"history-service/constants/const.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"const questionServiceFallback \u003d"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"  process.env.ENV \u003d\u003d\u003d \u0027production\u0027 // production means using Docker"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"    ? `http://${process.env.QUESTION_SERVICE_HOST}:8500`"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"    : \u0027http://localhost:8500\u0027"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"const URI_QUESTION_SERVICE \u003d"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  process.env.URI_QUESTION_SERVICE || questionServiceFallback"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"const PREFIX_QUESTION_SERVICE \u003d \u0027/api/v1/question\u0027"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"export const URL_QUESTION_SERVICE_QUESTION_NAMES \u003d"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"  URI_QUESTION_SERVICE + PREFIX_QUESTION_SERVICE + \u0027/questionNames\u0027"}],"authorContributionMap":{"uyencfi":12}},{"path":"history-service/docker-compose.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"version: \"3.9\""},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"services:"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"  web:"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"    build: "},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"      context: ."},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"      dockerfile: Dockerfile"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    ports:"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"      - \"8080:8080\""},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"    links:"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"      - mongo"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"    env_file:"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"      - .env"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"  mongo:"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    image: mongo"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"    ports:"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"      - \"27017:27017\""}],"authorContributionMap":{"uyencfi":17}},{"path":"history-service/handler/handler.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import HistoryService from \u0027../service/service.js\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"export async function getHistory(req, res) {"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"  try {"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"    const { uid } \u003d req.params"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"    if (!uid) {"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"      return res.status(400).json({ message: \u0027user ID is missing\u0027 })"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"    const resp \u003d await HistoryService.getUserHistory(uid)"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"    if (resp.err) {"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"      const msg \u003d `Could not get history for user ${uid}`"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"      console.log(`${msg}: ${resp.err}`)"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"      return res.status(400).json({ message: msg })"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    return res.status(200).json({"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"      message: \u0027Get history successfully\u0027,"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"      data: resp,"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"    })"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"  } catch (err) {"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    console.log(err)"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"    return res.status(500).json({ message: err.message })"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"export async function createHistory(req, res) {"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"  try {"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"    const { roomId, u1, u2 } \u003d req.body"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"    if (!roomId) {"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"      return res.status(400).json({ message: \u0027roomId is missing\u0027 })"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"    const resp \u003d await HistoryService.createRoomHistory(roomId, u1, u2)"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    if (resp?.err) {"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"      const msg \u003d `Could not create room history for roomId ${roomId}`"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"      console.log(`${msg}: ${resp.err}`)"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"      return res.status(400).json({ message: msg })"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"    return res.status(201).json({ message: \u0027Created room history\u0027 })"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"  } catch (err) {"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"    console.log(err)"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"    return res.status(500).json({ message: err.message })"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"export async function updateHistory(req, res) {"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"  try {"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"    const { roomId } \u003d req.params"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"    const { questionId, answer } \u003d req.body"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"    if (!roomId) {"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"      return res.status(400).json({ message: \u0027roomId is missing\u0027 })"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    if (!questionId) {"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"      return res.status(400).json({ message: \u0027questionId is missing\u0027 })"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"    const resp \u003d await HistoryService.updateRoomHistory(roomId, questionId, answer)"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"    if (resp?.err) {"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"      const msg \u003d `Could not update history for room ${roomId}`"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"      console.log(`${msg}: ${resp.err}`)"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"      return res.status(400).json({ message: msg })"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"    return res.status(200).json({ message: \u0027Update history successfully\u0027 })"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"  } catch (err) {"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"    console.log(err)"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"    return res.status(500).json({ message: err.message })"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"}"}],"authorContributionMap":{"uyencfi":65}},{"path":"history-service/index.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import express from \u0027express\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import cors from \u0027cors\u0027"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import { getHistory, createHistory, updateHistory } from \u0027./handler/handler.js\u0027"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"import \u0027dotenv/config\u0027"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"const app \u003d express()"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"app.use(express.urlencoded({ extended: true }))"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"app.use(express.json())"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"app.options(\u0027*\u0027, cors())"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"app.use(cors())"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"const router \u003d express.Router()"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"router.get(\u0027/user/:uid\u0027, getHistory)"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"router.post(\u0027/room/\u0027, createHistory)"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"router.put(\u0027/room/:roomId\u0027, updateHistory)"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"const URL_PREFIX \u003d \u0027/api/v1/history\u0027"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"app.use(URL_PREFIX, router).all((_, res) \u003d\u003e {"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"  res.setHeader(\u0027content-type\u0027, \u0027application/json\u0027)"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"  res.setHeader(\u0027Access-Control-Allow-Origin\u0027, \u0027*\u0027)"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"})"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"// Test server alive"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"app.get(\u0027/\u0027, (_, res) \u003d\u003e {"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"  res.send(\u0027Hello World from history-service\u0027)"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"})"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"app.listen(8080, () \u003d\u003e console.log(\u0027history-service listening on port 8080\u0027))"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"export { app }"}],"authorContributionMap":{"tlylt":2,"uyencfi":28}},{"path":"history-service/model/history.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import mongoose from \u0027mongoose\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"var Schema \u003d mongoose.Schema"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"const CompletedQuestionSchema \u003d new Schema({"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  id: {"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"    type: String,"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    immutable: true,"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  },"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"  answer: {"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    type: String,"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"    immutable: true,"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"  },"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"  completedAt: {"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    type: Date,"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"    immutable: true,"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"    default: () \u003d\u003e Date.now(),"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"  },"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"})"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"const HistoryModelSchema \u003d new Schema("},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"  {"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    roomId: {"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"      type: String,"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"      unique: true,"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"      immutable: true,"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"    },"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"    u1: {"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"      type: String,"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"      immutable: true,"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"    },"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    u2: {"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"      type: String,"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"      immutable: true,"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"    },"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"    // Array of nested sub-documents "},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"    completed: [CompletedQuestionSchema],"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"  },"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"  // Schema options to enable createdAt and updatedAt timestamps"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"  {"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"    timestamps: true,"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"  }"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":")"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"export default mongoose.model(\u0027History\u0027, HistoryModelSchema)"}],"authorContributionMap":{"uyencfi":45}},{"path":"history-service/repository/repository.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import mongoose from \u0027mongoose\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import HistoryModel from \u0027../model/history.js\u0027"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import { MongoServerError } from \u0027mongodb\u0027"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"import \u0027dotenv/config\u0027"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"const uri \u003d"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  process.env.ENV \u003d\u003d \u0027PROD\u0027"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    ? process.env.DB_URI_PROD"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"    : process.env.DB_URI_DEV"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"mongoose.connect(uri, { useNewUrlParser: true, useUnifiedTopology: true })"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"const db \u003d mongoose.connection"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"db.on(\u0027error\u0027, () \u003d\u003e console.error(\u0027MongoDB connection error\u0027))"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"db.on(\u0027connected\u0027, () \u003d\u003e console.info(\u0027Connected to MongoDB\u0027))"},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"const HistoryRepository \u003d {"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"  /** Returns an array of rooms the user has been in. */"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"  getByUid: function (uid) {"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"    return HistoryModel.find({ $or: [{ u1: uid }, { u2: uid }] })"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"  },"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"  /** Creates a new room for History service. Returns an error if roomId already exists. */"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"  create: async function (roomId, u1, u2) {"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"    try {"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"      await HistoryModel.create({ roomId, u1, u2 })"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    } catch (err) {"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"      // Check for duplicate roomId"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"      if (err instanceof MongoServerError \u0026\u0026 err.code \u003d\u003d\u003d 11000) {"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"        return { err: \u0027roomId already exists\u0027 }"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"  },"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"  /** Adds a completed question and its answer to the room history. Returns an error if roomId does not exist. */"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"  add: async function (roomId, questionId, answer) {"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"    const doc \u003d await HistoryModel.findOneAndUpdate("},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"      { roomId: roomId },"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"      {"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"        $push: {"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"          \u0027completed\u0027: { id: questionId, answer: answer },"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"      },"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"      { new: true }"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"    )"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"    if (!doc) {"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"      return { err: \u0027roomId does not exist\u0027 }"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"    console.log(doc)"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"  },"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"export default HistoryRepository"}],"authorContributionMap":{"uyencfi":50}},{"path":"history-service/requests.rest","fileType":"rest","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"### TEST SERVER ALIVE"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"GET http://localhost:8080/"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":"### CREATE ROOM HISTORY"},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"### expect: Success if roomId is not missing"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"POST http://localhost:8080/api/v1/history/room"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"Content-Type: application/json"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"{"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"    \"roomId\": \"room1\","},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    \"u1\": \"qwe\","},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"    \"u2\": \"asd\""},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"### CREATE ANOTHER ROOM"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"POST http://localhost:8080/api/v1/history/room"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"Content-Type: application/json"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"{"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    \"roomId\": \"room2\","},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"    \"u1\": \"qwe\","},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"    \"u2\": \"zxc\""},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"### GET HISTORY OF USER qwe"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"### expect: array of qwe\u0027s rooms"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"GET http://localhost:8080/api/v1/history/user/qwe"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"### GET HISTORY OF USER asd"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"GET http://localhost:8080/api/v1/history/user/asd"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"### GET HISTORY OF USER zxc"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"GET http://localhost:8080/api/v1/history/user/zxc"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"### UPDATE ROOM HISTORY room1 (ADD COMPLETED QUESTIONS)"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":"PUT http://localhost:8080/api/v1/history/room/room1"},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"Content-Type: application/json"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"{"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"    \"questionId\": \"two sum\","},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"    \"answer\": \"test\""},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"### UPDATE ROOM HISTORY room2"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"PUT http://localhost:8080/api/v1/history/room/room2"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"Content-Type: application/json"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"{"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"    \"questionId\": \"Shortest path\","},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    \"answer\": \"from queue import PriorityQueue\\n\\nclass Graph:\\n    def __init__(self, num_of_vertices):\\n        self.v \u003d num_of_vertices\\n        self.edges \u003d [[-1 for i in range(num_of_vertices)] for j in range(num_of_vertices)]\\n        self.visited \u003d []\\n\\n    def add_edge(self, u, v, weight):\\n        self.edges[u][v] \u003d weight\\n        self.edges[v][u] \u003d weight\\n\\n# Dijkstra\u0027s algorithm for SSSP\\ndef dijkstra(graph, start_vertex):\\n    D \u003d {v:float(\u0027inf\u0027) for v in range(graph.v)}\\n    D[start_vertex] \u003d 0\\n\\n    pq \u003d PriorityQueue()\\n    pq.put((0, start_vertex))\\n\\n    while not pq.empty():\\n        (dist, current_vertex) \u003d pq.get()\\n        graph.visited.append(current_vertex)\\n\\n        for neighbor in range(graph.v):\\n            if graph.edges[current_vertex][neighbor] !\u003d -1:\\n                distance \u003d graph.edges[current_vertex][neighbor]\\n                if neighbor not in graph.visited:\\n                    old_cost \u003d D[neighbor]\\n                    new_cost \u003d D[current_vertex] + distance\\n                    if new_cost \u003c old_cost:\\n                        pq.put((new_cost, neighbor))\\n                        D[neighbor] \u003d new_cost\\n    return D\\n\""},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"### UPDATE ROOM HISTORY room3"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"### expect: 400 roomId not exist (room3 has not been created)"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"PUT http://localhost:8080/api/v1/history/room/room3"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"Content-Type: application/json"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"{"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"    \"questionId\": \"palindrome\","},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"    \"answer\": \"nil\""},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":""}],"authorContributionMap":{"uyencfi":63}},{"path":"history-service/service/service.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"uyencfi"},"content":"import HistoryRepository from \u0027../repository/repository.js\u0027"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"import { URL_QUESTION_SERVICE_QUESTION_NAMES } from \u0027../constants/const.js\u0027"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"import axios from \u0027axios\u0027"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":5,"author":{"gitId":"uyencfi"},"content":"const HistoryService \u003d {"},{"lineNumber":6,"author":{"gitId":"uyencfi"},"content":"  /** Returns an array of questions the user has completed, including questions from any current room. */"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"  getUserHistory: async function (uid) {"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"    const resp \u003d await HistoryRepository.getByUid(uid).lean() // an array of rooms"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"    if (resp.length \u003d\u003d\u003d 0) {"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"      return []"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"    const questions \u003d flattenHist(uid, resp)"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"    const params \u003d getIdParams(questions)"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":15,"author":{"gitId":"uyencfi"},"content":"    const res \u003d await axios"},{"lineNumber":16,"author":{"gitId":"uyencfi"},"content":"      .get(URL_QUESTION_SERVICE_QUESTION_NAMES, { params: params })"},{"lineNumber":17,"author":{"gitId":"uyencfi"},"content":"      .catch(console.log)"},{"lineNumber":18,"author":{"gitId":"uyencfi"},"content":"    // insert question name into the response"},{"lineNumber":19,"author":{"gitId":"uyencfi"},"content":"    questions.forEach((q) \u003d\u003e q.name \u003d res.data.data[q.id])"},{"lineNumber":20,"author":{"gitId":"uyencfi"},"content":"    questions.sort((x, y) \u003d\u003e new Date(y.completedAt) - new Date(x.completedAt))"},{"lineNumber":21,"author":{"gitId":"uyencfi"},"content":"    return questions"},{"lineNumber":22,"author":{"gitId":"uyencfi"},"content":"  },"},{"lineNumber":23,"author":{"gitId":"uyencfi"},"content":"  /** Creates a new room for History purposes. To be called when the room is created by Matching service. */"},{"lineNumber":24,"author":{"gitId":"uyencfi"},"content":"  createRoomHistory: async function (roomId, u1, u2) {"},{"lineNumber":25,"author":{"gitId":"uyencfi"},"content":"    return HistoryRepository.create(roomId, u1, u2)"},{"lineNumber":26,"author":{"gitId":"uyencfi"},"content":"  },"},{"lineNumber":27,"author":{"gitId":"uyencfi"},"content":"  /** Adds a completed question to this room. Also records the final answer when the question was completed. */"},{"lineNumber":28,"author":{"gitId":"uyencfi"},"content":"  updateRoomHistory: async function (roomId, questionId, answer) {"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"    if (!answer) {"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"      answer \u003d \u0027\u0027"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    return HistoryRepository.add(roomId, questionId, answer)"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"  },"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"/**"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":" * Data is a list of room documents; within each room is a list of question documents."},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":" * We flatten it into a list of question objects, where each question consists of a partner,"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":" * question details, and a key property for React child."},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":" */"},{"lineNumber":41,"author":{"gitId":"uyencfi"},"content":"function flattenHist(uid, data) {"},{"lineNumber":42,"author":{"gitId":"uyencfi"},"content":"  return data.flatMap((room) \u003d\u003e {"},{"lineNumber":43,"author":{"gitId":"uyencfi"},"content":"    const partner \u003d room.u1 \u003d\u003d\u003d uid ? room.u2 : room.u1"},{"lineNumber":44,"author":{"gitId":"uyencfi"},"content":"    function transformer(question) {"},{"lineNumber":45,"author":{"gitId":"uyencfi"},"content":"      return {"},{"lineNumber":46,"author":{"gitId":"uyencfi"},"content":"        partner,"},{"lineNumber":47,"author":{"gitId":"uyencfi"},"content":"        roomId: room.roomId,"},{"lineNumber":48,"author":{"gitId":"uyencfi"},"content":"        ...question,"},{"lineNumber":49,"author":{"gitId":"uyencfi"},"content":"      }"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"    }"},{"lineNumber":51,"author":{"gitId":"uyencfi"},"content":"    return room.completed.map(transformer)"},{"lineNumber":52,"author":{"gitId":"uyencfi"},"content":"  })"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"/** Constructs a query param string consisting of the question IDs. */"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"function getIdParams(questions) {"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"  const ids \u003d new Set(questions.map((q) \u003d\u003e {"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"    return q.id"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"  }))"},{"lineNumber":60,"author":{"gitId":"uyencfi"},"content":"  const params \u003d new URLSearchParams()"},{"lineNumber":61,"author":{"gitId":"uyencfi"},"content":"  ids.forEach((id) \u003d\u003e params.append(\u0027id\u0027, id))"},{"lineNumber":62,"author":{"gitId":"uyencfi"},"content":"  return params"},{"lineNumber":63,"author":{"gitId":"uyencfi"},"content":"}"},{"lineNumber":64,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":65,"author":{"gitId":"uyencfi"},"content":"export default HistoryService"}],"authorContributionMap":{"uyencfi":65}},{"path":"k8s/.gitignore","fileType":"gitignore","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":".env"}],"authorContributionMap":{"tlylt":1}},{"path":"k8s/README.md","fileType":"md","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"# Deployment Guide"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"## Docker"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"Container images are deployed under the b9jmthkk account on Docker Hub. E.g https://hub.docker.com/repository/docker/b9jmthkk/question"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"## Production"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"- Go to Google Cloud console and create a new project"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"- Enable billing"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"- Create new cluster"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"  - choose zone near the region"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"- Run the required commands in `init.sh` from the Google Cloud Shell"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"- Push to branch `production`"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"## Local Deployment in KIND"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"- Ensure KIND is installed"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"- Run the required commands in `init.sh` from the root of the repository"}],"authorContributionMap":{"tlylt":19}},{"path":"k8s/full-flow.sh","fileType":"sh","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"## Note: this is for local testing and debugging only, refer to init.sh instead"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"## Frontend"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/frontend-deployment.yaml"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/frontend-cluster-ip-service.yaml"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"## User Service"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/mongo-deployment.yaml"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/mongo-cluster-ip-service.yaml"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/redis-deployment.yaml"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/redis-cluster-ip-service.yaml"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"## Secrets"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic access-token-secret --from-literal ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic refresh-token-secret --from-literal REFRESH_TOKEN_SECRET\u003dd094b5d45a93e9b1f9bc6dee9aff27e26bf7a875333db0df955415e87151c16a49a72b6ee85ce483e6a243a0fbf8b93989dc150cacdd970c29053a650d4fb908"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic postgres-password --from-literal POSTGRES_PASSWORD\u003dpostgres"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"## User"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/user-deployment.yaml"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/user-cluster-ip-service.yaml"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"## Question"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/postgres-deployment.yaml"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/postgres-cluster-ip-service.yaml"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/postgres-persistent-volume-claim.yaml"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/question-deployment.yaml"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/question-cluster-ip-service.yaml"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"## Room"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/room-deployment.yaml"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/room-cluster-ip-service.yaml"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"## Matching"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/matching-deployment.yaml"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/matching-cluster-ip-service.yaml"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"## Ingress"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/main/deploy/static/provider/kind/deploy.yaml"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/ingress-service.yaml"}],"authorContributionMap":{"tlylt":41}},{"path":"k8s/init.sh","fileType":"sh","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"# Initialization for PRODUCTION environment"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"## setup the google cloud via the cloud terminal"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"gcloud config set project cs3219-365909"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"gcloud config set compute/zone asia-southeast1-a"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"gcloud container clusters get-credentials cs3219-cluster"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"## Create secrets (actual secrets will not be the following)"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic access-token-secret --from-literal ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic refresh-token-secret --from-literal REFRESH_TOKEN_SECRET\u003dd094b5d45a93e9b1f9bc6dee9aff27e26bf7a875333db0df955415e87151c16a49a72b6ee85ce483e6a243a0fbf8b93989dc150cacdd970c29053a650d4fb908"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic postgres-password --from-literal POSTGRES_PASSWORD\u003dpostgres"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"## Install Helm https://helm.sh/docs/intro/install/#from-script"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"chmod 700 get_helm.sh"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"./get_helm.sh"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"## Install ingress-nginx"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"helm install my-release ingress-nginx/ingress-nginx"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"## Install https cert manager"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"helm repo add jetstack https://charts.jetstack.io"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"helm repo update"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"helm install \\"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"  cert-manager jetstack/cert-manager \\"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"  --namespace cert-manager \\"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"  --create-namespace \\"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"  --version v1.8.0 \\"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"  --set installCRDs\u003dtrue"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"## get certificates"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"kubectl get certificates"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"kubectl describe certificates"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"################################################################################################################"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"################################################################################################################"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"# Initialization for LOCAL environment"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"kind create cluster --name kind-1 --config k8s/kind/cluster-config.yaml"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"## Create secrets (actual secrets will not be the following)"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic access-token-secret --from-literal ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic refresh-token-secret --from-literal REFRESH_TOKEN_SECRET\u003dd094b5d45a93e9b1f9bc6dee9aff27e26bf7a875333db0df955415e87151c16a49a72b6ee85ce483e6a243a0fbf8b93989dc150cacdd970c29053a650d4fb908"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic postgres-password --from-literal POSTGRES_PASSWORD\u003dpostgres"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"## Install ingress-nginx"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/main/deploy/static/provider/kind/deploy.yaml"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"## Update all the docker images"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"docker build -t b9jmthkk/frontend:latest -f ./frontend/Dockerfile.production ./frontend"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"docker build -t b9jmthkk/user:latest -f ./user-service/Dockerfile ./user-service"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"docker build -t b9jmthkk/question:latest -f ./question-service/Dockerfile ./question-service"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"docker build -t b9jmthkk/matching:latest -f ./matching-service/Dockerfile ./matching-service"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"docker build -t b9jmthkk/room:latest -f ./room-service/Dockerfile ./room-service"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"## Login"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"docker login -u xxxxx -p xxxxxxxxxx"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"## Push all images"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"docker push b9jmthkk/frontend:latest"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"docker push b9jmthkk/user:latest"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"docker push b9jmthkk/question:latest"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"docker push b9jmthkk/matching:latest"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"docker push b9jmthkk/room:latest"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"## Apply all manifests"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"# (Note that may need to wait a few minutes for the above ingress-nginx to be ready)"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"# use the following to check status"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"kubectl -n ingress-nginx get deploy"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"# finally apply all"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests"},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"# check status (Took about 4 mintues for me)"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"kubectl get all"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"# visit http://localhost !!!!"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"## Clean up"},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"# delete deployments"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"kubectl delete -f k8s/manifests"},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"# delete ingress-nginx"},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"kubectl delete -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/main/deploy/static/provider/kind/deploy.yaml"},{"lineNumber":80,"author":{"gitId":"tlylt"},"content":"# delete kind cluster"},{"lineNumber":81,"author":{"gitId":"tlylt"},"content":"kind delete cluster --name kind-1"}],"authorContributionMap":{"tlylt":81}},{"path":"k8s/kind/cluster-config.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"kind: Cluster"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"apiVersion: kind.x-k8s.io/v1alpha4"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"name: kind-cluster-1"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"nodes:"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  - role: control-plane"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  - role: worker"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    kubeadmConfigPatches:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"      - |"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"        kind: JoinConfiguration"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        nodeRegistration:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"          kubeletExtraArgs:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"            node-labels: \"ingress-ready\u003dtrue,topology.kubernetes.io/zone\u003da\""},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    extraPortMappings:"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"      - containerPort: 80"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"        hostPort: 80"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        protocol: TCP"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"  # - role: worker"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"  #   kubeadmConfigPatches:"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"  #     - |"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"  #       kind: JoinConfiguration"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"  #       nodeRegistration:"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"  #         kubeletExtraArgs:"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"  #           node-labels: \"topology.kubernetes.io/zone\u003da\""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"  # - role: worker"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"  #   kubeadmConfigPatches:"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"  #     - |"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"  #       kind: JoinConfiguration"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"  #       nodeRegistration:"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"  #         kubeletExtraArgs:"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"  #           node-labels: \"topology.kubernetes.io/zone\u003db\""}],"authorContributionMap":{"tlylt":30}},{"path":"k8s/manifests/certificate.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: cert-manager.io/v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Certificate"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: leetwithfriend-com-tls"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  secretName: leetwithfriend-com"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  issuerRef:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    name: letsencrypt-prod"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    kind: ClusterIssuer"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  commonName: leetwithfriend.com"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"  dnsNames:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"    - leetwithfriend.com"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    - www.leetwithfriend.com"}],"authorContributionMap":{"tlylt":13}},{"path":"k8s/manifests/frontend-cluster-ip-service.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Service"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: frontend-cluster-ip-service"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  type: ClusterIP"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    app: frontend"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  ports:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    - name: http"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"      port: 3000"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      targetPort: 3000"}],"authorContributionMap":{"tlylt":12}},{"path":"k8s/manifests/frontend-deployment.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: apps/v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Deployment"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: frontend-deployment"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  replicas: 1"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    matchLabels:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      app: frontend"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  template:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    metadata:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      labels:"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        app: frontend"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    spec:"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      containers:"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        - name: frontend"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"          image: b9jmthkk/frontend"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"          ports:"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"            - name: http"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"              containerPort: 3000"}],"authorContributionMap":{"tlylt":20}},{"path":"k8s/manifests/history-cluster-ip-service.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Service"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: history-cluster-ip-service"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  type: ClusterIP"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    app: history"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  ports:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    - name: http"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"      port: 8080"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      targetPort: 8080"}],"authorContributionMap":{"tlylt":12}},{"path":"k8s/manifests/history-deployment.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: apps/v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Deployment"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: history-deployment"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  replicas: 1"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    matchLabels:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      app: history"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  template:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    metadata:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      labels:"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        app: history"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    spec:"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      containers:"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        - name: history"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"          image: b9jmthkk/history"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"          ports:"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"            - name: http"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"              containerPort: 8080"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"          env:"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"            - name: REDIS_HOST"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"              value: redis-cluster-ip-service"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"            - name: DB_LOCAL_URI"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"              value: mongodb://mongo-cluster-ip-service:27017/peerprep"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"            - name: ENV"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"              value: PRODUCTION"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"            - name: PORT"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"              value: \u002780\u0027"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"            - name: URI_QUESTION_SERVICE"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"              value: http://question-cluster-ip-service:8500"}],"authorContributionMap":{"tlylt":31}},{"path":"k8s/manifests/ingress-service.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: networking.k8s.io/v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Ingress"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: ingress-service"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"  annotations:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    kubernetes.io/ingress.class: nginx"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    nginx.ingress.kubernetes.io/use-regex: \u0027true\u0027"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    # nginx.ingress.kubernetes.io/rewrite-target: /$1"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    cert-manager.io/cluster-issuer: \u0027letsencrypt-prod\u0027"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    nginx.ingress.kubernetes.io/ssl-redirect: \u0027true\u0027"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"  tls: # https"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    - hosts:"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"        - leetwithfriend.com"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"        - www.leetwithfriend.com"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"      secretName: leetwithfriend-com"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"  rules:"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"    - host: \u0027leetwithfriend.com\u0027 # https"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"      http:"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"        paths:"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"          - path: /?(.*)"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"                name: frontend-cluster-ip-service"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"                  number: 3000"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"          - path: /api/v1/user?(.*)"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"                name: user-cluster-ip-service"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"                  number: 8000"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"          - path: /api/v1/matching?(.*)"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"                name: matching-cluster-ip-service"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"                  number: 8001"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"          - path: /api/v1/question?(.*)"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"                name: question-cluster-ip-service"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"                  number: 8500"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"          - path: /socket.io/room?(.*)"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"                name: room-cluster-ip-service"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"                  number: 8022"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"          - path: /socket.io/matching?(.*)"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"                name: matching-cluster-ip-service"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"                  number: 8001"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"          - path: /api/v1/room?(.*)"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"                name: room-cluster-ip-service"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"                  number: 8022"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"    - host: \u0027www.leetwithfriend.com\u0027 # https"},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"      http:"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"        paths:"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"          - path: /?(.*)"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"                name: frontend-cluster-ip-service"},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"                  number: 3000"},{"lineNumber":80,"author":{"gitId":"tlylt"},"content":"          - path: /api/v1/user?(.*)"},{"lineNumber":81,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":82,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":83,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":84,"author":{"gitId":"tlylt"},"content":"                name: user-cluster-ip-service"},{"lineNumber":85,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":86,"author":{"gitId":"tlylt"},"content":"                  number: 8000"},{"lineNumber":87,"author":{"gitId":"tlylt"},"content":"          - path: /api/v1/matching?(.*)"},{"lineNumber":88,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":89,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":90,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":91,"author":{"gitId":"tlylt"},"content":"                name: matching-cluster-ip-service"},{"lineNumber":92,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":93,"author":{"gitId":"tlylt"},"content":"                  number: 8001"},{"lineNumber":94,"author":{"gitId":"tlylt"},"content":"          - path: /api/v1/question?(.*)"},{"lineNumber":95,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":96,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":97,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":98,"author":{"gitId":"tlylt"},"content":"                name: question-cluster-ip-service"},{"lineNumber":99,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":100,"author":{"gitId":"tlylt"},"content":"                  number: 8500"},{"lineNumber":101,"author":{"gitId":"tlylt"},"content":"          - path: /socket.io/room?(.*)"},{"lineNumber":102,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":103,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":104,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":105,"author":{"gitId":"tlylt"},"content":"                name: room-cluster-ip-service"},{"lineNumber":106,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":107,"author":{"gitId":"tlylt"},"content":"                  number: 8022"},{"lineNumber":108,"author":{"gitId":"tlylt"},"content":"          - path: /socket.io/matching?(.*)"},{"lineNumber":109,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":110,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":111,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":112,"author":{"gitId":"tlylt"},"content":"                name: matching-cluster-ip-service"},{"lineNumber":113,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":114,"author":{"gitId":"tlylt"},"content":"                  number: 8001"},{"lineNumber":115,"author":{"gitId":"tlylt"},"content":"          - path: /api/v1/room?(.*)"},{"lineNumber":116,"author":{"gitId":"tlylt"},"content":"            pathType: Prefix"},{"lineNumber":117,"author":{"gitId":"tlylt"},"content":"            backend:"},{"lineNumber":118,"author":{"gitId":"tlylt"},"content":"              service:"},{"lineNumber":119,"author":{"gitId":"tlylt"},"content":"                name: room-cluster-ip-service"},{"lineNumber":120,"author":{"gitId":"tlylt"},"content":"                port:"},{"lineNumber":121,"author":{"gitId":"tlylt"},"content":"                  number: 8022"},{"lineNumber":122,"author":{"gitId":"tlylt"},"content":"    # - http:"},{"lineNumber":123,"author":{"gitId":"tlylt"},"content":"    #     paths:"},{"lineNumber":124,"author":{"gitId":"tlylt"},"content":"    #       - path: /?(.*)"},{"lineNumber":125,"author":{"gitId":"tlylt"},"content":"    #         pathType: Prefix"},{"lineNumber":126,"author":{"gitId":"tlylt"},"content":"    #         backend:"},{"lineNumber":127,"author":{"gitId":"tlylt"},"content":"    #           service:"},{"lineNumber":128,"author":{"gitId":"tlylt"},"content":"    #             name: frontend-cluster-ip-service"},{"lineNumber":129,"author":{"gitId":"tlylt"},"content":"    #             port:"},{"lineNumber":130,"author":{"gitId":"tlylt"},"content":"    #               number: 3000"},{"lineNumber":131,"author":{"gitId":"tlylt"},"content":"    #       - path: /api/v1/user?(.*)"},{"lineNumber":132,"author":{"gitId":"tlylt"},"content":"    #         pathType: Prefix"},{"lineNumber":133,"author":{"gitId":"tlylt"},"content":"    #         backend:"},{"lineNumber":134,"author":{"gitId":"tlylt"},"content":"    #           service:"},{"lineNumber":135,"author":{"gitId":"tlylt"},"content":"    #             name: user-cluster-ip-service"},{"lineNumber":136,"author":{"gitId":"tlylt"},"content":"    #             port:"},{"lineNumber":137,"author":{"gitId":"tlylt"},"content":"    #               number: 8000"},{"lineNumber":138,"author":{"gitId":"tlylt"},"content":"    #       - path: /api/v1/matching?(.*)"},{"lineNumber":139,"author":{"gitId":"tlylt"},"content":"    #         pathType: Prefix"},{"lineNumber":140,"author":{"gitId":"tlylt"},"content":"    #         backend:"},{"lineNumber":141,"author":{"gitId":"tlylt"},"content":"    #           service:"},{"lineNumber":142,"author":{"gitId":"tlylt"},"content":"    #             name: matching-cluster-ip-service"},{"lineNumber":143,"author":{"gitId":"tlylt"},"content":"    #             port:"},{"lineNumber":144,"author":{"gitId":"tlylt"},"content":"    #               number: 8001"},{"lineNumber":145,"author":{"gitId":"tlylt"},"content":"    #       - path: /api/v1/room?(.*)"},{"lineNumber":146,"author":{"gitId":"tlylt"},"content":"    #         pathType: Prefix"},{"lineNumber":147,"author":{"gitId":"tlylt"},"content":"    #         backend:"},{"lineNumber":148,"author":{"gitId":"tlylt"},"content":"    #           service:"},{"lineNumber":149,"author":{"gitId":"tlylt"},"content":"    #             name: room-cluster-ip-service"},{"lineNumber":150,"author":{"gitId":"tlylt"},"content":"    #             port:"},{"lineNumber":151,"author":{"gitId":"tlylt"},"content":"    #               number: 8022"},{"lineNumber":152,"author":{"gitId":"tlylt"},"content":"    #       - path: /api/v1/question?(.*)"},{"lineNumber":153,"author":{"gitId":"tlylt"},"content":"    #         pathType: Prefix"},{"lineNumber":154,"author":{"gitId":"tlylt"},"content":"    #         backend:"},{"lineNumber":155,"author":{"gitId":"tlylt"},"content":"    #           service:"},{"lineNumber":156,"author":{"gitId":"tlylt"},"content":"    #             name: question-cluster-ip-service"},{"lineNumber":157,"author":{"gitId":"tlylt"},"content":"    #             port:"},{"lineNumber":158,"author":{"gitId":"tlylt"},"content":"    #               number: 8500"},{"lineNumber":159,"author":{"gitId":"tlylt"},"content":"    #       - path: /socket.io/room?(.*)"},{"lineNumber":160,"author":{"gitId":"tlylt"},"content":"    #         pathType: Prefix"},{"lineNumber":161,"author":{"gitId":"tlylt"},"content":"    #         backend:"},{"lineNumber":162,"author":{"gitId":"tlylt"},"content":"    #           service:"},{"lineNumber":163,"author":{"gitId":"tlylt"},"content":"    #             name: room-cluster-ip-service"},{"lineNumber":164,"author":{"gitId":"tlylt"},"content":"    #             port:"},{"lineNumber":165,"author":{"gitId":"tlylt"},"content":"    #               number: 8022"},{"lineNumber":166,"author":{"gitId":"tlylt"},"content":"    #       - path: /socket.io/matching?(.*)"},{"lineNumber":167,"author":{"gitId":"tlylt"},"content":"    #         pathType: Prefix"},{"lineNumber":168,"author":{"gitId":"tlylt"},"content":"    #         backend:"},{"lineNumber":169,"author":{"gitId":"tlylt"},"content":"    #           service:"},{"lineNumber":170,"author":{"gitId":"tlylt"},"content":"    #             name: matching-cluster-ip-service"},{"lineNumber":171,"author":{"gitId":"tlylt"},"content":"    #             port:"},{"lineNumber":172,"author":{"gitId":"tlylt"},"content":"    #               number: 8001"}],"authorContributionMap":{"tlylt":172}},{"path":"k8s/manifests/issuer.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: cert-manager.io/v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: ClusterIssuer"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: letsencrypt-prod"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  acme:"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    server: https://acme-v02.api.letsencrypt.org/directory"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    email: \u0027test@test.com\u0027"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    privateKeySecretRef:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"      name: letsencrypt-prod"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    solvers:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      - http01:"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"          ingress:"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"            class: nginx"}],"authorContributionMap":{"tlylt":14}},{"path":"k8s/manifests/matching-cluster-ip-service.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Service"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: matching-cluster-ip-service"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  type: ClusterIP"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    app: matching"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  ports:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    - name: http"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"      port: 8001"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      targetPort: 8001"}],"authorContributionMap":{"tlylt":12}},{"path":"k8s/manifests/matching-deployment.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: apps/v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Deployment"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: matching-deployment"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  replicas: 1"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    matchLabels:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      app: matching"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  template:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    metadata:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      labels:"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        app: matching"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    spec:"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      containers:"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        - name: matching"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"          image: b9jmthkk/matching"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"          ports:"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"            - name: http"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"              containerPort: 8001"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"          env:"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"            - name: PORT"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"              value: \u002780\u0027"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"            - name: URI_QUESTION_SERVICE"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"              value: http://question-cluster-ip-service:8500"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"            - name: URI_ROOM_SERVICE"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"              value: http://room-cluster-ip-service:8022"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"            - name: ACCESS_TOKEN_SECRET"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"              valueFrom:"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"                secretKeyRef:"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"                  name: access-token-secret"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"                  key: ACCESS_TOKEN_SECRET"}],"authorContributionMap":{"tlylt":32}},{"path":"k8s/manifests/mongo-cluster-ip-service.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Service"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: mongo-cluster-ip-service"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  type: ClusterIP"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    app: mongo"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  ports:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    - name: http"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"      port: 27017"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      targetPort: 27017"}],"authorContributionMap":{"tlylt":12}},{"path":"k8s/manifests/mongo-deployment.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: apps/v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Deployment"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: mongo-deployment"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  replicas: 1"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    matchLabels:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      app: mongo"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  template:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    metadata:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      labels:"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        app: mongo"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    spec:"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      volumes:"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        - name: mongo-storage"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"          persistentVolumeClaim:"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"            claimName: mongo-persistent-volume-claim"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"      containers:"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"        - name: mongo"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"          image: mongo"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"          ports:"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"            - name: http"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"              containerPort: 27017"}],"authorContributionMap":{"tlylt":24}},{"path":"k8s/manifests/mongo-persistent-volume-claim.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: PersistentVolumeClaim"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: mongo-persistent-volume-claim"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  accessModes:"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    - ReadWriteOnce"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  resources:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    requests:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"      storage: 1Gi"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"  storageClassName: standard"}],"authorContributionMap":{"tlylt":11}},{"path":"k8s/manifests/postgres-cluster-ip-service.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Service"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: postgres-cluster-ip-service"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  type: ClusterIP"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    app: postgres"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  ports:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    - name: http"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"      port: 5432"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      targetPort: 5432"}],"authorContributionMap":{"tlylt":12}},{"path":"k8s/manifests/postgres-deployment.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: apps/v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Deployment"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: postgres-deployment"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  replicas: 1"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    matchLabels:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      app: postgres"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  template:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    metadata:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      labels:"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        app: postgres"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    spec:"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      volumes:"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        - name: postgres-storage"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"          persistentVolumeClaim:"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"            claimName: postgres-persistent-volume-claim"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"      containers:"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"        - name: postgres"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"          image: postgres"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"          ports:"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"            - name: http"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"              containerPort: 5432"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"          env:"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"            - name: POSTGRES_DB"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"              value: postgres_db"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"            - name: POSTGRES_USER"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"              value: postgres"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"            - name: POSTGRES_HOST"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"              value: localhost"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"            - name: POSTGRES_PORT"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"              value: \u00275432\u0027"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"            - name: POSTGRES_PASSWORD"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"              valueFrom:"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"                secretKeyRef:"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"                  name: postgres-password"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"                  key: POSTGRES_PASSWORD"}],"authorContributionMap":{"tlylt":38}},{"path":"k8s/manifests/postgres-persistent-volume-claim.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: PersistentVolumeClaim"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: postgres-persistent-volume-claim"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  accessModes:"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    - ReadWriteOnce"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"  resources:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    requests:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"      storage: 1Gi"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"  storageClassName: standard"}],"authorContributionMap":{"tlylt":11}},{"path":"k8s/manifests/question-cluster-ip-service.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Service"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: question-cluster-ip-service"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  type: ClusterIP"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    app: question"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  ports:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    - name: http"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"      port: 8500"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      targetPort: 8500"}],"authorContributionMap":{"tlylt":12}},{"path":"k8s/manifests/question-deployment.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: apps/v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Deployment"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: question-deployment"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  replicas: 1"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    matchLabels:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      app: question"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  template:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    metadata:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      labels:"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        app: question"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    spec:"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      containers:"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        - name: question"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"          image: b9jmthkk/question"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"          ports:"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"            - name: http"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"              containerPort: 8500"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"          env:"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"            - name: PORT"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"              value: \u002780\u0027"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"            - name: ENV"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"              value: production"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"            - name: POSTGRES_USER"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"              value: postgres"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"            - name: POSTGRES_HOST"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"              value: postgres-cluster-ip-service"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"            - name: POSTGRES_PORT"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"              value: \u00275432\u0027"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"            - name: POSTGRES_PASSWORD"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"              valueFrom:"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"                secretKeyRef:"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"                  name: postgres-password"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"                  key: POSTGRES_PASSWORD"}],"authorContributionMap":{"tlylt":36}},{"path":"k8s/manifests/redis-cluster-ip-service.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Service"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: redis-cluster-ip-service"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  type: ClusterIP"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    app: redis"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  ports:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    - name: http"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"      port: 6379"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      targetPort: 6379"}],"authorContributionMap":{"tlylt":12}},{"path":"k8s/manifests/redis-deployment.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: apps/v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Deployment"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: redis-deployment"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  replicas: 1"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    matchLabels:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      app: redis"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  template:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    metadata:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      labels:"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        app: redis"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    spec:"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      containers:"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        - name: redis"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"          image: redis:alpine"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"          ports:"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"            - name: http"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"              containerPort: 6379"}],"authorContributionMap":{"tlylt":20}},{"path":"k8s/manifests/room-cluster-ip-service.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Service"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: room-cluster-ip-service"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  type: ClusterIP"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    app: room"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  ports:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    - name: http"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"      port: 8022"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      targetPort: 8022"}],"authorContributionMap":{"tlylt":12}},{"path":"k8s/manifests/room-deployment.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: apps/v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Deployment"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: room-deployment"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  replicas: 1"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    matchLabels:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      app: room"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  template:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    metadata:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      labels:"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        app: room"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    spec:"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      containers:"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        - name: room"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"          image: b9jmthkk/room"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"          ports:"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"            - name: http"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"              containerPort: 8022"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"          env:"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"            - name: PORT"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"              value: \u002780\u0027"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"            - name: URI_QUESTION_SERVICE"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"              value: http://question-cluster-ip-service:8500"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"            - name: ACCESS_TOKEN_SECRET"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"              valueFrom:"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"                secretKeyRef:"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"                  name: access-token-secret"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"                  key: ACCESS_TOKEN_SECRET"}],"authorContributionMap":{"tlylt":30}},{"path":"k8s/manifests/user-cluster-ip-service.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Service"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: user-cluster-ip-service"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  type: ClusterIP"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    app: user"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"  ports:"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    - name: http"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"      port: 8000"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      targetPort: 8000"}],"authorContributionMap":{"tlylt":12}},{"path":"k8s/manifests/user-deployment.yaml","fileType":"yaml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"apiVersion: apps/v1"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"kind: Deployment"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"metadata:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"  name: user-deployment"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"spec:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"  replicas: 1"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"  selector:"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    matchLabels:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"      app: user"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"  template:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    metadata:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"      labels:"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        app: user"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    spec:"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"      containers:"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        - name: user"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"          image: b9jmthkk/user"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"          ports:"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"            - name: http"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"              containerPort: 8000"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"          env:"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"            - name: REDIS_HOST"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"              value: redis-cluster-ip-service"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"            - name: DB_LOCAL_URI"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"              value: mongodb://mongo-cluster-ip-service:27017/peerprep"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"            - name: ENV"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"              value: PRODUCTION"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"            - name: PORT"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"              value: \u002780\u0027"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"            - name: ACCESS_TOKEN_SECRET"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"              valueFrom:"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"                secretKeyRef:"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"                  name: access-token-secret"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"                  key: ACCESS_TOKEN_SECRET"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"            - name: REFRESH_TOKEN_SECRET"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"              valueFrom:"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"                secretKeyRef:"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"                  name: refresh-token-secret"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"                  key: REFRESH_TOKEN_SECRET"}],"authorContributionMap":{"tlylt":39}},{"path":"k8s/setup.sh","fileType":"sh","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"## Note: this is for local testing and debugging only, refer to init.sh instead"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"# apply all the yaml files in the directory"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"kubectl apply manifests"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/frontend-deployment.yaml"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/frontend-cluster-ip-service.yaml"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"## Ingress"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/main/deploy/static/provider/kind/deploy.yaml"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/ingress-service.yaml"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"## User Service"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/mongo-deployment.yaml"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/mongo-cluster-ip-service.yaml"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/redis-deployment.yaml"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/redis-cluster-ip-service.yaml"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic access-token-secret --from-literal ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic refresh-token-secret --from-literal REFRESH_TOKEN_SECRET\u003dd094b5d45a93e9b1f9bc6dee9aff27e26bf7a875333db0df955415e87151c16a49a72b6ee85ce483e6a243a0fbf8b93989dc150cacdd970c29053a650d4fb908"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/user-deployment.yaml"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/user-cluster-ip-service.yaml"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"## Question"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic postgres-password --from-literal POSTGRES_PASSWORD\u003dpostgres"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/postgres-deployment.yaml"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/postgres-cluster-ip-service.yaml"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/question-deployment.yaml"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/question-cluster-ip-service.yaml"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"# create secrets required (actual secrets will be different from the following)"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic access-token-secret --from-literal ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic refresh-token-secret --from-literal REFRESH_TOKEN_SECRET\u003dd094b5d45a93e9b1f9bc6dee9aff27e26bf7a875333db0df955415e87151c16a49a72b6ee85ce483e6a243a0fbf8b93989dc150cacdd970c29053a650d4fb908"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"kubectl create secret generic postgres-password --from-literal POSTGRES_PASSWORD\u003dpostgres"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"## Room"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/room-deployment.yaml"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/room-cluster-ip-service.yaml"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"## Matching"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/matching-deployment.yaml"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"kubectl apply -f k8s/manifests/matching-cluster-ip-service.yaml"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"# https required setup"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"# populate question bank"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"# build and push docker images"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"docker build -f Dockerfile.production -t b9jmthkk/frontend ."},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"docker push b9jmthkk/frontend"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"docker build -f Dockerfile -t b9jmthkk/user ."},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"docker push b9jmthkk/user"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"docker build -f Dockerfile -t b9jmthkk/matching ."},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"docker push b9jmthkk/matching"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"docker build -f Dockerfile -t b9jmthkk/question ."},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"docker push b9jmthkk/question"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"docker build -f Dockerfile -t b9jmthkk/room ."},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"docker push b9jmthkk/room"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"# local testing"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"kind create cluster --name kind-1 --config k8s/kind/cluster-config.yaml"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"# clean up"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"kubectl delete -f k8s/manifests/question-deployment.yaml"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"kind delete cluster --name kind-1"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"# logs"},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"kubectl logs --selector\u003dapp\u003dquestion"}],"authorContributionMap":{"tlylt":76}},{"path":"matching-service/.dockerignore","fileType":"dockerignore","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"node_modules"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"npm-debug.log"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":".env"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"*.sqlite3"}],"authorContributionMap":{"MarcusTXK":5}},{"path":"matching-service/.env.example","fileType":"example","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"}],"authorContributionMap":{"MarcusTXK":1}},{"path":"matching-service/.env.local","fileType":"local","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"}],"authorContributionMap":{"MarcusTXK":1}},{"path":"matching-service/.gitignore","fileType":"gitignore","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"# See https://help.github.com/articles/ignoring-files/ for more about ignoring files."},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"# dependencies"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"/node_modules"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"/.pnp"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":".pnp.js"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"# testing"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"/coverage"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"# misc"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":".DS_Store"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"*.pem"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"# debug"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"npm-debug.log*"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"yarn-debug.log*"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"yarn-error.log*"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"# sqlite"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"*.sqlite3"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"# env "},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":".env"}],"authorContributionMap":{"MarcusTXK":5,"tlylt":19}},{"path":"matching-service/Dockerfile","fileType":"Dockerfile","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"# Use node alpine image"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"FROM node:14.17.0"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"# Set working directory"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"WORKDIR /app"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"# Copy package-lock.json and package.json"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"COPY package*.json ./"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"# Install node modules"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"RUN npm install --quiet"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"# Copy all files from project excluding node_modules (via .dockerignore)"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"COPY . ."},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"# Create sqlite3 database tables"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"RUN npm run db:migrate"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"# Expose port "},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"EXPOSE 8001"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"# Exec form to avoid starting a shell session"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"CMD [\"npm\", \"start\"]"}],"authorContributionMap":{"MarcusTXK":17}},{"path":"matching-service/README.md","fileType":"md","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"# Matching Service"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"# Setup environment variables"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"1. Rename `.env.example` to `.env`"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"## Usage"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"1. Install npm packages using `npm install`."},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"2. Set up SQLite database using `npm run db:migrate`."},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"3. Run Matching Service using `npm run dev`."},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"## Docker"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"- Via docker-compose: `docker-compose up --build`"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"- Via docker"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"```bash"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"docker build . -t matching-service"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"docker run -p 8001:8001 -d matching-service"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"```"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"### How to test with Postman"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"1. Run `docker-compose up --build`"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"2. Run postman and create a new WebSocket Request (click the top left New button)"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"   ![image](https://user-images.githubusercontent.com/50147457/188167251-15b4bb10-a4d8-41c2-8727-382224a8ebac.png)"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"3. Choose Socket.io in upper left dropdown, add the url `http://localhost:8001` and the message `{\"difficulty\":\"easy\"}`"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"   ![image](https://user-images.githubusercontent.com/50147457/188167374-825174fd-9d5a-4a04-9256-302ddd14143a.png)"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"4. Select `JSON` and input `matchFind` for the event to emit (image outdated)"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"   ![image](https://user-images.githubusercontent.com/50147457/188168120-c66974f4-b773-4cc2-9954-eee17cc1b1c1.png)"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"5. At the bottom right, add the any [events](https://github.com/CS3219-AY2223S1/cs3219-project-ay2223s1-g58/blob/main/matching-service/const/constants.json) you are interested in:"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"   ![image](https://user-images.githubusercontent.com/50147457/188168182-03431725-bbe2-4537-a0aa-2afb87d99bf4.png)"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"6. Click Send and you should see that the message was emitted to the `match` event, and is is currently `matching`"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"   ![image](https://user-images.githubusercontent.com/50147457/188168685-647fea55-e36b-4802-9fa4-e8a913da478d.png)"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"7. Repeat steps 3 to 6 for a second user. If done right, both users will be matched up, with the room id being emitted to the `matchSuccess` event for both users."},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"   ![image](https://user-images.githubusercontent.com/50147457/188168885-47fa43c9-3779-4e52-83bf-f743733dac89.png)"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"Note: If the instructions above were unclear, please refer [here](https://blog.postman.com/postman-now-supports-socket-io/) for more instructions on how to setup postman for socket.io. Unfortunately, postman does not currently support exporting of postman collections testing socket.io, so this has to be manually set up by the tester."}],"authorContributionMap":{"MarcusTXK":37,"uyencfi":2}},{"path":"matching-service/const/constants.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"exports.EVENT_EMIT \u003d {"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"  MATCHING: \"matching\","},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"  MATCH_SUCCESS: \"matchSuccess\","},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"  MATCH_FAIL: \"matchFail\","},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  MATCH_TIMEOUT: \"matchTimeout\","},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"exports.EVENT_LISTEN \u003d {"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"  MATCH_FIND: \"matchFind\","},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"  MATCH_CANCEL: \"matchCancel\","},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"exports.DIFFICULTY \u003d {"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"  EASY: \"easy\","},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"  MEDIUM: \"medium\","},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"  HARD: \"hard\","},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"const roomServiceFallback \u003d"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"  process.env.ENV \u003d\u003d\u003d \"production\" // production means using Docker"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"    ? `http://${process.env.ROOM_SERVICE_HOST}:8022`"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"    : \"http://localhost:8022\";"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"const URI_ROOM_SERVICE \u003d process.env.URI_ROOM_SERVICE || roomServiceFallback;"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"const PREFIX_ROOM_SERVICE \u003d \"/api/v1/room\";"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"exports.URL_ROOM_SERVICE \u003d URI_ROOM_SERVICE + PREFIX_ROOM_SERVICE;"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"const historyServiceFallback \u003d"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"  process.env.ENV \u003d\u003d\u003d \"production\""},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"    ? `http://${process.env.HISTORY_SERVICE_HOST}:8080`"},{"lineNumber":33,"author":{"gitId":"uyencfi"},"content":"    : \"http://localhost:8080\";"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"const URI_HISTORY_SERVICE \u003d"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"  process.env.URI_HISTORY_SERVICE || historyServiceFallback;"},{"lineNumber":36,"author":{"gitId":"uyencfi"},"content":"const HISTORY_SERVICE_ROOM_PATH \u003d \"/api/v1/history/room\";"},{"lineNumber":37,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":38,"author":{"gitId":"uyencfi"},"content":"exports.URL_HISTORY_SERVICE_ROOM_PATH \u003d"},{"lineNumber":39,"author":{"gitId":"uyencfi"},"content":"  URI_HISTORY_SERVICE + HISTORY_SERVICE_ROOM_PATH;"}],"authorContributionMap":{"MarcusTXK":28,"uyencfi":11}},{"path":"matching-service/docker-compose.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"version: \"3.8\""},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"services:"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"  nodeserver:"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"    build:"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"      context: ."},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"    ports:"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"      - \"8001:8001\""},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"    env_file:"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"      - .env"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"    environment:"},{"lineNumber":12,"author":{"gitId":"uyencfi"},"content":"      ENV: production"},{"lineNumber":13,"author":{"gitId":"uyencfi"},"content":"      HISTORY_SERVICE_HOST: host.docker.internal"},{"lineNumber":14,"author":{"gitId":"uyencfi"},"content":"      QUESTION_SERVICE_HOST: host.docker.internal"}],"authorContributionMap":{"MarcusTXK":10,"uyencfi":4}},{"path":"matching-service/dto/match-dto.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"const Joi \u003d require(\"joi\");"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const { DIFFICULTY } \u003d require(\"../const/constants\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"exports.matchDto \u003d Joi.object({"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  difficulty: Joi.string()"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"    .valid(...Object.values(DIFFICULTY))"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"    .error(new Error(\"Invalid/missing difficulty\")),"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"});"}],"authorContributionMap":{"MarcusTXK":8}},{"path":"matching-service/handler/match-handler.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"const MatchService \u003d require(\"../service/match-service\");"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const { isSocketActive } \u003d require(\"../utils/socket-io\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"const { EVENT_EMIT } \u003d require(\"../const/constants\");"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"const { matchDto } \u003d require(\"../dto/match-dto\");"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"exports.findMatch \u003d async function (payload) {"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  const socket \u003d this;"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"  try {"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"    const { value, error } \u003d matchDto.validate(payload);"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"    if (error) {"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"      throw error;"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"    const match \u003d await MatchService.findByDifficulty("},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"      value.difficulty,"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"      socket.id"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"    );"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"    // no other user with same requirements ready for match, or other user is not active"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"    if (!match || !isSocketActive(match.socketId)) {"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"      // matched but socket inactive"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"      if (match) {"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"        console.log(\"Inactive user found\");"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"        MatchService.deleteMatch(match.socketId);"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"      }"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"      await MatchService.createMatch("},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"        socket.id,"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"        value.difficulty,"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"        socket.userId"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"      );"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"      console.log(EVENT_EMIT.MATCHING);"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"      socket.emit(EVENT_EMIT.MATCHING, {"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"        status: EVENT_EMIT.MATCHING,"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"      });"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"      return;"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"    // TODO additional validations"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"    await MatchService.matchSuccess("},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"      match.socketId,"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"      match.userId,"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"      socket.id,"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"      socket.userId,"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"      value.difficulty"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"    );"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"  } catch (e) {"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"    // TODO add custom error messages"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":"    console.error(e);"},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"    console.log(EVENT_EMIT.MATCH_FAIL);"},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"    socket.emit(EVENT_EMIT.MATCH_FAIL, {"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":"      status: EVENT_EMIT.MATCH_FAIL,"},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":"      error: e.message,"},{"lineNumber":50,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":52,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":53,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":54,"author":{"gitId":"MarcusTXK"},"content":"exports.cancelMatch \u003d async function () {"},{"lineNumber":55,"author":{"gitId":"MarcusTXK"},"content":"  const socket \u003d this;"},{"lineNumber":56,"author":{"gitId":"MarcusTXK"},"content":"  console.log(\"Cancel Match\");"},{"lineNumber":57,"author":{"gitId":"MarcusTXK"},"content":"  MatchService.deleteMatch(socket.id);"},{"lineNumber":58,"author":{"gitId":"MarcusTXK"},"content":"};"}],"authorContributionMap":{"MarcusTXK":58}},{"path":"matching-service/index.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"const express \u003d require(\"express\");"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const cors \u003d require(\"cors\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"const { createServer } \u003d require(\"http\");"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"const { initSocket } \u003d require(\"./utils/socket-io\");"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"const { findMatch, cancelMatch } \u003d require(\"./handler/match-handler\");"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"require(\"dotenv\").config();"},{"lineNumber":7,"author":{"gitId":"-"},"content":""},{"lineNumber":8,"author":{"gitId":"-"},"content":"const app \u003d express();"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"app.use(express.urlencoded({ extended: true }));"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"app.use(express.json());"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"app.options(\"*\", cors());"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"app.use(cors())"},{"lineNumber":14,"author":{"gitId":"-"},"content":""},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"app.get(\"/\", (req, res) \u003d\u003e {"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"  res.send(\"Hello World from matching-service\");"},{"lineNumber":17,"author":{"gitId":"-"},"content":"});"},{"lineNumber":18,"author":{"gitId":"-"},"content":""},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"const httpServer \u003d createServer(app);"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"initSocket(httpServer, findMatch, cancelMatch);"},{"lineNumber":21,"author":{"gitId":"-"},"content":""},{"lineNumber":22,"author":{"gitId":"-"},"content":"httpServer.listen(8001);"}],"authorContributionMap":{"MarcusTXK":13,"tlylt":2,"-":7}},{"path":"matching-service/migrations/20220901090816-create-match.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"/* eslint-disable no-unused-vars */"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"module.exports \u003d {"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"  async up(queryInterface, Sequelize) {"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"    await queryInterface.createTable(\"Matches\", {"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"      id: {"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"        allowNull: false,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"        autoIncrement: true,"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"        primaryKey: true,"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.INTEGER,"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"      socket_id: {"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.INTEGER,"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"        allowNull: false,"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"        unique: true,"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"      difficulty: {"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.STRING,"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"      user_id: {"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.STRING,"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"        allowNull: false,"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"        unique: true,"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"      createdAt: {"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"        allowNull: false,"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.DATE,"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"      updatedAt: {"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"        allowNull: false,"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.DATE,"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"  async down(queryInterface, Sequelize) {"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"    await queryInterface.dropTable(\"Matches\");"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"};"}],"authorContributionMap":{"MarcusTXK":37}},{"path":"matching-service/models/index.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"/* eslint-disable import/no-dynamic-require */"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const fs \u003d require(\"fs\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"const path \u003d require(\"path\");"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"const Sequelize \u003d require(\"sequelize\");"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"const basename \u003d path.basename(__filename);"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"const env \u003d process.env.ENV || \"development\";"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"const config \u003d require(`${__dirname}/../config/config.json`)[env];"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"const db \u003d {};"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"let sequelize;"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"if (config.use_env_variable) {"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"  sequelize \u003d new Sequelize(process.env[config.use_env_variable], config);"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"} else {"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"  sequelize \u003d new Sequelize({"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"    dialect: config.dialect,"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"    storage: config.storage,"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"  });"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"fs.readdirSync(__dirname)"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"  .filter("},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"    (file) \u003d\u003e"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"      file.indexOf(\".\") !\u003d\u003d 0 \u0026\u0026 file !\u003d\u003d basename \u0026\u0026 file.slice(-3) \u003d\u003d\u003d \".js\""},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"  .forEach((file) \u003d\u003e {"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"    // eslint-disable-next-line global-require"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"    const model \u003d require(path.join(__dirname, file))("},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"      sequelize,"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"      Sequelize.DataTypes"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"    );"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"    db[model.name] \u003d model;"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"  });"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"Object.keys(db).forEach((modelName) \u003d\u003e {"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"  if (db[modelName].associate) {"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"    db[modelName].associate(db);"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"});"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"db.sequelize \u003d sequelize;"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"db.Sequelize \u003d Sequelize;"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"module.exports \u003d db;"}],"authorContributionMap":{"MarcusTXK":43,"Hzxin":1}},{"path":"matching-service/models/match.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"/* eslint-disable no-unused-vars */"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const { Model } \u003d require(\"sequelize\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"module.exports \u003d (sequelize, DataTypes) \u003d\u003e {"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  class Match extends Model {"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"    /**"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"     * Helper method for defining associations."},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"     * This method is not a part of Sequelize lifecycle."},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"     * The `models/index` file will call this method automatically."},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"     */"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"    static associate(models) {"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"      // define association here"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"  Match.init("},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"    {"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"      socketId: {"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"        type: DataTypes.INTEGER,"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"        field: \"socket_id\","},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"      difficulty: {"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"        type: DataTypes.STRING,"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"      userId: {"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"        type: DataTypes.STRING,"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"        field: \"user_id\","},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"    },"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"    {"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"      sequelize,"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"      modelName: \"Match\","},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"  );"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"  return Match;"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"};"}],"authorContributionMap":{"MarcusTXK":35}},{"path":"matching-service/repository/match-repository.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"const Sequelize \u003d require(\"sequelize\");"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const db \u003d require(\"../models/index\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"const MatchRepository \u003d {"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  findByDifficulty: function (difficulty, socketId) {"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"    return db.Match.findOne({"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"      where: {"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"        difficulty: difficulty,"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"        socketId: {"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"          [Sequelize.Op.ne]: socketId,"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"        },"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"  findBySocketId: function (socketId) {"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"    return db.Match.findOne({"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"      where: {"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"        socketId: socketId,"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"  create: function (socketId, difficulty, userId) {"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"    return db.Match.create({ socketId, difficulty, userId });"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"  delete: function (socketId) {"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"    return db.Match.destroy({"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"      where: {"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"        socketId: socketId,"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"module.exports \u003d MatchRepository;"}],"authorContributionMap":{"MarcusTXK":34}},{"path":"matching-service/service/match-service.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"const schedule \u003d require(\"node-schedule\");"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const axios \u003d require(\"axios\").default;"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"const nanoid \u003d require(\"nanoid\");"},{"lineNumber":4,"author":{"gitId":"uyencfi"},"content":""},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"const MatchRepository \u003d require(\"../repository/match-repository\");"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"const { sendMessageToOne, sendMessageToBoth } \u003d require(\"../utils/socket-io\");"},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"const {"},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"  EVENT_EMIT,"},{"lineNumber":9,"author":{"gitId":"uyencfi"},"content":"  URL_ROOM_SERVICE,"},{"lineNumber":10,"author":{"gitId":"uyencfi"},"content":"  URL_HISTORY_SERVICE_ROOM_PATH,"},{"lineNumber":11,"author":{"gitId":"uyencfi"},"content":"} \u003d require(\"../const/constants\");"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"const MATCH_TIMEOUT_SECONDS \u003d 30;"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"const MATCH_TIMEOUT \u003d MATCH_TIMEOUT_SECONDS * 1000;"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"const scheduleTimeout \u003d (socketId) \u003d\u003e {"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"  const date \u003d new Date();"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"  schedule.scheduleJob(new Date(date.getTime() + MATCH_TIMEOUT), async () \u003d\u003e {"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"    if (await MatchRepository.findBySocketId(socketId)) {"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"      MatchRepository.delete(socketId);"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"      console.log(EVENT_EMIT.MATCH_TIMEOUT);"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"      sendMessageToOne("},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"        socketId,"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"        EVENT_EMIT.MATCH_TIMEOUT,"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"        `Match timeout after ${MATCH_TIMEOUT_SECONDS}s`"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"      );"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"  });"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"const MatchService \u003d {"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"  findByDifficulty: function (difficulty, socketId) {"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"    return MatchRepository.findByDifficulty(difficulty, socketId);"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"  createMatch: async function (socketId, difficulty, userId) {"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"    const created \u003d await MatchRepository.create(socketId, difficulty, userId);"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"    scheduleTimeout(socketId);"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"    return created;"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"  deleteMatch: function (socketId) {"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"    return MatchRepository.delete(socketId);"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"  matchSuccess: async function ("},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"    socketIdWaiting,"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":"    userWaiting,"},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"    socketIdNew,"},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"    userNew,"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":"    difficulty"},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":"  ) {"},{"lineNumber":50,"author":{"gitId":"uyencfi"},"content":"    await MatchService.deleteMatch(socketIdWaiting);"},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"    console.log(EVENT_EMIT.MATCH_SUCCESS);"},{"lineNumber":52,"author":{"gitId":"MarcusTXK"},"content":"    const roomId \u003d nanoid(7) + new Date().getTime();"},{"lineNumber":53,"author":{"gitId":"uyencfi"},"content":"    // Record match history in History Service. Will throw an error (400 response) if the roomId is a duplicate"},{"lineNumber":54,"author":{"gitId":"uyencfi"},"content":"    await axios.post(URL_HISTORY_SERVICE_ROOM_PATH, {"},{"lineNumber":55,"author":{"gitId":"uyencfi"},"content":"      roomId,"},{"lineNumber":56,"author":{"gitId":"uyencfi"},"content":"      u1: userWaiting,"},{"lineNumber":57,"author":{"gitId":"uyencfi"},"content":"      u2: userNew,"},{"lineNumber":58,"author":{"gitId":"uyencfi"},"content":"    });"},{"lineNumber":59,"author":{"gitId":"uyencfi"},"content":"    // Create room in Room Service"},{"lineNumber":60,"author":{"gitId":"MarcusTXK"},"content":"    await axios.post(URL_ROOM_SERVICE, {"},{"lineNumber":61,"author":{"gitId":"MarcusTXK"},"content":"      roomId,"},{"lineNumber":62,"author":{"gitId":"MarcusTXK"},"content":"      userId1: userWaiting,"},{"lineNumber":63,"author":{"gitId":"MarcusTXK"},"content":"      userId2: userNew,"},{"lineNumber":64,"author":{"gitId":"MarcusTXK"},"content":"      difficulty,"},{"lineNumber":65,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":66,"author":{"gitId":"MarcusTXK"},"content":"    console.log(`Created room ${roomId} for ${userWaiting} and ${userNew}`);"},{"lineNumber":67,"author":{"gitId":"uyencfi"},"content":"    sendMessageToBoth(socketIdWaiting, socketIdNew, EVENT_EMIT.MATCH_SUCCESS, {"},{"lineNumber":68,"author":{"gitId":"MarcusTXK"},"content":"      status: EVENT_EMIT.MATCH_SUCCESS,"},{"lineNumber":69,"author":{"gitId":"MarcusTXK"},"content":"      room: roomId,"},{"lineNumber":70,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":71,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":72,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":73,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":74,"author":{"gitId":"MarcusTXK"},"content":"module.exports \u003d MatchService;"}],"authorContributionMap":{"MarcusTXK":59,"uyencfi":15}},{"path":"matching-service/utils/socket-io.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"/* eslint-disable no-param-reassign */"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const { Server } \u003d require(\"socket.io\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"const jwt \u003d require(\"jsonwebtoken\");"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"const { EVENT_LISTEN } \u003d require(\"../const/constants\");"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"let io;"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"exports.initSocket \u003d (httpServer, matchHandler, cancelHandler) \u003d\u003e {"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"  io \u003d new Server(httpServer, {"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"    cors: {"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"      origin: \"*\","},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"      methods: [\"GET\", \"POST\"],"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"    },"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"  });"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"  io.path(\"/socket.io/matching\");"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"  io.use((socket, next) \u003d\u003e {"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"    try {"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"      const { token } \u003d socket.handshake.auth;"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"      // TODO update to verify when expired token is fixed"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"      const payload \u003d jwt.decode(token, process.env.ACCESS_TOKEN_SECRET);"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"      console.log(\"middleware payload\", payload);"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"      socket.userId \u003d payload.username;"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"      next();"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"    } catch (e) {"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"      console.log(e);"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"      next(e);"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"  });"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"  io.on(\"connection\", (socket) \u003d\u003e {"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"    socket.on(EVENT_LISTEN.MATCH_FIND, matchHandler);"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"    socket.on(EVENT_LISTEN.MATCH_CANCEL, cancelHandler);"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"  });"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"exports.sendMessageToBoth \u003d (firstSocket, secondSocket, event, message) \u003d\u003e"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"  io.to(firstSocket).to(secondSocket).emit(event, message);"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"exports.sendMessageToOne \u003d (socket, event, message) \u003d\u003e"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"  io.to(socket).emit(event, message);"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"exports.emit \u003d (event, message) \u003d\u003e io.emit(event, message);"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"exports.isSocketActive \u003d (socket) \u003d\u003e"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"  io.sockets.sockets.get(socket) !\u003d\u003d undefined;"}],"authorContributionMap":{"MarcusTXK":43}},{"path":"question-service/.dockerignore","fileType":"dockerignore","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"node_modules"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"npm-debug.log"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":".env"}],"authorContributionMap":{"Hzxin":4}},{"path":"question-service/.env.prod","fileType":"prod","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"POSTGRES_HOST\u003d\u0027postgres_db\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"POSTGRES_USER\u003d\u0027postgres\u0027"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"POSTGRES_DB\u003d\u0027postgres_db\u0027"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"POSTGRES_PASSWORD\u003d\u0027postgres\u0027"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"POSTGRES_PORT\u003d5432"}],"authorContributionMap":{"Hzxin":5}},{"path":"question-service/.env.sample","fileType":"sample","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"POSTGRES_HOST\u003d\u0027localhost\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"POSTGRES_USER\u003d\u0027postgres\u0027"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"POSTGRES_DB\u003d\u0027postgres_db\u0027"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"POSTGRES_PASSWORD\u003d\u0027postgres\u0027"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"POSTGRES_PORT\u003d5432"}],"authorContributionMap":{"Hzxin":5}},{"path":"question-service/.eslintignore","fileType":"eslintignore","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"node_modules/*"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"package-lock.json"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"migrations/*"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"seeders/*"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"test/*"}],"authorContributionMap":{"Hzxin":5}},{"path":"question-service/.gitignore","fileType":"gitignore","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"# See https://help.github.com/articles/ignoring-files/ for more about ignoring files."},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"# dependencies"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"/node_modules"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"/.pnp"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":".pnp.js"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"# testing"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"/coverage"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"# misc"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":".DS_Store"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"*.pem"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"# debug"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"npm-debug.log*"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"yarn-debug.log*"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"yarn-error.log*"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"# local env files"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":".env"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":".env.local"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":".env.development.local"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":".env.test.local"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":".env.production.local"}],"authorContributionMap":{"Hzxin":25}},{"path":"question-service/Dockerfile","fileType":"Dockerfile","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"# Use node alpine image"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"FROM node:14.17.0"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"# Create app directory"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"WORKDIR /app"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"# Copy package-lock.json and package.json"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"COPY package*.json ./"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"# Install node modules"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"RUN npm install --quiet"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"# Copy all files from project excluding node_modules (via .dockerignore)"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"COPY . ."},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"# Expose port "},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"EXPOSE 8500"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"# Exec form to avoid starting a shell session"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"CMD [\"npm\", \"start\"]"}],"authorContributionMap":{"Hzxin":17}},{"path":"question-service/README.md","fileType":"md","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"# Question service"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"## Usage"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"1. Rename .env.sample to .env"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"2. Install npm packages using `npm install`."},{"lineNumber":7,"author":{"gitId":"uyencfi"},"content":"3. Ensure postgresdb is available locally."},{"lineNumber":8,"author":{"gitId":"uyencfi"},"content":"4. Run Question Service using `npm run dev`."},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"## Docker"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"-   Via docker-compose: `docker-compose up --build`"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"Then visit `http://localhost:8500/api/question` to see that hello world!"}],"authorContributionMap":{"Hzxin":12,"uyencfi":2}},{"path":"question-service/config/config.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"require(\u0027dotenv\u0027).config()"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"const { POSTGRES_HOST, POSTGRES_USER,POSTGRES_DB, POSTGRES_PASSWORD, POSTGRES_PORT } \u003d process.env;"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"module.exports \u003d "},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"{   "},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"    LOCAL: {"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"        username: POSTGRES_USER,"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"        password: POSTGRES_PASSWORD,"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"        database: POSTGRES_DB,"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"        host: POSTGRES_HOST,"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"        port: POSTGRES_PORT,"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"        dialect: \u0027postgres\u0027,"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"    development: {"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"        username: POSTGRES_USER,"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"        password: POSTGRES_PASSWORD,"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"        database: POSTGRES_DB,"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"        host: \"localhost\","},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"        port: 5432,"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"        dialect: \u0027postgres\u0027,"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"    test: {"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"        username: POSTGRES_USER,"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"        password: POSTGRES_PASSWORD,"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"        database: POSTGRES_DB,"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"        host: POSTGRES_HOST,"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"        port: POSTGRES_PORT,"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"        dialect: \u0027postgres\u0027,"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"    production: {"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"        username: POSTGRES_USER,"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"        password: POSTGRES_PASSWORD,"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"        database: POSTGRES_DB,"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"        host: POSTGRES_HOST,"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"        port: POSTGRES_PORT,"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"        dialect: \u0027postgres\u0027,"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"}"}],"authorContributionMap":{"Hzxin":38}},{"path":"question-service/controller/question-controller.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"const QuestionRepository \u003d require(\u0027../repository/question-repository\u0027)"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"const CategoryRepository \u003d require(\u0027../repository/category-repository\u0027)"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"async function createQuestion(req, res) {"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"    try {"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"        const { name, type, content, difficulty } \u003d req.body"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"        if (name \u0026\u0026 content \u0026\u0026 difficulty) {"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"            difficulty.toLowerCase()"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"            const question \u003d await QuestionRepository.create(name, content)"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"            await CategoryRepository.create(question.id, difficulty, type)"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"            return res"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"                .status(201)"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"                .json({ message: \u0027Create new question successfully!\u0027 })"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"        } else {"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"            return res.status(400).json({"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"                message:"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"                    \u0027Question name, difficulty and/or content are missing!\u0027,"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"            })"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"    } catch (err) {"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"        return res.status(500).json({"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"            message: \u0027Database failure when creating new question! \u0027 + err,"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"async function getQuestionNames(req, res) {"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"    try {"},{"lineNumber":29,"author":{"gitId":"uyencfi"},"content":"        let { id } \u003d req.query"},{"lineNumber":30,"author":{"gitId":"uyencfi"},"content":"        if (!(id instanceof Array)) {  // If there is only 1 id, the value will not be an array"},{"lineNumber":31,"author":{"gitId":"uyencfi"},"content":"          id \u003d [id]"},{"lineNumber":32,"author":{"gitId":"uyencfi"},"content":"        }"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"        const questionArray \u003d await QuestionRepository.findQuestionsById(id)"},{"lineNumber":34,"author":{"gitId":"uyencfi"},"content":"        const id2name \u003d {}"},{"lineNumber":35,"author":{"gitId":"uyencfi"},"content":"        questionArray.forEach(q \u003d\u003e id2name[q.id] \u003d q.name)"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"        return res"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"                .status(200)"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"                .json({ "},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"                    message: \u0027Question names successfully!\u0027,"},{"lineNumber":40,"author":{"gitId":"uyencfi"},"content":"                    data: id2name,"},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":"                 })"},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"    } catch (err) {"},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":"        return res.status(500).json({"},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"            message: \u0027Database failure when retriving question names! \u0027 + err,"},{"lineNumber":45,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":46,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":47,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":48,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":49,"author":{"gitId":"Hzxin"},"content":"async function getAllQuestions(req, res) {"},{"lineNumber":50,"author":{"gitId":"Hzxin"},"content":"    try {"},{"lineNumber":51,"author":{"gitId":"Hzxin"},"content":"        const questions \u003d await QuestionRepository.getAllQuestion()"},{"lineNumber":52,"author":{"gitId":"Hzxin"},"content":"        return res.status(200).json({"},{"lineNumber":53,"author":{"gitId":"Hzxin"},"content":"            message: \u0027All questions retrieved!\u0027,"},{"lineNumber":54,"author":{"gitId":"Hzxin"},"content":"            questions: questions,"},{"lineNumber":55,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":56,"author":{"gitId":"Hzxin"},"content":"    } catch (err) {"},{"lineNumber":57,"author":{"gitId":"Hzxin"},"content":"        return res.status(500).json({"},{"lineNumber":58,"author":{"gitId":"Hzxin"},"content":"            message: \u0027Database failure when retriving all questions! \u0027 + err,"},{"lineNumber":59,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":60,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":61,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":62,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":63,"author":{"gitId":"Hzxin"},"content":"async function getAllTypes(req, res) {"},{"lineNumber":64,"author":{"gitId":"Hzxin"},"content":"    try {"},{"lineNumber":65,"author":{"gitId":"Hzxin"},"content":"        const allTypes \u003d await CategoryRepository.getAllTypes()"},{"lineNumber":66,"author":{"gitId":"Hzxin"},"content":"        let union \u003d []"},{"lineNumber":67,"author":{"gitId":"Hzxin"},"content":"        allTypes.map(arr \u003d\u003e "},{"lineNumber":68,"author":{"gitId":"Hzxin"},"content":"         union \u003d Array.from(new Set([...union, ...arr.types]))"},{"lineNumber":69,"author":{"gitId":"Hzxin"},"content":"        )"},{"lineNumber":70,"author":{"gitId":"Hzxin"},"content":"        return res.status(200).json({"},{"lineNumber":71,"author":{"gitId":"Hzxin"},"content":"            message: \u0027All types retrieved!\u0027,"},{"lineNumber":72,"author":{"gitId":"Hzxin"},"content":"            types: union"},{"lineNumber":73,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":74,"author":{"gitId":"Hzxin"},"content":"    } catch (err) {"},{"lineNumber":75,"author":{"gitId":"Hzxin"},"content":"        return res.status(500).json({"},{"lineNumber":76,"author":{"gitId":"Hzxin"},"content":"            message: \u0027Database failure when retriving all questions! \u0027 + err,"},{"lineNumber":77,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":78,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":79,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":80,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":81,"author":{"gitId":"Hzxin"},"content":"async function getNextQuestion(req, res) {"},{"lineNumber":82,"author":{"gitId":"Hzxin"},"content":"    try {"},{"lineNumber":83,"author":{"gitId":"Hzxin"},"content":"        var category, question"},{"lineNumber":84,"author":{"gitId":"Hzxin"},"content":"        const { past_id, difficulty, types } \u003d req.query"},{"lineNumber":85,"author":{"gitId":"Hzxin"},"content":"        if (!types \u0026\u0026 !difficulty) {"},{"lineNumber":86,"author":{"gitId":"Hzxin"},"content":"            return res"},{"lineNumber":87,"author":{"gitId":"Hzxin"},"content":"                .status(400)"},{"lineNumber":88,"author":{"gitId":"Hzxin"},"content":"                .json({ message: `The difficulty/types is missing!` })"},{"lineNumber":89,"author":{"gitId":"Hzxin"},"content":"        } else if (types) {"},{"lineNumber":90,"author":{"gitId":"Hzxin"},"content":"            category \u003d await CategoryRepository.findNextQuestionOfSameTypes("},{"lineNumber":91,"author":{"gitId":"Hzxin"},"content":"                types,"},{"lineNumber":92,"author":{"gitId":"Hzxin"},"content":"                past_id"},{"lineNumber":93,"author":{"gitId":"Hzxin"},"content":"            )"},{"lineNumber":94,"author":{"gitId":"Hzxin"},"content":"            question \u003d await QuestionRepository.findById(category.questionId)"},{"lineNumber":95,"author":{"gitId":"Hzxin"},"content":"        } else if (difficulty) {"},{"lineNumber":96,"author":{"gitId":"Hzxin"},"content":"            category \u003d"},{"lineNumber":97,"author":{"gitId":"Hzxin"},"content":"                await CategoryRepository.findNextQuestionOfSameDifficulty("},{"lineNumber":98,"author":{"gitId":"Hzxin"},"content":"                    difficulty,"},{"lineNumber":99,"author":{"gitId":"Hzxin"},"content":"                    past_id"},{"lineNumber":100,"author":{"gitId":"Hzxin"},"content":"                )"},{"lineNumber":101,"author":{"gitId":"Hzxin"},"content":"            question \u003d await QuestionRepository.findById(category.questionId)"},{"lineNumber":102,"author":{"gitId":"Hzxin"},"content":"        } else {"},{"lineNumber":103,"author":{"gitId":"Hzxin"},"content":"            return res.status(400).json({ message: `Unexpected format` })"},{"lineNumber":104,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":105,"author":{"gitId":"Hzxin"},"content":"        return res.status(200).json({"},{"lineNumber":106,"author":{"gitId":"Hzxin"},"content":"            id: question.id,"},{"lineNumber":107,"author":{"gitId":"Hzxin"},"content":"            name: question.name,"},{"lineNumber":108,"author":{"gitId":"Hzxin"},"content":"            content: question.content,"},{"lineNumber":109,"author":{"gitId":"Hzxin"},"content":"            difficulty: category.difficulty,"},{"lineNumber":110,"author":{"gitId":"Hzxin"},"content":"            types: category.types,"},{"lineNumber":111,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":112,"author":{"gitId":"Hzxin"},"content":"    } catch (err) {"},{"lineNumber":113,"author":{"gitId":"Hzxin"},"content":"        return res.status(500).json({"},{"lineNumber":114,"author":{"gitId":"Hzxin"},"content":"            message: \u0027Database failure when retrieving the question! \u0027 + err,"},{"lineNumber":115,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":116,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":117,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":118,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":119,"author":{"gitId":"Hzxin"},"content":"async function getQuestion(req, res) {"},{"lineNumber":120,"author":{"gitId":"Hzxin"},"content":"    try {"},{"lineNumber":121,"author":{"gitId":"Hzxin"},"content":"        const { difficulty, id, types } \u003d req.query"},{"lineNumber":122,"author":{"gitId":"Hzxin"},"content":"        var category, question"},{"lineNumber":123,"author":{"gitId":"Hzxin"},"content":"        if (difficulty) {"},{"lineNumber":124,"author":{"gitId":"Hzxin"},"content":"            category \u003d await CategoryRepository.findByDifficulty(difficulty)"},{"lineNumber":125,"author":{"gitId":"Hzxin"},"content":"            question \u003d await QuestionRepository.findById(category.questionId)"},{"lineNumber":126,"author":{"gitId":"Hzxin"},"content":"        } else if (types) {"},{"lineNumber":127,"author":{"gitId":"Hzxin"},"content":"            category \u003d await CategoryRepository.findByQuestionTypes(types)"},{"lineNumber":128,"author":{"gitId":"Hzxin"},"content":"            question \u003d await QuestionRepository.findById(category.questionId)"},{"lineNumber":129,"author":{"gitId":"Hzxin"},"content":"        } else if (id) {"},{"lineNumber":130,"author":{"gitId":"Hzxin"},"content":"            question \u003d await QuestionRepository.findById(id)"},{"lineNumber":131,"author":{"gitId":"Hzxin"},"content":"            category \u003d await CategoryRepository.findByQuestionId(id)"},{"lineNumber":132,"author":{"gitId":"Hzxin"},"content":"        } else {"},{"lineNumber":133,"author":{"gitId":"Hzxin"},"content":"            return res"},{"lineNumber":134,"author":{"gitId":"Hzxin"},"content":"                .status(400)"},{"lineNumber":135,"author":{"gitId":"Hzxin"},"content":"                .json({ message: `Difficulty/Question ID is missing!` })"},{"lineNumber":136,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":137,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":138,"author":{"gitId":"Hzxin"},"content":"        return res.status(200).json({"},{"lineNumber":139,"author":{"gitId":"Hzxin"},"content":"            id: question.id,"},{"lineNumber":140,"author":{"gitId":"Hzxin"},"content":"            name: question.name,"},{"lineNumber":141,"author":{"gitId":"Hzxin"},"content":"            content: question.content,"},{"lineNumber":142,"author":{"gitId":"Hzxin"},"content":"            difficulty: category.difficulty,"},{"lineNumber":143,"author":{"gitId":"Hzxin"},"content":"            types: category.types,"},{"lineNumber":144,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":145,"author":{"gitId":"Hzxin"},"content":"    } catch (err) {"},{"lineNumber":146,"author":{"gitId":"Hzxin"},"content":"        return res.status(500).json({"},{"lineNumber":147,"author":{"gitId":"Hzxin"},"content":"            message: \u0027Database failure when retrieving the question! \u0027 + err,"},{"lineNumber":148,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":149,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":150,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":151,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":152,"author":{"gitId":"Hzxin"},"content":"async function deleteQuestionById(req, res) {"},{"lineNumber":153,"author":{"gitId":"Hzxin"},"content":"    try {"},{"lineNumber":154,"author":{"gitId":"Hzxin"},"content":"        const { id } \u003d req.query"},{"lineNumber":155,"author":{"gitId":"Hzxin"},"content":"        if (id) {"},{"lineNumber":156,"author":{"gitId":"Hzxin"},"content":"            await QuestionRepository.deleteById(id)"},{"lineNumber":157,"author":{"gitId":"Hzxin"},"content":"            return res"},{"lineNumber":158,"author":{"gitId":"Hzxin"},"content":"                .status(200)"},{"lineNumber":159,"author":{"gitId":"Hzxin"},"content":"                .json({ message: `Question deleted succesfully` })"},{"lineNumber":160,"author":{"gitId":"Hzxin"},"content":"        } else {"},{"lineNumber":161,"author":{"gitId":"Hzxin"},"content":"            return res"},{"lineNumber":162,"author":{"gitId":"Hzxin"},"content":"                .status(400)"},{"lineNumber":163,"author":{"gitId":"Hzxin"},"content":"                .json({ message: \u0027Question id is missing for deletion\u0027 })"},{"lineNumber":164,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":165,"author":{"gitId":"Hzxin"},"content":"    } catch (err) {"},{"lineNumber":166,"author":{"gitId":"Hzxin"},"content":"        return res.status(500).json({"},{"lineNumber":167,"author":{"gitId":"Hzxin"},"content":"            message: \u0027Database failure when retrieving the question! \u0027 + err,"},{"lineNumber":168,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":169,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":170,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":171,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":172,"author":{"gitId":"Hzxin"},"content":"async function updateQuestion(req, res) {"},{"lineNumber":173,"author":{"gitId":"Hzxin"},"content":"    try {"},{"lineNumber":174,"author":{"gitId":"Hzxin"},"content":"        const id \u003d req.body.id"},{"lineNumber":175,"author":{"gitId":"Hzxin"},"content":"        const question \u003d await QuestionRepository.findById(id)"},{"lineNumber":176,"author":{"gitId":"Hzxin"},"content":"        const category \u003d await CategoryRepository.findByQuestionId(id)"},{"lineNumber":177,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":178,"author":{"gitId":"Hzxin"},"content":"        if (req.body?.name) {"},{"lineNumber":179,"author":{"gitId":"Hzxin"},"content":"            question.name \u003d req.body.name"},{"lineNumber":180,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":181,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":182,"author":{"gitId":"Hzxin"},"content":"        if (req.body?.content) {"},{"lineNumber":183,"author":{"gitId":"Hzxin"},"content":"            question.content \u003d req.body.content"},{"lineNumber":184,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":185,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":186,"author":{"gitId":"Hzxin"},"content":"        if (req.body?.difficulty) {"},{"lineNumber":187,"author":{"gitId":"Hzxin"},"content":"            category.difficulty \u003d req.body.difficulty"},{"lineNumber":188,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":189,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":190,"author":{"gitId":"Hzxin"},"content":"        if (req.body?.types) {"},{"lineNumber":191,"author":{"gitId":"Hzxin"},"content":"            category.types \u003d req.body.types"},{"lineNumber":192,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":193,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":194,"author":{"gitId":"Hzxin"},"content":"        await QuestionRepository.update(question)"},{"lineNumber":195,"author":{"gitId":"Hzxin"},"content":"        await CategoryRepository.update(category)"},{"lineNumber":196,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":197,"author":{"gitId":"Hzxin"},"content":"        return res.status(200).json({"},{"lineNumber":198,"author":{"gitId":"Hzxin"},"content":"            message: \u0027Question updated succesfully\u0027,"},{"lineNumber":199,"author":{"gitId":"Hzxin"},"content":"            id: question.id,"},{"lineNumber":200,"author":{"gitId":"Hzxin"},"content":"            name: question.name,"},{"lineNumber":201,"author":{"gitId":"Hzxin"},"content":"            difficulty: category.difficulty,"},{"lineNumber":202,"author":{"gitId":"Hzxin"},"content":"            types: category.types,"},{"lineNumber":203,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":204,"author":{"gitId":"Hzxin"},"content":"    } catch (err) {"},{"lineNumber":205,"author":{"gitId":"Hzxin"},"content":"        return res.status(500).json({"},{"lineNumber":206,"author":{"gitId":"Hzxin"},"content":"            message: \u0027Database failure when retrieving the question! \u0027 + err,"},{"lineNumber":207,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":208,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":209,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":210,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":211,"author":{"gitId":"Hzxin"},"content":"module.exports \u003d {"},{"lineNumber":212,"author":{"gitId":"Hzxin"},"content":"    createQuestion,"},{"lineNumber":213,"author":{"gitId":"Hzxin"},"content":"    getQuestionNames,"},{"lineNumber":214,"author":{"gitId":"Hzxin"},"content":"    getAllQuestions,"},{"lineNumber":215,"author":{"gitId":"Hzxin"},"content":"    getQuestion,"},{"lineNumber":216,"author":{"gitId":"Hzxin"},"content":"    deleteQuestionById,"},{"lineNumber":217,"author":{"gitId":"Hzxin"},"content":"    updateQuestion,"},{"lineNumber":218,"author":{"gitId":"Hzxin"},"content":"    getNextQuestion,"},{"lineNumber":219,"author":{"gitId":"Hzxin"},"content":"    getAllTypes,"},{"lineNumber":220,"author":{"gitId":"Hzxin"},"content":"}"}],"authorContributionMap":{"Hzxin":213,"uyencfi":7}},{"path":"question-service/docker-compose.test.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"version: \u00273.3\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"services:"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"    postgres_db:"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"        image: postgres:latest"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"        restart: always"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"        ports:"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"            - \u00275432:5432\u0027"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"        environment:"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"            POSTGRES_PASSWORD: postgres"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"            POSTGRES_DB: postgres_db"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"            POSTGRES_USER: postgres"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"            POSTGRES_HOST: postgres_db"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"            POSTGRES_PORT: 5432"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"        healthcheck:"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"            test:"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"                ["},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"                    \u0027CMD\u0027,"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"                    \u0027pg_isready\u0027,"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"                    \u0027-q\u0027,"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"                    \u0027-d\u0027,"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"                    \u0027postgres_db\u0027,"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"                    \u0027-U\u0027,"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"                    \u0027postgres\u0027,"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"                ]"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"            interval: 5s"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"            timeout: 5s"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"            retries: 5"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"    web:"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"        build:"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"            context: ."},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"            dockerfile: Dockerfile"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"        ports:"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"            - \u00278500:8500\u0027"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"        depends_on:"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"            postgres_db:"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"                condition: service_healthy"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"        environment:"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"            ENV: test"},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":"        env_file:"},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":"            - .env.prod"},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"        links:"},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":"            - postgres_db"},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"        restart: on-failure"},{"lineNumber":45,"author":{"gitId":"Hzxin"},"content":"        command: npm run test:ci"}],"authorContributionMap":{"Hzxin":45}},{"path":"question-service/docker-compose.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"version: \u00273.3\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"services:"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"    postgres_db:"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"        image: postgres:latest"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"        restart: always"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"        ports:"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"            - \u00275432:5432\u0027"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"        environment:"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"            POSTGRES_PASSWORD: postgres"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"            POSTGRES_DB: postgres_db"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"            POSTGRES_USER: postgres"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"            POSTGRES_HOST: postgres_db"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"            POSTGRES_PORT: 5432"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"        healthcheck:"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"            test:"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"                ["},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"                    \u0027CMD\u0027,"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"                    \u0027pg_isready\u0027,"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"                    \u0027-q\u0027,"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"                    \u0027-d\u0027,"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"                    \u0027postgres_db\u0027,"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"                    \u0027-U\u0027,"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"                    \u0027postgres\u0027,"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"                ]"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"            interval: 5s"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"            timeout: 5s"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"            retries: 5"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"    web:"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"        build:"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"            context: ."},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"            dockerfile: Dockerfile"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"        ports:"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"            - \u00278500:8500\u0027"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"        depends_on:"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"            postgres_db:"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"                condition: service_healthy"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"        environment:"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"            ENV: production"},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":"        env_file:"},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":"            - .env.prod"},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"        links:"},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":"            - postgres_db"},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"        restart: on-failure"}],"authorContributionMap":{"Hzxin":44}},{"path":"question-service/index.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"const express \u003d require(\u0027express\u0027)"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"const cors \u003d require(\u0027cors\u0027)"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"const app \u003d express()"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"app.use(express.urlencoded({ extended: true }))"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"app.use(express.json())"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"app.options(\"*\", cors());"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"app.use(cors())"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"const {"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"    createQuestion,"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"    getQuestion,"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"    deleteQuestionById,"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"    updateQuestion,"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"    getNextQuestion,"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"    getAllQuestions,"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"    getAllTypes,"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"    getQuestionNames,"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"} \u003d require(\u0027./controller/question-controller\u0027)"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"const router \u003d express.Router()"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"// Controller will contain all the User-defined Routes"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"router.get(\u0027/status\u0027, (_, res) \u003d\u003e {"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"    res.status(200).send({ message: \u0027Hello World from question-service\u0027 })"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"})"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"router.get(\u0027\u0027, getQuestion)"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"router.get(\u0027/nextQuestion\u0027, getNextQuestion)"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"router.get(\u0027/allQuestions\u0027, getAllQuestions)"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"router.get(\u0027/questionNames\u0027, getQuestionNames)"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"router.get(\u0027/allTypes\u0027, getAllTypes)"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"router.post(\u0027/\u0027, createQuestion)"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"router.put(\u0027/\u0027, updateQuestion)"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"router.delete(\u0027\u0027, deleteQuestionById)"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"app.use(\u0027/api/v1/question\u0027, router).all((_, res) \u003d\u003e {"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"    res.setHeader(\u0027content-type\u0027, \u0027application/json\u0027)"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"    res.setHeader(\u0027Access-Control-Allow-Origin\u0027, \u0027*\u0027)"},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":"})"},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"app.listen(8500, () \u003d\u003e console.log(\u0027question-service listening on port 8500\u0027))"},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"module.exports \u003d app"}],"authorContributionMap":{"Hzxin":42,"tlylt":2}},{"path":"question-service/migrations/20220910135435-create-question.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"\u0027use strict\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"module.exports \u003d {"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"    async up(queryInterface, Sequelize) {"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"        await queryInterface.createTable(\u0027Questions\u0027, {"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"            id: {"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"                autoIncrement: true,"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"                primaryKey: true,"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"                type: Sequelize.INTEGER,"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"            name: {"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"                type: Sequelize.STRING,"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"            content: {"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"                type: Sequelize.TEXT,"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"            createdAt: {"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"                type: Sequelize.DATE,"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"            updatedAt: {"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"                type: Sequelize.DATE,"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"    async down(queryInterface, Sequelize) {"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"        await queryInterface.dropTable(\u0027Questions\u0027)"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"}"}],"authorContributionMap":{"Hzxin":32}},{"path":"question-service/migrations/20220910135944-create-category.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"\u0027use strict\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"module.exports \u003d {"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"    async up(queryInterface, Sequelize) {"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"        await queryInterface.createTable(\u0027Categories\u0027, {"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"            id: {"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"                autoIncrement: true,"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"                primaryKey: true,"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"                type: Sequelize.INTEGER,"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"            difficulty: {"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"                type: Sequelize.STRING,"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"            types: {"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"                type: Sequelize.ARRAY(Sequelize.STRING),"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"            questionId: {"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"                type: Sequelize.INTEGER,"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"                unique: true,"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"                references: { model: \u0027Questions\u0027, key: \u0027id\u0027 },"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"                onDelete: \u0027cascade\u0027,"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"                onUpdate: \u0027cascade\u0027,"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"            createdAt: {"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"                type: Sequelize.DATE,"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"            updatedAt: {"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"                type: Sequelize.DATE,"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"    async down(queryInterface, Sequelize) {"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"        await queryInterface.dropTable(\u0027Categories\u0027)"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"}"}],"authorContributionMap":{"Hzxin":39}},{"path":"question-service/models/category.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"\u0027use strict\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"const { Model } \u003d require(\u0027sequelize\u0027)"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"module.exports \u003d (sequelize, DataTypes) \u003d\u003e {"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"    class Category extends Model {"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"        static associate(models) {"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"            Category.belongsTo(models.Question, {"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"                foreignKey: \u0027questionId\u0027,"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"            })"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"    Category.init("},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"        {"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"            difficulty: {"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"                type: DataTypes.STRING,"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"            types: {"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"                type: DataTypes.ARRAY(DataTypes.STRING),"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"                allowNull: true,"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"            questionId: {"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"                type: DataTypes.INTEGER,"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"                unique: true,"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"                references: { model: \u0027Questions\u0027, key: \u0027id\u0027 },"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"                onDelete: \u0027cascade\u0027,"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"                onUpdate: \u0027cascade\u0027,"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"        },"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"        {"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"            sequelize,"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"            modelName: \u0027Category\u0027,"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"    )"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"    return Category"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"}"}],"authorContributionMap":{"Hzxin":37}},{"path":"question-service/models/index.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"\u0027use strict\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"const fs \u003d require(\u0027fs\u0027)"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"const path \u003d require(\u0027path\u0027)"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"const Sequelize \u003d require(\u0027sequelize\u0027)"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"const envConfigs \u003d  require(\u0027../config/config\u0027)"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"const basename \u003d path.basename(__filename)"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"const env \u003d process.env.ENV || \u0027development\u0027;"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"const config \u003d envConfigs[env];"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"const db \u003d {}"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"let sequelize \u003d new Sequelize(config)"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"fs.readdirSync(__dirname)"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"    .filter((file) \u003d\u003e {"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"        return ("},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"            file.indexOf(\u0027.\u0027) !\u003d\u003d 0 \u0026\u0026"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"            file !\u003d\u003d basename \u0026\u0026"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"            file.slice(-3) \u003d\u003d\u003d \u0027.js\u0027"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"        )"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"    })"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"    .forEach((file) \u003d\u003e {"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"        const model \u003d require(path.join(__dirname, file))("},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"            sequelize,"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"            Sequelize.DataTypes"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"        )"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"        db[model.name] \u003d model"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"    })"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"Object.keys(db).forEach((modelName) \u003d\u003e {"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"    if (db[modelName].associate) {"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"        db[modelName].associate(db)"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"})"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"db.sequelize \u003d sequelize"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"db.Sequelize \u003d Sequelize"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"module.exports \u003d db"}],"authorContributionMap":{"Hzxin":39}},{"path":"question-service/models/question.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"\u0027use strict\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"const { Model } \u003d require(\u0027sequelize\u0027)"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"module.exports \u003d (sequelize, DataTypes) \u003d\u003e {"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"    class Question extends Model {"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"        static associate(models) {"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"            Question.hasOne(models.Category, {"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"                foreignKey: \u0027questionId\u0027,"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"            })"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"    }"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"    Question.init("},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"        {"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"            name: {"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"                type: DataTypes.STRING,"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"            content: {"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"                type: DataTypes.TEXT,"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"                allowNull: false,"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"        },"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"        {"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"            sequelize,"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"            modelName: \u0027Question\u0027,"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"    )"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"    return Question"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"}"}],"authorContributionMap":{"Hzxin":28}},{"path":"question-service/repository/category-repository.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"const db \u003d require(\u0027../models\u0027)"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"const { Op } \u003d require(\u0027sequelize\u0027)"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"const CategoryRepository \u003d {"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"    create: function (id, difficulty, type) {"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"        return db.Category.create({"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"            difficulty: difficulty,"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"            types: type,"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"            questionId: id,"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"    findByDifficulty: function (difficulty) {"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"        return db.Category.findOne({"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"            where: {"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"                difficulty: difficulty,"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"            order: db.sequelize.random(),"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"            limit: 1,"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"    findByQuestionId: function (id) {"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"        return db.Category.findOne({"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"            where: {"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"                questionId: id,"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"    findByQuestionTypes: function (types) {"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"        if (!Array.isArray(types)) {"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"            types \u003d [types]"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"        return db.Category.findOne({"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"            where: {"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"                types: {"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"                    [Op.overlap]: types,"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"                },"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"            order: db.sequelize.random(),"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"            limit: 1,"},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"    update: function (category) {"},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":"        return db.Category.update("},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"            {"},{"lineNumber":45,"author":{"gitId":"Hzxin"},"content":"                difficulty: category.difficulty,"},{"lineNumber":46,"author":{"gitId":"Hzxin"},"content":"                types: category.types,"},{"lineNumber":47,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":48,"author":{"gitId":"Hzxin"},"content":"            {"},{"lineNumber":49,"author":{"gitId":"Hzxin"},"content":"                where: {"},{"lineNumber":50,"author":{"gitId":"Hzxin"},"content":"                    questionId: category.questionId,"},{"lineNumber":51,"author":{"gitId":"Hzxin"},"content":"                },"},{"lineNumber":52,"author":{"gitId":"Hzxin"},"content":"            }"},{"lineNumber":53,"author":{"gitId":"Hzxin"},"content":"        )"},{"lineNumber":54,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":55,"author":{"gitId":"Hzxin"},"content":"    findNextQuestionOfSameDifficulty: function (difficulty, id) {"},{"lineNumber":56,"author":{"gitId":"Hzxin"},"content":"        // filter out questions in id"},{"lineNumber":57,"author":{"gitId":"Hzxin"},"content":"        const numberIds \u003d []"},{"lineNumber":58,"author":{"gitId":"Hzxin"},"content":"        console.log(id)"},{"lineNumber":59,"author":{"gitId":"Hzxin"},"content":"        for (var i \u003d 0; i \u003c id.length; i++) {"},{"lineNumber":60,"author":{"gitId":"Hzxin"},"content":"            numberIds.push(parseInt(id[i]))"},{"lineNumber":61,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":62,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":63,"author":{"gitId":"Hzxin"},"content":"        return db.Category.findOne({"},{"lineNumber":64,"author":{"gitId":"Hzxin"},"content":"            where: {"},{"lineNumber":65,"author":{"gitId":"Hzxin"},"content":"                difficulty: difficulty,"},{"lineNumber":66,"author":{"gitId":"Hzxin"},"content":"                questionId: {"},{"lineNumber":67,"author":{"gitId":"Hzxin"},"content":"                    [Op.notIn]: numberIds,"},{"lineNumber":68,"author":{"gitId":"Hzxin"},"content":"                },"},{"lineNumber":69,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":70,"author":{"gitId":"Hzxin"},"content":"            order: db.sequelize.random(),"},{"lineNumber":71,"author":{"gitId":"Hzxin"},"content":"            limit: 1,"},{"lineNumber":72,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":73,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":74,"author":{"gitId":"Hzxin"},"content":"    findNextQuestionOfSameTypes: function (types, id) {"},{"lineNumber":75,"author":{"gitId":"Hzxin"},"content":"        const numberIds \u003d []"},{"lineNumber":76,"author":{"gitId":"Hzxin"},"content":"        for (var i \u003d 0; i \u003c id.length; i++) {"},{"lineNumber":77,"author":{"gitId":"Hzxin"},"content":"            numberIds.push(parseInt(id[i]))"},{"lineNumber":78,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":79,"author":{"gitId":"Hzxin"},"content":"        if (!Array.isArray(types)) {"},{"lineNumber":80,"author":{"gitId":"Hzxin"},"content":"            types \u003d [types]"},{"lineNumber":81,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":82,"author":{"gitId":"Hzxin"},"content":"        console.log(types)"},{"lineNumber":83,"author":{"gitId":"Hzxin"},"content":"        return db.Category.findOne({"},{"lineNumber":84,"author":{"gitId":"Hzxin"},"content":"            where: {"},{"lineNumber":85,"author":{"gitId":"Hzxin"},"content":"                types: {"},{"lineNumber":86,"author":{"gitId":"Hzxin"},"content":"                    [Op.overlap]: types,"},{"lineNumber":87,"author":{"gitId":"Hzxin"},"content":"                },"},{"lineNumber":88,"author":{"gitId":"Hzxin"},"content":"                questionId: {"},{"lineNumber":89,"author":{"gitId":"Hzxin"},"content":"                    [Op.notIn]: id,"},{"lineNumber":90,"author":{"gitId":"Hzxin"},"content":"                },"},{"lineNumber":91,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":92,"author":{"gitId":"Hzxin"},"content":"            order: db.sequelize.random(),"},{"lineNumber":93,"author":{"gitId":"Hzxin"},"content":"            limit: 1,"},{"lineNumber":94,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":95,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":96,"author":{"gitId":"Hzxin"},"content":"    getAllTypes: function () {"},{"lineNumber":97,"author":{"gitId":"Hzxin"},"content":"        return db.Category.findAll({"},{"lineNumber":98,"author":{"gitId":"Hzxin"},"content":"            distinct: true,"},{"lineNumber":99,"author":{"gitId":"Hzxin"},"content":"            attributes: [\u0027types\u0027]"},{"lineNumber":100,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":101,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":102,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":103,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":104,"author":{"gitId":"Hzxin"},"content":"module.exports \u003d CategoryRepository"}],"authorContributionMap":{"Hzxin":104}},{"path":"question-service/repository/question-repository.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"const db \u003d require(\u0027../models\u0027)"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"const { Op } \u003d require(\u0027sequelize\u0027)"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"const QuestionRepository \u003d {"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"    findById: function (id) {"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"        return db.Question.findOne({"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"            where: {"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"                id: id,"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"    findQuestionsById: function(ids) {"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"        return db.Question.findAll({"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"            attributes: [\u0027id\u0027, \u0027name\u0027],"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"            where: {"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"                id: {"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"                    [Op.in]: ids,"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"                }"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"            }"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"    create: function (name, content) {"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"        return db.Question.create({"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"            name: name,"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"            content: content,"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"    deleteById: function (id) {"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"        return db.Question.destroy({"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"            where: {"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"                id: id,"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"    update: function (question) {"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"        return db.Question.update("},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"            {"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"                name: question.name,"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"                content: question.content,"},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":"            { where: { id: question.id } }"},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"        )"},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"    getRandomQuestion: function () {"},{"lineNumber":45,"author":{"gitId":"Hzxin"},"content":"        return db.Question.findAll({"},{"lineNumber":46,"author":{"gitId":"Hzxin"},"content":"            order: db.sequelize.random(),"},{"lineNumber":47,"author":{"gitId":"Hzxin"},"content":"            limit: 1,"},{"lineNumber":48,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":49,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":50,"author":{"gitId":"Hzxin"},"content":"    getAllQuestion: function () {"},{"lineNumber":51,"author":{"gitId":"Hzxin"},"content":"        return db.Question.findAll({"},{"lineNumber":52,"author":{"gitId":"Hzxin"},"content":"            distinct: true,"},{"lineNumber":53,"author":{"gitId":"Hzxin"},"content":"            include: [db.Category],"},{"lineNumber":54,"author":{"gitId":"Hzxin"},"content":"        })"},{"lineNumber":55,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":56,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":57,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":58,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":59,"author":{"gitId":"Hzxin"},"content":"module.exports \u003d QuestionRepository"}],"authorContributionMap":{"Hzxin":59}},{"path":"question-service/requests.rest","fileType":"rest","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"### CHECK SERVER ALIVE"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"GET http://localhost:8500/api/v1/question/status"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"### CREATE QUESTION"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"POST http://localhost:8500/api/v1/question"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"Content-Type: application/json"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"{"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"    \"name\":\"Two Sum\","},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"    \"type\":[\"Array\", \"Hashmap\"],"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"    \"content\": \"# [1\\\\. Two Sum](https://leetcode.com/problems/two-sum/)\\n\\n## Description\\n\\nDifficulty: **Easy**  \\n\\nRelated Topics: [Array](https://leetcode.com/tag/array/), [Hash Table](https://leetcode.com/tag/hash-table/)\\n\\n\\nGiven an array of integers `nums` and an integer `target`, return _indices of the two numbers such that they add up to `target`_.\\n\\nYou may assume that each input would have **_exactly_ one solution**, and you may not use the _same_ element twice.\\n\\nYou can return the answer in any order.\\n\\n**Example 1:**\\n\\n```\\nInput: nums \u003d [2,7,11,15], target \u003d 9\\nOutput: [0,1]\\nExplanation: Because nums[0] + nums[1] \u003d\u003d 9, we return [0, 1].\\n```\\n\\n**Example 2:**\\n\\n```\\nInput: nums \u003d [3,2,4], target \u003d 6\\nOutput: [1,2]\\n```\\n\\n**Example 3:**\\n\\n```\\nInput: nums \u003d [3,3], target \u003d 6\\nOutput: [0,1]\\n```\\n\\n**Constraints:**\\n\\n*   2 \u003c\u003d nums.length \u003c\u003d 10\u003csup\u003e4\u003c/sup\u003e\\n*   -10\u003csup\u003e9\u003c/sup\u003e \u003c\u003d nums[i] \u003c\u003d 10\u003csup\u003e9\u003c/sup\u003e\\n*   -10\u003csup\u003e9\u003c/sup\u003e \u003c\u003d target \u003c\u003d 10\u003csup\u003e9\u003c/sup\u003e\\n*   **Only one valid answer exists.**\\n\\n**Follow-up:** Can you come up with an algorithm that is less than O(n\u003csup\u003e2\u003c/sup\u003e) time complexity?\\n\\n\""},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":","},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"    \"difficulty\":\"easy\""},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"### GET ALL QUESTIONS"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"GET http://localhost:8500/api/v1/question/allQuestions"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"### GET ALL TYPES"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"GET http://localhost:8500/api/v1/question/allTypes"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"### GET Question Names"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"GET http://localhost:8500/api/v1/question/questionNames?id\u003d1\u0026id\u003d2\u0026id\u003d3"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"### GET QUESTION By difficulty"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"GET http://localhost:8500/api/v1/question?difficulty\u003deasy"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"### GET QUESTION By types"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"GET http://localhost:8500/api/v1/question?types\u003dArray\u0026types\u003dHash+Table"},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"### GET QUESTION By id"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"GET http://localhost:8500/api/v1/question?id\u003d1"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"### Get Next Question given a list of id by difficulty"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"GET http://localhost:8500/api/v1/question/nextQuestion?past_id\u003d1\u0026difficulty\u003deasy"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"### Get Next Question given a list of id by types"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"GET http://localhost:8500/api/v1/question/nextQuestion?past_id\u003d1\u0026past_id\u003d4\u0026types\u003dString\u0026types\u003dHash+Table"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":"### UPDATE QUESTION"},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":"PUT http://localhost:8500/api/v1/question"},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"Content-Type: application/json"},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"{   "},{"lineNumber":45,"author":{"gitId":"Hzxin"},"content":"    \"id\": 1,"},{"lineNumber":46,"author":{"gitId":"Hzxin"},"content":"    \"name\":\"Updated question\","},{"lineNumber":47,"author":{"gitId":"Hzxin"},"content":"    \"difficulty\":\"medium\""},{"lineNumber":48,"author":{"gitId":"Hzxin"},"content":"}"},{"lineNumber":49,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":50,"author":{"gitId":"Hzxin"},"content":"### DELETE QUESTION By id"},{"lineNumber":51,"author":{"gitId":"Hzxin"},"content":"DELETE http://localhost:8500/api/v1/question?id\u003d7"}],"authorContributionMap":{"Hzxin":51}},{"path":"question-service/seeders/20220912131629-questions.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"\u0027use strict\u0027"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":"module.exports \u003d {"},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"    async up(queryInterface, Sequelize) {"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"        const fs \u003d require(\u0027fs\u0027)"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"        const questionPath \u003d \u0027./seeders/question.json\u0027"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"        const categoryPath \u003d \u0027./seeders/category.json\u0027"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"        const questions \u003d await queryInterface.rawSelect("},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"            \u0027Questions\u0027,"},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"            { "},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"                where: {"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"                    id: 1"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"                },"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"                plain: false "},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"            },"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"            [\u0027id\u0027]"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"        )"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":"        if (questions.length \u003d\u003d 0) {"},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"            const data \u003d JSON.parse(fs.readFileSync(questionPath))"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"            await queryInterface.bulkInsert(\u0027Questions\u0027, data)"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"        const categories \u003d await queryInterface.rawSelect("},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"            \u0027Categories\u0027,"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"            { where: {"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"                questionId: 1"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":"            }, "},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"            plain: false },"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"            [\u0027id\u0027]"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"        )"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"        if (categories.length \u003d\u003d\u003d 0) {"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"            const data \u003d JSON.parse(fs.readFileSync(categoryPath))"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"            await queryInterface.bulkInsert(\u0027Categories\u0027, data)"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"        }"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":"    async down(queryInterface, Sequelize) {"},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":"        /**"},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"         * Add commands to revert seed here."},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":"         *"},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"         * Example:"},{"lineNumber":45,"author":{"gitId":"Hzxin"},"content":"         * await queryInterface.bulkDelete(\u0027People\u0027, null, {});"},{"lineNumber":46,"author":{"gitId":"Hzxin"},"content":"         */"},{"lineNumber":47,"author":{"gitId":"Hzxin"},"content":"        await queryInterface.bulkDelete(\u0027Categories\u0027, null, {})"},{"lineNumber":48,"author":{"gitId":"Hzxin"},"content":"        await queryInterface.bulkDelete(\u0027Questions\u0027, null, {})"},{"lineNumber":49,"author":{"gitId":"Hzxin"},"content":"    },"},{"lineNumber":50,"author":{"gitId":"Hzxin"},"content":"}"}],"authorContributionMap":{"Hzxin":50}},{"path":"question-service/test/index.spec.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"Hzxin"},"content":"const request \u003d require(\u0027supertest\u0027)"},{"lineNumber":2,"author":{"gitId":"Hzxin"},"content":"const app \u003d require(\u0027../index.js\u0027)"},{"lineNumber":3,"author":{"gitId":"Hzxin"},"content":"const { expect } \u003d require(\u0027chai\u0027)"},{"lineNumber":4,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":5,"author":{"gitId":"Hzxin"},"content":"describe(\u0027GET service status\u0027, function () {"},{"lineNumber":6,"author":{"gitId":"Hzxin"},"content":"    it(\u0027responds successfully\u0027, function (done) {"},{"lineNumber":7,"author":{"gitId":"Hzxin"},"content":"        request(app)"},{"lineNumber":8,"author":{"gitId":"Hzxin"},"content":"            .get(\u0027/api/v1/question/status\u0027)"},{"lineNumber":9,"author":{"gitId":"Hzxin"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":10,"author":{"gitId":"Hzxin"},"content":"            .expect(\u0027Content-Type\u0027, /json/)"},{"lineNumber":11,"author":{"gitId":"Hzxin"},"content":"            .expect("},{"lineNumber":12,"author":{"gitId":"Hzxin"},"content":"                200,"},{"lineNumber":13,"author":{"gitId":"Hzxin"},"content":"                {"},{"lineNumber":14,"author":{"gitId":"Hzxin"},"content":"                    message: \u0027Hello World from question-service\u0027,"},{"lineNumber":15,"author":{"gitId":"Hzxin"},"content":"                },"},{"lineNumber":16,"author":{"gitId":"Hzxin"},"content":"                done"},{"lineNumber":17,"author":{"gitId":"Hzxin"},"content":"            )"},{"lineNumber":18,"author":{"gitId":"Hzxin"},"content":"    })"},{"lineNumber":19,"author":{"gitId":"Hzxin"},"content":"})"},{"lineNumber":20,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":21,"author":{"gitId":"Hzxin"},"content":"describe(\u0027GET Question by id\u0027, function () {"},{"lineNumber":22,"author":{"gitId":"Hzxin"},"content":"    it(\u0027Responds with retrieved question id\u0027, function (done) {"},{"lineNumber":23,"author":{"gitId":"Hzxin"},"content":"        request(app)"},{"lineNumber":24,"author":{"gitId":"Hzxin"},"content":"            .get(\u0027/api/v1/question?id\u003d1\u0027)"},{"lineNumber":25,"author":{"gitId":"Hzxin"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":26,"author":{"gitId":"Hzxin"},"content":"            .expect(200, done)"},{"lineNumber":27,"author":{"gitId":"Hzxin"},"content":"    })"},{"lineNumber":28,"author":{"gitId":"Hzxin"},"content":"})"},{"lineNumber":29,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":30,"author":{"gitId":"Hzxin"},"content":"describe(\u0027POST new Question\u0027, function () {"},{"lineNumber":31,"author":{"gitId":"Hzxin"},"content":"    it(\u0027responds successfully for creating question\u0027, async function () {"},{"lineNumber":32,"author":{"gitId":"Hzxin"},"content":"        const response \u003d await request(app)"},{"lineNumber":33,"author":{"gitId":"Hzxin"},"content":"            .post(\u0027/api/v1/question\u0027)"},{"lineNumber":34,"author":{"gitId":"Hzxin"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":35,"author":{"gitId":"Hzxin"},"content":"            .send({"},{"lineNumber":36,"author":{"gitId":"Hzxin"},"content":"                name: \u0027test\u0027,"},{"lineNumber":37,"author":{"gitId":"Hzxin"},"content":"                type: [\u0027test\u0027],"},{"lineNumber":38,"author":{"gitId":"Hzxin"},"content":"                content: \u0027test\u0027,"},{"lineNumber":39,"author":{"gitId":"Hzxin"},"content":"                difficulty: \u0027easy\u0027,"},{"lineNumber":40,"author":{"gitId":"Hzxin"},"content":"            })"},{"lineNumber":41,"author":{"gitId":"Hzxin"},"content":"        expect(\u0027Content-Type\u0027, /json/)"},{"lineNumber":42,"author":{"gitId":"Hzxin"},"content":"        expect(201)"},{"lineNumber":43,"author":{"gitId":"Hzxin"},"content":"        expect(response.body.message).equal(\u0027Create new question successfully!\u0027)"},{"lineNumber":44,"author":{"gitId":"Hzxin"},"content":"    })"},{"lineNumber":45,"author":{"gitId":"Hzxin"},"content":"})"},{"lineNumber":46,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":47,"author":{"gitId":"Hzxin"},"content":"describe(\u0027GET Next Question of same difficulty\u0027, function () {"},{"lineNumber":48,"author":{"gitId":"Hzxin"},"content":"    it(\u0027Responds with retrieved question id\u0027, function (done) {"},{"lineNumber":49,"author":{"gitId":"Hzxin"},"content":"        request(app)"},{"lineNumber":50,"author":{"gitId":"Hzxin"},"content":"            .get("},{"lineNumber":51,"author":{"gitId":"Hzxin"},"content":"                \u0027/api/v1/question/nextQuestion?past_id\u003d1\u0026past_id\u003d2\u0026difficulty\u003deasy\u0027"},{"lineNumber":52,"author":{"gitId":"Hzxin"},"content":"            )"},{"lineNumber":53,"author":{"gitId":"Hzxin"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":54,"author":{"gitId":"Hzxin"},"content":"            .expect(\u0027Content-Type\u0027, /json/)"},{"lineNumber":55,"author":{"gitId":"Hzxin"},"content":"            .expect("},{"lineNumber":56,"author":{"gitId":"Hzxin"},"content":"                200,"},{"lineNumber":57,"author":{"gitId":"Hzxin"},"content":"                done"},{"lineNumber":58,"author":{"gitId":"Hzxin"},"content":"            )"},{"lineNumber":59,"author":{"gitId":"Hzxin"},"content":"    })"},{"lineNumber":60,"author":{"gitId":"Hzxin"},"content":"})"},{"lineNumber":61,"author":{"gitId":"Hzxin"},"content":""},{"lineNumber":62,"author":{"gitId":"Hzxin"},"content":"describe(\u0027Delete a question\u0027, function () {"},{"lineNumber":63,"author":{"gitId":"Hzxin"},"content":"    it(\u0027responds successfully for delete\u0027, function (done) {"},{"lineNumber":64,"author":{"gitId":"Hzxin"},"content":"        request(app)"},{"lineNumber":65,"author":{"gitId":"Hzxin"},"content":"            .delete(\u0027/api/v1/question?id\u003d7\u0027)"},{"lineNumber":66,"author":{"gitId":"Hzxin"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":67,"author":{"gitId":"Hzxin"},"content":"            .expect(\u0027Content-Type\u0027, /json/)"},{"lineNumber":68,"author":{"gitId":"Hzxin"},"content":"            .expect("},{"lineNumber":69,"author":{"gitId":"Hzxin"},"content":"                200,"},{"lineNumber":70,"author":{"gitId":"Hzxin"},"content":"                {"},{"lineNumber":71,"author":{"gitId":"Hzxin"},"content":"                    message: \u0027Question deleted succesfully\u0027,"},{"lineNumber":72,"author":{"gitId":"Hzxin"},"content":"                },"},{"lineNumber":73,"author":{"gitId":"Hzxin"},"content":"                done"},{"lineNumber":74,"author":{"gitId":"Hzxin"},"content":"            )"},{"lineNumber":75,"author":{"gitId":"Hzxin"},"content":"    })"},{"lineNumber":76,"author":{"gitId":"Hzxin"},"content":"})"}],"authorContributionMap":{"Hzxin":76}},{"path":"room-service/.dockerignore","fileType":"dockerignore","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"node_modules"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"npm-debug.log"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":".env"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"*.sqlite3"}],"authorContributionMap":{"MarcusTXK":5}},{"path":"room-service/.env.example","fileType":"example","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"}],"authorContributionMap":{"MarcusTXK":1}},{"path":"room-service/.env.local","fileType":"local","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"}],"authorContributionMap":{"MarcusTXK":1}},{"path":"room-service/.gitignore","fileType":"gitignore","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"# See https://help.github.com/articles/ignoring-files/ for more about ignoring files."},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"# dependencies"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"/node_modules"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"/.pnp"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":".pnp.js"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"# testing"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"/coverage"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"# misc"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":".DS_Store"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"*.pem"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"# debug"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"npm-debug.log*"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"yarn-debug.log*"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"yarn-error.log*"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"# sqlite"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"*.sqlite3"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"# env "},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":".env"}],"authorContributionMap":{"MarcusTXK":24}},{"path":"room-service/Dockerfile","fileType":"Dockerfile","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"# Use node alpine image"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"FROM node:14.17.0"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"# Set working directory"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"WORKDIR /app"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"# Copy package-lock.json and package.json"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"COPY package*.json ./"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"# Install node modules"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"RUN npm install --quiet"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"# Copy all files from project excluding node_modules (via .dockerignore)"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"COPY . ."},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"# Create sqlite3 database tables"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"RUN npm run db:migrate"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"# Expose port "},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"EXPOSE 8022"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"# Exec form to avoid starting a shell session"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"CMD [\"npm\", \"start\"]"}],"authorContributionMap":{"MarcusTXK":17}},{"path":"room-service/README.md","fileType":"md","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"# Matching Service"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"# Setup environment variables"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"1. Rename `.env.example` to `.env`"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"## Usage"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"1. Install npm packages using `npm install`."},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"2. Set up SQLite database using `npm run db:migrate`."},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"3. Run Matching Service using `npm run dev`."},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"## Docker"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"- Via docker-compose: `docker-compose up --build`"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"- Via docker"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"```bash"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"docker build . -t room-service"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"docker run -p 8022:8022 -d room-service"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"```"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"### How to test with Postman"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"1. Run `docker-compose up --build`"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"2. Run postman and create a new WebSocket Request (click the top left New button)"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"   ![image](https://user-images.githubusercontent.com/50147457/188167251-15b4bb10-a4d8-41c2-8727-382224a8ebac.png)"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"3. Choose Socket.io in upper left dropdown, add the url `http://localhost:8001` and the message `{\"difficulty\":\"easy\"}`"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"   ![image](https://user-images.githubusercontent.com/50147457/188167374-825174fd-9d5a-4a04-9256-302ddd14143a.png)"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"4. Select `JSON` and input `matchFind` for the event to emit (image outdated)"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"   ![image](https://user-images.githubusercontent.com/50147457/188168120-c66974f4-b773-4cc2-9954-eee17cc1b1c1.png)"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"5. At the bottom right, add the any [events](https://github.com/CS3219-AY2223S1/cs3219-project-ay2223s1-g58/blob/main/matching-service/const/constants.json) you are interested in:"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"   ![image](https://user-images.githubusercontent.com/50147457/188168182-03431725-bbe2-4537-a0aa-2afb87d99bf4.png)"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"6. Click Send and you should see that the message was emitted to the `match` event, and is is currently `matching`"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"   ![image](https://user-images.githubusercontent.com/50147457/188168685-647fea55-e36b-4802-9fa4-e8a913da478d.png)"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"7. Repeat steps 3 to 6 for a second user. If done right, both users will be matched up, with the room id being emitted to the `matchSuccess` event for both users."},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"   ![image](https://user-images.githubusercontent.com/50147457/188168885-47fa43c9-3779-4e52-83bf-f743733dac89.png)"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"Note: If the instructions above were unclear, please refer [here](https://blog.postman.com/postman-now-supports-socket-io/) for more instructions on how to setup postman for socket.io. Unfortunately, postman does not currently support exporting of postman collections testing socket.io, so this has to be manually set up by the tester."}],"authorContributionMap":{"MarcusTXK":39}},{"path":"room-service/const/constants.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"exports.EVENT_EMIT \u003d {"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"  ROOM_UPDATE: \"roomUpdate\","},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"  ROOM_END: \"roomEnd\","},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"exports.DIFFICULTY \u003d {"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  EASY: \"easy\","},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"  MEDIUM: \"medium\","},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"  HARD: \"hard\","},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"const questionServiceFallback \u003d"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"  process.env.ENV \u003d\u003d\u003d \"production\" // production means using Docker"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"    ? `http://${process.env.QUESTION_SERVICE_HOST}:8500`"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"    : \"http://localhost:8500\";"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"const URI_QUESTION_SERVICE \u003d"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"  process.env.URI_QUESTION_SERVICE || questionServiceFallback;"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"const PREFIX_QUESTION_SERVICE \u003d \"/api/v1/question\";"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"exports.URL_QUESTION_SERVICE \u003d URI_QUESTION_SERVICE + PREFIX_QUESTION_SERVICE;"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"exports.URL_QUESTION_SERVICE_NEXT_QUESTION \u003d `${this.URL_QUESTION_SERVICE}/nextQuestion`;"}],"authorContributionMap":{"MarcusTXK":24}},{"path":"room-service/controller/room-controller.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"const { createRoomDto } \u003d require(\"../dto/room-dto\");"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const RoomService \u003d require(\"../service/room-service\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"exports.getRoomById \u003d async function (req, res) {"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  try {"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"    const room \u003d await RoomService.findByRoomId(req.params.roomId);"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"    // room not found or user does not belong to room"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"    const userId \u003d req.user.username;"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"    if (!room || (room.userId1 !\u003d\u003d userId \u0026\u0026 room.userId2 !\u003d\u003d userId)) {"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"      return res.status(400).json({ message: \"Could not get Room info\" });"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"    return res.status(200).json({"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"      message: \"Get Room info successfully\","},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"      data: {"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"        roomId: room.roomId,"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"        userId1: room.userId1,"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"        userId2: room.userId2,"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"        questionId: room.questionId,"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"  } catch (err) {"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"    console.log(err);"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"    return res.status(500).json({ message: err.message });"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"exports.getRoomByUserId \u003d async function (req, res) {"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"  try {"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"    const room \u003d await RoomService.findByUserId(req.user.username);"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"    const data \u003d {"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"      isInRoom: room !\u003d\u003d null,"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"    };"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"    if (room) {"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"      data.roomId \u003d room.roomId;"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"    return res.status(200).json({"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"      message: \"Get Room info successfully\","},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"      data,"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"  } catch (err) {"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"    console.log(err);"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"    return res.status(500).json({ message: err.message });"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"exports.updateRoomQuestionId \u003d async function (req, res) {"},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"  try {"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":"    const room \u003d await RoomService.findByRoomId(req.params.roomId);"},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":"    // room not found or user does not belong to room"},{"lineNumber":50,"author":{"gitId":"MarcusTXK"},"content":"    const userId \u003d req.user.username;"},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"    if (!room || (room.userId1 !\u003d\u003d userId \u0026\u0026 room.userId2 !\u003d\u003d userId)) {"},{"lineNumber":52,"author":{"gitId":"MarcusTXK"},"content":"      return res.status(400).json({ message: \"Could not update Room info\" });"},{"lineNumber":53,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":54,"author":{"gitId":"MarcusTXK"},"content":"    await RoomService.updateRoomQuestionId(req.params.roomId);"},{"lineNumber":55,"author":{"gitId":"MarcusTXK"},"content":"    return res.status(200).json({"},{"lineNumber":56,"author":{"gitId":"MarcusTXK"},"content":"      message: \"Update Room questionId successfully\","},{"lineNumber":57,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":58,"author":{"gitId":"MarcusTXK"},"content":"  } catch (err) {"},{"lineNumber":59,"author":{"gitId":"MarcusTXK"},"content":"    console.log(err);"},{"lineNumber":60,"author":{"gitId":"MarcusTXK"},"content":"    return res.status(500).json({ message: err.message });"},{"lineNumber":61,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":62,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":63,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":64,"author":{"gitId":"MarcusTXK"},"content":"exports.createRoom \u003d async function (req, res) {"},{"lineNumber":65,"author":{"gitId":"MarcusTXK"},"content":"  try {"},{"lineNumber":66,"author":{"gitId":"MarcusTXK"},"content":"    console.log(\"body\", req.body);"},{"lineNumber":67,"author":{"gitId":"MarcusTXK"},"content":"    const { value, error } \u003d createRoomDto.validate(req.body);"},{"lineNumber":68,"author":{"gitId":"MarcusTXK"},"content":"    if (error) {"},{"lineNumber":69,"author":{"gitId":"MarcusTXK"},"content":"      throw error;"},{"lineNumber":70,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":71,"author":{"gitId":"MarcusTXK"},"content":"    const { roomId, userId1, userId2, difficulty } \u003d value;"},{"lineNumber":72,"author":{"gitId":"MarcusTXK"},"content":"    await RoomService.createRoom(roomId, userId1, userId2, difficulty);"},{"lineNumber":73,"author":{"gitId":"MarcusTXK"},"content":"    return res.status(200).json({"},{"lineNumber":74,"author":{"gitId":"MarcusTXK"},"content":"      message: \"Created Room successfully\","},{"lineNumber":75,"author":{"gitId":"MarcusTXK"},"content":"      data: {"},{"lineNumber":76,"author":{"gitId":"MarcusTXK"},"content":"        roomId: roomId,"},{"lineNumber":77,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":78,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":79,"author":{"gitId":"MarcusTXK"},"content":"  } catch (err) {"},{"lineNumber":80,"author":{"gitId":"MarcusTXK"},"content":"    console.log(err);"},{"lineNumber":81,"author":{"gitId":"MarcusTXK"},"content":"    return res.status(500).json({ message: err.message });"},{"lineNumber":82,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":83,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":84,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":85,"author":{"gitId":"MarcusTXK"},"content":"exports.deleteRoom \u003d async function (req, res) {"},{"lineNumber":86,"author":{"gitId":"MarcusTXK"},"content":"  try {"},{"lineNumber":87,"author":{"gitId":"MarcusTXK"},"content":"    await RoomService.deleteRoom(req.params.roomId);"},{"lineNumber":88,"author":{"gitId":"MarcusTXK"},"content":"    return res.status(200).json({"},{"lineNumber":89,"author":{"gitId":"MarcusTXK"},"content":"      message: \"Deleted Room successfully\","},{"lineNumber":90,"author":{"gitId":"MarcusTXK"},"content":"      data: {"},{"lineNumber":91,"author":{"gitId":"MarcusTXK"},"content":"        roomId: req.params.roomId,"},{"lineNumber":92,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":93,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":94,"author":{"gitId":"MarcusTXK"},"content":"  } catch (err) {"},{"lineNumber":95,"author":{"gitId":"MarcusTXK"},"content":"    console.log(err);"},{"lineNumber":96,"author":{"gitId":"MarcusTXK"},"content":"    return res.status(500).json({ message: err.message });"},{"lineNumber":97,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":98,"author":{"gitId":"MarcusTXK"},"content":"};"}],"authorContributionMap":{"MarcusTXK":98}},{"path":"room-service/docker-compose.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"version: \"3.8\""},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"services:"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"  nodeserver:"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"    build:"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"      context: ."},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"    ports:"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"      - \"8001:8001\""},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"    env_file:"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"      - .env"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"    environment:"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"      ENV: production"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"      QUESTION_SERVICE_HOST: host.docker.internal"}],"authorContributionMap":{"MarcusTXK":13}},{"path":"room-service/dto/room-dto.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"const Joi \u003d require(\"joi\");"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const { DIFFICULTY } \u003d require(\"../const/constants\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"exports.createRoomDto \u003d Joi.object({"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  roomId: Joi.string().required(),"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  userId1: Joi.string().required(),"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  userId2: Joi.string().required(),"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"  difficulty: Joi.string()"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"    .valid(...Object.values(DIFFICULTY))"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"    .error(new Error(\"Invalid/missing difficulty\")),"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"});"}],"authorContributionMap":{"MarcusTXK":11}},{"path":"room-service/index.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"const express \u003d require(\"express\");"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const cors \u003d require(\"cors\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"const { createServer } \u003d require(\"http\");"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"const { initSocket } \u003d require(\"./utils/socket-io\");"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"const roomRoutes \u003d require(\"./routes/RoomRoutes\");"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"require(\"dotenv\").config();"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"const app \u003d express();"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"app.use(express.urlencoded({ extended: true }));"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"app.use(express.json());"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"app.options(\"*\", cors());"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"app.use(cors())"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"app.get(\"/\", (req, res) \u003d\u003e {"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"  res.send(\"Hello World from room-service\");"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"});"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"const URL_PREFIX \u003d \"/api/v1/room\";"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"app.use(URL_PREFIX, roomRoutes);"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"const httpServer \u003d createServer(app);"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"initSocket(httpServer);"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"httpServer.listen(8022);"}],"authorContributionMap":{"MarcusTXK":24,"tlylt":1}},{"path":"room-service/migrations/20220915072153-create-room.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"/* eslint-disable no-unused-vars */"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"module.exports \u003d {"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"  async up(queryInterface, Sequelize) {"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"    await queryInterface.createTable(\"Rooms\", {"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"      id: {"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"        allowNull: false,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"        autoIncrement: true,"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"        primaryKey: true,"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.INTEGER,"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"      room_id: {"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.STRING,"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"        unique: true,"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"        allowNull: false,"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"      question_id: {"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.NUMBER,"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"        allowNull: false,"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"      user_id_1: {"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.STRING,"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"        allowNull: false,"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"        unique: true,"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"      user_id_2: {"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.STRING,"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"        allowNull: false,"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"        unique: true,"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"      difficulty: {"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.STRING,"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"      createdAt: {"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"        allowNull: false,"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.DATE,"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"      updatedAt: {"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"        allowNull: false,"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"        type: Sequelize.DATE,"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"  async down(queryInterface, Sequelize) {"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"    await queryInterface.dropTable(\"Rooms\");"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"};"}],"authorContributionMap":{"MarcusTXK":46}},{"path":"room-service/models/index.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"/* eslint-disable import/no-dynamic-require */"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const fs \u003d require(\"fs\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"const path \u003d require(\"path\");"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"const Sequelize \u003d require(\"sequelize\");"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"const basename \u003d path.basename(__filename);"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"const env \u003d process.env.ENV || \"development\";"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"const config \u003d require(`${__dirname}/../config/config.json`)[env];"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"const db \u003d {};"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"let sequelize;"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"if (config.use_env_variable) {"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"  sequelize \u003d new Sequelize(process.env[config.use_env_variable], config);"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"} else {"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"  sequelize \u003d new Sequelize({"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"    dialect: config.dialect,"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"    storage: config.storage,"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"  });"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"}"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"fs.readdirSync(__dirname)"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"  .filter("},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"    (file) \u003d\u003e"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"      file.indexOf(\".\") !\u003d\u003d 0 \u0026\u0026 file !\u003d\u003d basename \u0026\u0026 file.slice(-3) \u003d\u003d\u003d \".js\""},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"  )"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"  .forEach((file) \u003d\u003e {"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"    // eslint-disable-next-line global-require"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"    const model \u003d require(path.join(__dirname, file))("},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"      sequelize,"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"      Sequelize.DataTypes"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"    );"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"    db[model.name] \u003d model;"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"  });"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"Object.keys(db).forEach((modelName) \u003d\u003e {"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"  if (db[modelName].associate) {"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"    db[modelName].associate(db);"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"});"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"db.sequelize \u003d sequelize;"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"db.Sequelize \u003d Sequelize;"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"module.exports \u003d db;"}],"authorContributionMap":{"MarcusTXK":44}},{"path":"room-service/models/room.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"/* eslint-disable no-unused-vars */"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const { Model } \u003d require(\"sequelize\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"module.exports \u003d (sequelize, DataTypes) \u003d\u003e {"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  class Room extends Model {"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"    /**"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"     * Helper method for defining associations."},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"     * This method is not a part of Sequelize lifecycle."},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"     * The `models/index` file will call this method automatically."},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"     */"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"    static associate(models) {"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"      // define association here"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"  Room.init("},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"    {"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"      roomId: {"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"        type: DataTypes.STRING,"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"        field: \"room_id\","},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"      questionId: {"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"        type: DataTypes.NUMBER,"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"        field: \"question_id\","},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"      userId1: {"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"        type: DataTypes.STRING,"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"        field: \"user_id_1\","},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"      userId2: {"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"        type: DataTypes.STRING,"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"        field: \"user_id_2\","},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"      difficulty: {"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"        type: DataTypes.STRING,"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"        field: \"difficulty\","},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"    },"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"    {"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"      sequelize,"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"      modelName: \"Room\","},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"  );"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"  return Room;"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"};"}],"authorContributionMap":{"MarcusTXK":44}},{"path":"room-service/repository/room-repository.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"const Sequelize \u003d require(\"sequelize\");"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const db \u003d require(\"../models/index\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"const RoomRepository \u003d {"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  findByRoomId: function (roomId) {"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"    return db.Room.findOne({"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"      where: {"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"        roomId: roomId,"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"  findByUserId: function (userId) {"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"    return db.Room.findOne({"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"      where: {"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"        [Sequelize.Op.or]: [{ userId1: userId }, { userId2: userId }],"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"  update: function (roomId, updatedRoom) {"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"    return db.Room.update(updatedRoom, {"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"      where: {"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"        roomId: roomId,"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"  create: function (roomId, questionId, userId1, userId2, difficulty) {"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"    return db.Room.create({ roomId, questionId, userId1, userId2, difficulty });"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"  delete: function (roomId) {"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"    return db.Room.destroy({"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"      where: {"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"        roomId: roomId,"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"      },"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"module.exports \u003d RoomRepository;"}],"authorContributionMap":{"MarcusTXK":38}},{"path":"room-service/requests.rest","fileType":"rest","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"### GET ROOM"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"GET http://localhost:8022/api/v1/room/MUdekW1LM87Ouq0SAAAC|Ex7jLTZLxXKGW6wXAAAF"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"### CREATE ROOM"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"POST http://localhost:8022/api/v1/room"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"Content-Type: application/json"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"{\"roomId\":\"WvlfuCkjpslqHdaIAAAB-DHME9NS-fLSzEZX8AAAD\",\"questionId\":1,\"userId1\":\"qwe\",\"userId2\":\"asd\",\"difficulty\":\"easy\"}"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"### DELETE Room"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"DELETE http://localhost:8022/api/v1/room/MUdekW1LM87Ouq0SAAAC|Ex7jLTZLxXKGW6wXAAAF"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":""}],"authorContributionMap":{"MarcusTXK":12}},{"path":"room-service/routes/RoomRoutes.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"const express \u003d require(\"express\");"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const { authenticationMiddleware } \u003d require(\"../utils/authentication\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"const {"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"  getRoomById,"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  deleteRoom,"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  createRoom,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  updateRoomQuestionId,"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"  getRoomByUserId,"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"} \u003d require(\"../controller/room-controller\");"},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"const router \u003d express.Router();"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"router.get(\"/:roomId\", authenticationMiddleware, getRoomById);"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"router.get(\"/\", authenticationMiddleware, getRoomByUserId);"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"// no authentication for createRoom, since it is used by internally"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"router.post(\"/\", createRoom);"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"router.put(\"/:roomId\", authenticationMiddleware, updateRoomQuestionId);"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"router.delete(\"/:roomId\", authenticationMiddleware, deleteRoom);"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"module.exports \u003d router;"}],"authorContributionMap":{"MarcusTXK":24}},{"path":"room-service/service/room-service.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"const axios \u003d require(\"axios\").default;"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const RoomRepository \u003d require(\"../repository/room-repository\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"const { emit } \u003d require(\"../utils/socket-io\");"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"const {"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  EVENT_EMIT,"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"  URL_QUESTION_SERVICE,"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  URL_QUESTION_SERVICE_NEXT_QUESTION,"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"} \u003d require(\"../const/constants\");"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"const RoomService \u003d {"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"  findByRoomId: function (roomId) {"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"    return RoomRepository.findByRoomId(roomId);"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"  findByUserId: function (userId) {"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"    return RoomRepository.findByUserId(userId);"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"  createRoom: async function (roomId, userId1, userId2, difficulty) {"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"    const response \u003d await axios.get(URL_QUESTION_SERVICE, {"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"      params: { difficulty: difficulty },"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"    return RoomRepository.create("},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"      roomId,"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"      response.data.id,"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"      userId1,"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"      userId2,"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"      difficulty"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"    );"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"  updateRoomQuestionId: async function (roomId) {"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"    const room \u003d await RoomRepository.findByRoomId(roomId);"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"    console.log(room);"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":"    const response \u003d await axios.get(URL_QUESTION_SERVICE_NEXT_QUESTION, {"},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"      params: { difficulty: room.difficulty, past_id: room.questionId },"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":"    // TODO append it to array instead of replacing when update to Postgres"},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"    RoomRepository.update(roomId, { ...room, questionId: response.data.id });"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"    emit(`${roomId}-${EVENT_EMIT.ROOM_UPDATE}`, {"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"      status: EVENT_EMIT.ROOM_UPDATE,"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"      room: roomId,"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"      question: response.data.id,"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"  deleteRoom: function (roomId) {"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"    emit(`${roomId}-${EVENT_EMIT.ROOM_END}`, {"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":"      status: EVENT_EMIT.ROOM_END,"},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"      room: roomId,"},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":"    return RoomRepository.delete(roomId);"},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":"  },"},{"lineNumber":50,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":52,"author":{"gitId":"MarcusTXK"},"content":"module.exports \u003d RoomService;"}],"authorContributionMap":{"MarcusTXK":52}},{"path":"room-service/utils/authentication.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"/* eslint-disable consistent-return */"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const jwt \u003d require(\"jsonwebtoken\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":"const getAccessToken \u003d (req) \u003d\u003e {"},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"  try {"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"    const authHeader \u003d req.headers.authorization;"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"    const authContent \u003d authHeader \u0026\u0026 authHeader.split(\" \");"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"    console.log(\"req\", req.headers);"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"    if ("},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"      !authHeader ||"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"      authContent.length !\u003d\u003d 2 ||"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"      authContent[0] !\u003d\u003d \"Bearer\" ||"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"      authContent[1] \u003d\u003d\u003d null"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"    ) {"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"      console.log(\"Access token not provided or invalid\");"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"      return null;"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"    return authContent[1];"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"  } catch (err) {"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"    console.log(\"Error: Access token not provided or invalid\");"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"    return null;"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"exports.authenticationMiddleware \u003d (req, res, next) \u003d\u003e {"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"  try {"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"    const token \u003d getAccessToken(req);"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"    console.log(\"token: \", token);"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"    if (token \u003d\u003d\u003d null) {"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"      return res.status(401).json({ message: \"Access token not found\" });"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"    // Skip deny check as the token is only valid for 60 seconds if circumventing the frontend"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"    // Reasonable risk to tolerate"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"    jwt.verify(token, process.env.ACCESS_TOKEN_SECRET, (err, user) \u003d\u003e {"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"      if (err) {"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"        console.log(err);"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"        return res.status(401).json({ message: \"Invalid access token\" });"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"      }"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"      req.user \u003d user;"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":"      req.accessToken \u003d token;"},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"      next();"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":"  } catch (err) {"},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"    console.log(\"Fail to authenticate token in middleware\");"},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"    console.log(err);"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":"    return res"},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":"      .status(500)"},{"lineNumber":50,"author":{"gitId":"MarcusTXK"},"content":"      .json({ message: \"Problem encountered when validating token\" });"},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"  }"},{"lineNumber":52,"author":{"gitId":"MarcusTXK"},"content":"};"}],"authorContributionMap":{"MarcusTXK":52}},{"path":"room-service/utils/socket-io.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"MarcusTXK"},"content":"/* eslint-disable no-param-reassign */"},{"lineNumber":2,"author":{"gitId":"MarcusTXK"},"content":"const { Server } \u003d require(\"socket.io\");"},{"lineNumber":3,"author":{"gitId":"MarcusTXK"},"content":"const jwt \u003d require(\"jsonwebtoken\");"},{"lineNumber":4,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":5,"author":{"gitId":"MarcusTXK"},"content":"let io;"},{"lineNumber":6,"author":{"gitId":"MarcusTXK"},"content":"exports.initSocket \u003d (httpServer) \u003d\u003e {"},{"lineNumber":7,"author":{"gitId":"MarcusTXK"},"content":"  io \u003d new Server(httpServer, {"},{"lineNumber":8,"author":{"gitId":"MarcusTXK"},"content":"    cors: {"},{"lineNumber":9,"author":{"gitId":"MarcusTXK"},"content":"      origin: \"*\","},{"lineNumber":10,"author":{"gitId":"MarcusTXK"},"content":"      methods: [\"GET\", \"POST\"],"},{"lineNumber":11,"author":{"gitId":"MarcusTXK"},"content":"    },"},{"lineNumber":12,"author":{"gitId":"MarcusTXK"},"content":"  });"},{"lineNumber":13,"author":{"gitId":"MarcusTXK"},"content":"  io.path(\"/socket.io/room\");"},{"lineNumber":14,"author":{"gitId":"MarcusTXK"},"content":"  io.use((socket, next) \u003d\u003e {"},{"lineNumber":15,"author":{"gitId":"MarcusTXK"},"content":"    try {"},{"lineNumber":16,"author":{"gitId":"MarcusTXK"},"content":"      const { token } \u003d socket.handshake.auth;"},{"lineNumber":17,"author":{"gitId":"MarcusTXK"},"content":"      // TODO update to verify when expired token is fixed"},{"lineNumber":18,"author":{"gitId":"MarcusTXK"},"content":"      const payload \u003d jwt.decode(token, process.env.ACCESS_TOKEN_SECRET);"},{"lineNumber":19,"author":{"gitId":"MarcusTXK"},"content":"      console.log(\"middleware payload\", payload);"},{"lineNumber":20,"author":{"gitId":"MarcusTXK"},"content":"      socket.userId \u003d payload.username;"},{"lineNumber":21,"author":{"gitId":"MarcusTXK"},"content":"      next();"},{"lineNumber":22,"author":{"gitId":"MarcusTXK"},"content":"    } catch (e) {"},{"lineNumber":23,"author":{"gitId":"MarcusTXK"},"content":"      console.log(e);"},{"lineNumber":24,"author":{"gitId":"MarcusTXK"},"content":"      next(e);"},{"lineNumber":25,"author":{"gitId":"MarcusTXK"},"content":"    }"},{"lineNumber":26,"author":{"gitId":"MarcusTXK"},"content":"  });"},{"lineNumber":27,"author":{"gitId":"MarcusTXK"},"content":"  io.on(\"connection\", (socket) \u003d\u003e {"},{"lineNumber":28,"author":{"gitId":"MarcusTXK"},"content":"    console.log(\"connection here\");"},{"lineNumber":29,"author":{"gitId":"MarcusTXK"},"content":"    socket.on(\"join-room\", (payload) \u003d\u003e {"},{"lineNumber":30,"author":{"gitId":"MarcusTXK"},"content":"      console.log(\"join-room payload\", payload);"},{"lineNumber":31,"author":{"gitId":"MarcusTXK"},"content":"      const { roomId, userId } \u003d payload;"},{"lineNumber":32,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":33,"author":{"gitId":"MarcusTXK"},"content":"      socket.join(roomId);"},{"lineNumber":34,"author":{"gitId":"MarcusTXK"},"content":"      socket.to(roomId).emit(\"user-connected\", userId);"},{"lineNumber":35,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":36,"author":{"gitId":"MarcusTXK"},"content":"      socket.on(\"disconnect\", () \u003d\u003e {"},{"lineNumber":37,"author":{"gitId":"MarcusTXK"},"content":"        socket.to(roomId).emit(\"user-disconnected\", userId);"},{"lineNumber":38,"author":{"gitId":"MarcusTXK"},"content":"      });"},{"lineNumber":39,"author":{"gitId":"MarcusTXK"},"content":"    });"},{"lineNumber":40,"author":{"gitId":"MarcusTXK"},"content":"  });"},{"lineNumber":41,"author":{"gitId":"MarcusTXK"},"content":"};"},{"lineNumber":42,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":43,"author":{"gitId":"MarcusTXK"},"content":"exports.sendMessageToBoth \u003d (firstSocket, secondSocket, event, message) \u003d\u003e"},{"lineNumber":44,"author":{"gitId":"MarcusTXK"},"content":"  io.to(firstSocket).to(secondSocket).emit(event, message);"},{"lineNumber":45,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":46,"author":{"gitId":"MarcusTXK"},"content":"exports.sendMessageToOne \u003d (socket, event, message) \u003d\u003e"},{"lineNumber":47,"author":{"gitId":"MarcusTXK"},"content":"  io.to(socket).emit(event, message);"},{"lineNumber":48,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":49,"author":{"gitId":"MarcusTXK"},"content":"exports.emit \u003d (event, message) \u003d\u003e io.emit(event, message);"},{"lineNumber":50,"author":{"gitId":"MarcusTXK"},"content":""},{"lineNumber":51,"author":{"gitId":"MarcusTXK"},"content":"exports.isSocketActive \u003d (socket) \u003d\u003e"},{"lineNumber":52,"author":{"gitId":"MarcusTXK"},"content":"  io.sockets.sockets.get(socket) !\u003d\u003d undefined;"}],"authorContributionMap":{"MarcusTXK":52}},{"path":"user-service/.dockerignore","fileType":"dockerignore","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"node_modules"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"npm-debug.log"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":".env"}],"authorContributionMap":{"tlylt":4}},{"path":"user-service/.env.dev","fileType":"dev","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"NODE_ENV\u003dDEV"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"ENV\u003dDEV"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"DB_LOCAL_URI\u003dmongodb://localhost:27017/peerprep"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"REFRESH_TOKEN_SECRET\u003dd094b5d45a93e9b1f9bc6dee9aff27e26bf7a875333db0df955415e87151c16a49a72b6ee85ce483e6a243a0fbf8b93989dc150cacdd970c29053a650d4fb908"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"REDIS_HOST\u003dlocalhost"}],"authorContributionMap":{"tlylt":5,"uyencfi":1}},{"path":"user-service/.env.sample","fileType":"sample","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"ENV\u003dPROD"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"DB_CLOUD_URI\u003d\u003cyour mongodb connection url\u003e"},{"lineNumber":3,"author":{"gitId":"uyencfi"},"content":"DB_LOCAL_URI\u003dmongodb://\u003cyour host\u003e:27017/peerprep"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"ACCESS_TOKEN_SECRET\u003d\u003cyour token\u003e"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"REFRESH_TOKEN_SECRET\u003d\u003cyour token\u003e"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"REDIS_HOST\u003d\u003cyour host\u003e"}],"authorContributionMap":{"tlylt":5,"uyencfi":1}},{"path":"user-service/.env.test","fileType":"test","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"ENV\u003dTEST"},{"lineNumber":2,"author":{"gitId":"uyencfi"},"content":"DB_LOCAL_URI\u003dmongodb://mongo:27017/peerprep"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"ACCESS_TOKEN_SECRET\u003d7c0dd92cafc2537595f48eca543a45e38e25b0322c558b8cb44907db49726b54a0809709c4491cbc086187009367ac4febfb8d5db310320c16d510818d833ad9"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"REFRESH_TOKEN_SECRET\u003dd094b5d45a93e9b1f9bc6dee9aff27e26bf7a875333db0df955415e87151c16a49a72b6ee85ce483e6a243a0fbf8b93989dc150cacdd970c29053a650d4fb908"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"REDIS_HOST\u003dredis"}],"authorContributionMap":{"tlylt":4,"uyencfi":1}},{"path":"user-service/.eslintignore","fileType":"eslintignore","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"node_modules/*"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"package-lock.json"}],"authorContributionMap":{"tlylt":2}},{"path":"user-service/.gitignore","fileType":"gitignore","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"# See https://help.github.com/articles/ignoring-files/ for more about ignoring files."},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"# dependencies"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"/node_modules"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"/.pnp"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":".pnp.js"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"# testing"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"/coverage"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"# misc"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":".DS_Store"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"*.pem"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"# debug"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"npm-debug.log*"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"yarn-debug.log*"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"yarn-error.log*"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"# local env files"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":".env.local"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":".env.development.local"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":".env.test.local"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":".env.production.local"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":".env"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"# logs"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"logs"}],"authorContributionMap":{"tlylt":28}},{"path":"user-service/Dockerfile","fileType":"Dockerfile","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"FROM node:14.17.0"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"# Create /usr/app directory"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"WORKDIR /usr/app"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"# Install dependencies"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"COPY package.json ."},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"COPY package-lock.json ."},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"RUN npm ci --quiet"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"# Copy source files"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"COPY . ."},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"EXPOSE 8000"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"# Run the app"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"CMD [\"npm\", \"start\"]"}],"authorContributionMap":{"tlylt":17}},{"path":"user-service/README.md","fileType":"md","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"# User service"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"## Prerequisites"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"It is recommended to have redis and mongodb installed locally. If you don\u0027t have them installed, you can use docker-compose to start them."},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"## Development Guide"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"(initial setup)"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"1. Install Node.js 14 and above"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"1. Install dependencies via `npm ci`"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"1. Rename `.env.dev` file to `.env`"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"(for local setup and manual testing)"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"First rename `.env.test` to `.env` and then run the following commands:"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"`docker-compose -f docker-compose.yml up --build`"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"OR"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"(daily development)"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"1. Start the required database services:"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"   1. `docker-compose -f docker-compose.dev.yml up --build`"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"1. Start the express server:"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"   1. `npm run dev`"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"1. Shut down database services:"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"   1. `docker-compose -f docker-compose.yml stop`"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"OR"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"(running automated tests in docker)"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"`docker-compose -f docker-compose.test.yml up --exit-code-from web --build`"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"## Docker Guide"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"(Work in progress, development wise please follow the development guide)"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"Run everything in docker, for production/preview environment:"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"- Either via docker-compose: `docker-compose up --build`,"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"- Or via docker (assuming mongoDB and redis is up and running in the cloud instead):"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"  - `docker build -t user-service .`"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"  - `docker run -p 8000:8000 user-service`"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"Then visit `http://localhost:8000/api/v1/user/status` to see that hello world!"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"## JWT"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"JWT is a JSON Web Token (JWT) is a compact token format used to represent claims to be transferred between two parties."},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"To generate the secret tokens, use the following command:"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"```bash"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"node"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"require(\u0027crypto\u0027).randomBytes(64).toString(\u0027hex\u0027)"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"```"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"## Reference"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"- https://www.youtube.com/watch?v\u003dT0k-3Ze4NLo"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"- https://softwareengineering.stackexchange.com/questions/387243/best-practice-to-confirm-unique-username-for-user-creation-in-jsp-and-jdbc"}],"authorContributionMap":{"tlylt":64}},{"path":"user-service/auth/index.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import jwt from \"jsonwebtoken\""},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import bcrypt from \"bcryptjs\""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import logger from \"../logger.js\""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import { redisClient } from \"../index.js\""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"const ACCESS_TOKEN_EXPIRATION \u003d 60; // 1 minute"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"export function hashPassword(password) {"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    return bcrypt.hashSync(password, 10)"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"export function validatePassword(password, hashedPassword) {"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    return bcrypt.compareSync(password, hashedPassword)"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"export function validateToken(token, secret) {"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"        const result \u003d jwt.verify(token, secret)"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"        return {"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"            username: result.username,"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"            email: result.email,"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"            school: result.school,"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        logger.error(err)"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"        return null"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"export function generateAccessToken(user) {"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"    return jwt.sign("},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"        {"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"            username: user.username,"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"            email: user.email,"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"            school: user.school,"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"        }, process.env.ACCESS_TOKEN_SECRET, {"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"        expiresIn: \"60s\","},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"    })"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"export function generateRefreshToken(user) {"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"    return jwt.sign({"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"        username: user.username,"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"        email: user.email,"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"        school: user.school,"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"    }, process.env.REFRESH_TOKEN_SECRET, {"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"        expiresIn: \"7d\", // to be safe, we set it to 7 days instead of no expiration"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"    })"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"export async function denyAccessToken(accessToken, username) {"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"        if (!accessToken) {"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"            return"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"        // Revoke access token immediately"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"        await redisClient.set(accessToken, username, \"EX\", ACCESS_TOKEN_EXPIRATION)"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"        logger.info(\"Access token is denied\")"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"        logger.error(err)"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"        logger.error(`Could not deny access token ${accessToken} for user ${username}`)"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"export async function isAccessTokenDenied(accessToken) {"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"        const username \u003d await redisClient.get(accessToken);"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"        if (username !\u003d null) {"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"            logger.warn(\"Token has been revoked\");"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"            return true"},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"        return false"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":"        logger.error(err)"},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"        return true"},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":77}},{"path":"user-service/controller/user-controller.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import {"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"    validatePassword,"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"    generateAccessToken,"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"    generateRefreshToken,"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"    validateToken,"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    denyAccessToken,"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    hashPassword"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"} from \"../auth/index.js\""},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"import {"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    ormCreateUser,"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    ormDeleteUser,"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"    ormDeleteUserRefreshToken,"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    ormDoesUserExist,"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    ormGetUser,"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    ormSaveUserRefreshToken,"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"} from \"../model/user-orm.js\""},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"import logger from \"../logger.js\""},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"import { updateCookieToken } from \"../middleware.js\";"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"const REFRESH_TOKEN_EXPIRATION \u003d 60 * 60 * 24 * 7 * 1000; // 1 week"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"export async function getUser(req, res) {"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"        const { username } \u003d req.user"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        const resp \u003d await ormGetUser(username)"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"        if (resp.err) {"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"            logger.error(resp.err)"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"Could not get user info\" })"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"        return res.status(200).json({"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"            message: \"Get user info successfully\","},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"            data: {"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"                username: resp.username,"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"                email: resp.email,"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"                school: resp.school,"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"                createdAt: resp.createdAt,"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"                updatedAt: resp.updatedAt,"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"            }"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"        })"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"        logger.error(err)"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"        return res.status(500).json({ message: \"Database failure when querying user\" })"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"export async function updateUser(req, res) {"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"        const { username } \u003d req.user"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"        const resp \u003d await ormGetUser(username)"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"        if (resp.err) {"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"            logger.error(resp.err)"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"Could not get user info\" })"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"        const user \u003d resp"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"        if (req.body?.email) {"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"            user.email \u003d req.body.email"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"        if (req.body?.school) {"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"            user.school \u003d req.body.school"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"        if ((req.body?.previousPassword \u0026\u0026 !req.body?.updatedPassword) || (!req.body?.previousPassword \u0026\u0026 req.body?.updatedPassword)) {"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"Previous password and updated password must be provided together\" })"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"        let passwordUpdated \u003d false"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"        if (req.body?.previousPassword \u0026\u0026 req.body?.updatedPassword) {"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"            if (req.body.previousPassword \u003d\u003d\u003d req.body.updatedPassword) {"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"                return res.status(400).json({ message: \"Previous password and updated password cannot be the same\" })"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"            }"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"            if (!validatePassword(req.body.previousPassword, user.password)) {"},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"                return res.status(400).json({ message: \"Invalid password\" })"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"            }"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"            user.password \u003d hashPassword(req.body.updatedPassword)"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":"            passwordUpdated \u003d true"},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"        user.save()"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"        if (passwordUpdated) {"},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"            updateCookieToken(res, \"\", 0)"},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"            return res.status(200)"},{"lineNumber":80,"author":{"gitId":"tlylt"},"content":"                .json({"},{"lineNumber":81,"author":{"gitId":"tlylt"},"content":"                    message: \"Update user info successfully\","},{"lineNumber":82,"author":{"gitId":"tlylt"},"content":"                    data: {"},{"lineNumber":83,"author":{"gitId":"tlylt"},"content":"                        username: resp.username,"},{"lineNumber":84,"author":{"gitId":"tlylt"},"content":"                        email: resp.email,"},{"lineNumber":85,"author":{"gitId":"tlylt"},"content":"                        school: resp.school,"},{"lineNumber":86,"author":{"gitId":"tlylt"},"content":"                        createdAt: resp.createdAt,"},{"lineNumber":87,"author":{"gitId":"tlylt"},"content":"                        updatedAt: resp.updatedAt,"},{"lineNumber":88,"author":{"gitId":"tlylt"},"content":"                    }"},{"lineNumber":89,"author":{"gitId":"tlylt"},"content":"                })"},{"lineNumber":90,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":91,"author":{"gitId":"tlylt"},"content":"        return res.status(200).json({"},{"lineNumber":92,"author":{"gitId":"tlylt"},"content":"            message: \"Update user info successfully\","},{"lineNumber":93,"author":{"gitId":"tlylt"},"content":"            data: {"},{"lineNumber":94,"author":{"gitId":"tlylt"},"content":"                username: resp.username,"},{"lineNumber":95,"author":{"gitId":"tlylt"},"content":"                email: resp.email,"},{"lineNumber":96,"author":{"gitId":"tlylt"},"content":"                school: resp.school,"},{"lineNumber":97,"author":{"gitId":"tlylt"},"content":"                createdAt: resp.createdAt,"},{"lineNumber":98,"author":{"gitId":"tlylt"},"content":"                updatedAt: resp.updatedAt,"},{"lineNumber":99,"author":{"gitId":"tlylt"},"content":"            }"},{"lineNumber":100,"author":{"gitId":"tlylt"},"content":"        })"},{"lineNumber":101,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":102,"author":{"gitId":"tlylt"},"content":"        logger.error(err)"},{"lineNumber":103,"author":{"gitId":"tlylt"},"content":"        return res.status(500).json({ message: \"Database failure when updating user\" })"},{"lineNumber":104,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":105,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":106,"author":{"gitId":"-"},"content":""},{"lineNumber":107,"author":{"gitId":"-"},"content":"export async function createUser(req, res) {"},{"lineNumber":108,"author":{"gitId":"-"},"content":"    try {"},{"lineNumber":109,"author":{"gitId":"tlylt"},"content":"        const { username, password } \u003d req.body"},{"lineNumber":110,"author":{"gitId":"tlylt"},"content":"        if (!(username \u0026\u0026 password)) {"},{"lineNumber":111,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"Username and/or Password are missing\" })"},{"lineNumber":112,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":113,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":114,"author":{"gitId":"tlylt"},"content":"        const exist \u003d await ormDoesUserExist(username)"},{"lineNumber":115,"author":{"gitId":"tlylt"},"content":"        if (exist?.err) {"},{"lineNumber":116,"author":{"gitId":"tlylt"},"content":"            logger.error(exist.err)"},{"lineNumber":117,"author":{"gitId":"tlylt"},"content":"            return res.status(500).json({ message: \"Database failure when checking user existence\" })"},{"lineNumber":118,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":119,"author":{"gitId":"tlylt"},"content":"        if (exist) {"},{"lineNumber":120,"author":{"gitId":"tlylt"},"content":"            return res.status(409).json({ message: \"Username has been taken\" })"},{"lineNumber":121,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":122,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":123,"author":{"gitId":"tlylt"},"content":"        const resp \u003d await ormCreateUser(username, password)"},{"lineNumber":124,"author":{"gitId":"-"},"content":"        if (resp.err) {"},{"lineNumber":125,"author":{"gitId":"tlylt"},"content":"            logger.error(resp.err)"},{"lineNumber":126,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"Could not create a new user\" })"},{"lineNumber":127,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":128,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":129,"author":{"gitId":"tlylt"},"content":"        const msg \u003d `Created new user ${username} successfully`"},{"lineNumber":130,"author":{"gitId":"tlylt"},"content":"        logger.info(msg)"},{"lineNumber":131,"author":{"gitId":"tlylt"},"content":"        return res.status(201).json({ message: msg })"},{"lineNumber":132,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":133,"author":{"gitId":"tlylt"},"content":"        logger.error(err)"},{"lineNumber":134,"author":{"gitId":"tlylt"},"content":"        return res.status(500).json({ message: \"Database failure when creating new user\" })"},{"lineNumber":135,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":136,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":137,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":138,"author":{"gitId":"tlylt"},"content":"export async function deleteUser(req, res) {"},{"lineNumber":139,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":140,"author":{"gitId":"tlylt"},"content":"        const { username } \u003d req.user"},{"lineNumber":141,"author":{"gitId":"tlylt"},"content":"        const resp \u003d await ormDeleteUser(username)"},{"lineNumber":142,"author":{"gitId":"tlylt"},"content":"        if (resp.err) {"},{"lineNumber":143,"author":{"gitId":"tlylt"},"content":"            logger.error(resp.err)"},{"lineNumber":144,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"Could not delete user\" })"},{"lineNumber":145,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":146,"author":{"gitId":"tlylt"},"content":"        const msg \u003d `Deleted user ${username} successfully`"},{"lineNumber":147,"author":{"gitId":"tlylt"},"content":"        logger.info(msg)"},{"lineNumber":148,"author":{"gitId":"tlylt"},"content":"        await denyAccessToken(req.accessToken, req.user.username)"},{"lineNumber":149,"author":{"gitId":"tlylt"},"content":"        updateCookieToken(res, \"\", 0)"},{"lineNumber":150,"author":{"gitId":"tlylt"},"content":"        return res.status(200)"},{"lineNumber":151,"author":{"gitId":"tlylt"},"content":"            .json({ message: msg })"},{"lineNumber":152,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":153,"author":{"gitId":"tlylt"},"content":"        logger.error(err)"},{"lineNumber":154,"author":{"gitId":"tlylt"},"content":"        return res.status(500).json({ message: \"Database failure when deleting user\" })"},{"lineNumber":155,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":156,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":157,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":158,"author":{"gitId":"tlylt"},"content":"export async function login(req, res) {"},{"lineNumber":159,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":160,"author":{"gitId":"tlylt"},"content":"        const { username, password } \u003d req.body"},{"lineNumber":161,"author":{"gitId":"tlylt"},"content":"        if (!(username \u0026\u0026 password)) {"},{"lineNumber":162,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"Username and/or Password are missing\" })"},{"lineNumber":163,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":164,"author":{"gitId":"tlylt"},"content":"        const exist \u003d await ormDoesUserExist(username)"},{"lineNumber":165,"author":{"gitId":"tlylt"},"content":"        if (!exist) {"},{"lineNumber":166,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"User does not exist\" })"},{"lineNumber":167,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":168,"author":{"gitId":"tlylt"},"content":"        const user \u003d await ormGetUser(username)"},{"lineNumber":169,"author":{"gitId":"tlylt"},"content":"        const accessToken \u003d generateAccessToken(user)"},{"lineNumber":170,"author":{"gitId":"tlylt"},"content":"        const refreshToken \u003d generateRefreshToken(user)"},{"lineNumber":171,"author":{"gitId":"tlylt"},"content":"        if (!ormSaveUserRefreshToken(user, refreshToken)) {"},{"lineNumber":172,"author":{"gitId":"tlylt"},"content":"            return res.status(500).json({ message: \"Could not save user refresh token\" })"},{"lineNumber":173,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":174,"author":{"gitId":"tlylt"},"content":"        if (validatePassword(password, user.password)) {"},{"lineNumber":175,"author":{"gitId":"tlylt"},"content":"            updateCookieToken(res, refreshToken, REFRESH_TOKEN_EXPIRATION)"},{"lineNumber":176,"author":{"gitId":"tlylt"},"content":"            return res"},{"lineNumber":177,"author":{"gitId":"tlylt"},"content":"                .status(200)"},{"lineNumber":178,"author":{"gitId":"tlylt"},"content":"                .json({"},{"lineNumber":179,"author":{"gitId":"tlylt"},"content":"                    message: \"User login is successful\","},{"lineNumber":180,"author":{"gitId":"tlylt"},"content":"                    data: {"},{"lineNumber":181,"author":{"gitId":"tlylt"},"content":"                        username: user.username,"},{"lineNumber":182,"author":{"gitId":"tlylt"},"content":"                        email: user.email,"},{"lineNumber":183,"author":{"gitId":"tlylt"},"content":"                        school: user.school,"},{"lineNumber":184,"author":{"gitId":"tlylt"},"content":"                        accessToken: accessToken,"},{"lineNumber":185,"author":{"gitId":"tlylt"},"content":"                    },"},{"lineNumber":186,"author":{"gitId":"tlylt"},"content":"                })"},{"lineNumber":187,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":188,"author":{"gitId":"tlylt"},"content":"        return res.status(400).json({ message: `Username and/or Password are incorrect` })"},{"lineNumber":189,"author":{"gitId":"-"},"content":"    } catch (err) {"},{"lineNumber":190,"author":{"gitId":"tlylt"},"content":"        logger.error(err)"},{"lineNumber":191,"author":{"gitId":"tlylt"},"content":"        return res.status(500).json({ message: \"Login failed\" })"},{"lineNumber":192,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":193,"author":{"gitId":"-"},"content":"}"},{"lineNumber":194,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":195,"author":{"gitId":"tlylt"},"content":"export async function logout(req, res) {"},{"lineNumber":196,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":197,"author":{"gitId":"tlylt"},"content":"        if (ormDeleteUserRefreshToken(req.user.username)) {"},{"lineNumber":198,"author":{"gitId":"tlylt"},"content":"            await denyAccessToken(req.accessToken, req.user.username)"},{"lineNumber":199,"author":{"gitId":"tlylt"},"content":"            updateCookieToken(res, \"\", 0)"},{"lineNumber":200,"author":{"gitId":"tlylt"},"content":"            return res"},{"lineNumber":201,"author":{"gitId":"tlylt"},"content":"                .status(200)"},{"lineNumber":202,"author":{"gitId":"tlylt"},"content":"                .json({ message: \"User logout is successful\" })"},{"lineNumber":203,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":204,"author":{"gitId":"tlylt"},"content":"        return res.status(500).json({ message: \"Could not logout user\" })"},{"lineNumber":205,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":206,"author":{"gitId":"tlylt"},"content":"        logger.error(err)"},{"lineNumber":207,"author":{"gitId":"tlylt"},"content":"        return res.status(500).json({ message: \"Could not logout user\" })"},{"lineNumber":208,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":209,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":210,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":211,"author":{"gitId":"tlylt"},"content":"// Handle refresh token"},{"lineNumber":212,"author":{"gitId":"tlylt"},"content":"export async function token(req, res) {"},{"lineNumber":213,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":214,"author":{"gitId":"tlylt"},"content":"        const refreshToken \u003d req.cookies.jwt_refresh_token"},{"lineNumber":215,"author":{"gitId":"tlylt"},"content":"        if (!refreshToken) {"},{"lineNumber":216,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"Refresh token is missing\" })"},{"lineNumber":217,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":218,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":219,"author":{"gitId":"tlylt"},"content":"        const userInfo \u003d validateToken(refreshToken, process.env.REFRESH_TOKEN_SECRET)"},{"lineNumber":220,"author":{"gitId":"tlylt"},"content":"        if (!userInfo) {"},{"lineNumber":221,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"Invalid refresh token\" })"},{"lineNumber":222,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":223,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":224,"author":{"gitId":"tlylt"},"content":"        const resp \u003d await ormGetUser(userInfo.username)"},{"lineNumber":225,"author":{"gitId":"tlylt"},"content":"        if (resp.err) {"},{"lineNumber":226,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"Could not get user\" })"},{"lineNumber":227,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":228,"author":{"gitId":"tlylt"},"content":"        if (resp.refreshToken !\u003d\u003d refreshToken) {"},{"lineNumber":229,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"Refresh token does not match the user\u0027s token record\" })"},{"lineNumber":230,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":231,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":232,"author":{"gitId":"tlylt"},"content":"        const accessToken \u003d generateAccessToken(resp)"},{"lineNumber":233,"author":{"gitId":"tlylt"},"content":"        const newRefreshToken \u003d generateRefreshToken(userInfo)"},{"lineNumber":234,"author":{"gitId":"tlylt"},"content":"        resp.refreshToken \u003d newRefreshToken"},{"lineNumber":235,"author":{"gitId":"tlylt"},"content":"        await resp.save()"},{"lineNumber":236,"author":{"gitId":"tlylt"},"content":"        updateCookieToken(res, newRefreshToken, REFRESH_TOKEN_EXPIRATION)"},{"lineNumber":237,"author":{"gitId":"tlylt"},"content":"        return res"},{"lineNumber":238,"author":{"gitId":"tlylt"},"content":"            .status(200)"},{"lineNumber":239,"author":{"gitId":"tlylt"},"content":"            .json({"},{"lineNumber":240,"author":{"gitId":"tlylt"},"content":"                message: \"Token refreshed successfully\","},{"lineNumber":241,"author":{"gitId":"tlylt"},"content":"                data: {"},{"lineNumber":242,"author":{"gitId":"tlylt"},"content":"                    username: userInfo.username,"},{"lineNumber":243,"author":{"gitId":"tlylt"},"content":"                    email: resp.email,"},{"lineNumber":244,"author":{"gitId":"tlylt"},"content":"                    school: resp.school,"},{"lineNumber":245,"author":{"gitId":"tlylt"},"content":"                    accessToken: accessToken,"},{"lineNumber":246,"author":{"gitId":"tlylt"},"content":"                }"},{"lineNumber":247,"author":{"gitId":"tlylt"},"content":"            })"},{"lineNumber":248,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":249,"author":{"gitId":"tlylt"},"content":"        logger.error(err)"},{"lineNumber":250,"author":{"gitId":"tlylt"},"content":"        return res.status(500).json({ message: \"Database failure when refreshing token\" })"},{"lineNumber":251,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":252,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":253,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":254,"author":{"gitId":"tlylt"},"content":"export async function deleteUserViaPassword(req, res) {"},{"lineNumber":255,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":256,"author":{"gitId":"tlylt"},"content":"        const { username, password } \u003d req.body"},{"lineNumber":257,"author":{"gitId":"tlylt"},"content":"        if (!(username \u0026\u0026 password)) {"},{"lineNumber":258,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"Username and/or Password are missing\" })"},{"lineNumber":259,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":260,"author":{"gitId":"tlylt"},"content":"        const exist \u003d await ormDoesUserExist(username)"},{"lineNumber":261,"author":{"gitId":"tlylt"},"content":"        if (!exist) {"},{"lineNumber":262,"author":{"gitId":"tlylt"},"content":"            return res.status(400).json({ message: \"User does not exist\" })"},{"lineNumber":263,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":264,"author":{"gitId":"tlylt"},"content":"        const user \u003d await ormGetUser(username)"},{"lineNumber":265,"author":{"gitId":"tlylt"},"content":"        if (validatePassword(password, user.password)) {"},{"lineNumber":266,"author":{"gitId":"tlylt"},"content":"            const resp \u003d await ormDeleteUser(username)"},{"lineNumber":267,"author":{"gitId":"tlylt"},"content":"            if (resp.err) {"},{"lineNumber":268,"author":{"gitId":"tlylt"},"content":"                logger.error(resp.err)"},{"lineNumber":269,"author":{"gitId":"tlylt"},"content":"                return res.status(400).json({ message: \"Could not delete user\" })"},{"lineNumber":270,"author":{"gitId":"tlylt"},"content":"            }"},{"lineNumber":271,"author":{"gitId":"tlylt"},"content":"            const msg \u003d `Deleted user ${username} successfully`"},{"lineNumber":272,"author":{"gitId":"tlylt"},"content":"            return res.status(200).json({ message: msg })"},{"lineNumber":273,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":274,"author":{"gitId":"tlylt"},"content":"        return res.status(400).json({ message: `Username and/or Password are incorrect` })"},{"lineNumber":275,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":276,"author":{"gitId":"tlylt"},"content":"        logger.error(err)"},{"lineNumber":277,"author":{"gitId":"tlylt"},"content":"        return res.status(500).json({ message: \"Test delete user failed\" })"},{"lineNumber":278,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":279,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":270,"-":9}},{"path":"user-service/docker-compose.dev.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"version: \"3.3\""},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"services:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"    mongo:"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"        image: mongo"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"        ports:"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"            - \"27017:27017\""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"        command:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"            - \"--logpath\""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"            - \"/dev/null\""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    redis:"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"        image: redis:alpine"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        ports:"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"            - \"6379:6379\""}],"authorContributionMap":{"tlylt":14}},{"path":"user-service/docker-compose.test.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"version: \"3.3\""},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"services:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"    web:"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"        build:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"            context: ."},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"            dockerfile: Dockerfile"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"        ports:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"            - \"8000:8000\""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        links:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"            - mongo"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"            - redis"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        env_file:"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"            - .env.test"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"        depends_on:"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"            - mongo"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"            - redis"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"        command: npm run test:ci"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"    mongo:"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"        image: mongo"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"        command:"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"            - \"--logpath\""},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"            - \"/dev/null\""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"        ports:"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"            - \"27017:27017\""},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"    redis:"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"        image: redis:alpine"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"        ports:"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"            - \"6379:6379\""}],"authorContributionMap":{"tlylt":29}},{"path":"user-service/docker-compose.yml","fileType":"yml","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"version: \"3.3\""},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"services:"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"    web:"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"        build:"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"            context: ."},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"            dockerfile: Dockerfile"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"        ports:"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"            - \"8000:8000\""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        links:"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"            - mongo"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"            - redis"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        env_file:"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"            - .env"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    mongo:"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        image: mongo"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"        ports:"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"            - \"27017:27017\""},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"    redis:"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"        image: redis:alpine"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"        ports:"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"            - \"6379:6379\""}],"authorContributionMap":{"tlylt":22}},{"path":"user-service/index.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import express from \"express\""},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import cors from \"cors\""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import cookieParser from \"cookie-parser\""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import morgan from \"morgan\""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"import helmet from \"helmet\""},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"import compression from \"compression\""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"import redis from \"redis\""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"import \"dotenv/config\""},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"import {"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"    createUser,"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"    deleteUser,"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"    getUser,"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    login,"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    logout,"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"    token,"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"    updateUser,"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"    deleteUserViaPassword"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"} from \"./controller/user-controller.js\""},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"import { authenticateToken } from \u0027./middleware.js\u0027"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"import logger from \u0027./logger.js\u0027"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"import { seedUsers } from \"./model/repository.js\""},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"const API_PREFIX \u003d \"/api/v1/user\""},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"const app \u003d express()"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"const router \u003d express.Router()"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"let redisClient"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"(async () \u003d\u003e {"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"    redisClient \u003d redis.createClient({ url: `redis://${process.env.REDIS_HOST}:6379` });"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"    redisClient.on(\"error\", (error) \u003d\u003e logger.error(`${error}`))"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"    redisClient.on(\"connect\", () \u003d\u003e logger.info(\"Connected to Redis\"))"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"    await redisClient.connect()"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"})()"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":38,"author":{"gitId":"-"},"content":"app.use(express.urlencoded({ extended: true }))"},{"lineNumber":39,"author":{"gitId":"-"},"content":"app.use(express.json())"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"app.use(cors())"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"app.use(cookieParser())"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"app.use(morgan(\"dev\"))"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"app.use(helmet())"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"app.use(compression())"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"app.use(API_PREFIX, router).all((_, res) \u003d\u003e {"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"    res.setHeader(\"content-type\", \"application/json\")"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"    res.setHeader(\"Access-Control-Allow-Origin\", \"*\")"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"})"},{"lineNumber":51,"author":{"gitId":"-"},"content":""},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"// CHECK SERVER ALIVE"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"router.get(\"/status\", (_, res) \u003d\u003e {"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"    res.status(200).send({ message: \"Hello World from user-service\" })"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"})"},{"lineNumber":56,"author":{"gitId":"-"},"content":""},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"// CREATE USER"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"router.post(\"/\", createUser)"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"// LOGIN"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"router.post(\"/login\", login)"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"// REFRESH TOKEN"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"router.post(\u0027/token\u0027, token)"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"// UPDATE USER"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"router.put(\"/\", authenticateToken, updateUser)"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"// GET USER"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"router.get(\"/\", authenticateToken, getUser)"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"// DELETE USER"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"router.delete(\"/\", authenticateToken, deleteUser)"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"// LOGOUT"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"router.post(\u0027/logout\u0027, authenticateToken, logout)"},{"lineNumber":71,"author":{"gitId":"-"},"content":""},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"// TEST TOKEN"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"router.post(\"/testToken\", authenticateToken, (req, res) \u003d\u003e {"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":"    console.log(req)"},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"    res.status(200).send(\"Hello World from user-service token test\")"},{"lineNumber":76,"author":{"gitId":"-"},"content":"})"},{"lineNumber":77,"author":{"gitId":"-"},"content":""},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"// TEST DELETE USER"},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"router.delete(\"/testDelete\", deleteUserViaPassword)"},{"lineNumber":80,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":81,"author":{"gitId":"tlylt"},"content":"// Error handling"},{"lineNumber":82,"author":{"gitId":"tlylt"},"content":"app.use((err, _, res, next) \u003d\u003e {"},{"lineNumber":83,"author":{"gitId":"tlylt"},"content":"    logger.error(err)"},{"lineNumber":84,"author":{"gitId":"tlylt"},"content":"    res.status(500).send({ message: \"Server error\" })"},{"lineNumber":85,"author":{"gitId":"tlylt"},"content":"    next(err);"},{"lineNumber":86,"author":{"gitId":"tlylt"},"content":"})"},{"lineNumber":87,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":88,"author":{"gitId":"tlylt"},"content":"app.listen(8000, async () \u003d\u003e {"},{"lineNumber":89,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":90,"author":{"gitId":"tlylt"},"content":"        await seedUsers()"},{"lineNumber":91,"author":{"gitId":"tlylt"},"content":"    } catch {"},{"lineNumber":92,"author":{"gitId":"tlylt"},"content":"        logger.info(\"Seeded in the past\")"},{"lineNumber":93,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":94,"author":{"gitId":"tlylt"},"content":"    logger.info(\"user-service listening on port 8000\")"},{"lineNumber":95,"author":{"gitId":"tlylt"},"content":"})"},{"lineNumber":96,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":97,"author":{"gitId":"tlylt"},"content":"export { redisClient, app }"}],"authorContributionMap":{"tlylt":90,"-":7}},{"path":"user-service/logger.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { createLogger, format, transports } from \u0027winston\u0027"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import \u0027winston-daily-rotate-file\u0027;"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"const errorTransport \u003d new transports.DailyRotateFile({"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"    filename: \u0027logs/user-service-error-%DATE%.log\u0027,"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"    level: \u0027error\u0027,"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    datePattern: \u0027YYYY-MM-DD-HH\u0027,"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    zippedArchive: true,"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    maxSize: \u002720m\u0027,"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    maxFiles: \u00272d\u0027"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"});"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"const combinedTransport \u003d new transports.DailyRotateFile({"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    filename: \u0027logs/user-service-combined-%DATE%.log\u0027,"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    datePattern: \u0027YYYY-MM-DD-HH\u0027,"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"    zippedArchive: true,"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"    maxSize: \u002720m\u0027,"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"    maxFiles: \u00272d\u0027"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"});"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"const logger \u003d createLogger({"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"    level: \u0027info\u0027,"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"    format: format.combine("},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"        format.timestamp({"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"            format: \u0027YYYY-MM-DD HH:mm:ss\u0027"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"        }),"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"        format.errors({ stack: true }),"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"        format.splat(),"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"        format.json(),"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"    ),"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"    defaultMeta: { service: \u0027user-service\u0027 },"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"    transports: ["},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"        // - Write to all logs with level `info` and below to `user-service-combined.log`."},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"        // - Write all logs error (and below) to `user-service-error.log`."},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"        errorTransport,"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"        combinedTransport"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"    ]"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"});"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"const alignedWithColorsAndTime \u003d format.combine("},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"    format.colorize(),"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"    format.timestamp(),"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"    format.align(),"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"    format.printf(info \u003d\u003e `${info.timestamp} ${info.level}: ${info.message}`)"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":");"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"if (process.env.NODE_ENV !\u003d\u003d \u0027PROD\u0027) {"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"    logger.add(new transports.Console({"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"        format: alignedWithColorsAndTime"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"    }));"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"export default logger;"}],"authorContributionMap":{"tlylt":53}},{"path":"user-service/middleware.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"// With reference to JWT Authentication Tutorial - Node.js"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"// https://www.youtube.com/watch?v\u003dmbsmsi7l3r4"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import jwt from \"jsonwebtoken\";"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import { isAccessTokenDenied } from \"./auth/index.js\";"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"import logger from \"./logger.js\";"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"function getAccessToken(req) {"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"        const authHeader \u003d req.headers[\u0027authorization\u0027];"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        const authContent \u003d authHeader \u0026\u0026 authHeader.split(\u0027 \u0027);"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"        if (!authHeader || authContent.length !\u003d\u003d 2 || authContent[0] !\u003d\u003d \"Bearer\" || authContent[1] \u003d\u003d\u003d null) {"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"            logger.info(\"Access token not provided or invalid\");"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"            return null;"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"        return authContent[1];"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"        logger.info(\"Access token not provided or invalid\");"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"        return null;"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"// Modifies the response object to configure the cookie"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"export async function updateCookieToken(res, token, maxAge) {"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"    res.cookie(\"jwt_refresh_token\", token, {"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        httpOnly: true,"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"        overwrite: true,"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"        maxAge: maxAge,"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"    })"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"export async function authenticateToken(req, res, next) {"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"        const token \u003d getAccessToken(req);"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"        if (token \u003d\u003d\u003d null) {"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"            return res.status(401).json({ message: \"Access token not found\" });"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"        const denied \u003d await isAccessTokenDenied(token);"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"        if (denied) {"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"            return res.status(401).json({ message: \"Token has been revoked\" });"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"        }"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"        jwt.verify(token, process.env.ACCESS_TOKEN_SECRET, (err, user) \u003d\u003e {"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"            if (err) {"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"                logger.error(err)"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"                return res.status(401).json({ message: \"Invalid access token\" });"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"            }"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"            req.user \u003d user;"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"            req.accessToken \u003d token;"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"            next();"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"        })"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"        logger.error(\"Fail to authenticate token in middleware\");"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"        logger.error(err);"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"        return res.status(500).json({ message: \"Problem encountered when validating token\" });"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":56}},{"path":"user-service/model/repository.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import UserModel from \"./user-model.js\""},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import mongoose from \"mongoose\""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import logger from \"../logger.js\""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"import { hashPassword } from \"../auth/index.js\""},{"lineNumber":5,"author":{"gitId":"-"},"content":""},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"const mongoDB \u003d process.env.ENV \u003d\u003d \"PROD\""},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":"    ? process.env.DB_CLOUD_URI"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"    : process.env.DB_LOCAL_URI // Either via docker-compose, or local mongo db needed"},{"lineNumber":9,"author":{"gitId":"-"},"content":""},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"mongoose.connect(mongoDB, { useNewUrlParser: true, useUnifiedTopology: true })"},{"lineNumber":11,"author":{"gitId":"-"},"content":""},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"const db \u003d mongoose.connection"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"db.on(\"error\", () \u003d\u003e logger.error(\"MongoDB connection error:\"))"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"db.on(\"connected\", () \u003d\u003e logger.info(\"Connected to MongoDB\"))"},{"lineNumber":15,"author":{"gitId":"-"},"content":""},{"lineNumber":16,"author":{"gitId":"-"},"content":"export async function createUser(params) {"},{"lineNumber":17,"author":{"gitId":"-"},"content":"    return new UserModel(params)"},{"lineNumber":18,"author":{"gitId":"-"},"content":"}"},{"lineNumber":19,"author":{"gitId":"-"},"content":""},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"export async function doesUserExist(username) {"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"    return UserModel.exists({ username: username })"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"export async function getUser(username) {"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"    return UserModel.findOne({ username: username })"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"export async function deleteUser(username) {"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"    return UserModel.deleteOne({ username: username })"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"export async function seedUsers() {"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"    const users \u003d ["},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"        { username: \"qwe\", password: hashPassword(\"qwe\") },"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"        { username: \"asd\", password: hashPassword(\"asd\") },"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"        { username: \"zxc\", password: hashPassword(\"zxc\") },"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"    ]"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"    await UserModel.insertMany(users)"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":31,"-":8}},{"path":"user-service/model/user-model.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import mongoose from \"mongoose\""},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":3,"author":{"gitId":"-"},"content":"var Schema \u003d mongoose.Schema"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"const UserModelSchema \u003d new Schema({"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"    username: { // Identifier for the user, since it is unique"},{"lineNumber":6,"author":{"gitId":"-"},"content":"        type: String,"},{"lineNumber":7,"author":{"gitId":"-"},"content":"        required: true,"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"        minLength: 1,"},{"lineNumber":9,"author":{"gitId":"-"},"content":"        unique: true,"},{"lineNumber":10,"author":{"gitId":"-"},"content":"    },"},{"lineNumber":11,"author":{"gitId":"-"},"content":"    password: {"},{"lineNumber":12,"author":{"gitId":"-"},"content":"        type: String,"},{"lineNumber":13,"author":{"gitId":"-"},"content":"        required: true,"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"    email: { // For communication purposes"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        type: String,"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"    school: {"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"        type: String,"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"    role: { // For future proofing, we can add roles to users"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"        type: String,"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"        default: \"user\","},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"    refreshToken: {"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"        type: String,"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"    createdAt: {"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"        type: Date,"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"        immutable: true,"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"        default: () \u003d\u003e Date.now(),"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"    updatedAt: {"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"        type: Date,"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"        default: () \u003d\u003e Date.now(),"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"    },"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"})"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"UserModelSchema.pre(\"save\", function (next) {"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"    this.updatedAt \u003d Date.now()"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"    next()"},{"lineNumber":42,"author":{"gitId":"-"},"content":"})"},{"lineNumber":43,"author":{"gitId":"-"},"content":""},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"export default mongoose.model(\"UserModel\", UserModelSchema)"}],"authorContributionMap":{"tlylt":34,"-":10}},{"path":"user-service/model/user-orm.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import { createUser, doesUserExist, getUser, deleteUser } from \"./repository.js\""},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { hashPassword } from \"../auth/index.js\""},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import logger from \"../logger.js\""},{"lineNumber":4,"author":{"gitId":"-"},"content":""},{"lineNumber":5,"author":{"gitId":"-"},"content":"// need to separate orm functions from repository to decouple business logic from persistence"},{"lineNumber":6,"author":{"gitId":"-"},"content":"export async function ormCreateUser(username, password) {"},{"lineNumber":7,"author":{"gitId":"-"},"content":"    try {"},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"        const newUser \u003d await createUser({"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"            username,"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"            password: hashPassword(password),"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"        })"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"        newUser.save()"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"        return true"},{"lineNumber":14,"author":{"gitId":"-"},"content":"    } catch (err) {"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"        logger.error(\"Could not create new user\")"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"        logger.error(err)"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"        return false"},{"lineNumber":18,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":19,"author":{"gitId":"-"},"content":"}"},{"lineNumber":20,"author":{"gitId":"-"},"content":""},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"export async function ormDoesUserExist(username) {"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"        return await doesUserExist(username)"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"        logger.error(\"Could not check user existence\")"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"        return { err }"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"export async function ormGetUser(username) {"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"        return await getUser(username)"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"        logger.error(\"Could not get user\")"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"        return { err }"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"export async function ormGetUserRefreshToken(username) {"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":"        return await getUser(username).refreshToken"},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"        logger.error(\"Could not get user refresh token\")"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"        return { err }"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"export async function ormSaveUserRefreshToken(user, refreshToken) {"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"        user.refreshToken \u003d refreshToken"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"        await user.save()"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"        return true"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"        logger.error(\"Could not save user refresh token\")"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"        return { err }"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"export async function ormDeleteUserRefreshToken(username) {"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"        const user \u003d await getUser(username)"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"        user.refreshToken \u003d undefined"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"        await user.save()"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"        return true"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"        logger.error(\"Could not delete user refresh token\")"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"        return { err }"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"export async function ormDeleteUser(username) {"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"    try {"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"        await deleteUser(username)"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":"        return true"},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"    } catch (err) {"},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"        logger.error(\"Could not delete user\")"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"        return { err }"},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"    }"},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":71,"-":8}},{"path":"user-service/requests.rest","fileType":"rest","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"### CHECK SERVER ALIVE"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"GET http://localhost:8000/api/v1/user/status"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":"### CREATE USER"},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"POST http://localhost:8000/api/v1/user"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"Content-Type: application/json"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"{"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    \"username\": \"test\","},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"    \"password\": \"test\""},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"### GET USER"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"GET http://localhost:8000/api/v1/user"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRlc3QiLCJpYXQiOjE2NjI1NjY0MTksImV4cCI6MTY2MjU2NzMxOX0.QYeoCA_qNSWfnY9wyJjWEvmT6p8T0XO6Oz7iadSwbyE"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"### UPDATE USER"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"PUT http://localhost:8000/api/v1/user"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":"Content-Type: application/json"},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRlc3QiLCJpYXQiOjE2NjI1NjY0MTksImV4cCI6MTY2MjU2NzMxOX0.QYeoCA_qNSWfnY9wyJjWEvmT6p8T0XO6Oz7iadSwbyE"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"{"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"    \"email\": \"test\","},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"    \"previousPassword\": \"test\","},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"    \"updatedPassword\": \"test1\""},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"### DELETE USER"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"DELETE http://localhost:8000/api/v1/user"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRlc3QiLCJpYXQiOjE2NjI1NjYxMTgsImV4cCI6MTY2MjU2NzAxOH0.7u4he3mncLOWH-o9EYFFpSd_-DT822X1FONZ4WFeZOk"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"### LOGIN"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"POST http://localhost:8000/api/v1/user/login"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"Content-Type: application/json"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"{"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"    \"username\": \"test\","},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"    \"password\": \"test\""},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"### LOGOUT (Need to login to get the access token from response object)"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"POST http://localhost:8000/api/v1/user/logout"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRlc3QiLCJpYXQiOjE2NjIzMDYzMzksImV4cCI6MTY2MjMwNzIzOX0.5r4boZMBQxnPlpCMrjl-v0FoR3gJwTKgWGRqa-SJKpQ"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"### TOKEN REFRESH"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"POST http://localhost:8000/api/v1/user/token"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"Content-Type: application/json"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"Cookie: jwt_refresh_token \u003d \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRlc3QiLCJpYXQiOjE2NjIzMDYzNjAsImV4cCI6MTY2MjkxMTE2MH0.biena8VzR0shF4Q84qIi2aNzd3yWi87DQ0Vn4rQojRk\""},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"### TEST TOKEN"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"POST http://localhost:8000/api/v1/user/testToken"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InRlc3QiLCJpYXQiOjE2NjI1NjU5MzQsImV4cCI6MTY2MjU2NTk5NH0.UlW3Vw7RCkK_k-9Ky3WQA3pSLNXaBznSx-y32ChjHhg"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":"Content-Type: application/json"},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"{"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"    \"username\": \"test\","},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"    \"password\": \"test\""},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"}"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"### DELETE USER"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"DELETE http://localhost:8000/api/v1/testDelete"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"Content-Type: application/json"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"{"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"    \"username\": \"test\","},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"    \"password\": \"test\""},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"}"}],"authorContributionMap":{"tlylt":69}},{"path":"user-service/test/index.spec.js","fileType":"js","lines":[{"lineNumber":1,"author":{"gitId":"tlylt"},"content":"import request from \u0027supertest\u0027;"},{"lineNumber":2,"author":{"gitId":"tlylt"},"content":"import { app } from \u0027../index.js\u0027;"},{"lineNumber":3,"author":{"gitId":"tlylt"},"content":"import { expect } from \u0027chai\u0027;"},{"lineNumber":4,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":5,"author":{"gitId":"tlylt"},"content":"const BASE_URL_PREFIX \u003d \u0027/api/v1/user\u0027;"},{"lineNumber":6,"author":{"gitId":"tlylt"},"content":"let accessToken \u003d \u0027\u0027;"},{"lineNumber":7,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":8,"author":{"gitId":"tlylt"},"content":"describe(\u0027GET /status\u0027, function () {"},{"lineNumber":9,"author":{"gitId":"tlylt"},"content":"    it(\u0027responds successfully\u0027, function (done) {"},{"lineNumber":10,"author":{"gitId":"tlylt"},"content":"        request(app)"},{"lineNumber":11,"author":{"gitId":"tlylt"},"content":"            .get(`${BASE_URL_PREFIX}/status`)"},{"lineNumber":12,"author":{"gitId":"tlylt"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":13,"author":{"gitId":"tlylt"},"content":"            .expect(\u0027Content-Type\u0027, /json/)"},{"lineNumber":14,"author":{"gitId":"tlylt"},"content":"            .expect(200, {"},{"lineNumber":15,"author":{"gitId":"tlylt"},"content":"                message: \u0027Hello World from user-service\u0027"},{"lineNumber":16,"author":{"gitId":"tlylt"},"content":"            }, done);"},{"lineNumber":17,"author":{"gitId":"tlylt"},"content":"    });"},{"lineNumber":18,"author":{"gitId":"tlylt"},"content":"});"},{"lineNumber":19,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":20,"author":{"gitId":"tlylt"},"content":"describe(\u0027POST /user\u0027, function () {"},{"lineNumber":21,"author":{"gitId":"tlylt"},"content":"    it(\u0027responds successfully for creating user\u0027, async function () {"},{"lineNumber":22,"author":{"gitId":"tlylt"},"content":"        // Clear user if any"},{"lineNumber":23,"author":{"gitId":"tlylt"},"content":"        await request(app)"},{"lineNumber":24,"author":{"gitId":"tlylt"},"content":"            .delete(`${BASE_URL_PREFIX}/testDelete`)"},{"lineNumber":25,"author":{"gitId":"tlylt"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":26,"author":{"gitId":"tlylt"},"content":"            .send({"},{"lineNumber":27,"author":{"gitId":"tlylt"},"content":"                username: \u0027testuser\u0027,"},{"lineNumber":28,"author":{"gitId":"tlylt"},"content":"                password: \u0027testuser\u0027"},{"lineNumber":29,"author":{"gitId":"tlylt"},"content":"            })"},{"lineNumber":30,"author":{"gitId":"tlylt"},"content":"        const response \u003d await request(app)"},{"lineNumber":31,"author":{"gitId":"tlylt"},"content":"            .post(`${BASE_URL_PREFIX}`)"},{"lineNumber":32,"author":{"gitId":"tlylt"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":33,"author":{"gitId":"tlylt"},"content":"            .send({"},{"lineNumber":34,"author":{"gitId":"tlylt"},"content":"                username: \u0027testuser\u0027,"},{"lineNumber":35,"author":{"gitId":"tlylt"},"content":"                password: \u0027testuser\u0027"},{"lineNumber":36,"author":{"gitId":"tlylt"},"content":"            })"},{"lineNumber":37,"author":{"gitId":"tlylt"},"content":"        expect(\u0027Content-Type\u0027, /json/)"},{"lineNumber":38,"author":{"gitId":"tlylt"},"content":"        expect(201)"},{"lineNumber":39,"author":{"gitId":"tlylt"},"content":"        expect(response.body.message).equal(\u0027Created new user testuser successfully\u0027);"},{"lineNumber":40,"author":{"gitId":"tlylt"},"content":"    });"},{"lineNumber":41,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":42,"author":{"gitId":"tlylt"},"content":"    it(\u0027responds unsuccessfully for creating duplicate user\u0027, async function () {"},{"lineNumber":43,"author":{"gitId":"tlylt"},"content":"        const response \u003d await request(app)"},{"lineNumber":44,"author":{"gitId":"tlylt"},"content":"            .post(`${BASE_URL_PREFIX}`)"},{"lineNumber":45,"author":{"gitId":"tlylt"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":46,"author":{"gitId":"tlylt"},"content":"            .send({"},{"lineNumber":47,"author":{"gitId":"tlylt"},"content":"                username: \u0027testuser\u0027,"},{"lineNumber":48,"author":{"gitId":"tlylt"},"content":"                password: \u0027testuser\u0027"},{"lineNumber":49,"author":{"gitId":"tlylt"},"content":"            })"},{"lineNumber":50,"author":{"gitId":"tlylt"},"content":"        expect(\u0027Content-Type\u0027, /json/)"},{"lineNumber":51,"author":{"gitId":"tlylt"},"content":"        expect(409)"},{"lineNumber":52,"author":{"gitId":"tlylt"},"content":"        expect(response.body.message).equal(\u0027Username has been taken\u0027);"},{"lineNumber":53,"author":{"gitId":"tlylt"},"content":"    });"},{"lineNumber":54,"author":{"gitId":"tlylt"},"content":"});"},{"lineNumber":55,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":56,"author":{"gitId":"tlylt"},"content":"describe(\u0027Login/Logout user\u0027, function () {"},{"lineNumber":57,"author":{"gitId":"tlylt"},"content":"    it(\u0027responds successfully for login\u0027, async function () {"},{"lineNumber":58,"author":{"gitId":"tlylt"},"content":"        const response \u003d await request(app)"},{"lineNumber":59,"author":{"gitId":"tlylt"},"content":"            .post(`${BASE_URL_PREFIX}/login`)"},{"lineNumber":60,"author":{"gitId":"tlylt"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":61,"author":{"gitId":"tlylt"},"content":"            .send({"},{"lineNumber":62,"author":{"gitId":"tlylt"},"content":"                username: \u0027testuser\u0027,"},{"lineNumber":63,"author":{"gitId":"tlylt"},"content":"                password: \u0027testuser\u0027"},{"lineNumber":64,"author":{"gitId":"tlylt"},"content":"            })"},{"lineNumber":65,"author":{"gitId":"tlylt"},"content":"        expect(\u0027Content-Type\u0027, /json/)"},{"lineNumber":66,"author":{"gitId":"tlylt"},"content":"        expect(200)"},{"lineNumber":67,"author":{"gitId":"tlylt"},"content":"        expect(response.body.message).equal(\u0027User login is successful\u0027);"},{"lineNumber":68,"author":{"gitId":"tlylt"},"content":"        expect(response.body.data).to.be.a(\u0027object\u0027);"},{"lineNumber":69,"author":{"gitId":"tlylt"},"content":"        expect(response.body.data).to.have.property(\u0027username\u0027);"},{"lineNumber":70,"author":{"gitId":"tlylt"},"content":"        expect(response.body.data).to.have.property(\u0027accessToken\u0027);"},{"lineNumber":71,"author":{"gitId":"tlylt"},"content":"        expect(response.body.data.username).equal(\u0027testuser\u0027);"},{"lineNumber":72,"author":{"gitId":"tlylt"},"content":"        accessToken \u003d response.body.data.accessToken;"},{"lineNumber":73,"author":{"gitId":"tlylt"},"content":"    });"},{"lineNumber":74,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":75,"author":{"gitId":"tlylt"},"content":"    it(\u0027responds successfully for logout\u0027, async function () {"},{"lineNumber":76,"author":{"gitId":"tlylt"},"content":"        const response \u003d await request(app)"},{"lineNumber":77,"author":{"gitId":"tlylt"},"content":"            .post(`${BASE_URL_PREFIX}/logout`)"},{"lineNumber":78,"author":{"gitId":"tlylt"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":79,"author":{"gitId":"tlylt"},"content":"            .set(\u0027Authorization\u0027, `Bearer ${accessToken}`)"},{"lineNumber":80,"author":{"gitId":"tlylt"},"content":"        expect(\u0027Content-Type\u0027, /json/)"},{"lineNumber":81,"author":{"gitId":"tlylt"},"content":"        expect(200)"},{"lineNumber":82,"author":{"gitId":"tlylt"},"content":"        expect(response.body.message).equal(\u0027User logout is successful\u0027);"},{"lineNumber":83,"author":{"gitId":"tlylt"},"content":"    });"},{"lineNumber":84,"author":{"gitId":"tlylt"},"content":"});"},{"lineNumber":85,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":86,"author":{"gitId":"tlylt"},"content":"describe(\u0027Delete user\u0027, function () {"},{"lineNumber":87,"author":{"gitId":"tlylt"},"content":"    it(\u0027responds successfully for delete\u0027, async function () {"},{"lineNumber":88,"author":{"gitId":"tlylt"},"content":"        // await some time to allow for token change"},{"lineNumber":89,"author":{"gitId":"tlylt"},"content":"        // https://github.com/auth0/node-jsonwebtoken/issues/570"},{"lineNumber":90,"author":{"gitId":"tlylt"},"content":"        await new Promise(resolve \u003d\u003e setTimeout(resolve, 1000));"},{"lineNumber":91,"author":{"gitId":"tlylt"},"content":"        // Update access token"},{"lineNumber":92,"author":{"gitId":"tlylt"},"content":"        const res \u003d await request(app)"},{"lineNumber":93,"author":{"gitId":"tlylt"},"content":"            .post(`${BASE_URL_PREFIX}/login`)"},{"lineNumber":94,"author":{"gitId":"tlylt"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":95,"author":{"gitId":"tlylt"},"content":"            .send({"},{"lineNumber":96,"author":{"gitId":"tlylt"},"content":"                username: \u0027testuser\u0027,"},{"lineNumber":97,"author":{"gitId":"tlylt"},"content":"                password: \u0027testuser\u0027"},{"lineNumber":98,"author":{"gitId":"tlylt"},"content":"            })"},{"lineNumber":99,"author":{"gitId":"tlylt"},"content":"        accessToken \u003d res.body.data.accessToken;"},{"lineNumber":100,"author":{"gitId":"tlylt"},"content":""},{"lineNumber":101,"author":{"gitId":"tlylt"},"content":"        const response \u003d await request(app)"},{"lineNumber":102,"author":{"gitId":"tlylt"},"content":"            .delete(`${BASE_URL_PREFIX}`)"},{"lineNumber":103,"author":{"gitId":"tlylt"},"content":"            .set(\u0027Accept\u0027, \u0027application/json\u0027)"},{"lineNumber":104,"author":{"gitId":"tlylt"},"content":"            .set(\u0027Authorization\u0027, `Bearer ${accessToken}`)"},{"lineNumber":105,"author":{"gitId":"tlylt"},"content":"        expect(\u0027Content-Type\u0027, /json/)"},{"lineNumber":106,"author":{"gitId":"tlylt"},"content":"        expect(200)"},{"lineNumber":107,"author":{"gitId":"tlylt"},"content":"        expect(response.body.message).equal(\u0027Deleted user testuser successfully\u0027);"},{"lineNumber":108,"author":{"gitId":"tlylt"},"content":"    });"},{"lineNumber":109,"author":{"gitId":"tlylt"},"content":"});"}],"authorContributionMap":{"tlylt":109}},{"path":"frontend/public/android-chrome-192x192.png","fileType":"png","isBinary":true,"lines":[],"authorContributionMap":{"tlylt":0}},{"path":"frontend/public/android-chrome-512x512.png","fileType":"png","isBinary":true,"lines":[],"authorContributionMap":{"tlylt":0}},{"path":"frontend/public/apple-touch-icon.png","fileType":"png","isBinary":true,"lines":[],"authorContributionMap":{"tlylt":0}},{"path":"frontend/public/favicon.ico","fileType":"ico","isBinary":true,"lines":[],"authorContributionMap":{"tlylt":0,"-":0}}]
